<script>document.write(decodeURIComponent(escape(atob("PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCIgLz4NCiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgLz4NCiAgICA8bWV0YSBodHRwLWVxdWl2PSJDYWNoZS1Db250cm9sIg0KICAgICAgICAgIGNvbnRlbnQ9Im5vLWNhY2hlLCBuby1zdG9yZSwgbXVzdC1yZXZhbGlkYXRlIiAvPg0KICAgIDxtZXRhIGh0dHAtZXF1aXY9IlByYWdtYSIgY29udGVudD0ibm8tY2FjaGUiIC8+DQogICAgPG1ldGEgaHR0cC1lcXVpdj0iRXhwaXJlcyIgY29udGVudD0iMCIgLz4NCg0KICAgIDx0aXRsZT5NTVBUIERhdGFiYXNlIC0gdjIwLjI8L3RpdGxlPg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2NoYXJ0LmpzIj48L3NjcmlwdD4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMveGxzeC8wLjE4LjUveGxzeC5mdWxsLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pzcGRmLzIuNS4xL2pzcGRmLnVtZC5taW4uanMiPjwvc2NyaXB0Pg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9odG1sMmNhbnZhcy8xLjQuMS9odG1sMmNhbnZhcy5taW4uanMiPjwvc2NyaXB0Pg0KDQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pzcGRmLWF1dG90YWJsZS8zLjUuMjUvanNwZGYucGx1Z2luLmF1dG90YWJsZS5taW4uanMiPjwvc2NyaXB0Pg0KDQoNCiAgICA8c3R5bGU+DQoNCg0KICAgICAgICAvKiBOYXZpZ2F0aW9uIGJ1dHRvbnMgZml4ICovDQogICAgICAgIC5uYXYtc2Nyb2xsLWJ0biB7DQogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgICAgICByaWdodDogMjBweDsNCiAgICAgICAgICAgIHdpZHRoOiA1MHB4Ow0KICAgICAgICAgICAgaGVpZ2h0OiA1MHB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogIzMzMyAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjZmZmOw0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgZGlzcGxheTogZmxleCAhaW1wb3J0YW50OyAvKiBGb3JjZXMgdmlzaWJpbGl0eSAqLw0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgei1pbmRleDogOTk5OTk7IC8qIEhpZ2hlciB0aGFuIGV2ZXJ5dGhpbmcgZWxzZSAqLw0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTBweCByZ2JhKDAsMCwwLDAuNSk7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4yczsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAubmF2LXNjcm9sbC1idG46YWN0aXZlIHsNCiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDAuOSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgI2J0bkdvVG9wIHsNCiAgICAgICAgICAgIGJvdHRvbTogOTBweDsNCiAgICAgICAgfQ0KDQogICAgICAgICNidG5Hb0JvdHRvbSB7DQogICAgICAgICAgICBib3R0b206IDMwcHg7DQogICAgICAgIH0NCg0KDQogICAgICAgIC8qIC0tLSBOZXcgTWF0Y2ggVGFibGUgU3R5bGVzIC0tLSAqLw0KICAgICAgICAjbWF0Y2hUYWJsZSB7DQogICAgICAgICAgICB0YWJsZS1sYXlvdXQ6IGZpeGVkOw0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlOw0KICAgICAgICB9DQoNCiAgICAgICAgICAgICNtYXRjaFRhYmxlIHRoLCAjbWF0Y2hUYWJsZSB0ZCB7DQogICAgICAgICAgICAgICAgcGFkZGluZzogOHB4IDRweDsNCiAgICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICAgICAgICAgICAgICAgIHdvcmQtd3JhcDogYnJlYWstd29yZDsNCiAgICAgICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOw0KICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8qIFNwZWNpZmljIENvbHVtbiBXaWR0aHM6IDEwJSB8IDE1JSB8IDc1JSAqLw0KICAgICAgICAgICAgICAgIC8qIFVwZGF0ZWQgd2lkdGhzOiBDb2wgMTogMTAlLCBDb2wgMjogMTAlLCBDb2wgMzogODAlICovDQogICAgICAgICAgICAgICAgI21hdGNoVGFibGUgdGg6bnRoLWNoaWxkKDEpLCAjbWF0Y2hUYWJsZSB0ZDpudGgtY2hpbGQoMSkgew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTAlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAjbWF0Y2hUYWJsZSB0aDpudGgtY2hpbGQoMiksICNtYXRjaFRhYmxlIHRkOm50aC1jaGlsZCgyKSB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMCUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAjbWF0Y2hUYWJsZSB0aDpudGgtY2hpbGQoMyksICNtYXRjaFRhYmxlIHRkOm50aC1jaGlsZCgzKSB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiA4MCUgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIEhlYWRlciBTdHlsaW5nIHdpdGggdHdvLWxpbmUgc3VwcG9ydCAqLw0KICAgICAgICAgICAgI21hdGNoVGFibGUgdGggew0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7DQogICAgICAgICAgICAgICAgY29sb3I6ICMzMzM7DQogICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC8qIERlYml0L0NyZWRpdCBDb2xvcnMgKi8NCiAgICAgICAgLmFtdC1kZWJpdCB7DQogICAgICAgICAgICBjb2xvcjogI0ZGMDAwMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgIH0NCg0KICAgICAgICAuYW10LWNyZWRpdCB7DQogICAgICAgICAgICBjb2xvcjogIzAwNjQwMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgIH0NCg0KDQoNCg0KICAgICAgICAvKiBTdHlsZSBmb3IgdGhlIG5ldyBRdWl0IEJ1dHRvbiAqLw0KICAgICAgICAucXVpdC1idG4gew0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmNDQ0NCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBib3JkZXI6IG5vbmUgIWltcG9ydGFudDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxNXB4Ow0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICBtYXJnaW4tbGVmdDogMTVweDsNCiAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICAgICAgICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7DQogICAgICAgIH0NCg0KICAgICAgICAgICAgLnF1aXQtYnRuOmhvdmVyIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjY2MwMDAwICFpbXBvcnRhbnQ7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5xdWl0LWJ0bjpkaXNhYmxlZCB7DQogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogIzk5OSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC5hbm9ueS1tYWluLXJvdyB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTFCRUU3ICFpbXBvcnRhbnQ7IC8qIFB1cnBsZSBmb3IgY3VycmVudCB5ZWFyIHRhcmdldCAqLw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgIH0NCg0KICAgICAgICAubWF0Y2gtcmVzdWx0LXJvdyB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyAvKiBXaGl0ZSBmb3IgaGlzdG9yaWNhbCBtYXRjaGVzICovDQogICAgICAgIH0NCg0KICAgICAgICAuc3BhY2VyLXJvdyB7DQogICAgICAgICAgICBoZWlnaHQ6IDE1cHg7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmMGYwOw0KICAgICAgICB9DQoNCiAgICAgICAgLmFub255LW1haW4tcm93IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNFMUJFRTcgIWltcG9ydGFudDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQoNCiAgICAgICAgLm1hdGNoLXJlc3VsdC1yb3cgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsNCiAgICAgICAgfQ0KDQogICAgICAgIC5idG4tcm93NSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTFCRUU3ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBIaWdobGlnaHQgdGhlIEFub255bW91cyByZWNvcmQgYmVpbmcgbWF0Y2hlZCAqLw0KICAgICAgICAuYW5vbnktbWFpbi1yb3cgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjljNCAhaW1wb3J0YW50OyAvKiBDaGFuZ2UgdG8gWWVsbG93ICovDQogICAgICAgICAgICA7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgfQ0KICAgICAgICAvKiBTdHlsZSBmb3Igc2VhcmNoIHJlc3VsdCByb3dzICovDQogICAgICAgIC5tYXRjaC1yZXN1bHQtcm93IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7DQogICAgICAgIH0NCg0KICAgICAgICAjZGV0YWlsZWRSZXN1bHRzIHRhYmxlIHsNCiAgICAgICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQ7IC8qIEtlZXBzIGNvbHVtbnMgYWxpZ25lZCBhY3Jvc3MgdGFibGVzICovDQogICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQogICAgICAgICAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7IC8qIEZvcmNlcyBsb25nIHRleHQgdG8gYnJlYWsgKi8NCiAgICAgICAgfQ0KDQogICAgICAgIC8qIERlZmluZSBzcGVjaWZpYyB3aWR0aHMgZm9yIGVhY2ggY29sdW1uICovDQogICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDEpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCgxKSB7DQogICAgICAgICAgICB3aWR0aDogMTglOw0KICAgICAgICB9DQogICAgICAgIC8qIFJlY2VpcHQgKi8NCiAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0aDpudGgtY2hpbGQoMiksICNkZXRhaWxlZFJlc3VsdHMgdGQ6bnRoLWNoaWxkKDIpIHsNCiAgICAgICAgICAgIHdpZHRoOiAxOCU7DQogICAgICAgIH0NCiAgICAgICAgLyogRGF0ZSAqLw0KICAgICAgICAjZGV0YWlsZWRSZXN1bHRzIHRoOm50aC1jaGlsZCgzKSwgI2RldGFpbGVkUmVzdWx0cyB0ZDpudGgtY2hpbGQoMykgew0KICAgICAgICAgICAgd2lkdGg6IDIyJTsNCiAgICAgICAgfQ0KICAgICAgICAvKiBBbW91bnQgKi8NCiAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0aDpudGgtY2hpbGQoNCksICNkZXRhaWxlZFJlc3VsdHMgdGQ6bnRoLWNoaWxkKDQpIHsNCiAgICAgICAgICAgIHdpZHRoOiA0MiU7DQogICAgICAgIH0NCiAgICAgICAgLyogUmVmZXJlbmNlICovDQoNCiAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0ZCwgI2RldGFpbGVkUmVzdWx0cyB0aCB7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHggNHB4Ow0KICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDsgLyogS2VlcHMgdGV4dCBhbGlnbmVkIHRvIHRoZSB0b3AgaWYgYSBuZWlnaGJvciB3cmFwcyAqLw0KICAgICAgICAgICAgd29yZC1icmVhazogYnJlYWstd29yZDsgLyogQWxsb3dzIGJyZWFraW5nIGxvbmcgc3RyaW5ncyBsaWtlIFVQSSBJRHMgKi8NCiAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3JtYWw7IC8qIEZJWEVEOiBBbGxvd3MgdGV4dCB0byBmbG93IHRvIHRoZSBuZXh0IGxpbmUgKi8NCiAgICAgICAgICAgIG92ZXJmbG93OiB2aXNpYmxlOyAvKiBGSVhFRDogTm8gbW9yZSBjdXR0aW5nIG9mZiB0ZXh0ICovDQogICAgICAgIH0NCg0KICAgICAgICAgICAgLyogU3BlY2lmaWMgZml4IGZvciBBbW91bnQgY29sdW1uIHRvIGtlZXAgY3VycmVuY3kgc3ltYm9scyB0b2dldGhlciAqLw0KICAgICAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0ZDpudGgtY2hpbGQoMykgew0KICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgOnJvb3Qgew0KICAgICAgICAgICAgLS1wcmltYXJ5LWJsdWU6ICMwMDAwOEI7DQogICAgICAgICAgICAtLWJnLXNhZmZyb246ICNGRkQ1ODA7DQogICAgICAgICAgICAtLXdoaXRlOiAjZmZmZmZmOw0KICAgICAgICAgICAgLS1jYW5jZWwtcmVkOiAjZmYwMDAwOw0KICAgICAgICAgICAgLS1ndy1ncmVlbjogIzAwNjQwMDsNCiAgICAgICAgICAgIC0tcm95YWwtYmx1ZTogIzAwMjM2NjsNCiAgICAgICAgICAgIC0tZ29sZDogI0ZGRDcwMDsNCiAgICAgICAgICAgIC0tZGFyay10ZXh0OiAjMWExYTFhOw0KICAgICAgICAgICAgLS12aWJyYW50LWJsdWU6ICMwMDMzY2M7DQogICAgICAgICAgICAtLWxvYW4tZ3JlZW46ICMwMDY0MDA7DQogICAgICAgICAgICAtLWRlcG9zaXQtcHVycGxlOiAjNEIwMDgyOw0KICAgICAgICAgICAgLS1leGVtcHQtZ3JheTogIzU1NTU1NTsNCiAgICAgICAgfQ0KDQogICAgICAgIGJvZHkgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmctc2FmZnJvbik7DQogICAgICAgICAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgICAgICAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgfQ0KDQogICAgICAgICNsb2dpbk92ZXJsYXkgew0KICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgdG9wOiAwOw0KICAgICAgICAgICAgbGVmdDogMDsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmctc2FmZnJvbik7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgIHotaW5kZXg6IDIwMDA7DQogICAgICAgIH0NCg0KICAgICAgICAubG9naW4tYm94IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDI1cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNXB4Ow0KICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDI1cHggcmdiYSgwLDAsMCwwLjIpOw0KICAgICAgICAgICAgd2lkdGg6IDI4MHB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC5sb2dpbi1ib3ggaW1nIHsNCiAgICAgICAgICAgICAgICB3aWR0aDogODBweDsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDgwcHg7DQogICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgICAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAjbWFpbkNvbnRlbnQgew0KICAgICAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5kYXNoLXRhYmxlIHsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgbWF4LXdpZHRoOiA2MDBweDsNCiAgICAgICAgICAgIG1hcmdpbjogMCBhdXRvIDVweCBhdXRvOyAvKiBSZWR1Y2VkIGJvdHRvbSBtYXJnaW4gZnJvbSAxNXB4IHRvIDVweCAqLw0KICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7IC8qIFNsaWdodGx5IHRpZ2h0ZXIgY29ybmVycyAqLw0KICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBzZXBhcmF0ZTsNCiAgICAgICAgICAgIGJvcmRlci1zcGFjaW5nOiAwOw0KICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44MHJlbTsgLyogU2xpZ2h0bHkgc21hbGxlciBmb250ICovDQogICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwwLDAsMC4xNSk7DQogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC5kYXNoLXRhYmxlIHRkIHsNCiAgICAgICAgICAgICAgICBwYWRkaW5nOiA0cHggMTJweDsgLyogUmVkdWNlZCB2ZXJ0aWNhbCBwYWRkaW5nIGZyb20gNnB4IHRvIDRweCAqLw0KICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC5kYXNoLWxhYmVsIHsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tZGFyay10ZXh0KTsNCiAgICAgICAgICAgIHdpZHRoOiA0MiU7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZjFmMWYxOw0KICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICAgICAgICAgIGJvcmRlci1yaWdodDogMnB4IHNvbGlkICNkZGQ7DQogICAgICAgIH0NCg0KICAgICAgICAuZGFzaC12YWwgew0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDsNCiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS12aWJyYW50LWJsdWUpOw0KICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgICAgIH0NCg0KICAgICAgICAuZGFzaC10YWJsZSB0cjpsYXN0LWNoaWxkIHRkIHsNCiAgICAgICAgICAgIGJvcmRlci1ib3R0b206IG5vbmU7DQogICAgICAgIH0NCg0KICAgICAgICAjbG9hZGluZ01zZyB7DQogICAgICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgdG9wOiA1MCU7DQogICAgICAgICAgICBsZWZ0OiA1MCU7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDEzOSwwLjkpOw0KICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgcGFkZGluZzogMjBweCA0MHB4Ow0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgICAgICAgICAgIHotaW5kZXg6IDMwMDA7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5zZWFyY2gtYXJlYSB7DQogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0td2hpdGUpOw0KICAgICAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAuZmlsdGVyLWdyb3VwIHsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEycHg7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICBnYXA6IDhweDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAuZmlsdGVyLWdyb3VwIGxhYmVsIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZjBmMGYwOw0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDVweCAxMHB4Ow0KICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC5maWx0ZXItZ3JvdXAgbGFiZWw6aGFzKGlucHV0OmNoZWNrZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogI2UwZTBmZjsNCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICBpbnB1dFt0eXBlPSJ0ZXh0Il0sIGlucHV0W3R5cGU9InBhc3N3b3JkIl0gew0KICAgICAgICAgICAgcGFkZGluZzogMTBweDsNCiAgICAgICAgICAgIHdpZHRoOiA4NSU7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDMwMHB4Ow0KICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQogICAgICAgIH0NCg0KICAgICAgICBidXR0b24gew0KICAgICAgICAgICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS13aGl0ZSk7DQogICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgICAgIG1hcmdpbjogMnB4Ow0KICAgICAgICB9DQoNCiAgICAgICAgI3V0aWxpdGllc01lbnUgew0KICAgICAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICAgICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDMsIDFmcik7DQogICAgICAgICAgICBnYXA6IDhweDsNCiAgICAgICAgICAgIGp1c3RpZnktaXRlbXM6IHN0cmV0Y2g7DQogICAgICAgIH0NCg0KICAgICAgICAudXRpbC1tZW51LWJ0biB7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBmb250LXNpemU6IDAuNzJyZW07DQogICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDJweDsNCiAgICAgICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICM5OTk7DQogICAgICAgIH0NCg0KDQogICAgICAgIC5idG4tcm93MSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjQUREOEU2ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCg0KICAgICAgICAuYnRuLXJvdzIgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzkwRUU5MCAhaW1wb3J0YW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmJ0bi1yb3czIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkEwN0EgIWltcG9ydGFudDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5idG4tcm93NCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGOUM0ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCiAgICAgICAgLyogWWVsbG93ICovDQogICAgICAgIC5idG4tcm93NSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTFCRUU3ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCiAgICAgICAgLyogUHVycGxlICovDQoNCiAgICAgICAgLmJ0bi13YSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjVEMzY2ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDY1MHB4Ow0KICAgICAgICAgICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87DQogICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87DQogICAgICAgIH0NCg0KICAgICAgICAuYnRuLXJvdGF0ZSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNmM3NTdkICFpbXBvcnRhbnQ7DQogICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgIG1heC13aWR0aDogNjUwcHg7DQogICAgICAgICAgICBtYXJnaW46IDVweCBhdXRvOw0KICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7DQogICAgICAgIH0NCg0KICAgICAgICBtYXJrIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHllbGxvdzsNCiAgICAgICAgICAgIGNvbG9yOiBibGFjazsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQoNCiAgICAgICAgLmNhbmNlbGxlZC1yb3csIC5jYW5jZWxsZWQtcm93IHRkIHsNCiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1jYW5jZWwtcmVkKSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQgIWltcG9ydGFudDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5ndy1yb3cgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tZ3ctZ3JlZW4pICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0td2hpdGUpICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCg0KICAgICAgICAgICAgLmd3LXJvdyAucmNwdC1saW5rIHsNCiAgICAgICAgICAgICAgICBjb2xvcjogIzkwRUU5MCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC5yY3B0LWxpbmsgew0KICAgICAgICAgICAgY29sb3I6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQoNCiAgICAgICAgLmxhdGVzdC1hZGRyLWJveCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmZmZGU3Ow0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgI2ZiYzAyZDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDEycHg7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxNXB4Ow0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgICAgICAgICAgZm9udC1zaXplOiAwLjg1cmVtOw0KICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNDsNCiAgICAgICAgICAgIGNvbG9yOiAjMzMzOw0KICAgICAgICAgICAgdGV4dC1hbGlnbjogbGVmdDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5sYXRlc3QtYWRkci1oZWFkZXIgew0KICAgICAgICAgICAgY29sb3I6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMXJlbTsNCiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDVweDsNCiAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICAgICB9DQoNCiAgICAgICAgLnBlbmRpbmctY29uc2VudC1saW5lIHsNCiAgICAgICAgICAgIG1hcmdpbi10b3A6IDhweDsNCiAgICAgICAgICAgIGJvcmRlci10b3A6IDFweCBkYXNoZWQgI2NjYzsNCiAgICAgICAgICAgIHBhZGRpbmctdG9wOiA1cHg7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tY2FuY2VsLXJlZCk7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jb25zZW50LWZ5LWJsdWUgew0KICAgICAgICAgICAgY29sb3I6IHZhcigtLXJveWFsLWJsdWUpOw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgIH0NCg0KICAgICAgICAudGFibGUtd3JhcCB7DQogICAgICAgICAgICBvdmVyZmxvdy14OiBhdXRvOw0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0td2hpdGUpOw0KICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDA7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7DQogICAgICAgIH0NCg0KICAgICAgICB0YWJsZSB7DQogICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQogICAgICAgICAgICBmb250LXNpemU6IDAuNzVyZW07DQogICAgICAgIH0NCg0KICAgICAgICB0aCwgdGQgew0KICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgICAgICAgICAgIHBhZGRpbmc6IDhweDsNCiAgICAgICAgICAgIHRleHQtYWxpZ246IGxlZnQ7DQogICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOw0KICAgICAgICB9DQoNCiAgICAgICAgdGggew0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgIGNvbG9yOiAjZmZmOw0KICAgICAgICB9DQoNCiAgICAgICAgLmFtdC1jcmVkaXQgew0KICAgICAgICAgICAgY29sb3I6ICMwMDAwRkY7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmFtdC1kZWJpdCB7DQogICAgICAgICAgICBjb2xvcjogI0ZGMDAwMDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgICAgIH0NCg0KICAgICAgICAuYmFuay10aXRsZSB7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDA7DQogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICBmb250LXNpemU6IDEuMXJlbTsNCiAgICAgICAgfQ0KDQoNCg0KICAgICAgICAvKiBDb250YWluZXIgZm9yIGVhY2ggc2VhcmNoIHJlc3VsdCBjYXJkICovDQogICAgICAgIC5yZWNvcmQgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICAgICAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgICAgIG1hcmdpbjogMTBweCA1cHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgICAgICBib3gtc2hhZG93OiAwIDJweCA1cHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOyAvKiBJbmRpY2F0ZXMgaXQgY2FuIGJlIGNsaWNrZWQgKi8NCiAgICAgICAgfQ0KDQogICAgICAgIC5maWVsZC1yb3cgew0KICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDVweCAwOw0KICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWU7DQogICAgICAgIH0NCg0KICAgICAgICAuZmllbGQtaGVhZGVyIHsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgY29sb3I6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICBtaW4td2lkdGg6IDE0MHB4Ow0KICAgICAgICAgICAgZmxleC1zaHJpbms6IDA7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBNb2JpbGUgU3BlY2lmaWM6IEhpZGUgbm9uLWVzc2VudGlhbCBmaWVsZHMgYnkgZGVmYXVsdCAqLw0KICAgICAgICBAbWVkaWEgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA2MDBweCkgew0KICAgICAgICAgICAgLmZpZWxkLXJvdyB7DQogICAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLyogSGlkZSBhbGwgcm93cyBleGNlcHQgdGhlIGZpcnN0IDMgKFJlY2VpcHQsIERhdGUsIE5hbWUsIEFtb3VudCkgb24gbW9iaWxlICovDQogICAgICAgICAgICAucmVjb3JkLmNvbGxhcHNlZCAuZmllbGQtcm93Om50aC1jaGlsZChuKzUpIHsNCiAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBBZGQgYSAiVGFwIHRvIHNlZSBtb3JlIiBpbmRpY2F0b3IgKi8NCiAgICAgICAgICAgIC5yZWNvcmQuY29sbGFwc2VkOjphZnRlciB7DQogICAgICAgICAgICAgICAgY29udGVudDogIuKWvCBUYXAgdG8gc2hvdyBkZXRhaWxzIjsNCiAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jazsNCiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjc1cmVtOw0KICAgICAgICAgICAgICAgIGNvbG9yOiAjODg4Ow0KICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5yZWNvcmQuZXhwYW5kZWQ6OmFmdGVyIHsNCiAgICAgICAgICAgICAgICBjb250ZW50OiAi4payIFRhcCB0byBoaWRlIGRldGFpbHMiOw0KICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzVyZW07DQogICAgICAgICAgICAgICAgY29sb3I6ICM4ODg7DQogICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLnJlY2VpcHQtdmlld3BvcnQgew0KICAgICAgICAgICAgb3ZlcmZsb3c6IGF1dG87DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICBwYWRkaW5nOiAwOw0KICAgICAgICAgICAgLXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6IHRvdWNoOw0KICAgICAgICB9DQoNCiAgICAgICAgLnJlY2VpcHQtY29udGFpbmVyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOw0KICAgICAgICAgICAgcGFkZGluZzogMTBweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgICAgIHdpZHRoOiA2NTBweDsNCiAgICAgICAgICAgIG1pbi13aWR0aDogNjUwcHg7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4zcyBlYXNlOw0KICAgICAgICAgICAgdHJhbnNmb3JtLW9yaWdpbjogY2VudGVyOw0KICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgICAgei1pbmRleDogMTA7DQogICAgICAgIH0NCg0KICAgICAgICAucmVjZWlwdC1odG1sIHsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgZm9udC1mYW1pbHk6ICJUaW1lcyBOZXcgUm9tYW4iLCBzZXJpZjsNCiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICMwMDA7DQogICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KICAgICAgICAgICAgY29sb3I6ICMwMDA7DQogICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICAgICAgICB6LWluZGV4OiAyOw0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC5yZWNlaXB0LWh0bWwgdGQgew0KICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMDA7DQogICAgICAgICAgICAgICAgcGFkZGluZzogNnB4IDEwcHg7DQogICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDFyZW07DQogICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuMjsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAucm90YXRlZCB7DQogICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSg5MGRlZykgc2NhbGUoMC43NSk7DQogICAgICAgICAgICBtYXJnaW46IDA7DQogICAgICAgIH0NCg0KICAgICAgICAuc3Mtc3BhY2VyIHsNCiAgICAgICAgICAgIGhlaWdodDogMDsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogaGVpZ2h0IDAuM3MgZWFzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAuc3Mtc3BhY2VyLmFjdGl2ZSB7DQogICAgICAgICAgICAgICAgaGVpZ2h0OiAyNTBweDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAud2F0ZXJtYXJrIHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgIHRvcDogNTAlOw0KICAgICAgICAgICAgbGVmdDogNTAlOw0KICAgICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgcm90YXRlKC0zMGRlZyk7DQogICAgICAgICAgICBmb250LXNpemU6IDgwcHg7DQogICAgICAgICAgICBjb2xvcjogcmdiYSgwLCAwLCAxMzksIDAuMik7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7DQogICAgICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsNCiAgICAgICAgICAgIHotaW5kZXg6IDU7DQogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgICAgICAgICAgYm9yZGVyOiAxMHB4IHNvbGlkIHJnYmEoMCwgMCwgMTM5LCAwLjIpOw0KICAgICAgICAgICAgcGFkZGluZzogMTBweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDE1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAuc3VtLXRhYmxlIHsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44cmVtOw0KICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgICAgICAgICAgdGFibGUtbGF5b3V0OiBmaXhlZDsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAuc3VtLXRhYmxlIHRoIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZDNkM2QzOw0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweDsNCiAgICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjODg4Ow0KICAgICAgICAgICAgICAgIGNvbG9yOiAjMDAwOw0KICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLnN1bS10YWJsZSB0aDpudGgtY2hpbGQoMSksIC5zdW0tdGFibGUgdGQ6bnRoLWNoaWxkKDEpIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDQwJTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAuc3VtLXRhYmxlIHRoOm50aC1jaGlsZCgyKSwgLnN1bS10YWJsZSB0ZDpudGgtY2hpbGQoMikgew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogMjUlOw0KICAgICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLnN1bS10YWJsZSB0aDpudGgtY2hpbGQoMyksIC5zdW0tdGFibGUgdGQ6bnRoLWNoaWxkKDMpIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDM1JTsNCiAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgIC5zZWN0aW9uLWhkciB7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmOWY5Zjk7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgIHRleHQtYWxpZ246IGxlZnQ7DQogICAgICAgIH0NCg0KICAgICAgICAuY2hhcnQtd3JhcHBlciB7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jaGFydC1jb250YWluZXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICBtYXJnaW4tdG9wOiAxNXB4Ow0KICAgICAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgICAgICAgICBoZWlnaHQ6IDMyMHB4Ow0KICAgICAgICAgICAgd2lkdGg6IDk1JTsNCiAgICAgICAgICAgIG1heC13aWR0aDogNTAwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAjc2VhcmNoU3VtbWFyeUJhciB7DQogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgICAgICBib3R0b206IDA7DQogICAgICAgICAgICBsZWZ0OiAwOw0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICAgICAgY29sb3I6IHZhcigtLXdoaXRlKTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDE1cHg7DQogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIHotaW5kZXg6IDk5OTsNCiAgICAgICAgfQ0KDQogICAgICAgIC5jYXNoLXN1bS1ib3ggew0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmctc2FmZnJvbik7DQogICAgICAgICAgICBwYWRkaW5nOiAxMHB4Ow0KICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4Ow0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTBweDsNCiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmV4ZWMtc3VtbWFyeSB7DQogICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQogICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHdoaXRlOw0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC5leGVjLXN1bW1hcnkgdGggew0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzVyZW07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIC5leGVjLXN1bW1hcnkgdGQgew0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2RkZDsNCiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjg1cmVtOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC5leHAtYmFyIHsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgICAgIHBhZGRpbmc6IDhweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAgICAgICAgIG1hcmdpbjogMTBweCAwOw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICB9DQoNCiAgICAgICAgLm1haW4tYmFyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgIH0NCg0KICAgICAgICAuZGVwb3NpdC1iYXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tZGVwb3NpdC1wdXJwbGUpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmxvYW4tYmFyIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxvYW4tZ3JlZW4pOw0KICAgICAgICB9DQoNCiAgICAgICAgLmV4ZW1wdC1iYXIgew0KICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tZXhlbXB0LWdyYXkpOw0KICAgICAgICB9DQoNCiAgICAgICAgLmFtdCB7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIGNvbG9yOiAjQjIyMjIyOw0KICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgICAgIH0NCg0KICAgICAgICAudmVyc2lvbi1sYWJlbCB7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tcm95YWwtYmx1ZSk7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC45cmVtOw0KICAgICAgICAgICAgbWFyZ2luLXRvcDogNXB4Ow0KICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7DQogICAgICAgIH0NCg0KICAgICAgICAudG90YWwtaGlnaGxpZ2h0LXJvdyB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGRjAwICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzAwMCAhaW1wb3J0YW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC50b3RhbC1oaWdobGlnaHQtcm93IHRkIHsNCiAgICAgICAgICAgICAgICBjb2xvcjogIzAwMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAudG90YWwtaGlnaGxpZ2h0LXJvdyAuYW10IHsNCiAgICAgICAgICAgICAgICBjb2xvcjogI0IyMjIyMiAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgIC5wcm9maXQtdGV4dCB7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tZ3ctZ3JlZW4pOw0KICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICBmb250LXNpemU6IDEuMXJlbTsNCiAgICAgICAgICAgIG1hcmdpbjogMTVweCAwOw0KICAgICAgICB9DQoNCiAgICAgICAgLmxvc3MtdGV4dCB7DQogICAgICAgICAgICBjb2xvcjogdmFyKC0tY2FuY2VsLXJlZCk7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOw0KICAgICAgICAgICAgbWFyZ2luOiAxNXB4IDA7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBGbG9hdGluZyBOYXZpZ2F0aW9uIEJ1dHRvbnMgLSBJbXByb3ZlZCBmb3IgTW9iaWxlICovDQogICAgICAgIC5uYXYtc2Nyb2xsLWJ0biB7DQogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgICAgICByaWdodDogMjBweDsgLyogRGVmYXVsdCBmb3IgRGVza3RvcCAqLw0KICAgICAgICAgICAgd2lkdGg6IDUwcHg7DQogICAgICAgICAgICBoZWlnaHQ6IDUwcHg7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgdmFyKC0tZ29sZCk7DQogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICBmb250LXNpemU6IDI0cHg7DQogICAgICAgICAgICBkaXNwbGF5OiBub25lOyAvKiBIaWRkZW4gYnkgZGVmYXVsdCAqLw0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICAgICAgei1pbmRleDogOTk5OTsgLyogRW5zdXJlIGl0J3MgYWJvdmUgZXZlcnl0aGluZyAqLw0KICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuNCk7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4yczsNCiAgICAgICAgICAgIHRvdWNoLWFjdGlvbjogbWFuaXB1bGF0aW9uOyAvKiBQcmV2ZW50cyB6b29taW5nIG9uIGZhc3QgdGFwcyAqLw0KICAgICAgICB9DQoNCiAgICAgICAgI2J0bkdvQm90dG9tIHsNCiAgICAgICAgICAgIGJvdHRvbTogOTBweDsNCiAgICAgICAgfQ0KDQogICAgICAgICNidG5Hb1RvcCB7DQogICAgICAgICAgICBib3R0b206IDI1cHg7DQogICAgICAgIH0NCg0KICAgICAgICAvKiBNb2JpbGUtU3BlY2lmaWMgQWRqdXN0bWVudHMgKi8NCiAgICAgICAgQG1lZGlhIHNjcmVlbiBhbmQgKG1heC13aWR0aDogNjAwcHgpIHsNCiAgICAgICAgICAgIC5uYXYtc2Nyb2xsLWJ0biB7DQogICAgICAgICAgICAgICAgcmlnaHQ6IDE1cHg7IC8qIFB1bGwgaW4gc2xpZ2h0bHkgKi8NCiAgICAgICAgICAgICAgICB3aWR0aDogNTVweDsgLyogTWFrZSBzbGlnaHRseSBiaWdnZXIgZm9yIHRodW1icyAqLw0KICAgICAgICAgICAgICAgIGhlaWdodDogNTVweDsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDEzOSwgMC44KTsgLyogU2xpZ2h0IHRyYW5zcGFyZW5jeSBzbyB5b3UgY2FuIHNlZSB0ZXh0IGJlaGluZCBpdCAqLw0KICAgICAgICAgICAgICAgIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpOyAvKiBNb2Rlcm4gYmx1ciBlZmZlY3QgKi8NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgI2J0bkdvQm90dG9tIHsNCiAgICAgICAgICAgICAgICBib3R0b206IDEwMHB4Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAjYnRuR29Ub3Agew0KICAgICAgICAgICAgICAgIGJvdHRvbTogMzBweDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQoNCiAgICAgICAgLyogRk9SQ0UgV1JBUFBJTkcgSU4gQU5PTllNQVRDSCBUQUJMRSAqLw0KICAgICAgICAjZGV0YWlsZWRSZXN1bHRzIHRhYmxlIHsNCiAgICAgICAgICAgIHRhYmxlLWxheW91dDogZml4ZWQgIWltcG9ydGFudDsgLyogQWJzb2x1dGUgbXVzdDogZm9yY2VzIGNvbHVtbnMgdG8gc3RheSBpbiB0aGVpciAlIHdpZHRoICovDQogICAgICAgICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCiAgICAgICAgfQ0KDQogICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGQsDQogICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGggew0KICAgICAgICAgICAgLyogVGhlc2UgdGhyZWUgbGluZXMgdG9nZXRoZXIga2lsbCB0aGUgb3ZlcmZsb3cgKi8NCiAgICAgICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgd2hpdGUtc3BhY2U6IG5vcm1hbCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDsNCiAgICAgICAgICAgIHBhZGRpbmc6IDVweDsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44cmVtOyAvKiBTbGlnaHRseSBzbWFsbGVyIGZvbnQgaGVscHMgbW9iaWxlIGZpdCAqLw0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC8qIFNwZWNpZmljIGNvbHVtbiB3aWR0aCBjb250cm9sIHRvIGVuc3VyZSBiYWxhbmNlICovDQogICAgICAgICAgICAjZGV0YWlsZWRSZXN1bHRzIHRoOm50aC1jaGlsZCgxKSwgI2RldGFpbGVkUmVzdWx0cyB0ZDpudGgtY2hpbGQoMSkgew0KICAgICAgICAgICAgICAgIHdpZHRoOiAyMCU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvKiBSZWNlaXB0ICovDQogICAgICAgICAgICAjZGV0YWlsZWRSZXN1bHRzIHRoOm50aC1jaGlsZCgyKSwgI2RldGFpbGVkUmVzdWx0cyB0ZDpudGgtY2hpbGQoMikgew0KICAgICAgICAgICAgICAgIHdpZHRoOiAxNSU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvKiBBbW91bnQgKi8NCiAgICAgICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDMpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCgzKSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDMzJTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8qIERldGFpbHMgKi8NCiAgICAgICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDQpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCg0KSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDMyJTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgLyogUmVmZXJlbmNlICovDQogICAgPC9zdHlsZT4NCjwvaGVhZD4NCiAgPGJvZHkgb25sb2FkPSJjaGVja0RldmljZUF1dGgoKSI+DQoNCiAgICAgIDxidXR0b24gaWQ9ImJ0bkdvVG9wIiBjbGFzcz0ibmF2LXNjcm9sbC1idG4iIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCd9KSI+4payPC9idXR0b24+DQogICAgICA8YnV0dG9uIGlkPSJidG5Hb0JvdHRvbSIgY2xhc3M9Im5hdi1zY3JvbGwtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2Nyb2xsVG8oe3RvcDogZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQsIGJlaGF2aW9yOiAnc21vb3RoJ30pIj7ilrw8L2J1dHRvbj4NCg0KICAgICAgPGF1ZGlvIGlkPSJiZ011c2ljIiBsb29wPg0KICAgICAgICAgIDxzb3VyY2Ugc3JjPSJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpLzF3aXJoendhcXV6ejZ1c2hxanVjNC9KYXlhSmF5YS5tcDM/cmxrZXk9dWJmZ21rNHd0dm8wb3RoamxyeG5udDJ2bCZkbD0xIiB0eXBlPSJhdWRpby9tcGVnIj4NCiAgICAgIDwvYXVkaW8+DQoNCiAgICAgIDxkaXYgaWQ9ImxvYWRpbmdNc2ciPlBsZWFzZSB3YWl0IC0gV29ya2luZyBvbiB5b3VyIHJlcXVlc3QuLi48L2Rpdj4NCg0KICAgICAgPGRpdiBpZD0ibG9naW5PdmVybGF5Ij4NCiAgICAgICAgICA8ZGl2IGNsYXNzPSJsb2dpbi1ib3giPg0KICAgICAgICAgICAgICA8aW1nIHNyYz0iaHR0cHM6Ly93d3cuZ2FuZXNhc2FybWEuY29tL1Blcml5YXZhLmpwZyIgYWx0PSJQZXJpeWF2YSIgLz4NCiAgICAgICAgICAgICAgPGgzPk1NUFQgRGF0YWJhc2UgQXV0aG9yaXphdGlvbjwvaDM+DQogICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJ2ZXJzaW9uLWxhYmVsIj5WZXJzaW9uOiAyMC4yPC9zcGFuPg0KICAgICAgICAgICAgICA8ZGl2IGlkPSJhdXRoU3RhdHVzIj5DaGVja2luZyBkZXZpY2UuLi48L2Rpdj4NCiAgICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogICAgICA8ZGl2IGlkPSJtYWluQ29udGVudCI+DQogICAgICAgICAgPGgyIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgY29sb3I6dmFyKC0tcHJpbWFyeS1ibHVlKTsgZm9udC1zaXplOiBjbGFtcCgxNnB4LCA1LjJ2dywgMjRweCk7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93OiBoaWRkZW47IHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOyBtYXJnaW46IDA7IHBhZGRpbmc6IDcwcHggMXB4IDVweCAxMXB4OyI+DQogICAgICAgICAgICAgIE15bGFpIE1haGFwZXJpeWF2YSBBbnVzaGFtIFRydXN0DQogICAgICAgICAgPC9oMj4NCg0KICAgICAgICAgIDxkaXYgaWQ9InVzZXJNb25pdG9yIiBjbGFzcz0ic3RhdHVzLWVtcHR5Ij4NCiAgICAgICAgICAgICAgPHNwYW4gaWQ9ImFjdGl2ZVVzZXJMaXN0Ij5Jbml0aWFsaXNpbmcgU3lzdGVtIE1vbml0b3IuLi48L3NwYW4+DQogICAgICAgICAgICAgIDxidXR0b24gaWQ9InF1aXRCdG4iIGNsYXNzPSJxdWl0LWJ0biIgb25jbGljaz0icHJvcGVyUXVpdCgpIiBzdHlsZT0iZGlzcGxheTpub25lOyI+UXVpdCBBcHA8L2J1dHRvbj4NCiAgICAgICAgICA8L2Rpdj4NCg0KDQogICAgICAgICAgPHRhYmxlIGNsYXNzPSJkYXNoLXRhYmxlIiBpZD0iZGFzaGJvYXJkVGFibGUiPg0KICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImRhc2gtbGFiZWwiPkxhc3QgUmVjcHQgTm8uPC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC12YWwiIGlkPSJkQWJzb2x1dGVMYXN0Ij4uLi48L3RkPg0KICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImRhc2gtbGFiZWwiPkxhdGVzdCBSZWNwdCBOby48L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLXZhbCIgaWQ9ImRMYXN0UmNwdCI+Li4uPC90ZD4NCiAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLWxhYmVsIj5SZWNlaXB0cyBSZWFkeTwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImRhc2gtdmFsIiBpZD0iZFJjcHRSZWFkeSI+Li4uPC90ZD4NCiAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLWxhYmVsIj5CYW5rIFN0bW50IHRpbGw8L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLXZhbCIgaWQ9ImRCYW5rRGF0ZSI+Li4uPC90ZD4NCiAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLWxhYmVsIj5DYXNoIHRvIERlcG9zaXQ8L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLXZhbCIgaWQ9ImRDYXNoRGVwb3NpdCI+Li4uPC90ZD4NCiAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICA8L3RhYmxlPg0KDQogICAgICAgICAgPHN0eWxlPg0KICAgICAgICAgICAgICAgIC8qIFB1c2hpbmcgdGhlIGNvbnRyYXN0IGFuZCBhZGRpbmcgYSBwdWxzZSBmb3IgdGhlICdMaXZlJyBmZWVsICovDQoNCg0KICAgICAgICAgICAgICAgICN1c2VyTW9uaXRvciB7DQogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgICAgICAgICAgICAgICAgdG9wOiAwOw0KICAgICAgICAgICAgICAgICAgICBsZWZ0OiAwOw0KICAgICAgICAgICAgICAgICAgICByaWdodDogMDsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgICAgIHotaW5kZXg6IDEwMDAwOw0KICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEycHg7DQogICAgICAgICAgICAgICAgICAgIG1hcmdpbjogYXV0bzsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDk1JTsNCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4Ow0KICAgICAgICAgICAgICAgICAgICBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgVGFob21hLCBHZW5ldmEsIFZlcmRhbmEsIHNhbnMtc2VyaWY7DQogICAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiYSgwLDAsMCwwLjEpOw0KICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlOw0KICAgICAgICAgICAgICAgICAgICAvKiAtLS0gQUREL1ZFUklGWSBUSEVTRSBCRUxPVyAtLS0gKi8NCg0KICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jazsgLyogRW5zdXJlcyBpdCBhY3RzIGFzIGEgZnVsbC13aWR0aCBjb250YWluZXIgKi8NCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBhdXRvOyAvKiBBTExPV1MgdGhlIGhlaWdodCB0byBncm93IHdpdGggY29udGVudCAqLw0KICAgICAgICAgICAgICAgICAgICBtaW4taGVpZ2h0OiBmaXQtY29udGVudDsgLyogRW5zdXJlcyBpdCBzdGF5cyBhdCBsZWFzdCBhcyBiaWcgYXMgdGhlIHRleHQgKi8NCiAgICAgICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDEuNTsgLyogQWRkcyBicmVhdGhpbmcgcm9vbSBiZXR3ZWVuIHRoZSBsaW5lcyAqLw0KDQogICAgICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3JtYWw7IC8qIFJFTU9WRSAnbm93cmFwJyBpZiBpdCB3YXMgdGhlcmUgZWxzZXdoZXJlICovDQogICAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiB2aXNpYmxlOyAvKiBFbnN1cmVzIHRleHQgaXNuJ3QgY3V0IG9mZiBpZiBpdCBncm93cyAqLw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8qI2FjdGl2ZVVzZXJMaXN0IHsNCiAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICBmb250LXNpemU6IDE0cHggIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7Ki8gLyogRm9yY2UgTGluZSAxICovDQogICAgICAgICAgICAgICAgLyptYXJnaW46IDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAyMHB4ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgIH0qLw0KDQogICAgICAgICAgICAgICAgI3F1aXRCdG4gew0KICAgICAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAycHggIWltcG9ydGFudDsgLyogRm9yY2UgTGluZSAyICovDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLnN0YXR1cy1hY3RpdmUgew0KICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMWEyMzdlOyAvKiBEZWVwIE5hdnkgQmx1ZSAqLw0KICAgICAgICAgICAgICAgICAgICBjb2xvcjogI2ZmZmZmZjsgLyogQ3Jpc3AgV2hpdGUgKi8NCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgI2ZmZDYwMDsgLyogQnJpZ2h0IFllbGxvdyBCb3JkZXIgKi8NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAuc3RhdHVzLWVtcHR5IHsNCiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsNCiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICM3NTc1NzU7DQogICAgICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7DQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICAvKiBVcGRhdGUgdGhpcyBzZWN0aW9uIGluIHlvdXIgZmlsZSAqLw0KDQogICAgICAgICAgICAgICAgLyogTElHSFQgR1JFRU4gUFVMU0UgRk9SIERBUksgQkxVRSBCQVIgKi8NCiAgICAgICAgICAgICAgICAubGl2ZS1kb3Qgew0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwcHg7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMHB4Ow0KICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDBGRjAwOyAvKiBWaWJyYW50IEdyZWVuICovDQogICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgICAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDhweDsNCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBwdWxzZSAxLjVzIGluZmluaXRlOw0KICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgOHB4ICMwMEZGMDA7IC8qIENvbnN0YW50IGdyZWVuIGdsb3cgKi8NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBAa2V5ZnJhbWVzIHB1bHNlIHsNCiAgICAgICAgICAgICAgICAgICAgMCUgew0KICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDBGRjAwOyAvKiBQdXJlIEdyZWVuICovDQogICAgICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgNXB4ICMwMEZGMDA7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICA1MCUgew0KICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMC44Ow0KICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxLjMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0NDRkYwMDsgLyogRWxlY3RyaWMgTGltZSBHcmVlbiBmb3IgaGlnaCBjb250cmFzdCAqLw0KICAgICAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDE4cHggI0NDRkYwMDsgLyogTGFyZ2UgZ2xvd2luZyBwdWxzZSAqLw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgMTAwJSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAxOw0KICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMwMEZGMDA7DQogICAgICAgICAgICAgICAgICAgICAgICBib3gtc2hhZG93OiAwIDAgNXB4ICMwMEZGMDA7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAuc3RhdHVzLWFjdGl2ZSB7DQogICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICMxYTIzN2U7DQogICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmOw0KICAgICAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjMDBGRjAwOyAvKiBDaGFuZ2VkIGZyb20gWWVsbG93IHRvIFZpYnJhbnQgR3JlZW4gKi8NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgPC9zdHlsZT4NCg0KICAgICAgICAgIDxkaXYgY2xhc3M9InNlYXJjaC1hcmVhIj4NCiAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmlsdGVyLWdyb3VwIiBpZD0ieWVhckZpbHRlckdyb3VwIj4NCiAgICAgICAgICAgICAgICAgIDxsYWJlbD4NCiAgICAgICAgICAgICAgICAgICAgICA8aW5wdXQgdHlwZT0icmFkaW8iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9InllYXJGaWx0ZXIiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJmQWxsIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iYWxsIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2VkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uY2hhbmdlPSJjbGVhcldvcmtzcGFjZSgpIiAvPg0KICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPkFsbDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICA8bGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJ5ZWFyRmlsdGVyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0iZjIwMjEiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSIyMDIxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0iY2xlYXJXb3Jrc3BhY2UoKSIgLz4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4yMS0yMjwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICA8bGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJ5ZWFyRmlsdGVyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0iZjIwMjIiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSIyMDIyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0iY2xlYXJXb3Jrc3BhY2UoKSIgLz4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4yMi0yMzwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICA8bGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJ5ZWFyRmlsdGVyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0iZjIwMjMiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSIyMDIzIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0iY2xlYXJXb3Jrc3BhY2UoKSIgLz4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4yMy0yNDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICA8bGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJ5ZWFyRmlsdGVyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0iZjIwMjQiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSIyMDI0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0iY2xlYXJXb3Jrc3BhY2UoKSIgLz4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4yNC0yNTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICA8bGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJ5ZWFyRmlsdGVyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0iZjIwMjUiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPSIyMDI1Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0iY2xlYXJXb3Jrc3BhY2UoKSIgLz4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj4yNS0yNjwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgIDwvbGFiZWw+DQogICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJtdXRlQnRuIiBvbmNsaWNrPSJ0b2dnbGVNdXRlKCkiIHN0eWxlPSJtYXJnaW4tbGVmdDogMTVweDsgcGFkZGluZzogNHB4IDEwcHg7IGN1cnNvcjogcG9pbnRlcjsgYm9yZGVyLXJhZGl1czogNHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyBiYWNrZ3JvdW5kOiAjZWVlZWVlICFpbXBvcnRhbnQ7IGNvbG9yOiBibGFjayAhaW1wb3J0YW50OyBmb250LWZhbWlseTogaW5oZXJpdDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc2l6ZTogMTNweDsgZGlzcGxheTogaW5saW5lLWJsb2NrOyB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOyI+DQogICAgICAgICAgICAgICAgICAgICAg8J+UhyBNdXRlDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgICAgPGRpdiBpZD0ic2VhcmNoQ29udHJvbHMiPg0KICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InRleHQiDQogICAgICAgICAgICAgICAgICAgICAgICAgaWQ9InNlYXJjaElucHV0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPSJTZWFyY2ggKCcsJyBmb3IgQU5ELCAnOycgZm9yIE9SKSIgLz4NCiAgICAgICAgICAgICAgICAgIDxiciAvPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhmZXRjaEFuZFNlYXJjaCkiIHN0eWxlPSJ3aWR0aDo0NSU7Ij4NCiAgICAgICAgICAgICAgICAgICAgICBTZWFyY2gNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJzaG93VXRpbGl0aWVzKCkiIHN0eWxlPSJ3aWR0aDo0NSU7Ij4NCiAgICAgICAgICAgICAgICAgICAgICBVdGlsaXR5IE1lbnUNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgICAgICA8ZGl2IGlkPSJ1dGlsaXRpZXNNZW51Ij4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcocnVuU3VtbWFyeSkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3cxIj5TdW1tYXJ5PC9idXR0b24+DQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1bkFub255bW91cykiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3cxIj5Bbm9ueW1vdXM8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcocnVuQ2FzaERlcCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3cxIj5DYXNoIERlcDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1blBDb25zZW50KSIgY2xhc3M9InV0aWwtbWVudS1idG4gYnRuLXJvdzIiPlAgQ29uc2VudDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5Eb25vckxpc3QpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93MiI+RG9ub3IgTGlzdDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5FUmVjZWlwdCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3cyIj5lUmVjZWlwdDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1bkJhbmtTdGF0ZW1lbnQpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93MyI+QmFuayBTdGF0ZW1lbnRzPC9idXR0b24+DQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1bkV4cGVuc2VzKSIgY2xhc3M9InV0aWwtbWVudS1idG4gYnRuLXJvdzMiPkV4cGVuc2VzPC9idXR0b24+DQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1bkFjY291bnRzKSIgY2xhc3M9InV0aWwtbWVudS1idG4gYnRuLXJvdzMiPkFjY291bnRzPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcocnVuRG9uYXRpb24pIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93NCI+RG9uYXRpb24gTGlzdDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJydW5Bbm9ueU1hdGNoKCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3c0Ij5Bbm9ueSBNYXRjaDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJzaG93RG93bmxvYWRNZW51KCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3c0IiBzdHlsZT0iZm9udC13ZWlnaHQ6Ym9sZDsgYm9yZGVyOiAycHggc29saWQgIzE1NjVjMDsiPkRvd25sb2FkczwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InNob3dEb25vck1hdGNoTGlzdCgpIiBzdHlsZT0iZ3JpZC1jb2x1bW46IDEgLyBzcGFuIDI7IGJhY2tncm91bmQtY29sb3I6ICMyMTk2RjMgIWltcG9ydGFudDsgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXI6IDFweCBzb2xpZCAjOTk5OyI+IERvbm9yLUJhbmstRXhwZW5zZS1NYXRjaCBMaXN0IDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJoaWRlVXRpbGl0aWVzKCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIiBzdHlsZT0iYmFja2dyb3VuZDojNjY2ICFpbXBvcnRhbnQ7IGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50OyI+QmFjazwvYnV0dG9uPg0KICAgICAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgPGRpdiBpZD0ibnVtZXJpY1Jlc3VsdHMiPjwvZGl2Pg0KICAgICAgICAgIDxkaXYgaWQ9ImRldGFpbGVkUmVzdWx0cyI+PC9kaXY+DQogICAgICA8L2Rpdj4NCg0KICAgICAgPGRpdiBpZD0ic2VhcmNoU3VtbWFyeUJhciIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPjwvZGl2Pg0KDQogICAgICA8c2NyaXB0Pg0KDQogICAgICAgICAgbGV0IE1haW5Td1VzZXJOYW1lID0gJyc7DQoNCiAgICAgICAgICB2YXIgZ2xvYmFsUGVuZGluZ0NhcHR1cmUgPSBbXTsNCiAgICAgICAgICBsZXQgZ2xvYmFsRGFzaGJvYXJkQ2FzaFRvdGFsID0gMDsNCiAgICAgICAgICBsZXQgZ2xvYmFsRGFzaGJvYXJkQ2FzaFJlY2VpcHRzID0gMDsNCg0KICAgICAgICAgIGxldCBwcmV2aW91c1VzZXJMaXN0ID0gW107DQoNCiAgICAgICAgICBjb25zdCBSRVZFUlNBTFNfVVJMID0gImh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkvazZjbHZrZTdoMnF4aGduMDd2bWI1L1JldmVyc2Fscy50eHQ/cmxrZXk9MXk5ZG5yZXZkNm1tbnMwMDNseWR1dzk1bSZkbD0xIjsNCg0KICAgICAgICAgIC8vY29uc3QgREFUQV9VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9zOXI3eGZuM2E4azV3eXJzd29oemgvTU1QVDIuS1A/cmxrZXk9OXR6YWVzdHd4cDhudW5lZHJzd3E5bzZqciZyYXc9MSI7DQogICAgICAgICAgY29uc3QgREFUQV9VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9qNnUzaG8xNGR4eWRyNXY2aDVoYmkvTU1QVDIuS1A/cmxrZXk9M2VrdXJycTh3a3owOGJzcGl4emdqajV6ciZzdD0zc283Yzk1ZyZkbD0xIjsNCg0KICAgICAgICAgIGNvbnN0IFBBU1NfVVJMID0gImh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkveHB6NTg1OW1qMTJ3eG5peDB4YmEyL2Rldm90ZWUudHh0P3Jsa2V5PTV6NnZtZ2Npank3dTlqeXdtZTNvZXhlNjYmcmF3PTEiOw0KICAgICAgICAgIC8vc2FtZSBmb3IgcGFzc3dvcmQNCg0KDQogICAgICAgICAgY29uc3QgQ0FTSF9MSVNUX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpLzE2b3NyM2VqenFjMGRnZGx6Ym9wOC9DYXNoLUxpc3QudHh0P3Jsa2V5PWwzbnI2d210enVsMTczeGh2cGM1OGJ5bXYmcmF3PTEiOw0KICAgICAgICAgIC8vc2FtZSANCg0KICAgICAgICAgIGNvbnN0IEVYUEVOU0VTX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL2E1ZTg4dmp6YjZ3MnFtZWwzeXN5eC9FeHBlbnNlcy54bHN4P3Jsa2V5PWptZDhpMGpzMXNreGwydnlhdnM3cG84eXAmZGw9MSI7DQogICAgICAgICAgLy9zYW1lDQoNCiAgICAgICAgICAvL2NvbnN0IEJBTktfTkVXX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL2psM2k1d3FxOGt6MHJldGVlN2p0ai9NTVBUMy5LUD9ybGtleT1ic3NwcXk1eHAwYnJsM2djbzV5b2wxY3lpJmRsPTEiOw0KICAgICAgICAgIGNvbnN0IEJBTktfTkVXX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL2xobWEwNXdoNTNiNjZ2bGNxYzk0aS9NTVBUMy5LUD9ybGtleT1sNHQ4dzVqYWgxaGJ5Z3QzbzFqZG5rYm01JnN0PTR1NmJvZmYyJmRsPTEiOw0KDQogICAgICAgICAgDQoNCg0KDQogICAgICAgICAgY29uc3QgVElUTEVTID0gWyJSZWNlaXB0IE5vLiIsICJEYXRlIiwgIk5hbWUiLCAiUGhvbmUiLCAiQWRkcmVzcyIsICJFbWFpbCIsICJQQU4iLCAiU3RhciIsICJHb3RocmFtIiwgIkFtb3VudCIsICJSZWZlcmVuY2UiLCAiTW9kZSIsICJUb3dhcmRzIiwgIkNhbmNlbCIsICJDb21tZW50cyIsICJQaW4gQ29kZSIsICJSZWNlaXB0IFByaW50ZWQiLCAiUHJhc2FkYW0gU2VudCIsICJDb3JwdXMgU2lnbmVkIiwgIkNvdW50cnkiXTsNCiAgICAgICAgICBjb25zdCBDVVRPRkZfREFURSA9IG5ldyBEYXRlKCcyMDI1LTA0LTAxJyk7DQogICAgICAgICAgbGV0IGFjdGl2ZUNoYXJ0cyA9IFtdOw0KDQogICAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogICAgICAgICAgLy8gQ09SRSBBUFBMSUNBVElPTiBGVU5DVElPTlMNCiAgICAgICAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIEdsb2JhbCBXcmFwcGVyOiBTaG93cyB0aGUgbG9hZGluZyBtZXNzYWdlIGJlZm9yZSBleGVjdXRpbmcgYSBmdW5jdGlvbg0KICAgICAgICAgICAqIGFuZCBoaWRlcyBpdCBvbmNlIHRoZSBmdW5jdGlvbiBjb21wbGV0ZXMuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiB3cmFwTG9hZGluZyhmbikgew0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsNCiAgICAgICAgICAgICAgICAgIGF3YWl0IGZuKCk7DQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgIH0sIDUwKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBBdXRoZW50aWNhdGlvbjogVmFsaWRhdGVzIHRoZSBlbnRlcmVkIHBhc3N3b3JkIGFnYWluc3QgdGhlDQogICAgICAgICAgICogcmVtb3RlIHRleHQgZmlsZSBhbmQgaW5pdGlhbGl6ZXMgdGhlIGRhc2hib2FyZCBvbiBzdWNjZXNzLg0KICAgICAgICAgICAqLw0KDQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBEYXNoYm9hcmQgU2V0dXA6IEZldGNoZXMgbWFzdGVyIGRhdGEgYW5kIGJhbmsgZmlsZXMgdG8gY2FsY3VsYXRlDQogICAgICAgICAgICogdGhlIGhpZ2gtbGV2ZWwgbWV0cmljcyAoTGFzdCBSZWNlaXB0LCBQZW5kaW5nIENvdW50LCBldGMuKSBzaG93biBvbiB0aGUgbWFpbiBzY3JlZW4uDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBpbml0RGFzaGJvYXJkKCkgew0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gdGV4dC5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IHJlYWR5Q291bnQgPSAwLCByZWFkeUFtdCA9IDA7DQogICAgICAgICAgICAgIGxldCBsYXRlc3RSY3B0TnVtID0gIiIsIGxhdGVzdFJjcHREYXRlID0gIiIsIGJhbmtEYXRlID0gIi0tLSI7DQogICAgICAgICAgICAgIGxldCBtYXhEYXRlT2JqID0gbmV3IERhdGUoMCk7DQogICAgICAgICAgICAgIGxldCBsYXN0RW50cnkgPSByZWNzW3JlY3MubGVuZ3RoIC0gMl07DQogICAgICAgICAgICAgIGxldCBsZiA9IGxhc3RFbnRyeS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICBsZXQgYWJzTGFzdFN0ciA9IChsZi5sZW5ndGggPj0gMikgPyBgJHtsZlswXX0gOiAke2xmWzFdfWAgOiAiLS0tIjsNCg0KICAgICAgICAgICAgICByZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDIwKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBjb25zdCByTm8gPSBmWzBdLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJEYXRlU3RyID0gZlsxXS50cmltKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZU9iaiA9IHBhcnNlRGF0ZShyRGF0ZVN0cik7DQogICAgICAgICAgICAgICAgICBjb25zdCBpc0MgPSBmWzEzXT8udG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICBjb25zdCBhZGRyUmF3ID0gZls0XT8udHJpbSgpIHx8ICIiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaXNBbm9uID0gKCFmWzJdIHx8IGZbMl0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpOw0KICAgICAgICAgICAgICAgICAgaWYgKHJEYXRlT2JqID4gbWF4RGF0ZU9iaikgew0KICAgICAgICAgICAgICAgICAgICAgIG1heERhdGVPYmogPSByRGF0ZU9iajsNCiAgICAgICAgICAgICAgICAgICAgICBsYXRlc3RSY3B0TnVtID0gck5vOw0KICAgICAgICAgICAgICAgICAgICAgIGxhdGVzdFJjcHREYXRlID0gckRhdGVTdHI7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAock5vLnN0YXJ0c1dpdGgoIkNHIikgJiYgckRhdGVPYmogPj0gQ1VUT0ZGX0RBVEUgJiYgIWlzQyAmJiAhaXNBbm9uICYmIGFkZHJSYXcgIT09ICIiKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmNwdFAgPSBmWzE2XT8udHJpbSgpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJhc1MgPSBmWzE3XT8udHJpbSgpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKChyY3B0UCA9PT0gIk5PIiB8fCByY3B0UCA9PT0gIiIpICYmIChwcmFzUyA9PT0gIk5PIiB8fCBwcmFzUyA9PT0gIiIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5Q291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHlBbXQgKz0gcGFyc2VGbG9hdChmWzldKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgYXdhaXQgcnVuQ2FzaERlcCh0cnVlKTsNCg0KICAgICAgICAgICAgICBjb25zdCBiUmVzID0gYXdhaXQgZmV0Y2goQkFOS19ORVdfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgYkxpbmVzID0gKGF3YWl0IGJSZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgY29uc3QgYkxhc3QgPSBiTGluZXNbYkxpbmVzLmxlbmd0aCAtIDJdPy5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICBpZiAoYkxhc3QpIGJhbmtEYXRlID0gYkxhc3RbMF07DQoNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RBYnNvbHV0ZUxhc3QnKS5pbm5lclRleHQgPSBhYnNMYXN0U3RyOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZExhc3RSY3B0JykuaW5uZXJUZXh0ID0gYCR7bGF0ZXN0UmNwdE51bX0gOiAke2xhdGVzdFJjcHREYXRlfWA7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkUmNwdFJlYWR5JykuaW5uZXJUZXh0ID0gYCR7cmVhZHlDb3VudH0gUmVjZWlwdHMgKFJzLiAke3JlYWR5QW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfSlgOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZEJhbmtEYXRlJykuaW5uZXJUZXh0ID0gYmFua0RhdGU7DQoNCiAgICAgICAgICAgICAgLy8gU2V0IENhc2ggcm93IGZyb20gdGhlIEdsb2JhbCB2YXJpYWJsZQ0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZENhc2hEZXBvc2l0JykuaW5uZXJIVE1MID0gKGdsb2JhbERhc2hib2FyZENhc2hUb3RhbCA+IDApID8NCiAgICAgICAgICAgICAgICAgIGA8c3BhbiBzdHlsZT0iZm9udC1zaXplOiAwLjhlbTsgY29sb3I6ICM2NjY7Ij4oJHtnbG9iYWxEYXNoYm9hcmRDYXNoUmVjZWlwdHN9IFJlY2VpcHRzKTwvc3Bhbj4g4oK5JHtnbG9iYWxEYXNoYm9hcmRDYXNoVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9YCA6ICJOaWwiOw0KDQogICAgICAgICAgICAgIHN5bmNXaXRoSnNvbkJpbigpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIERhdGUgUGFyc2VyOiBDb252ZXJ0cyBzdGFuZGFyZCBERC1NTS1ZWVlZIG9yIEREL01NL1lZWVkgc3RyaW5ncw0KICAgICAgICAgICAqIGludG8gdmFsaWQgSmF2YVNjcmlwdCBEYXRlIG9iamVjdHMgZm9yIGNvbXBhcmlzb25zLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gcGFyc2VEYXRlKGRhdGVTdHIpIHsNCiAgICAgICAgICAgICAgaWYgKCFkYXRlU3RyKSByZXR1cm4gbmV3IERhdGUoMCk7DQogICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZVN0ci5zcGxpdCgvWy0vXS8pOw0KICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoICE9PSAzKSByZXR1cm4gbmV3IERhdGUoMCk7DQogICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShwYXJ0c1syXSwgcGFydHNbMV0gLSAxLCBwYXJ0c1swXSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogRlkgQ2FsY3VsYXRvcjogRGV0ZXJtaW5lcyB0aGUgRmluYW5jaWFsIFllYXIgbGFiZWwgKGUuZy4sICIyNC0yNSIpDQogICAgICAgICAgICogYmFzZWQgb24gdGhlIHRyYW5zYWN0aW9uIGRhdGUgcHJvdmlkZWQuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBmdW5jdGlvbiBnZXRGWShkYXRlU3RyKSB7DQogICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZGF0ZVN0ci5zcGxpdCgvWy0vXS8pOw0KICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoICE9PSAzKSByZXR1cm4gIiI7DQogICAgICAgICAgICAgIGxldCBtID0gcGFyc2VJbnQocGFydHNbMV0pLCB5ID0gcGFyc2VJbnQocGFydHNbMl0pOw0KICAgICAgICAgICAgICBsZXQgc3RhcnRZZWFyID0gKG0gPCA0KSA/IHkgLSAxIDogeTsNCiAgICAgICAgICAgICAgbGV0IGVuZFllYXIgPSAoc3RhcnRZZWFyICsgMSkudG9TdHJpbmcoKS5zbGljZSgtMik7DQogICAgICAgICAgICAgIHJldHVybiBgJHtzdGFydFllYXIudG9TdHJpbmcoKS5zbGljZSgtMil9LSR7ZW5kWWVhcn1gOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFJlY2VpcHQgTm9ybWFsaXplcjogU3RyaXBzIGxlYWRpbmcgemVyb3MgYW5kIHN0YW5kYXJkaXplcyByZWNlaXB0DQogICAgICAgICAgICogcHJlZml4IGZvcm1hdHRpbmcgZm9yIGVhc2llciBzZWFyY2hpbmcuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBmdW5jdGlvbiBub3JtYWxpemVSY3B0KHMpIHsNCiAgICAgICAgICAgICAgaWYgKCFzKSByZXR1cm4gIiI7DQogICAgICAgICAgICAgIHJldHVybiBzLnRvVXBwZXJDYXNlKCkucmVwbGFjZSgvXihbQS1aXSspMCsvLCAnJDEnKS50cmltKCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogVGV4dCBIaWdobGlnaHRlcjogSW5qZWN0cyA8bWFyaz4gdGFncyBpbnRvIGEgc3RyaW5nIHRvIGhpZ2hsaWdodA0KICAgICAgICAgICAqIHNlYXJjaCB0ZXJtcyBmb3VuZCB3aXRoaW4gdGhlIHJlc3VsdHMuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBmdW5jdGlvbiBoaWdobGlnaHRUZXh0KHRleHQsIHRlcm1zKSB7DQogICAgICAgICAgICAgIGlmICghdGVybXMgfHwgIXRlcm1zLmxlbmd0aCB8fCAhdGV4dCkgcmV0dXJuIHRleHQgfHwgIiI7DQogICAgICAgICAgICAgIGxldCBoID0gU3RyaW5nKHRleHQpOw0KICAgICAgICAgICAgICB0ZXJtcy5mb3JFYWNoKHQgPT4gew0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAoJHt0fSlgLCAnZ2knKTsNCiAgICAgICAgICAgICAgICAgIGggPSBoLnJlcGxhY2UocmVnZXgsICc8bWFyaz4kMTwvbWFyaz4nKTsNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIHJldHVybiBoOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFNlYXJjaCBMb2dpYyBFdmFsdWF0b3I6IEhhbmRsZXMgbXVsdGktdGVybSBzZWFyY2hpbmcgdXNpbmcNCiAgICAgICAgICAgKiBjb21tYXMgZm9yICdBTkQnIGxvZ2ljIGFuZCBzZW1pY29sb25zIGZvciAnT1InIGxvZ2ljLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gZXZhbHVhdGVMb2dpYyhyb3dTdHIsIHFSYXcpIHsNCiAgICAgICAgICAgICAgbGV0IGxvZ2ljID0gIkFORCI7DQogICAgICAgICAgICAgIGxldCB0ZXJtcyA9IFtdOw0KICAgICAgICAgICAgICBpZiAocVJhdy5pbmNsdWRlcygnOycpKSB7DQogICAgICAgICAgICAgICAgICBsb2dpYyA9ICJPUiI7DQogICAgICAgICAgICAgICAgICB0ZXJtcyA9IHFSYXcudG9Mb3dlckNhc2UoKS5zcGxpdCgnOycpLm1hcCh0ID0+IHQudHJpbSgpKS5maWx0ZXIodCA9PiB0ICE9PSAiIik7DQogICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICB0ZXJtcyA9IHFSYXcudG9Mb3dlckNhc2UoKS5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKS5maWx0ZXIodCA9PiB0ICE9PSAiIik7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgaWYgKGxvZ2ljID09PSAiT1IiKSByZXR1cm4geyBtYXRjaGVzOiB0ZXJtcy5zb21lKHQgPT4gcm93U3RyLmluY2x1ZGVzKHQpKSwgdGVybXM6IHRlcm1zIH07DQogICAgICAgICAgICAgIGVsc2UgcmV0dXJuIHsgbWF0Y2hlczogdGVybXMuZXZlcnkodCA9PiByb3dTdHIuaW5jbHVkZXModCkpLCB0ZXJtczogdGVybXMgfTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBVSSBDbGVhbnVwOiBDbGVhcnMgYWxsIGN1cnJlbnQgcmVzdWx0cywgY2hhcnRzLCBhbmQgc3VtbWFyeSBiYXJzDQogICAgICAgICAgICogdG8gcHJlcGFyZSB0aGUgd29ya3NwYWNlIGZvciBhIG5ldyBvcGVyYXRpb24uDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBmdW5jdGlvbiBjbGVhcldvcmtzcGFjZSgpIHsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ251bWVyaWNSZXN1bHRzJykuaW5uZXJIVE1MID0gIiI7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSAiIjsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICBhY3RpdmVDaGFydHMuZm9yRWFjaChjID0+IHsgaWYgKGMpIGMuZGVzdHJveSgpOyB9KTsNCiAgICAgICAgICAgICAgYWN0aXZlQ2hhcnRzID0gW107DQoNCiAgICAgICAgICAgICAgLy8gSGlkZSBidXR0b25zIHdoZW4gY2xlYXJpbmcNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyhmYWxzZSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogTWVudSBDb250cm9sbGVyIChTaG93KTogRGlzcGxheXMgdGhlIFV0aWxpdHkgZ3JpZCBhbmQgaGlkZXMgc3RhbmRhcmQgc2VhcmNoIGNvbnRyb2xzLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gc2hvd1V0aWxpdGllcygpIHsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaENvbnRyb2xzJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3V0aWxpdGllc01lbnUnKS5zdHlsZS5kaXNwbGF5ID0gJ2dyaWQnOw0KICAgICAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgICBjb25zdCBjdXJGWSA9IChub3cuZ2V0TW9udGgoKSA8IDMpID8gbm93LmdldEZ1bGxZZWFyKCkgLSAxIDogbm93LmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZicgKyBjdXJGWSkpIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmJyArIGN1ckZZKS5jaGVja2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBNZW51IENvbnRyb2xsZXIgKEhpZGUpOiBTd2l0Y2hlcyBiYWNrIHRvIHRoZSBzZWFyY2ggaW5wdXQgYW5kIGhpZGVzIHRoZSBVdGlsaXR5IGdyaWQuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBmdW5jdGlvbiBoaWRlVXRpbGl0aWVzKCkgew0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoQ29udHJvbHMnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3V0aWxpdGllc01lbnUnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZkFsbCcpLmNoZWNrZWQgPSB0cnVlOw0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIE5hdmlnYXRpb24gU2hvcnRjdXQ6IFByb2dyYW1tYXRpY2FsbHkgb3BlbnMgdGhlIFV0aWxpdHkgTWVudQ0KICAgICAgICAgICAqIGFuZCB0cmlnZ2VycyB0aGUgZVJlY2VpcHQgdmlldyBmb3IgYSBzcGVjaWZpYyByZWNlaXB0IG51bWJlci4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGZ1bmN0aW9uIGp1bXBUb1JlY2VpcHQocmNwdE5vKSB7DQogICAgICAgICAgICAgIHNob3dVdGlsaXRpZXMoKTsNCiAgICAgICAgICAgICAgcnVuRVJlY2VpcHQocmNwdE5vKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBCYW5rIFN0YXRlbWVudCBWaWV3ZXI6IEZpbHRlcnMgYW5kIGRpc3BsYXlzIGJhbmsgdHJhbnNhY3Rpb24gcmVjb3JkcyBmcm9tIHRoZSBNTVBUMyBmaWxlDQogICAgICAgICAgICogYmFzZWQgb24gdGhlIHNlbGVjdGVkIEZpbmFuY2lhbCBZZWFyLiBJdCBoaWdobGlnaHRzIGNyZWRpdHMgaW4gYmx1ZSBhbmQgZGViaXRzIGluIHJlZC4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkJhbmtTdGF0ZW1lbnQoKSB7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICAgICAgICAgICAgY29uc3QgZnlMYWJlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykucGFyZW50RWxlbWVudC5pbm5lclRleHQudHJpbSgpOw0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChCQU5LX05FV19VUkwpOw0KICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IChhd2FpdCByZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IHRDciA9IDAsIHREciA9IDAsIHRyID0gIiI7DQogICAgICAgICAgICAgIGxpbmVzLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IGxpbmUuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDUpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVTdHIgPSBmWzBdLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRPYmogPSBwYXJzZURhdGUoZGF0ZVN0cik7DQogICAgICAgICAgICAgICAgICBjb25zdCBkciA9IHBhcnNlRmxvYXQoZlszXSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNyID0gcGFyc2VGbG9hdChmWzRdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgbGV0IGluWWVhciA9IChzWWVhciA9PT0gImFsbCIpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFpblllYXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmeVMgPSBwYXJzZUludChzWWVhcik7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IGRPYmouZ2V0TW9udGgoKSArIDEsIHkgPSBkT2JqLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgaW5ZZWFyID0gKHkgPT09IGZ5UyAmJiBtID49IDQpIHx8ICh5ID09PSBmeVMgKyAxICYmIG0gPD0gMyk7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAoaW5ZZWFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgdENyICs9IGNyOyB0RHIgKz0gZHI7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGFtdCA9IGNyID4gMCA/IGA8c3BhbiBjbGFzcz0iYW10LWNyZWRpdCI+JHtjci50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3NwYW4+YCA6IGA8c3BhbiBjbGFzcz0iYW10LWRlYml0Ij4ke2RyLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvc3Bhbj5gOw0KICAgICAgICAgICAgICAgICAgICAgIHRyICs9IGA8dHI+PHRkPiR7ZlswXX08L3RkPjx0ZD4ke2ZbMV19PC90ZD48dGQ+JHthbXR9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iYmFuay10aXRsZSI+QmFuayBTdGF0ZW1lbnRzIGZvciBGWSA6ICR7c1llYXIgPT09ICJhbGwiID8gIkFsbCIgOiBmeUxhYmVsfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPjx0cj48dGg+RGF0ZTwvdGg+PHRoPkRldGFpbHM8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+JHt0cn08L3RhYmxlPjwvZGl2PmA7DQogICAgICAgICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoU3VtbWFyeUJhcicpOw0KICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGBUb3RhbCBDcjog4oK5JHt0Q3IudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9IHwgVG90YWwgRHI6IOKCuSR7dERyLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfWA7DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogRXhwZW5zZSBUcmFja2VyOiBEb3dubG9hZHMgYW5kIHBhcnNlcyB0aGUgRXhwZW5zZXMgRXhjZWwgZmlsZS4gSXQgY2F0ZWdvcml6ZXMNCiAgICAgICAgICAgKiBzcGVuZGluZyBpbnRvIEdlbmVyYWwsIERlcG9zaXRzLCBMb2FucywgYW5kIEV4ZW1wdGVkIGdyb3VwcyBmb3IgdGhlIHNlbGVjdGVkIHBlcmlvZC4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkV4cGVuc2VzKCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGWSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChFWFBFTlNFU19VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnJlYWQobmV3IFVpbnQ4QXJyYXkoYXdhaXQgcmVzLmFycmF5QnVmZmVyKCkpLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHdiLlNoZWV0c1t3Yi5TaGVldE5hbWVzWzBdXSwgeyBoZWFkZXI6IDEgfSk7DQogICAgICAgICAgICAgICAgICBsZXQgaHRtbE1hcCA9IHsgbWFpbjogIiIsIGxvYW46ICIiLCBleGVtcHQ6ICIiLCBkZXBvc2l0OiAiIiB9Ow0KICAgICAgICAgICAgICAgICAgbGV0IGNvdW50TWFwID0geyBtYWluOiAwLCBsb2FuOiAwLCBkZXBvc2l0OiAwLCBleGVtcHQ6IDAgfTsNCiAgICAgICAgICAgICAgICAgIGxldCB0b3RhbE1hcCA9IHsgbWFpbjogMCwgbG9hbjogMCwgZGVwb3NpdDogMCwgZXhlbXB0OiAwIH07DQogICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBkYXRhW2ldOw0KICAgICAgICAgICAgICAgICAgICAgIGlmICghcm93IHx8IHJvdy5sZW5ndGggPCAyKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgZE9iaiA9ICh0eXBlb2Ygcm93WzBdID09PSAnbnVtYmVyJykgPyBYTFNYLnV0aWxzLnNoZWV0X3RvX2RhdGUocm93WzBdKSA6IHBhcnNlRGF0ZShyb3dbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkT2JqLmdldFRpbWUoKSkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBtID0gZE9iai5nZXRNb250aCgpICsgMSwgeSA9IGRPYmouZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgcm93RlkgPSAobSA+PSA0KSA/IHkudG9TdHJpbmcoKSA6ICh5IC0gMSkudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRGWSAhPT0gImFsbCIgJiYgcm93RlkgIT09IHNlbGVjdGVkRlkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXQgPSBwYXJzZUZsb2F0KHJvd1szXSkgfHwgMCwgZGVzYyA9IChyb3dbNF0gfHwgcm93WzFdIHx8ICIiKS50b1N0cmluZygpLCBzID0gZGVzYy50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCByb3dIdG1sID0gYDx0cj48dGQ+JHtkT2JqLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tR0InKX08L3RkPjx0ZD4ke2Rlc2N9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHthbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKHMuaW5jbHVkZXMoImV4ZW1wdCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxNYXAuZXhlbXB0ICs9IHJvd0h0bWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50TWFwLmV4ZW1wdCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE1hcC5leGVtcHQgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocy5pbmNsdWRlcygiZGVwb3NpdCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxNYXAuZGVwb3NpdCArPSByb3dIdG1sOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudE1hcC5kZXBvc2l0Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsTWFwLmRlcG9zaXQgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocy5pbmNsdWRlcygibG9hbiIpIHx8IHMuaW5jbHVkZXMoImNsb3N1cmUiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sTWFwLmxvYW4gKz0gcm93SHRtbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRNYXAubG9hbisrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE1hcC5sb2FuICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sTWFwLm1haW4gKz0gcm93SHRtbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRNYXAubWFpbisrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE1hcC5tYWluICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbnVtZXJpY1Jlc3VsdHMnKS5pbm5lckhUTUwgPSBgPHRhYmxlIGNsYXNzPSJleGVjLXN1bW1hcnkiPjx0cj48dGg+SXRlbTwvdGg+PHRoPkNvdW50PC90aD48dGg+VG90YWw8L3RoPjwvdHI+PHRyIHN0eWxlPSJjb2xvcjp2YXIoLS1wcmltYXJ5LWJsdWUpOyI+PHRkPkdlbmVyYWw8L3RkPjx0ZD4ke2NvdW50TWFwLm1haW59PC90ZD48dGQ+4oK5JHt0b3RhbE1hcC5tYWluLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48dHIgc3R5bGU9ImNvbG9yOnZhcigtLWRlcG9zaXQtcHVycGxlKTsiPjx0ZD5EZXBvc2l0czwvdGQ+PHRkPiR7Y291bnRNYXAuZGVwb3NpdH08L3RkPjx0ZD7igrkke3RvdGFsTWFwLmRlcG9zaXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPjx0ciBzdHlsZT0iY29sb3I6dmFyKC0tbG9hbi1ncmVlbik7Ij48dGQ+TG9hbnM8L3RkPjx0ZD4ke2NvdW50TWFwLmxvYW59PC90ZD48dGQ+4oK5JHt0b3RhbE1hcC5sb2FuLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48dHIgc3R5bGU9ImNvbG9yOnZhcigtLWV4ZW1wdC1ncmF5KTsiPjx0ZD5FeGVtcHRlZDwvdGQ+PHRkPiR7Y291bnRNYXAuZXhlbXB0fTwvdGQ+PHRkPuKCuSR7dG90YWxNYXAuZXhlbXB0LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48L3RhYmxlPmA7DQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gYDxkaXYgY2xhc3M9ImV4cC1iYXIgbWFpbi1iYXIiPjxzcGFuPkdFTkVSQUw8L3NwYW4+PHNwYW4+4oK5JHt0b3RhbE1hcC5tYWluLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvc3Bhbj48L2Rpdj48ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGU+JHtodG1sTWFwLm1haW59PC90YWJsZT48L2Rpdj48ZGl2IGNsYXNzPSJleHAtYmFyIGRlcG9zaXQtYmFyIj48c3Bhbj5ERVBPU0lUUzwvc3Bhbj48c3Bhbj7igrkke3RvdGFsTWFwLmRlcG9zaXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9zcGFuPjwvZGl2PjxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT4ke2h0bWxNYXAuZGVwb3NpdH08L3RhYmxlPjwvZGl2PjxkaXYgY2xhc3M9ImV4cC1iYXIgbG9hbi1iYXIiPjxzcGFuPkxPQU5TPC9zcGFuPjxzcGFuPuKCuSR7dG90YWxNYXAubG9hbi50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3NwYW4+PC9kaXY+PGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPiR7aHRtbE1hcC5sb2FufTwvdGFibGU+PC9kaXY+PGRpdiBjbGFzcz0iZXhwLWJhciBleGVtcHQtYmFyIj48c3Bhbj5FWEVNUFRFRDwvc3Bhbj48c3Bhbj7igrkke3RvdGFsTWFwLmV4ZW1wdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3NwYW4+PC9kaXY+PGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPiR7aHRtbE1hcC5leGVtcHR9PC90YWJsZT48L2Rpdj5gOw0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogQ29uc2VudCBNYW5hZ2VyOiBJZGVudGlmaWVzICJDb3JwdXMiIGRvbmF0aW9ucyB3aGVyZSB0aGUgbWFuZGF0b3J5IGNvbnNlbnQgZm9ybQ0KICAgICAgICAgICAqIGhhcyBub3QgeWV0IGJlZW4gc2lnbmVkIChDb3JwdXMgU2lnbmVkID0gTk8pLiBIZWxwcyBpbiB0cmFja2luZyByZWd1bGF0b3J5IGNvbXBsaWFuY2UuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5QQ29uc2VudCgpIHsNCiAgICAgICAgICAgICAgbGV0IHEgPSBwcm9tcHQoIlNlYXJjaD8gKEJsYW5rIGZvciBBbGwpIiwgIiIpOw0KICAgICAgICAgICAgICBpZiAocSA9PT0gbnVsbCkgcmV0dXJuOw0KICAgICAgICAgICAgICBsZXQgcVJhdyA9IHEudHJpbSgpLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gKGF3YWl0IHJlcy50ZXh0KCkpLnNwbGl0KCdcbicpOw0KICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IFtdOw0KICAgICAgICAgICAgICBsZXQgc2MgPSAwLCBzYSA9IDA7DQogICAgICAgICAgICAgIHJlY3MuZm9yRWFjaChyID0+IHsNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMjApIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRQID0gZlsxXS5zcGxpdCgvWy0vXS8pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgbW0gPSBwYXJzZUludChkUFsxXSksIHl5ID0gcGFyc2VJbnQoZFBbMl0pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaW5ZZWFyID0gKHNZZWFyID09PSAiYWxsIikgfHwgKCh5eSA9PT0gcGFyc2VJbnQoc1llYXIpICYmIG1tID49IDQpIHx8ICh5eSA9PT0gcGFyc2VJbnQoc1llYXIpICsgMSAmJiBtbSA8PSAzKSk7DQogICAgICAgICAgICAgICAgICBpZiAoIWluWWVhciB8fCBmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiIHx8IGZbMTJdPy50cmltKCkudG9VcHBlckNhc2UoKSAhPT0gIkNPUlBVUyIgfHwgKGZbMThdPy50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gIllFUyIpKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBjb25zdCByb3dTdHIgPSByLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBldmFsID0gKHFSYXcgPT09ICIiKSA/IHsgbWF0Y2hlczogdHJ1ZSwgdGVybXM6IFtdIH0gOiBldmFsdWF0ZUxvZ2ljKHJvd1N0ciwgcVJhdyk7DQogICAgICAgICAgICAgICAgICBpZiAoZXZhbC5tYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGFtdCA9IHBhcnNlRmxvYXQoZls5XSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICBzYysrOw0KICAgICAgICAgICAgICAgICAgICAgIHNhICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2goeyByY3B0OiBmWzBdLCBkYXRlOiBmWzFdLCBhbXQ6IGFtdCwgbmFtZTogZlsyXSwgcGhvbmU6IGZbM10gfHwgIi0tLSIsIGFkZHI6IGZbNF0/LnJlcGxhY2UoL34vZywgJywgJyksIHBpbjogZlsxNV0sIGNvdW50cnk6IGZbMTldIH0pOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgcmVzdWx0cy5zb3J0KChhLCBiKSA9PiBiLmFtdCAtIGEuYW10KTsNCiAgICAgICAgICAgICAgbGV0IHRyID0gIiI7DQogICAgICAgICAgICAgIHJlc3VsdHMuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJjcHRMaW5rID0gYDxzcGFuIGNsYXNzPSJyY3B0LWxpbmsiIG9uY2xpY2s9Imp1bXBUb1JlY2VpcHQoJyR7aXRlbS5yY3B0fScpIj4ke2l0ZW0ucmNwdH08L3NwYW4+YDsNCiAgICAgICAgICAgICAgICAgIGxldCBuYW1lRGlzcGxheSA9ICghaXRlbS5uYW1lIHx8IGl0ZW0ubmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSkgPyBgPHNwYW4gc3R5bGU9ImNvbG9yOnZhcigtLWNhbmNlbC1yZWQpOyBmb250LXdlaWdodDpib2xkOyBmb250LXNpemU6MS4xcmVtOyI+QU5PTllNT1VTPC9zcGFuPmAgOiBpdGVtLm5hbWU7DQogICAgICAgICAgICAgICAgICBjb25zdCBnZW8gPSBgJHtpdGVtLnBpbn0ke2l0ZW0ucGluICYmIGl0ZW0uY291bnRyeSA/ICcgLSAnIDogJyd9JHtpdGVtLmNvdW50cnl9YDsNCiAgICAgICAgICAgICAgICAgIHRyICs9IGA8dHI+PHRkIHdpZHRoPSIzNSUiPjxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7IGNvbG9yOnZhcigtLXByaW1hcnktYmx1ZSk7IGZvbnQtc2l6ZTowLjg1cmVtOyI+JHtyY3B0TGlua308L2Rpdj48ZGl2IHN0eWxlPSJmb250LXNpemU6MC43MnJlbTsgY29sb3I6IzMzMzsgbGluZS1oZWlnaHQ6MS40OyI+JHtpdGVtLmRhdGV9PGJyPjxiPuKCuSR7aXRlbS5hbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9iPjwvZGl2PjwvdGQ+PHRkPjxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7IGNvbG9yOnZhcigtLXByaW1hcnktYmx1ZSk7IGZvbnQtc2l6ZTowLjg1cmVtOyI+JHtuYW1lRGlzcGxheX08L2Rpdj48ZGl2IHN0eWxlPSJmb250LXNpemU6MC43MnJlbTsgY29sb3I6IzMzMzsgbGluZS1oZWlnaHQ6MS40OyI+JHtpdGVtLmFkZHJ9ICR7Z2VvID8gJygnICsgZ2VvICsgJyknIDogJyd9PGJyPjxzcGFuIHN0eWxlPSJjb2xvcjp2YXIoLS1wcmltYXJ5LWJsdWUpIj4ke2l0ZW0ucGhvbmV9PC9zcGFuPjwvZGl2PjwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IHRyID8gYDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT48dHI+PHRoPlJlY2VpcHQvRGF0ZS9BbXQ8L3RoPjx0aD5Eb25vciBEZXRhaWxzPC90aD48L3RyPiR7dHJ9PC90YWJsZT48L2Rpdj5gIDogIk5vIHJlY29yZHMuIjsNCiAgICAgICAgICAgICAgY29uc3QgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hTdW1tYXJ5QmFyJyk7DQogICAgICAgICAgICAgIGIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgIGIuaW5uZXJIVE1MID0gYFAtQ29uc2VudDogJHtzY30gfCBUb3RhbDog4oK5JHtzYS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX1gOw0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIENhc2ggUmVjb25jaWxpYXRpb246IENvbXBhcmVzIHRoZSBtYW51YWwgQ2FzaC1MaXN0IHRleHQgZmlsZSBhZ2FpbnN0IHRoZQ0KICAgICAgICAgICAqIG1hc3RlciBkYXRhYmFzZSB0byB2ZXJpZnkgdGhhdCBhbGwgcGh5c2ljYWwgY2FzaCByZWNlaXZlZCBoYXMgYmVlbiByZWNvcmRlZC4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkNhc2hEZXAoaXNEYXNoID0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hSZXMgPSBhd2FpdCBmZXRjaChDQVNIX0xJU1RfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hUZXh0ID0gYXdhaXQgY2FzaFJlcy50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBsZXQgZGVwb3NpdGVkU2V0ID0gbmV3IFNldCgpOw0KICAgICAgICAgICAgICAgICAgY2FzaFRleHQuc3BsaXQoJ1xuJykuZm9yRWFjaChsaW5lID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydHMubGVuZ3RoIDwgMikgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZURhdGUocGFydHNbMF0udHJpbSgpKSA8IENVVE9GRl9EQVRFKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IHBhcnRzWzFdLnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdLnNwbGl0KCcsJykuZm9yRWFjaChuID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNuID0gbi50cmltKCk7IGlmICghY24pIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICJNIiB8fCB0eXBlID09PSAiQiIpIGRlcG9zaXRlZFNldC5hZGQoIk1QUyIgKyBjbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAiQyIgfHwgdHlwZSA9PT0gIkIiKSBkZXBvc2l0ZWRTZXQuYWRkKCJDRyIgKyBjbik7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRiUmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IChhd2FpdCBkYlJlcy50ZXh0KCkpLnNwbGl0KCdcbicpOw0KICAgICAgICAgICAgICAgICAgbGV0IHBlbmRpbmdSZWNvcmRzID0gW107DQogICAgICAgICAgICAgICAgICBsZXQgdG90YWxQZW5kaW5nQW10ID0gMDsNCiAgICAgICAgICAgICAgICAgIHJlY3MuZm9yRWFjaChyID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxMykgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vcm1SY3B0ID0gbm9ybWFsaXplUmNwdChmWzBdLnRyaW0oKSk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRGF0ZShmWzFdKSA+PSBDVVRPRkZfREFURSAmJiAoZlsxMV0gfHwgIiIpLnRvVXBwZXJDYXNlKCkudHJpbSgpID09PSAiQ0FTSCIgJiYgKGZbMTNdIHx8ICIiKS50b1VwcGVyQ2FzZSgpLnRyaW0oKSAhPT0gIllFUyIgJiYgIShmWzEwXSB8fCAiIikudHJpbSgpICYmICFBcnJheS5mcm9tKGRlcG9zaXRlZFNldCkuc29tZShkID0+IG5vcm1hbGl6ZVJjcHQoZCkgPT09IG5vcm1SY3B0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nUmVjb3Jkcy5wdXNoKHsgcmNwdDogZlswXSwgZGF0ZTogZlsxXSwgYW10OiBwYXJzZUZsb2F0KGZbOV0pIHx8IDAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsUGVuZGluZ0FtdCArPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIEZJTkQgVEhJUyBBUkVBIElOIFlPVVIgT1JJR0lOQUwgcnVuQ2FzaERlcDoNCiAgICAgICAgICAgICAgICAgIC8vIHBlbmRpbmdSZWNvcmRzLnB1c2goZik7DQogICAgICAgICAgICAgICAgICAvLyB9IChlbmQgb2YgbG9vcCkNCg0KICAgICAgICAgICAgICAgICAgLy8gSU5TRVJUIFRISVMgTElORSBSSUdIVCBIRVJFOg0KICAgICAgICAgICAgICAgICAgd2luZG93Lmdsb2JhbFBlbmRpbmdDYXB0dXJlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwZW5kaW5nUmVjb3JkcykpOw0KDQogICAgICAgICAgICAgICAgICAvLyAtLS0gU1RSQVRFR1kgSU5TRVJUOiBBc3NpZ24gR2xvYmFsICYgUmV0dXJuIGlmIERhc2hib2FyZCAtLS0NCiAgICAgICAgICAgICAgICAgIGdsb2JhbERhc2hib2FyZENhc2hUb3RhbCA9IHRvdGFsUGVuZGluZ0FtdDsNCiAgICAgICAgICAgICAgICAgIGdsb2JhbERhc2hib2FyZENhc2hSZWNlaXB0cyA9IHBlbmRpbmdSZWNvcmRzLmxlbmd0aA0KDQogICAgICAgICAgICAgICAgICBpZiAoaXNEYXNoKSB7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOyAvLyBUaGlzIGV4aXRzIHRoZSBmdW5jdGlvbiBpbW1lZGlhdGVseQ0KICAgICAgICAgICAgICAgICAgfSAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KDQogICAgICAgICAgICAgICAgICBsZXQgaCA9IGA8ZGl2IGNsYXNzPSJjYXNoLXN1bS1ib3giPjxzcGFuPlRvdGFsOiDigrkke3RvdGFsUGVuZGluZ0FtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3NwYW4+PHNwYW4+UmVjZWlwdHM6ICR7cGVuZGluZ1JlY29yZHMubGVuZ3RofTwvc3Bhbj48L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdSZWNvcmRzLmxlbmd0aCA9PT0gMCkgaCArPSAiPHAgc3R5bGU9J3RleHQtYWxpZ246Y2VudGVyOyc+Tm8gcGVuZGluZyBjYXNoIGRlcG9zaXRzLjwvcD4iOw0KICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgaCArPSAiPGRpdiBjbGFzcz0ndGFibGUtd3JhcCc+PHRhYmxlPjx0cj48dGg+UmVjZWlwdDwvdGg+PHRoPkRhdGU8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+IjsNCiAgICAgICAgICAgICAgICAgICAgICBwZW5kaW5nUmVjb3Jkcy5zb3J0KChhLCBiKSA9PiBwYXJzZURhdGUoYS5kYXRlKSAtIHBhcnNlRGF0ZShiLmRhdGUpKS5mb3JFYWNoKHJlYyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGggKz0gYDx0cj48dGQ+PHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHtyZWMucmNwdH0nKSI+JHtyZWMucmNwdH08L3NwYW4+PC90ZD48dGQ+JHtyZWMuZGF0ZX08L3RkPjx0ZD7igrkke3JlYy5hbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgaCArPSAiPC90YWJsZT48L2Rpdj4iOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGg7DQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCg0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogZVJlY2VpcHQgVG9vbDogR2VuZXJhdGVzIGEgcHJpbnRhYmxlLCBwcm9mZXNzaW9uYWwgSFRNTCByZWNlaXB0IGZvciBhIHNwZWNpZmljDQogICAgICAgICAgICogcmVjZWlwdCBudW1iZXIuIEl0IGluY2x1ZGVzIGEgd2F0ZXJtYXJrIGFuZCB0cnVzdC1zcGVjaWZpYyBsZWdhbCB3b3JkaW5nLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuRVJlY2VpcHQocHJlZmlsbGVkSUQgPSBudWxsKSB7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIGxldCBxID0gcHJvbXB0KCJFbnRlciBSZWNlaXB0IE5vOiIsIHByZWZpbGxlZElEIHx8ICIiKTsNCiAgICAgICAgICAgICAgaWYgKCFxKSByZXR1cm47DQogICAgICAgICAgICAgIHEgPSBxLnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSAoYXdhaXQgcmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGxldCBmb3VuZCA9IHJlY3MuZmluZChyID0+IHIuc3BsaXQoJ3wnKVswXS50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gcSk7DQogICAgICAgICAgICAgIGlmICghZm91bmQpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJOb3QgaW4gRGF0YWJhc2UiKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBsZXQgZiA9IGZvdW5kLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgIGNvbnN0IGlzQyA9IChmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiKTsNCiAgICAgICAgICAgICAgbGV0IHdhdGVybWFya0h0bWwgPSBpc0MgPyAnPGRpdiBjbGFzcz0id2F0ZXJtYXJrIj5DQU5DRUxMRUQ8L2Rpdj4nIDogIiI7DQogICAgICAgICAgICAgIGNvbnN0IGJhc2VBZGRyID0gKGZbNF0gfHwgIiIpLnJlcGxhY2UoL34vZywgJzxicj4nKSwgcGluID0gZlsxNV0gfHwgIiIsIGNvdW50cnkgPSBmWzE5XSB8fCAiIjsNCiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheUFkZHIgPSBiYXNlQWRkciArICgocGluIHx8IGNvdW50cnkpID8gKCI8YnI+IiArIHBpbiArICIgIiArIGNvdW50cnkpIDogIiIpOw0KICAgICAgICAgICAgICBsZXQgaCA9IGA8YnV0dG9uIGNsYXNzPSJidG4tcm90YXRlIiBvbmNsaWNrPSJ0b2dnbGVSb3RhdGlvbigpIj5Sb3RhdGUgKDkwwrApPC9idXR0b24+PGRpdiBjbGFzcz0icmVjZWlwdC12aWV3cG9ydCI+PGRpdiBpZD0ic3BhY2VyVG9wIiBjbGFzcz0ic3Mtc3BhY2VyIj48L2Rpdj48ZGl2IGlkPSJyZWNlaXB0Q29udGFpbmVyIiBjbGFzcz0icmVjZWlwdC1jb250YWluZXIgJHtpc0MgPyAnY2FuY2VsbGVkLXJvdycgOiAnJ30iPiR7d2F0ZXJtYXJrSHRtbH08dGFibGUgY2xhc3M9InJlY2VpcHQtaHRtbCI+PHRyPjx0ZCB3aWR0aD0iMTMwIiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij48aW1nIHNyYz0iaHR0cHM6Ly93d3cuZ2FuZXNhc2FybWEuY29tL1Blcml5YXZhLmpwZyIgd2lkdGg9IjExMCI+PC90ZD48dGQ+PGNlbnRlcj48Yj5NWUxBSSBNQUhBUEVSSVlBVkEgQU5VU0hBTSBUUlVTVCAoUkVHRC4pLDwvYj48YnI+UGl0Y2h1cGlsbGFpIFN0cmVldCwgTXlsYXBvcmUsIENoZW5uYWktNC48YnI+UGg6IDYzODA4OTgyMzEsIDg2MTAyMTQxMzguPGJyPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTFweDsiPnRoaXJ1bXlsYWlhbnVzaGFtQGdtYWlsLmNvbTwvc3Bhbj48YnI+PGRpdiBzdHlsZT0ibWFyZ2luLXRvcDo1cHg7IGRpc3BsYXk6ZmxleDsganVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47IHdpZHRoOjEwMCU7Ij48c3Bhbj48Yj4ke2ZbMV19PC9iPjwvc3Bhbj48c3Bhbj48Yj5SZWNlaXB0PC9iPjwvc3Bhbj48c3Bhbj48Yj4ke2ZbMF19PC9iPjwvc3Bhbj48L2Rpdj48L2NlbnRlcj48L3RkPjwvdHI+PHRyPjx0ZCBjb2xzcGFuPSIyIj48cD5SZWNlaXZlZCBScy4gPGI+JHtmWzldfTwvYj4gZm9yIDxiPiR7ZlsxMl19PC9iPiB2aWEgPGI+JHtmWzExXX0gJHtmWzEwXSB8fCAiIn08L2I+IGZyb206PC9wPjwvdGQ+PC90cj48dHI+PHRkPjxiPk5hbWU8L2I+PC90ZD48dGQ+PGI+U2hyaS4vU210LiAke2ZbMl19PC9iPjwvdGQ+PC90cj48dHI+PHRkPjxiPlBBTjwvYj48L3RkPjx0ZD4ke2ZbNl0gfHwgIiJ9PC90ZD48L3RyPjx0cj48dGQ+PGI+UGhvbmU8L2I+PC90ZD48dGQ+JHtmWzNdfTwvdGQ+PC90cj48dHI+PHRkPjxiPkFkZHJlc3M8L2I+PC90ZD48dGQ+JHtkaXNwbGF5QWRkcn08L3RkPjwvdHI+PHRyPjx0ZCBjb2xzcGFuPSIyIiBzdHlsZT0idGV4dC1hbGlnbjpyaWdodDsgYm9yZGVyLXRvcDoycHggc29saWQgIzAwMDsiPmZvciA8Yj5NWUxBSSBNQUhBUEVSSVlBVkEgQU5VU0hBTSBUUlVTVDwvYj48YnI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMXB4OyBmb250LXdlaWdodDpib2xkOyI+U2VjdGlvbiAxMi1BIHJlZ2lzdHJhdGlvbiB2YWxpZCB0aWxsIDMxLTAzLTIwMjY8L3NwYW4+PC90ZD48L3RyPjwvdGFibGU+PC9kaXY+PGRpdiBpZD0ic3BhY2VyQm90dG9tIiBjbGFzcz0ic3Mtc3BhY2VyIj48L2Rpdj48L2Rpdj48YnV0dG9uIGNsYXNzPSJidG4td2EiIG9uY2xpY2s9J3NlbmRXaGF0c0FwcCgke0pTT04uc3RyaW5naWZ5KGYpfSknPlNlbmQgdmlhIFdoYXRzQXBwPC9idXR0b24+YDsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGg7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogU3RhdGlzdGljYWwgU3VtbWFyeTogR2VuZXJhdGVzIGEgaGlnaC1sZXZlbCBvdmVydmlldyBvZiB0b3RhbCBpbmNvbWUsDQogICAgICAgICAgICogZG9ub3IgY291bnRzLCBhbmQgY2F0ZWdvcmljYWwgYnJlYWtkb3ducyAoQ29ycHVzIHZzLiBHZW5lcmFsKSB3aXRoIHZpc3VhbCBjaGFydHMuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5TdW1tYXJ5KCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IChhd2FpdCByZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IHMgPSB7IHRBbXQ6IDAsIHRDbnQ6IDAsIHRvd2FyZHM6IHt9LCBtb2RlOiB7fSwgdHJlbmQ6IHt9LCBhbm9uQTogMCwgYW5vbkM6IDAsIG5vTmFtZUE6IDAsIG5vTmFtZUM6IDAsIG5vUGhvbmVBOiAwLCBub1Bob25lQzogMCwgbm9QYW5BOiAwLCBub1BhbkM6IDAsIHBlbmRDb3JwQTogMCwgcGVuZENvcnBDOiAwIH07DQogICAgICAgICAgICAgIGNvbnN0IG1vbiA9IFsiQXByIiwgIk1heSIsICJKdW4iLCAiSnVsIiwgIkF1ZyIsICJTZXAiLCAiT2N0IiwgIk5vdiIsICJEZWMiLCAiSmFuIiwgIkZlYiIsICJNYXIiXTsNCiAgICAgICAgICAgICAgcmVjcy5mb3JFYWNoKHIgPT4gew0KICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxMyB8fCBmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBjb25zdCBkUCA9IGZbMV0uc3BsaXQoL1stL10vKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSBwYXJzZUludChkUFsxXSksIHkgPSBwYXJzZUludChkUFsyXSk7DQogICAgICAgICAgICAgICAgICBpZiAoc1llYXIgIT09ICJhbGwiICYmICEoKHkgPT09IHBhcnNlSW50KHNZZWFyKSAmJiBtID49IDQpIHx8ICh5ID09PSBwYXJzZUludChzWWVhcikgKyAxICYmIG0gPD0gMykpKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBsZXQgYW10ID0gcGFyc2VGbG9hdChmWzldKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgcy50QW10ICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgIHMudENudCsrOw0KICAgICAgICAgICAgICAgICAgbGV0IHR3ID0gKGZbMTJdIHx8ICJPVEhFUlMiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFzLnRvd2FyZHNbdHddKSBzLnRvd2FyZHNbdHddID0geyBhOiAwLCBjOiAwIH07DQogICAgICAgICAgICAgICAgICBzLnRvd2FyZHNbdHddLmEgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgcy50b3dhcmRzW3R3XS5jKys7DQogICAgICAgICAgICAgICAgICBsZXQgbWQgPSAoZlsxMV0gfHwgIlVQSSIpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICBpZiAoIXMubW9kZVttZF0pIHMubW9kZVttZF0gPSB7IGE6IDAsIGM6IDAgfTsNCiAgICAgICAgICAgICAgICAgIHMubW9kZVttZF0uYSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICBzLm1vZGVbbWRdLmMrKzsNCiAgICAgICAgICAgICAgICAgIGlmICghZlsyXT8udHJpbSgpIHx8IGZbMl0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICBzLmFub25DKys7DQogICAgICAgICAgICAgICAgICAgICAgcy5hbm9uQSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAoIWZbMl0/LnRyaW0oKSkgew0KICAgICAgICAgICAgICAgICAgICAgIHMubm9OYW1lQysrOw0KICAgICAgICAgICAgICAgICAgICAgIHMubm9OYW1lQSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAoIWZbM10/LnRyaW0oKSkgew0KICAgICAgICAgICAgICAgICAgICAgIHMubm9QaG9uZUMrKzsNCiAgICAgICAgICAgICAgICAgICAgICBzLm5vUGhvbmVBICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGlmICghZls2XT8udHJpbSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgcy5ub1BhbkMrKzsNCiAgICAgICAgICAgICAgICAgICAgICBzLm5vUGFuQSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAoZlsxMl0/LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNPUlBVUyIpICYmIGZbMThdPy50b1VwcGVyQ2FzZSgpICE9PSAiWUVTIikgew0KICAgICAgICAgICAgICAgICAgICAgIHMucGVuZENvcnBDKys7DQogICAgICAgICAgICAgICAgICAgICAgcy5wZW5kQ29ycEEgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgbGV0IGxibCA9IChzWWVhciA9PT0gImFsbCIpID8geSA6IG1vblsobSArIDgpICUgMTJdOw0KICAgICAgICAgICAgICAgICAgcy50cmVuZFtsYmxdID0gKHMudHJlbmRbbGJsXSB8fCAwKSArIGFtdDsNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIGxldCBoID0gYDxkaXYgc3R5bGU9ImJhY2tncm91bmQ6d2hpdGU7IHBhZGRpbmc6MTBweDsgYm9yZGVyLXJhZGl1czoxMHB4OyI+PHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiPjx0aGVhZD48dHI+PHRoPkl0ZW08L3RoPjx0aD5Eb25vcnM8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD48dHIgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7Ij48dGQ+VG90YWw8L3RkPjx0ZD4ke3MudENudH08L3RkPjx0ZD4ke3MudEFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PHRyIGNsYXNzPSJzZWN0aW9uLWhkciI+PHRkIGNvbHNwYW49IjMiPlRvd2FyZHM8L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgZm9yIChsZXQgdCBpbiBzLnRvd2FyZHMpIGggKz0gYDx0cj48dGQ+JHt0fTwvdGQ+PHRkPiR7cy50b3dhcmRzW3RdLmN9PC90ZD48dGQ+JHtzLnRvd2FyZHNbdF0uYS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgaCArPSBgPHRyIGNsYXNzPSJzZWN0aW9uLWhkciI+PHRkIGNvbHNwYW49IjMiPk1vZGU8L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgZm9yIChsZXQgbSBpbiBzLm1vZGUpIGggKz0gYDx0cj48dGQ+JHttfTwvdGQ+PHRkPiR7cy5tb2RlW21dLmN9PC90ZD48dGQ+JHtzLm1vZGVbbV0uYS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgaCArPSBgPHRyIGNsYXNzPSJzZWN0aW9uLWhkciI+PHRkIGNvbHNwYW49IjMiPkFuYWx5dGljczwvdGQ+PC90cj48dHI+PHRkPkFub255bW91czwvdGQ+PHRkPiR7cy5hbm9uQ308L3RkPjx0ZD4ke3MuYW5vbkEudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPjx0cj48dGQ+UGVuZGluZyBDb25zZW50PC90ZD48dGQ+JHtzLnBlbmRDb3JwQ308L3RkPjx0ZD4ke3MucGVuZENvcnBBLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48dHI+PHRkPk5PIE5BTUU8L3RkPjx0ZD4ke3Mubm9OYW1lQ308L3RkPjx0ZD4ke3Mubm9OYW1lQS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PHRyPjx0ZD5OTyBQSE9ORTwvdGQ+PHRkPiR7cy5ub1Bob25lQ308L3RkPjx0ZD4ke3Mubm9QaG9uZUEudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPjx0cj48dGQ+Tk8gUEFOPC90ZD48dGQ+JHtzLm5vUGFuQ308L3RkPjx0ZD4ke3Mubm9QYW5BLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48L3RhYmxlPjxkaXYgY2xhc3M9ImNoYXJ0LXdyYXBwZXIiPjxkaXYgY2xhc3M9ImNoYXJ0LWNvbnRhaW5lciI+PGNhbnZhcyBpZD0iYzEiPjwvY2FudmFzPjwvZGl2PjxkaXYgY2xhc3M9ImNoYXJ0LWNvbnRhaW5lciI+PGNhbnZhcyBpZD0iYzIiPjwvY2FudmFzPjwvZGl2PjxkaXYgY2xhc3M9ImNoYXJ0LWNvbnRhaW5lciI+PGNhbnZhcyBpZD0iYzMiPjwvY2FudmFzPjwvZGl2PjwvZGl2PjwvZGl2PmA7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSBoOw0KICAgICAgICAgICAgICBhY3RpdmVDaGFydHMucHVzaChuZXcgQ2hhcnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2MxJyksIHsgdHlwZTogJ2JhcicsIGRhdGE6IHsgbGFiZWxzOiBPYmplY3Qua2V5cyhzLnRyZW5kKSwgZGF0YXNldHM6IFt7IGxhYmVsOiAnVHJlbmQnLCBkYXRhOiBPYmplY3QudmFsdWVzKHMudHJlbmQpLCBiYWNrZ3JvdW5kQ29sb3I6ICcjMDAwMDhCJyB9XSB9IH0pKTsNCiAgICAgICAgICAgICAgYWN0aXZlQ2hhcnRzLnB1c2gobmV3IENoYXJ0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjMicpLCB7IHR5cGU6ICdwaWUnLCBkYXRhOiB7IGxhYmVsczogT2JqZWN0LmtleXMocy5tb2RlKSwgZGF0YXNldHM6IFt7IGRhdGE6IE9iamVjdC52YWx1ZXMocy5tb2RlKS5tYXAoeCA9PiB4LmEpLCBiYWNrZ3JvdW5kQ29sb3I6IFsnI0ZGNjM4NCcsICcjMzZBMkVCJywgJyNGRkNFNTYnLCAnIzRCQzBDMCddIH1dIH0gfSkpOw0KICAgICAgICAgICAgICBhY3RpdmVDaGFydHMucHVzaChuZXcgQ2hhcnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2MzJyksIHsgdHlwZTogJ3BpZScsIGRhdGE6IHsgbGFiZWxzOiBPYmplY3Qua2V5cyhzLnRvd2FyZHMpLCBkYXRhc2V0czogW3sgZGF0YTogT2JqZWN0LnZhbHVlcyhzLnRvd2FyZHMpLm1hcCh4ID0+IHguYSksIGJhY2tncm91bmRDb2xvcjogWycjOTk2NkZGJywgJyM0QkMwQzAnLCAnI0ZGOUY0MCcsICcjRkY2Mzg0JywgJyMzNkEyRUInXSB9XSB9IH0pKTsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCg0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIE1haW4gU2VhcmNoIEVuZ2luZTogRmV0Y2hlcyB0aGUgbWFzdGVyIGRhdGFiYXNlIGFuZCBhcHBsaWVzIHVzZXItZGVmaW5lZA0KICAgICAgICAgICAqIGZpbHRlcnMgKFllYXIsIFNlYXJjaCBUZXJtcykgdG8gZGlzcGxheSBtYXRjaGluZyByZWNvcmRzIGluIGEgZGV0YWlsZWQgbGlzdCBmb3JtYXQuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBmZXRjaEFuZFNlYXJjaCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgcVJhdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hJbnB1dCcpLnZhbHVlLnRyaW0oKTsNCiAgICAgICAgICAgICAgaWYgKCFxUmF3KSByZXR1cm47DQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICAgICAgICAgICAgY29uc3QgaXNOdW1lcmljU2VhcmNoID0gL15cZCskLy50ZXN0KHFSYXcucmVwbGFjZSgvXEQvZywgJycpKTsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGxldCB0ciA9ICIiLCBkZXQgPSAiIiwgc2MgPSAwLCBzYSA9IDAsIGxhdGVzdFJlYyA9IG51bGwsIGxhdGVzdERhdGUgPSBuZXcgRGF0ZSgwKSwgcGVuZGluZ0NvbnNlbnRzID0gW107DQogICAgICAgICAgICAgIGZvciAobGV0IHIgb2YgcmVjcykgew0KICAgICAgICAgICAgICAgICAgY29uc3QgZXZhbCA9IGV2YWx1YXRlTG9naWMoci50b0xvd2VyQ2FzZSgpLCBxUmF3KTsNCiAgICAgICAgICAgICAgICAgIGlmIChldmFsLm1hdGNoZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAyMCkgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2QgPSBwYXJzZURhdGUoZlsxXSksIGRQID0gZlsxXS5zcGxpdCgvWy0vXS8pLCBtbSA9IHBhcnNlSW50KGRQWzFdKSwgeXkgPSBwYXJzZUludChkUFsyXSk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKChzWWVhciA9PT0gImFsbCIpIHx8ICgoeXkgPT09IHBhcnNlSW50KHNZZWFyKSAmJiBtbSA+PSA0KSB8fCAoeXkgPT09IHBhcnNlSW50KHNZZWFyKSArIDEgJiYgbW0gPD0gMykpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQyA9IChmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2MrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0MpIHNhICs9IHBhcnNlRmxvYXQoZls5XSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0MgJiYgZlsxMl0/LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNPUlBVUyIpICYmIGZbMThdPy50b1VwcGVyQ2FzZSgpICE9PSAiWUVTIiB8fCBmWzBdLnN0YXJ0c1dpdGgoIkdXIikpIHBlbmRpbmdDb25zZW50cy5wdXNoKHsgbnVtOiBmWzBdLCBmeTogZ2V0RlkoZlsxXSkgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc051bWVyaWNTZWFyY2ggJiYgY2QgPiBsYXRlc3REYXRlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRlc3REYXRlID0gY2Q7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXRlc3RSZWMgPSBmOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJjcHRMaW5rID0gYDxzcGFuIGNsYXNzPSJyY3B0LWxpbmsiIG9uY2xpY2s9Imp1bXBUb1JlY2VpcHQoJyR7ZlswXX0nKSI+JHtoaWdobGlnaHRUZXh0KGZbMF0sIGV2YWwudGVybXMpfTwvc3Bhbj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOdW1lcmljU2VhcmNoKSB0ciArPSBgPHRyIGNsYXNzPSIke2lzQyA/ICdjYW5jZWxsZWQtcm93JyA6ICcnfSI+PHRkPiR7cmNwdExpbmt9PC90ZD48dGQ+JHtmWzFdfTwvdGQ+PHRkPiR7aGlnaGxpZ2h0VGV4dChmWzJdLCBldmFsLnRlcm1zKX08L3RkPjx0ZD4ke2hpZ2hsaWdodFRleHQoZlsxMl0sIGV2YWwudGVybXMpfTwvdGQ+PHRkPuKCuSR7Zls5XX08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZsZCA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFRJVExFUy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbCA9IChpID09PSAwKSA/IHJjcHRMaW5rIDogaGlnaGxpZ2h0VGV4dChmW2ldIHx8ICItLS0iLCBldmFsLnRlcm1zKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsZCArPSBgPGRpdiBjbGFzcz0iZmllbGQtcm93Ij48c3BhbiBjbGFzcz0iZmllbGQtaGVhZGVyIj4ke1RJVExFU1tpXX06PC9zcGFuPjxzcGFuIGNsYXNzPSJmaWVsZC12YWwiPiR7dmFsfTwvc3Bhbj48L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIGRldCArPSBgPGRpdiBjbGFzcz0icmVjb3JkICR7aXNDID8gJ2NhbmNlbGxlZC1yb3cnIDogJyd9Ij4ke2ZsZH08L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBsZXQgYWRkcmVzc0JveEh0bWwgPSAiIjsNCiAgICAgICAgICAgICAgaWYgKGlzTnVtZXJpY1NlYXJjaCAmJiBsYXRlc3RSZWMpIHsNCiAgICAgICAgICAgICAgICAgIGxldCBjb25zZW50TGluZXMgPSBwZW5kaW5nQ29uc2VudHMubWFwKGMgPT4gYCR7Yy5udW19IDxzcGFuIGNsYXNzPSJjb25zZW50LWZ5LWJsdWUiPlske2MuZnl9XTwvc3Bhbj5gKS5qb2luKCcsICcpOw0KICAgICAgICAgICAgICAgICAgYWRkcmVzc0JveEh0bWwgPSBgPGRpdiBjbGFzcz0ibGF0ZXN0LWFkZHItYm94Ij48c3BhbiBjbGFzcz0ibGF0ZXN0LWFkZHItaGVhZGVyIj5MYXRlc3QgQWRkcmVzczwvc3Bhbj48Yj5OYW1lOjwvYj4gJHtsYXRlc3RSZWNbMl19PGJyPjxiPkFkZHJlc3M6PC9iPiAke2xhdGVzdFJlY1s0XS5yZXBsYWNlKC9+L2csICcsICcpfTxicj48Yj5QaW5jb2RlOjwvYj4gJHtsYXRlc3RSZWNbMTVdIHx8ICItLS0ifTxicj48Yj5QaG9uZTo8L2I+ICR7bGF0ZXN0UmVjWzNdfSR7cGVuZGluZ0NvbnNlbnRzLmxlbmd0aCA+IDAgPyBgPGRpdiBjbGFzcz0icGVuZGluZy1jb25zZW50LWxpbmUiPlBlbmRpbmcgQ29uc2VudCBMZXR0ZXJzOiAke2NvbnNlbnRMaW5lc308L2Rpdj5gIDogJyd9PC9kaXY+YDsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbnVtZXJpY1Jlc3VsdHMnKS5pbm5lckhUTUwgPSBhZGRyZXNzQm94SHRtbCArIChpc051bWVyaWNTZWFyY2ggJiYgdHIgPyBgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPjx0cj48dGg+Tm8uPC90aD48dGg+RGF0ZTwvdGg+PHRoPk5hbWU8L3RoPjx0aD5Ub3dhcmRzPC90aD48dGg+QW1vdW50PC90aD48L3RyPiR7dHJ9PC90YWJsZT48L2Rpdj5gIDogIiIpOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gZGV0IHx8ICJObyByZWNvcmRzIGZvdW5kLiI7DQogICAgICAgICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoU3VtbWFyeUJhcicpOw0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGBGb3VuZDogJHtzY30gfCBUb3RhbDog4oK5JHtzYS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX1gOw0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KDQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogQW5vbnltb3VzIEZpbHRlcjogSXNvbGF0ZXMgYW5kIHRvdGFscyBhbGwgZG9uYXRpb25zIG1hcmtlZCBhcyAnQW5vbnltb3VzJw0KICAgICAgICAgICAqIHRvIGVuc3VyZSB0aGV5IGFyZSBoYW5kbGVkIGFjY29yZGluZyB0byB0cnVzdCBhY2NvdW50aW5nIHN0YW5kYXJkcy4NCiAgICAgICAgICAgKi8NCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5Bbm9ueW1vdXMoKSB7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQoNCiAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGWSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IGZ5TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnBhcmVudEVsZW1lbnQuaW5uZXJUZXh0LnRyaW0oKTsNCiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheVRpdGxlID0gc2VsZWN0ZWRGWSA9PT0gJ2FsbCcgPyAnQWxsIFllYXJzJyA6IGZ5TGFiZWw7DQoNCiAgICAgICAgICAgICAgY29uc3Qgc1llYXIgPSBzZWxlY3RlZEZZOw0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSAoYXdhaXQgcmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQoNCiAgICAgICAgICAgICAgbGV0IGFub25MaXN0ID0gW10sIHNjID0gMCwgc2EgPSAwOw0KDQogICAgICAgICAgICAgIC8vIDEuIFBST0NFU1MgREFUQQ0KICAgICAgICAgICAgICByZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDEzIHx8IChmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZFAgPSBmWzFdLnNwbGl0KC9bLS9dLyksIG1tID0gcGFyc2VJbnQoZFBbMV0pLCB5eSA9IHBhcnNlSW50KGRQWzJdKTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKChzWWVhciA9PT0gImFsbCIpIHx8ICgoeXkgPT09IHBhcnNlSW50KHNZZWFyKSAmJiBtbSA+PSA0KSB8fCAoeXkgPT09IHBhcnNlSW50KHNZZWFyKSArIDEgJiYgbW0gPD0gMykpKSB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFmWzJdLnRyaW0oKSB8fCBmWzJdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImFub255bW91cyIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXQgPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHNjKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHNhICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgYW5vbkxpc3QucHVzaCh7IHJjcHQ6IGZbMF0sIGRhdGU6IGZbMV0sIGFtdDogYW10LCByZWY6IGZbMTBdIHx8ICItLS0iIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgYW5vbkxpc3Quc29ydCgoYSwgYikgPT4gYi5hbXQgLSBhLmFtdCk7DQoNCiAgICAgICAgICAgICAgY29uc3QgdGFibGVIZWFkZXIgPSBgPHRyPjx0aD5SZWNlaXB0PC90aD48dGg+RGF0ZTwvdGg+PHRoPkFtb3VudDwvdGg+PHRoPlJlZjwvdGg+PC90cj5gOw0KDQogICAgICAgICAgICAgIC8vIDIuIEdFTkVSQVRFIFJPV1MgRk9SIFRBQkxFIDE6IENIRVFVRQ0KICAgICAgICAgICAgICBsZXQgdHJDaHEgPSAiIjsNCiAgICAgICAgICAgICAgYW5vbkxpc3QuZm9yRWFjaChyZWMgPT4gew0KICAgICAgICAgICAgICAgICAgaWYgKHJlYy5yZWYudG9VcHBlckNhc2UoKS5pbmNsdWRlcygiQ0hRIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByY3B0TGluayA9IGA8c3BhbiBjbGFzcz0icmNwdC1saW5rIiBvbmNsaWNrPSJqdW1wVG9SZWNlaXB0KCcke3JlYy5yY3B0fScpIj4ke3JlYy5yY3B0fTwvc3Bhbj5gOw0KICAgICAgICAgICAgICAgICAgICAgIHRyQ2hxICs9IGA8dHIgY2xhc3M9IiR7cmVjLnJjcHQudG9VcHBlckNhc2UoKS5zdGFydHNXaXRoKCJHVyIpID8gJ2d3LXJvdycgOiAnJ30iPjx0ZD4ke3JjcHRMaW5rfTwvdGQ+PHRkPiR7cmVjLmRhdGV9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtyZWMuYW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PHRkPiR7cmVjLnJlZn08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgLy8gMy4gR0VORVJBVEUgUk9XUyBGT1IgVEFCTEUgMjogVVBJICsgUEhPTkUNCiAgICAgICAgICAgICAgbGV0IHRyVVBJID0gIiI7DQogICAgICAgICAgICAgIGFub25MaXN0LmZvckVhY2gocmVjID0+IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZmVyZW5jZSA9IHJlYy5yZWYudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgIGlmIChyZWZlcmVuY2UuaW5jbHVkZXMoIlVQSSIpICYmIC9cL1xkezEwfVwvLy50ZXN0KHJlZmVyZW5jZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByY3B0TGluayA9IGA8c3BhbiBjbGFzcz0icmNwdC1saW5rIiBvbmNsaWNrPSJqdW1wVG9SZWNlaXB0KCcke3JlYy5yY3B0fScpIj4ke3JlYy5yY3B0fTwvc3Bhbj5gOw0KICAgICAgICAgICAgICAgICAgICAgIHRyVVBJICs9IGA8dHIgY2xhc3M9IiR7cmVjLnJjcHQudG9VcHBlckNhc2UoKS5zdGFydHNXaXRoKCJHVyIpID8gJ2d3LXJvdycgOiAnJ30iPjx0ZD4ke3JjcHRMaW5rfTwvdGQ+PHRkPiR7cmVjLmRhdGV9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtyZWMuYW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PHRkPiR7cmVjLnJlZn08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgLy8gNC4gR0VORVJBVEUgUk9XUyBGT1IgVEFCTEUgMzogU1RBTkRBUkQNCiAgICAgICAgICAgICAgbGV0IHRyU3RhbmRhcmQgPSAiIjsNCiAgICAgICAgICAgICAgYW5vbkxpc3QuZm9yRWFjaChyZWMgPT4gew0KICAgICAgICAgICAgICAgICAgY29uc3QgcmNwdExpbmsgPSBgPHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHtyZWMucmNwdH0nKSI+JHtyZWMucmNwdH08L3NwYW4+YDsNCiAgICAgICAgICAgICAgICAgIHRyU3RhbmRhcmQgKz0gYDx0ciBjbGFzcz0iJHtyZWMucmNwdC50b1VwcGVyQ2FzZSgpLnN0YXJ0c1dpdGgoIkdXIikgPyAnZ3ctcm93JyA6ICcnfSI+PHRkPiR7cmNwdExpbmt9PC90ZD48dGQ+JHtyZWMuZGF0ZX08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke3JlYy5hbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48dGQ+JHtyZWMucmVmfTwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAvLyA1LiBBU1NFTUJMRSBBTEwgVEFCTEVTDQogICAgICAgICAgICAgIGxldCBmaW5hbEh0bWwgPSAiIjsNCg0KICAgICAgICAgICAgICAvLyBUYWJsZSAxOiBDaGVxdWUNCiAgICAgICAgICAgICAgZmluYWxIdG1sICs9IGA8ZGl2IGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0ibWFyZ2luLXRvcDozMHB4OyI+QW5vbnltb3VzIENoZXF1ZSBEb25vcnM8L2Rpdj5gOw0KICAgICAgICAgICAgICBmaW5hbEh0bWwgKz0gYDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT4ke3RhYmxlSGVhZGVyfSR7dHJDaHEgfHwgJzx0cj48dGQgY29sc3Bhbj0iNCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+Tm8gQ2hlcXVlIHJlY29yZHMgZm91bmQuPC90ZD48L3RyPid9PC90YWJsZT48L2Rpdj5gOw0KDQogICAgICAgICAgICAgIGZpbmFsSHRtbCArPSBgPGhyIHN0eWxlPSJtYXJnaW46IDQwcHggMDsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tcHJpbWFyeS1ibHVlKTsiPmA7DQoNCiAgICAgICAgICAgICAgLy8gVGFibGUgMjogVVBJICsgUGhvbmUNCiAgICAgICAgICAgICAgZmluYWxIdG1sICs9IGA8ZGl2IGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0ibWFyZ2luLXRvcDozMHB4OyI+QW5vbnltb3VzIFVQSSBEb25vcnMgd2l0aCBUZWxlcGhvbmUgTnVtYmVyczwvZGl2PmA7DQogICAgICAgICAgICAgIGZpbmFsSHRtbCArPSBgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPiR7dGFibGVIZWFkZXJ9JHt0clVQSSB8fCAnPHRyPjx0ZCBjb2xzcGFuPSI0IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij5ObyBVUEkgUGhvbmUgcmVjb3JkcyBmb3VuZC48L3RkPjwvdHI+J308L3RhYmxlPjwvZGl2PmA7DQoNCiAgICAgICAgICAgICAgZmluYWxIdG1sICs9IGA8aHIgc3R5bGU9Im1hcmdpbjogNDBweCAwOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1wcmltYXJ5LWJsdWUpOyI+YDsNCg0KICAgICAgICAgICAgICAvLyBUYWJsZSAzOiBGdWxsIExpc3QNCiAgICAgICAgICAgICAgZmluYWxIdG1sICs9IGA8ZGl2IGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0ibWFyZ2luLXRvcDozMHB4OyI+QW5vbnltb3VzIERvbm9ycyBmb3IgRmluYW5jaWFsIFllYXIgOiAke2Rpc3BsYXlUaXRsZX08L2Rpdj5gOw0KICAgICAgICAgICAgICBmaW5hbEh0bWwgKz0gYDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT4ke3RhYmxlSGVhZGVyfSR7dHJTdGFuZGFyZCB8fCAnPHRyPjx0ZCBjb2xzcGFuPSI0IiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7Ij5ObyByZWNvcmRzIGZvdW5kLjwvdGQ+PC90cj4nfTwvdGFibGU+PC9kaXY+YDsNCg0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gZmluYWxIdG1sOw0KDQogICAgICAgICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoU3VtbWFyeUJhcicpOw0KICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGBBbm9ueW1vdXM6ICR7c2N9IHwgVG90YWw6IOKCuSR7c2EudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9YDsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCiAgICAgICAgICB9DQoNCg0KDQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBNYWlsaW5nIExpc3QgR2VuZXJhdG9yOiBDb21waWxlcyBhIHVuaXF1ZSBsaXN0IG9mIGRvbm9ycyB3aXRoIHZhbGlkIGFkZHJlc3Nlcw0KICAgICAgICAgICAqIGZvciB0aGUgc2VsZWN0ZWQgeWVhciwgc3BlY2lmaWNhbGx5IGV4Y2x1ZGluZyB0aG9zZSBtYXJrZWQgYXMgJ0Fub255bW91cycuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5Eb25vckxpc3QoKSB7DQogICAgICAgICAgICAgIGxldCBxID0gcHJvbXB0KCJTZWFyY2ggRG9ub3I/IiwgIiIpOw0KICAgICAgICAgICAgICBpZiAocSA9PT0gbnVsbCkgcmV0dXJuOw0KICAgICAgICAgICAgICBsZXQgcVJhdyA9IHEudHJpbSgpLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gKGF3YWl0IHJlcy50ZXh0KCkpLnNwbGl0KCdcbicpOw0KICAgICAgICAgICAgICBsZXQgZG9ub3JzID0ge307DQogICAgICAgICAgICAgIHJlY3MuZm9yRWFjaChyID0+IHsNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMjAgfHwgZlsxM10/LnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiIHx8IGZbMF0uc3RhcnRzV2l0aCgiR1ciKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcGhvbmUgPSBmWzNdPy50cmltKCkgfHwgIiI7DQogICAgICAgICAgICAgICAgICBpZiAocGhvbmUuc3RhcnRzV2l0aCgiOTk5OTkiKSB8fCBwaG9uZS5zdGFydHNXaXRoKCI4ODg4OCIpIHx8ICFwaG9uZSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZFAgPSBmWzFdLnNwbGl0KC9bLS9dLyksIG1tID0gcGFyc2VJbnQoZFBbMV0pLCB5eSA9IHBhcnNlSW50KGRQWzJdKTsNCiAgICAgICAgICAgICAgICAgIGlmIChzWWVhciAhPT0gImFsbCIgJiYgISgoeXkgPT09IHBhcnNlSW50KHNZZWFyKSAmJiBtbSA+PSA0KSB8fCAoeXkgPT09IHBhcnNlSW50KHNZZWFyKSArIDEgJiYgbW0gPD0gMykpKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBpZiAocVJhdyAhPT0gIiIgJiYgIXIudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxUmF3KSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgaWYgKCFkb25vcnNbcGhvbmVdKSBkb25vcnNbcGhvbmVdID0geyBwaDogcGhvbmUsIGNudDogMCwgYW10OiAwLCBsYXRlc3Q6IG5ldyBEYXRlKDApLCBuYW1lOiAiIiwgYWRkcjogIiIgfTsNCiAgICAgICAgICAgICAgICAgIGRvbm9yc1twaG9uZV0uY250Kys7DQogICAgICAgICAgICAgICAgICBkb25vcnNbcGhvbmVdLmFtdCArPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICBsZXQgZE9iaiA9IHBhcnNlRGF0ZShmWzFdKTsNCiAgICAgICAgICAgICAgICAgIGlmIChkT2JqID4gZG9ub3JzW3Bob25lXS5sYXRlc3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICBkb25vcnNbcGhvbmVdLmxhdGVzdCA9IGRPYmo7DQogICAgICAgICAgICAgICAgICAgICAgZG9ub3JzW3Bob25lXS5uYW1lID0gZlsyXTsNCiAgICAgICAgICAgICAgICAgICAgICBkb25vcnNbcGhvbmVdLmFkZHIgPSBmWzRdLnJlcGxhY2UoL34vZywgJywgJyk7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICBjb25zdCBzb3J0ZWQgPSBPYmplY3QudmFsdWVzKGRvbm9ycykuc29ydCgoYSwgYikgPT4gYi5hbXQgLSBhLmFtdCk7DQogICAgICAgICAgICAgIGxldCB0ciA9ICIiOw0KICAgICAgICAgICAgICBzb3J0ZWQuZm9yRWFjaChkID0+IHsNCiAgICAgICAgICAgICAgICAgIHRyICs9IGA8dHI+PHRkPiR7ZC5waH08YnI+JHtkLmNudH0gdGltZXM8YnI+PGI+UnMuICR7ZC5hbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9iPjwvdGQ+PHRkPjxzcGFuIHN0eWxlPSJjb2xvcjp2YXIoLS1wcmltYXJ5LWJsdWUpOyBmb250LXdlaWdodDpib2xkOyI+JHtkLm5hbWV9PC9zcGFuPjxicj4ke2QuYWRkcn08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSB0ciA/IGA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGU+PHRyPjx0aD5Eb25vciBTdGF0czwvdGg+PHRoPkxhdGVzdCBEZXRhaWxzPC90aD48L3RyPiR7dHJ9PC90YWJsZT48L2Rpdj5gIDogIk5vIGRvbm9ycyBmb3VuZC4iOw0KICAgICAgICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKTsNCiAgICAgICAgICAgICAgYi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBgVW5pcXVlIERvbm9yczogJHtzb3J0ZWQubGVuZ3RofWA7DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogRmluYW5jaWFsIFN0YXRlbWVudHM6IFBlcmZvcm1zIGEgY3Jvc3MtZmlsZSBhbmFseXNpcyBiZXR3ZWVuIEluY29tZSAoTU1QVDIpDQogICAgICAgICAgICogYW5kIEV4cGVuc2VzIChFeGNlbCkgdG8gZ2VuZXJhdGUgYSBQcm9maXQgJiBMb3NzIHN0eWxlIHZpZXcgZm9yIHRoZSBGaW5hbmNpYWwgWWVhci4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkFjY291bnRzKCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IGZ5TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnBhcmVudEVsZW1lbnQuaW5uZXJUZXh0LnRyaW0oKTsNCg0KICAgICAgICAgICAgICAvLyAxLiBGZXRjaCBEb25hdGlvbiBEYXRhDQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSB0ZXh0LnNwbGl0KCdcbicpOw0KICAgICAgICAgICAgICBsZXQgY29ycHVzQ291bnQgPSAwLCBjb3JwdXNUb3RhbCA9IDAsIG5vbkNvcnB1c0NvdW50ID0gMCwgbm9uQ29ycHVzVG90YWwgPSAwOw0KICAgICAgICAgICAgICBsZXQgdG90YWxEb25hdGlvbkNvdW50ID0gMCwgdG90YWxEb25hdGlvbkFtb3VudCA9IDA7DQoNCiAgICAgICAgICAgICAgcmVjcy5mb3JFYWNoKHIgPT4gew0KICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxMyB8fCBmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBjb25zdCBkUCA9IGZbMV0uc3BsaXQoL1stL10vKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG1tID0gcGFyc2VJbnQoZFBbMV0pLCB5eSA9IHBhcnNlSW50KGRQWzJdKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGluWWVhciA9IChzWWVhciA9PT0gImFsbCIpIHx8ICgoeXkgPT09IHBhcnNlSW50KHNZZWFyKSAmJiBtbSA+PSA0KSB8fCAoeXkgPT09IHBhcnNlSW50KHNZZWFyKSArIDEgJiYgbW0gPD0gMykpOw0KICAgICAgICAgICAgICAgICAgaWYgKGluWWVhcikgew0KICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXQgPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IHRvd2FyZHMgPSAoZlsxMl0gfHwgIiIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmICh0b3dhcmRzID09PSAiQ09SUFVTIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JwdXNDb3VudCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb3JwdXNUb3RhbCArPSBhbXQ7DQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbm9uQ29ycHVzQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbm9uQ29ycHVzVG90YWwgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB0b3RhbERvbmF0aW9uQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICB0b3RhbERvbmF0aW9uQW1vdW50ICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgLy8gMi4gRmV0Y2ggSW50ZXJlc3QgRGF0YQ0KICAgICAgICAgICAgICBjb25zdCBiYW5rUmVzID0gYXdhaXQgZmV0Y2goQkFOS19ORVdfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgYmFua0xpbmVzID0gKGF3YWl0IGJhbmtSZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IGludGVyZXN0Q291bnQgPSAwLCBpbnRlcmVzdFRvdGFsID0gMDsNCg0KICAgICAgICAgICAgICBiYW5rTGluZXMuZm9yRWFjaChsaW5lID0+IHsNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gbGluZS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgNSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZGVzYyA9IChmWzFdIHx8ICIiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgY3IgPSBwYXJzZUZsb2F0KGZbNF0pIHx8IDA7DQogICAgICAgICAgICAgICAgICBjb25zdCBkT2JqID0gcGFyc2VEYXRlKGZbMF0pOw0KDQogICAgICAgICAgICAgICAgICBsZXQgaW5ZZWFyID0gKHNZZWFyID09PSAiYWxsIik7DQogICAgICAgICAgICAgICAgICBpZiAoIWluWWVhcikgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ5UyA9IHBhcnNlSW50KHNZZWFyKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gZE9iai5nZXRNb250aCgpICsgMSwgeSA9IGRPYmouZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICBpblllYXIgPSAoeSA9PT0gZnlTICYmIG0gPj0gNCkgfHwgKHkgPT09IGZ5UyArIDEgJiYgbSA8PSAzKTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGlmIChpblllYXIgJiYgKGRlc2MuaW5jbHVkZXMoIklOVEVSRVNUIikgfHwgZGVzYy5pbmNsdWRlcygiSU5UIFRSRiBGUk0iKSkgJiYgY3IgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgaW50ZXJlc3RDb3VudCsrOw0KICAgICAgICAgICAgICAgICAgICAgIGludGVyZXN0VG90YWwgKz0gY3I7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIGNvbnN0IGNvbWJpbmVkSW5jb21lQ291bnQgPSB0b3RhbERvbmF0aW9uQ291bnQgKyBpbnRlcmVzdENvdW50Ow0KICAgICAgICAgICAgICBjb25zdCBjb21iaW5lZEluY29tZVRvdGFsID0gdG90YWxEb25hdGlvbkFtb3VudCArIGludGVyZXN0VG90YWw7DQoNCiAgICAgICAgICAgICAgLy8gU3RhcnQgQnVpbGRpbmcgSFRNTA0KICAgICAgICAgICAgICBsZXQgaCA9IGA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOndoaXRlOyBwYWRkaW5nOjE1cHg7IGJvcmRlci1yYWRpdXM6MTBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMiBzdHlsZT0iY29sb3I6dmFyKC0tcHJpbWFyeS1ibHVlKTsgbWFyZ2luLXRvcDowOyI+QWNjb3VudHMgZm9yIHRoZSBGaW5hbmNpYWwgWWVhciA6ICR7ZnlMYWJlbH08L2gyPg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJjb2xvcjp2YXIoLS1kYXJrLXRleHQpOyBtYXJnaW4tYm90dG9tOjVweDsiPkluY29tZSBkdXJpbmcgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9oMz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgc3R5bGU9ImNvbG9yOnZhcigtLXZpYnJhbnQtYmx1ZSk7IG1hcmdpbi1ib3R0b206MTBweDsiPkluY29tZSBieSBEb25hdGlvbnMgOjwvaDQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiIHN0eWxlPSJtYXJnaW4tYm90dG9tOjIwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjx0cj48dGg+SXRlbTwvdGg+PHRoPkRvbm9yczwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj48L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkPkNvcnB1cyBEb25hdGlvbnM8L3RkPjx0ZD4ke2NvcnB1c0NvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7Y29ycHVzVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5Ob24gQ29ycHVzIERvbmF0aW9uczwvdGQ+PHRkPiR7bm9uQ29ycHVzQ291bnR9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtub25Db3JwdXNUb3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9InRvdGFsLWhpZ2hsaWdodC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5Ub3RhbCBEb25hdGlvbnM8L3RkPjx0ZD4ke3RvdGFsRG9uYXRpb25Db3VudH08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkke3RvdGFsRG9uYXRpb25BbW91bnQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNCBzdHlsZT0iY29sb3I6dmFyKC0tdmlicmFudC1ibHVlKTsgbWFyZ2luLWJvdHRvbToxMHB4OyI+SW5jb21lIGJ5IEludGVyZXN0IDo8L2g0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz0ic3VtLXRhYmxlIiBzdHlsZT0ibWFyZ2luLWJvdHRvbToyMHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPkl0ZW08L3RoPjx0aD5Db3VudDwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj48L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9InRvdGFsLWhpZ2hsaWdodC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5Ub3RhbCBJbnRlcmVzdCBFYXJuZWQ8L3RkPjx0ZD4ke2ludGVyZXN0Q291bnR9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImFtdCI+4oK5JHtpbnRlcmVzdFRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgc3R5bGU9ImNvbG9yOnZhcigtLXZpYnJhbnQtYmx1ZSk7IG1hcmdpbi1ib3R0b206MTBweDsiPlRvdGFsIEluY29tZSA6PC9oND4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9InN1bS10YWJsZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPkl0ZW1zPC90aD48dGg+Q291bnQ8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5CeSBEb25hdGlvbnM8L3RkPjx0ZD4ke3RvdGFsRG9uYXRpb25Db3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke3RvdGFsRG9uYXRpb25BbW91bnQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5CeSBJbnRlcmVzdDwvdGQ+PHRkPiR7aW50ZXJlc3RDb3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke2ludGVyZXN0VG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPSJ0b3RhbC1oaWdobGlnaHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+VG90YWwgSW5jb21lPC90ZD48dGQ+JHtjb21iaW5lZEluY29tZUNvdW50fTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJhbXQiPuKCuSR7Y29tYmluZWRJbmNvbWVUb3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPmA7DQoNCiAgICAgICAgICAgICAgLy8gVmFyaWFibGVzIGZvciBBbmFseXNpcw0KICAgICAgICAgICAgICBjb25zdCB0b3RhbEFsbG93ZWRTcGVuZCA9IG5vbkNvcnB1c1RvdGFsICsgaW50ZXJlc3RUb3RhbDsNCiAgICAgICAgICAgICAgY29uc3QgdG90YWxBbGxvd2VkQ291bnQgPSBub25Db3JwdXNDb3VudCArIGludGVyZXN0Q291bnQ7DQoNCiAgICAgICAgICAgICAgLy8gMy4gRmV0Y2ggRXhwZW5zZSBEYXRhIChBbmFseXNpcyAmIEJhbGFuY2UgU2hlZXQpDQogICAgICAgICAgICAgIGlmIChzWWVhciAhPT0gImFsbCIgJiYgcGFyc2VJbnQoc1llYXIpID49IDIwMjQpIHsNCiAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwUmVzID0gYXdhaXQgZmV0Y2goRVhQRU5TRVNfVVJMKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB3YiA9IFhMU1gucmVhZChuZXcgVWludDhBcnJheShhd2FpdCBleHBSZXMuYXJyYXlCdWZmZXIoKSksIHsgdHlwZTogJ2FycmF5JyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHdiLlNoZWV0c1t3Yi5TaGVldE5hbWVzWzBdXSwgeyBoZWFkZXI6IDEgfSk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGdlbkNvdW50ID0gMCwgZ2VuVG90YWwgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBkYXRhW2ldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoIDwgMikgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkT2JqID0gKHR5cGVvZiByb3dbMF0gPT09ICdudW1iZXInKSA/IFhMU1gudXRpbHMuc2hlZXRfdG9fZGF0ZShyb3dbMF0pIDogcGFyc2VEYXRlKHJvd1swXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihkT2JqLmdldFRpbWUoKSkpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbSA9IGRPYmouZ2V0TW9udGgoKSArIDEsIHkgPSBkT2JqLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByb3dGWSA9IChtID49IDQpID8geS50b1N0cmluZygpIDogKHkgLSAxKS50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93RlkgIT09IHNZZWFyKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFtdCA9IHBhcnNlRmxvYXQocm93WzNdKSB8fCAwLCBkZXNjID0gKHJvd1s0XSB8fCByb3dbMV0gfHwgIiIpLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkZXNjLmluY2x1ZGVzKCJleGVtcHQiKSAmJiAhZGVzYy5pbmNsdWRlcygiZGVwb3NpdCIpICYmICFkZXNjLmluY2x1ZGVzKCJsb2FuIikgJiYgIWRlc2MuaW5jbHVkZXMoImNsb3N1cmUiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2VuQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlblRvdGFsICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBzdHlsZT0iY29sb3I6dmFyKC0tZGFyay10ZXh0KTsgbWFyZ2luLXRvcDozMHB4OyBtYXJnaW4tYm90dG9tOjVweDsiPkV4cGVuc2VzIGZvciB0aGUgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9oMz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgc3R5bGU9ImNvbG9yOnZhcigtLXZpYnJhbnQtYmx1ZSk7IG1hcmdpbi1ib3R0b206MTBweDsiPkdlbmVyYWwgRXhwZW5zZXMgOjwvaDQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5JdGVtczwvdGg+PHRoPkNvdW50PC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0idG90YWwtaGlnaGxpZ2h0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlRvdGFsIEV4cGVuc2VzPC90ZD48dGQ+JHtnZW5Db3VudH08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkke2dlblRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+YDsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIEJhbGFuY2UgU2hlZXQgU2VjdGlvbg0KICAgICAgICAgICAgICAgICAgICAgIGxldCBiYWxhbmNlID0gY29tYmluZWRJbmNvbWVUb3RhbCAtIGdlblRvdGFsOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBiYWxhbmNlVGV4dCA9IChiYWxhbmNlID49IDApID8NCiAgICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgY2xhc3M9InByb2ZpdC10ZXh0Ij5UcnVzdCBpbiBQcm9maXQgZm9yIEZpbmFuY2lhbCBZZWFyIDogJHtmeUxhYmVsfTwvZGl2PmAgOg0KICAgICAgICAgICAgICAgICAgICAgICAgICBgPGRpdiBjbGFzcz0ibG9zcy10ZXh0Ij5UcnVzdCBpbiBMb3NzIGZvciBGaW5hbmNpYWwgWWVhciA6ICR7ZnlMYWJlbH08L2Rpdj5gOw0KDQogICAgICAgICAgICAgICAgICAgICAgaCArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJjb2xvcjp2YXIoLS1kYXJrLXRleHQpOyBtYXJnaW4tdG9wOjMwcHg7IG1hcmdpbi1ib3R0b206NXB4OyI+QmFsYW5jZSBTaGVldCBmb3IgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9oMz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9InN1bS10YWJsZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPkl0ZW1zPC90aD48dGg+Q291bnQ8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5JbmNvbWU8L3RkPjx0ZD4ke2NvbWJpbmVkSW5jb21lQ291bnR9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtjb21iaW5lZEluY29tZVRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+RXhwZW5zZXM8L3RkPjx0ZD4ke2dlbkNvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7Z2VuVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPSJ0b3RhbC1oaWdobGlnaHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+QmFsYW5jZSBTaGVldDwvdGQ+PHRkPjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJhbXQiPuKCuSR7YmFsYW5jZS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7YmFsYW5jZVRleHR9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGhyIHN0eWxlPSJib3JkZXI6IDA7IGJvcmRlci10b3A6IDJweCBzb2xpZCAjY2NjOyBtYXJnaW46IDIwcHggMDsiPmA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBBTkFMWVNJUyBTRUNUSU9ODQogICAgICAgICAgICAgICAgICAgICAgaCArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJjb2xvcjp2YXIoLS1kYXJrLXRleHQpOyBtYXJnaW4tdG9wOjMwcHg7IG1hcmdpbi1ib3R0b206NXB4OyI+QW5hbHlzaXM8L2gzPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNCBzdHlsZT0iY29sb3I6dmFyKC0tdmlicmFudC1ibHVlKTsgbWFyZ2luLWJvdHRvbToxMHB4OyI+VHJ1c3QgYWxsb3dlZCB0byBTcGVuZCBkdXJpbmcgdGhlIEZpbmFuY2lhbCBZZWFyIDogJHtmeUxhYmVsfTwvaDQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiIHN0eWxlPSJtYXJnaW4tYm90dG9tOjIwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjx0cj48dGg+SXRlbTwvdGg+PHRoPkNvdW50PC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+Tm9uIENvcnB1cyBEb25hdGlvbnM8L3RkPjx0ZD4ke25vbkNvcnB1c0NvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7bm9uQ29ycHVzVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5JbmNvbWUgYnkgSW50ZXJlc3Q8L3RkPjx0ZD4ke2ludGVyZXN0Q291bnR9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtpbnRlcmVzdFRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0idG90YWwtaGlnaGxpZ2h0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlRvdGFsIEV4cGVuc2VzIEFsbG93ZWQ8L3RkPjx0ZD4ke3RvdGFsQWxsb3dlZENvdW50fTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJhbXQiPuKCuSR7dG90YWxBbGxvd2VkU3BlbmQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoNCBzdHlsZT0iY29sb3I6dmFyKC0tdmlicmFudC1ibHVlKTsgbWFyZ2luLWJvdHRvbToxMHB4OyI+R2VuZXJhbCBFeHBlbnNlcyA6PC9oND4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9InN1bS10YWJsZSIgc3R5bGU9Im1hcmdpbi1ib3R0b206MjBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5JdGVtczwvdGg+PHRoPkNvdW50PC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0idG90YWwtaGlnaGxpZ2h0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlRvdGFsIEV4cGVuc2VzPC90ZD48dGQ+JHtnZW5Db3VudH08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkke2dlblRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDMgc3R5bGU9ImNvbG9yOnZhcigtLWRhcmstdGV4dCk7IG1hcmdpbi10b3A6MzBweDsgbWFyZ2luLWJvdHRvbTo1cHg7Ij5CYWxhbmNlIFNoZWV0IGZvciBGaW5hbmNpYWwgWWVhciA6ICR7ZnlMYWJlbH08L2gzPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz0ic3VtLXRhYmxlIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjx0cj48dGg+SXRlbTwvdGg+PHRoPkNvdW50PC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+QWxsb3dlZCBJbmNvbWUgdG8gU3BlbmQ8L3RkPjx0ZD4ke3RvdGFsQWxsb3dlZENvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7dG90YWxBbGxvd2VkU3BlbmQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5BY3R1YWwgRXhwZW5zZXM8L3RkPjx0ZD4ke2dlbkNvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7Z2VuVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPSJ0b3RhbC1oaWdobGlnaHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+QmFsYW5jZSBTaGVldDwvdGQ+PHRkPjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJhbXQiPuKCuSR7KHRvdGFsQWxsb3dlZFNwZW5kIC0gZ2VuVG90YWwpLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+YDsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIEZJTkFMIENPTU1FTlRTIFNFQ1RJT04NCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaW5hbEJhbGFuY2UgPSB0b3RhbEFsbG93ZWRTcGVuZCAtIGdlblRvdGFsOw0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gYDxoMyBzdHlsZT0iY29sb3I6dmFyKC0tZGFyay10ZXh0KTsgbWFyZ2luLXRvcDozMHB4OyBtYXJnaW4tYm90dG9tOjEwcHg7Ij5GaW5hbCBDb21tZW50czwvaDM+YDsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChmaW5hbEJhbGFuY2UgPj0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBoICs9IGA8ZGl2IHN0eWxlPSJjb2xvcjogIzAwNjQwMDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc2l6ZTogMS4xZW07IG1hcmdpbi1ib3R0b206IDIwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcnVzdCBpcyB3aXRoaW4gaXRzIHNwZW5kaW5nIGxpbWl0cy4gVGhlcmUgaXMgYSBzdXJwbHVzIG9mIDog4oK5JHtmaW5hbEJhbGFuY2UudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVmaWNpdEFtdCA9IE1hdGguYWJzKGZpbmFsQmFsYW5jZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGggKz0gYDxkaXYgc3R5bGU9ImNvbG9yOiAjZmYwMDAwOyBmb250LXdlaWdodDogYm9sZDsgZm9udC1zaXplOiAxLjFlbTsgbWFyZ2luLWJvdHRvbTogMjBweDsgbGluZS1oZWlnaHQ6IDEuNTsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRydXN0IGFjY291bnQgaXMgaW4gZGVmaWNpdC4gV2UgbmVlZCB0byBtb3ZlIFJzLiAke2RlZmljaXRBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnJvbSBDT1JQVVMgYWNjb3VudCB0byBFeHBlbnNlIEFjY291bnQuIFJlcXVpcmVkIFJlc29sdXRpb24gZG9jdW1lbnQgYXV0aG9yaXppbmcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0byB1c2UgY29ycHVzIGFtb3VudHMgYmUgcHJlcGFyZWQgZnJvbSB0aGUgVHJ1c3RlZXMgZm9yIFJlY29yZHMuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgaCArPSBgPGhyIHN0eWxlPSJib3JkZXI6IDA7IGJvcmRlci10b3A6IDNweCBkb3VibGUgdmFyKC0tcHJpbWFyeS1ibHVlKTsgbWFyZ2luOiAzMHB4IDA7Ij5gOw0KDQogICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkV4cGVuc2UgZmV0Y2ggZXJyb3IiLCBlKTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGggKz0gYDwvZGl2PmA7DQoNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGg7DQogICAgICAgICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoU3VtbWFyeUJhcicpOw0KICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGBBY2NvdW50cyBGWSAke2Z5TGFiZWx9IHwgVG90YWwgSW5jb21lOiDigrkke2NvbWJpbmVkSW5jb21lVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9YDsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCg0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFdoYXRzQXBwIEludGVncmF0b3I6IEZvcm1hdHMgYSByZWNlaXB0IHN1bW1hcnkgaW50byBhIHN0cnVjdHVyZWQgbWVzc2FnZQ0KICAgICAgICAgICAqIGFuZCBvcGVucyB0aGUgV2hhdHNBcHAgQVBJIHRvIHNlbmQgaXQgZGlyZWN0bHkgdG8gdGhlIGRvbm9yJ3MgcGhvbmUgbnVtYmVyLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gc2VuZFdoYXRzQXBwKGYpIHsNCiAgICAgICAgICAgICAgbGV0IHBoID0gZlszXS5yZXBsYWNlKC9cRC9nLCAnJyk7DQogICAgICAgICAgICAgIGlmIChwaC5sZW5ndGggPT09IDEwKSBwaCA9ICc5MScgKyBwaDsNCiAgICAgICAgICAgICAgY29uc3QgbGluZSA9ICI9PT09PT09PT09PT09PT09PT09PT09IjsNCiAgICAgICAgICAgICAgbGV0IG0gPSBgKk1ZTEFJIE1BSEFQRVJJWUFWQSBBTlVTSEFNIFRSVVNUKlxuJHtsaW5lfVxuKlJlY2VpcHQgTm86KiAke2ZbMF19XG4qRGF0ZToqICR7ZlsxXX1cblJlY2VpdmVkIHdpdGggdGhhbmtzIFJzLiAqJHtmWzldfSpcbmZvciAqJHtmWzEyXX0qIGZyb20gKlNocmkuL1NtdC4gJHtmWzJdfSpcbiR7bGluZX1cbl9UcnVzdCByZWdpc3RyYXRpb24gdmFsaWQgdGlsbCAzMS0wMy0yMDI2X2A7DQogICAgICAgICAgICAgIHdpbmRvdy5vcGVuKGBodHRwczovL3dhLm1lLyR7cGh9P3RleHQ9JHtlbmNvZGVVUklDb21wb25lbnQobSl9YCwgJ19ibGFuaycpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZVJvdGF0aW9uKCkgew0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjZWlwdENvbnRhaW5lcicpLmNsYXNzTGlzdC50b2dnbGUoJ3JvdGF0ZWQnKTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwYWNlclRvcCcpLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3BhY2VyQm90dG9tJykuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gR2xvYmFsIHZhcmlhYmxlIHRvIGhvbGQgZGF0YSBzYWZlbHkgZm9yIGRvd25sb2FkDQogICAgICAgICAgbGV0IGN1cnJlbnREb25hdGlvbkRhdGEgPSAiIjsNCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIERvbmF0aW9uIExpc3QgVmlld2VyOiBGaWx0ZXJzIHRoZSBtYXN0ZXIgZGF0YWJhc2UgYnkgRmluYW5jaWFsIFllYXIgYW5kDQogICAgICAgICAgICogZGlzcGxheXMgYSBkZXRhaWxlZCAzLWNvbHVtbiB0YWJsZSB3aXRoIGEgcm9idXN0IGRvd25sb2FkIG9wdGlvbi4NCiAgICAgICAgICAgKi8NCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5Eb25hdGlvbigpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRGWSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IGZ5TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnBhcmVudEVsZW1lbnQuaW5uZXJUZXh0LnRyaW0oKTsNCg0KICAgICAgICAgICAgICAvLyBMb2dpYyB0byBlbnN1cmUgc3VmZml4IGlzICIyNS0yNiIgZm9ybWF0DQogICAgICAgICAgICAgIGxldCB0YXJnZXRGWSA9IHNlbGVjdGVkRlk7DQogICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZZICE9PSAiYWxsIikgew0KICAgICAgICAgICAgICAgICAgY29uc3Qgc2hvcnRZZWFyID0gc2VsZWN0ZWRGWS5zbGljZSgtMik7DQogICAgICAgICAgICAgICAgICBjb25zdCBuZXh0WWVhciA9IChwYXJzZUludChzaG9ydFllYXIpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOw0KICAgICAgICAgICAgICAgICAgdGFyZ2V0RlkgPSBgJHtzaG9ydFllYXJ9LSR7bmV4dFllYXJ9YDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSB0ZXh0LnNwbGl0KCdcbicpOw0KDQogICAgICAgICAgICAgIGxldCB0b3RhbENvdW50ID0gMDsNCiAgICAgICAgICAgICAgbGV0IHRvdGFsQW1vdW50ID0gMDsNCiAgICAgICAgICAgICAgbGV0IHRhYmxlUm93cyA9ICIiOw0KDQogICAgICAgICAgICAgIC8vIFJlc2V0IGFuZCBzdGFydCBidWlsZGluZyB0ZXh0IGNvbnRlbnQgZm9yIGRvd25sb2FkDQogICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgPSBgRE9OQVRJT04gTElTVCBGT1IgRlk6ICR7ZnlMYWJlbH1cbmA7DQogICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYEdlbmVyYXRlZCBvbjogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCl9XG5gOw0KICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5gOw0KDQogICAgICAgICAgICAgIHJlY3MuZm9yRWFjaChyID0+IHsNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMjApIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmNwdE5vID0gZlswXS50cmltKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gZlsxXS50cmltKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdPy50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IHBhcnNlRmxvYXQoZls5XSkgfHwgMDsNCg0KICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkRlkgIT09ICJhbGwiICYmIGdldEZZKGRhdGVTdHIpICE9PSB0YXJnZXRGWSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgaWYgKGlzQ2FuY2VsbGVkKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgIHRvdGFsQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgIHRvdGFsQW1vdW50ICs9IGFtb3VudDsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGZbMl0gfHwgIkFub255bW91cyI7DQogICAgICAgICAgICAgICAgICBjb25zdCBhZGRyID0gKGZbNF0gfHwgIiIpLnJlcGxhY2UoL34vZywgJywgJyk7DQogICAgICAgICAgICAgICAgICBjb25zdCBwaW4gPSBmWzE1XSB8fCAiIjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50cnkgPSBmWzE5XSB8fCAiIjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHBob25lID0gZlszXSB8fCAiLS0tIjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHBhbiA9IGZbNl0gfHwgIi0tLSI7DQogICAgICAgICAgICAgICAgICBjb25zdCB0b3dhcmRzID0gZlsxMl0gfHwgIiI7DQogICAgICAgICAgICAgICAgICBjb25zdCBnZW9JbmZvID0gW2FkZHIsIHBpbiwgY291bnRyeV0uZmlsdGVyKHggPT4geC50cmltKCkgIT09ICIiKS5qb2luKCIgLSAiKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gQnVpbGQgUGxhaW4gVGV4dCBFbnRyeQ0KICAgICAgICAgICAgICAgICAgY3VycmVudERvbmF0aW9uRGF0YSArPSBgUmVjZWlwdDogJHtyY3B0Tm99IHwgRGF0ZTogJHtkYXRlU3RyfVxuYDsNCiAgICAgICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYEFtb3VudDogUnMuICR7YW1vdW50fSB8IFRvd2FyZHM6ICR7dG93YXJkc31cbmA7DQogICAgICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGBEb25vcjogJHtuYW1lfVxuYDsNCiAgICAgICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYEFkZHJlc3M6ICR7Z2VvSW5mb31cbmA7DQogICAgICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGBQaG9uZTogJHtwaG9uZX0gfCBQQU46ICR7cGFufVxuYDsNCiAgICAgICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5gOw0KDQogICAgICAgICAgICAgICAgICAvLyBCdWlsZCBIVE1MIFRhYmxlIFJvdw0KICAgICAgICAgICAgICAgICAgdGFibGVSb3dzICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9IndoaXRlLXNwYWNlOm5vd3JhcDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0icmNwdC1saW5rIiBvbmNsaWNrPSJqdW1wVG9SZWNlaXB0KCcke3JjcHROb30nKSI+JHtyY3B0Tm99PC9zcGFuPjxicj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPiR7ZGF0ZVN0cn08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ0ZXh0LWFsaWduOnJpZ2h0OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiPuKCuSR7YW1vdW50LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvYj48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT0iY29sb3I6dmFyKC0tcHJpbWFyeS1ibHVlKTsiPiR7dG93YXJkc308L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Yj4ke25hbWV9PC9iPjxicj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsPiR7Z2VvSW5mb308L3NtYWxsPjxicj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNtYWxsIHN0eWxlPSJjb2xvcjojNTU1OyI+W1Bob25lOiAke3Bob25lfV0gW1BBTjogJHtwYW59XTwvc21hbGw+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgY3VycmVudERvbmF0aW9uRGF0YSArPSBgXG5UT1RBTCBUUkFOU0FDVElPTlM6ICR7dG90YWxDb3VudH1cbmA7DQogICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYFRPVEFMIEFNT1VOVDogUnMuICR7dG90YWxBbW91bnQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9XG5gOw0KDQogICAgICAgICAgICAgIGNvbnN0IG1haW5UaXRsZSA9IGA8aDMgY2xhc3M9ImJhbmstdGl0bGUiPkxpc3Qgb2YgRG9uYXRpb25zIGZvciBGaW5hbmNpYWwgWWVhciA6ICR7ZnlMYWJlbH08L2gzPmA7DQoNCiAgICAgICAgICAgICAgLy8gRG93bmxvYWQgQnV0dG9uIC0gbm93IHNpbXBsaWZpZWQgdG8gYXZvaWQgc2NyaXB0IGVycm9ycw0KICAgICAgICAgICAgICBjb25zdCBkb3dubG9hZEJ0biA9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IG1hcmdpbi10b3A6MjBweDsgcGFkZGluZy1ib3R0b206NjBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJkb3dubG9hZEZpbGUoJyR7dGFyZ2V0Rll9JykiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWd3LWdyZWVuKTsgY29sb3I6d2hpdGU7IHBhZGRpbmc6MTVweCAzMHB4OyBmb250LXNpemU6MXJlbTsgYm9yZGVyLXJhZGl1czo4cHg7IGN1cnNvcjpwb2ludGVyOyBib3JkZXI6bm9uZTsgZm9udC13ZWlnaHQ6Ym9sZDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIERvd25sb2FkIERvbmF0aW9uc18ke3RhcmdldEZZfS50eHQNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOw0KDQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgICAgICR7bWFpblRpdGxlfQ0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5STm8gJiBEYXRlPC90aD48dGg+QW1vdW50ICYgVG93YXJkczwvdGg+PHRoPkRvbm9yIERldGFpbHM8L3RoPjwvdHI+PC90aGVhZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+JHt0YWJsZVJvd3MgfHwgJzx0cj48dGQgY29sc3Bhbj0iMyIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+Tm8gcmVjb3JkcyBmb3VuZC48L3RkPjwvdHI+J308L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICR7dG90YWxDb3VudCA+IDAgPyBkb3dubG9hZEJ0biA6ICIifWA7DQoNCiAgICAgICAgICAgICAgY29uc3QgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hTdW1tYXJ5QmFyJyk7DQogICAgICAgICAgICAgIGIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgIGIuaW5uZXJIVE1MID0gYFRvdGFsICR7dG90YWxDb3VudH0gVHJhbnNhY3Rpb25zIDog4oK5JHt0b3RhbEFtb3VudC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX1gOw0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFJvYnVzdCBEb3dubG9hZCBIZWxwZXINCiAgICAgICAgICAgKiBVc2VzIHRoZSBnbG9iYWwgY3VycmVudERvbmF0aW9uRGF0YSB2YXJpYWJsZQ0KICAgICAgICAgICAqLw0KICAgICAgICAgIGZ1bmN0aW9uIGRvd25sb2FkRmlsZShmeVN1ZmZpeCkgew0KICAgICAgICAgICAgICBpZiAoIWN1cnJlbnREb25hdGlvbkRhdGEpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJObyBkYXRhIGF2YWlsYWJsZSB0byBkb3dubG9hZC4iKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOw0KICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2N1cnJlbnREb25hdGlvbkRhdGFdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTsNCiAgICAgICAgICAgICAgZWxlbWVudC5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsNCiAgICAgICAgICAgICAgZWxlbWVudC5kb3dubG9hZCA9IGBEb25hdGlvbnNfJHtmeVN1ZmZpeH0udHh0YDsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTsNCiAgICAgICAgICAgICAgZWxlbWVudC5jbGljaygpOw0KICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW1lbnQpOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgY29uc3QgQVBQUk9WRURfVVJMID0gImh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkvbnppbHpia2Y4bDJ0bHgyMXB5Yjg0L0FwcHJvdmVkLnR4dD9ybGtleT1va3pmdm16bXBmYjlrdWh6NzRkYmUwYWRzJmRsPTEiOw0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogTkVXOiBEZXZpY2UgQXV0aG9yaXphdGlvbiBDaGVjaw0KICAgICAgICAgICAqIFJlcGxhY2VzIHRoZSBtYW51YWwgcGFzc3dvcmQgbG9naW4NCiAgICAgICAgICAgKi8NCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBjaGVja0RldmljZUF1dGgoKSB7DQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCBteUlEID0gZ2VuZXJhdGVGaW5nZXJwcmludCgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goQVBQUk9WRURfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KDQogICAgICAgICAgICAgICAgICAvLyBTcGxpdCBieSBsaW5lcywgdHJpbSBzcGFjZXMsIGFuZCByZW1vdmUgZW1wdHkgbGluZXMNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFwcHJvdmVkSURzID0gdGV4dC5zcGxpdCgvXHI/XG4vKS5tYXAoaWQgPT4gaWQudHJpbSgpKS5maWx0ZXIoaWQgPT4gaWQgIT09ICIiKTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGFwcHJvdmVkSURzLmluY2x1ZGVzKG15SUQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgLy8gU1VDQ0VTUzogSGlkZSBsb2dpbiBzY3JlZW4gYW5kIGxvYWQgZGFzaGJvYXJkDQogICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luT3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW5Db250ZW50Jykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgICAgICAgICAgd3JhcExvYWRpbmcoaW5pdERhc2hib2FyZCk7DQogICAgICAgICAgICAgICAgICAgICAgLy8gU1RSQVRFR1k6IENhbGwgdGhlIG5ldyBpZGVudGl0eSBmdW5jdGlvbiBhdCB0aGUgZW5kDQogICAgICAgICAgICAgICAgICAgICAgZ2V0VXNlcklkZW50aXR5KG15SUQpOw0KDQogICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgIC8vIEZBSUw6IERpc3BsYXkgdGhlIERldmljZSBJRCBmb3IgcmVnaXN0cmF0aW9uDQogICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1dGhTdGF0dXMnKS5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDoyMHB4OyBib3JkZXItdG9wOjFweCBzb2xpZCAjZWVlOyBwYWRkaW5nLXRvcDoxMHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxiIHN0eWxlPSJjb2xvcjp2YXIoLS1jYW5jZWwtcmVkKTsiPkRFVklDRSBOT1QgQVVUSE9SSVpFRDwvYj48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD5Zb3VyIERldmljZSBJRCBpczo8L3NtYWxsPjxicj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1mYW1pbHk6bW9ub3NwYWNlOyBiYWNrZ3JvdW5kOiNmNGY0ZjQ7IHBhZGRpbmc6OHB4OyBtYXJnaW46MTBweCAwOyBib3JkZXI6MXB4IGRhc2hlZCAjOTk5OyB3b3JkLWJyZWFrOmJyZWFrLWFsbDsgZm9udC1zaXplOjAuOXJlbTsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHtteUlEfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHAgc3R5bGU9ImZvbnQtc2l6ZTowLjc1cmVtOyI+Q29weSB0aGlzIElEIGFuZCBzZW5kIGl0IHRvIHRoZSBhZG1pbiB0byBlbmFibGUgYWNjZXNzLjwvcD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYXV0aFN0YXR1cycpLmlubmVySFRNTCA9ICJDb25uZWN0aW9uIEVycm9yLiBQbGVhc2UgY2hlY2sgaW50ZXJuZXQuIjsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkF1dGggZXJyb3I6IiwgZSk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBORVc6IEdlbmVyYXRlcyBhIHVuaXF1ZSBJRCBmb3IgdGhpcyBzcGVjaWZpYyBkZXZpY2UvYnJvd3Nlcg0KICAgICAgICAgICAqLw0KICAgICAgICAgIGZ1bmN0aW9uIGdlbmVyYXRlRmluZ2VycHJpbnQoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOw0KICAgICAgICAgICAgICBjb25zdCBnbCA9IGNhbnZhcy5nZXRDb250ZXh0KCd3ZWJnbCcpOw0KICAgICAgICAgICAgICBjb25zdCBkZWJ1Z0luZm8gPSBnbCA/IGdsLmdldEV4dGVuc2lvbignV0VCR0xfZGVidWdfcmVuZGVyZXJfaW5mbycpIDogbnVsbDsNCiAgICAgICAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBkZWJ1Z0luZm8gPyBnbC5nZXRQYXJhbWV0ZXIoZGVidWdJbmZvLlVOTUFTS0VEX1JFTkRFUkVSX1dFQkdMKSA6ICJzdGFuZGFyZC1icm93c2VyIjsNCg0KICAgICAgICAgICAgICAvLyBDb21iaW5lIGhhcmR3YXJlIHNwZWNzIHRvIGNyZWF0ZSBhIHVuaXF1ZSBzdHJpbmcNCiAgICAgICAgICAgICAgY29uc3QgcmF3SWQgPSBgJHtyZW5kZXJlcn0tJHtzY3JlZW4ud2lkdGh9eCR7c2NyZWVuLmhlaWdodH0tJHtuZXcgRGF0ZSgpLmdldFRpbWV6b25lT2Zmc2V0KCl9YDsNCg0KICAgICAgICAgICAgICAvLyBDb252ZXJ0IHN0cmluZyB0byBhIG51bWVyaWMgaGFzaA0KICAgICAgICAgICAgICBsZXQgaGFzaCA9IDA7DQogICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmF3SWQubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgIGhhc2ggPSAoKGhhc2ggPDwgNSkgLSBoYXNoKSArIHJhd0lkLmNoYXJDb2RlQXQoaSk7DQogICAgICAgICAgICAgICAgICBoYXNoIHw9IDA7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgcmV0dXJuICJNTVBULURFVi0iICsgTWF0aC5hYnMoaGFzaCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogVUkgSGVscGVyOiBTaG93cyBvciBoaWRlcyB0aGUgZmxvYXRpbmcgc2Nyb2xsIGJ1dHRvbnMgYmFzZWQgb24gY29udGVudCBwcmVzZW5jZS4NCiAgICAgICAgICAgKi8NCiAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVTY3JvbGxCdXR0b25zKHNob3cpIHsNCiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheVN0eWxlID0gc2hvdyA/ICdmbGV4JyA6ICdub25lJzsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bkdvVG9wJykuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXlTdHlsZTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bkdvQm90dG9tJykuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXlTdHlsZTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAqIFJSIExhYmVsczogUHJlcGFyZWQgZm9yIGdlbmVyYXRpbmcgYWRkcmVzcyBsYWJlbHMgZm9yIGRvbm9ycy4NCiAgICAgICAqIExvZ2ljIHRvIGJlIGltcGxlbWVudGVkIGluIHRoZSBuZXh0IHN0ZXAuDQogICAgICAgKi8NCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlUlJMYWJlbHMoKSB7DQogICAgICAgICAgICAgIGNvbnN0IHsganNQREYgfSA9IHdpbmRvdy5qc3BkZjsNCiAgICAgICAgICAgICAgY29uc3QgZG9jID0gbmV3IGpzUERGKCdwJywgJ21tJywgJ2E0Jyk7DQoNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQoNCiAgICAgICAgICAgICAgY29uc3QgdmFsaWRSZWNzID0gcmVjcy5maWx0ZXIociA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDIwKSByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdPy50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICBjb25zdCBpc0Fub24gPSAoIWZbMl0gfHwgZlsyXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSk7DQogICAgICAgICAgICAgICAgICBjb25zdCByY3B0UHJpbnRlZCA9IGZbMTZdPy50cmltKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHByYXNhZGFtU2VudCA9IGZbMTddPy50cmltKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUmVhZHkgPSAocmNwdFByaW50ZWQgPT09ICJOTyIgfHwgcmNwdFByaW50ZWQgPT09ICIiKSAmJg0KICAgICAgICAgICAgICAgICAgICAgIChwcmFzYWRhbVNlbnQgPT09ICJOTyIgfHwgcHJhc2FkYW1TZW50ID09PSAiIik7DQoNCiAgICAgICAgICAgICAgICAgIHJldHVybiBmWzBdLnN0YXJ0c1dpdGgoIkNHIikgJiYgcGFyc2VEYXRlKGZbMV0pID49IENVVE9GRl9EQVRFICYmDQogICAgICAgICAgICAgICAgICAgICAgIWlzQ2FuY2VsbGVkICYmICFpc0Fub24gJiYgZls0XS50cmltKCkgIT09ICIiICYmIGlzUmVhZHk7DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIGlmICh2YWxpZFJlY3MubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiTm8gcmVjZWlwdHMgYXJlIGN1cnJlbnRseSBtYXJrZWQgYXMgJ1JFQURZJy4iKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGNvbnN0IG1hcmdpbiA9IDEwLCBsYWJlbFcgPSA5NSwgbGFiZWxIID0gNzAsIGNvbHMgPSAyLCByb3dzID0gNDsNCiAgICAgICAgICAgICAgbGV0IGN1cnJlbnRJdGVtID0gMDsNCg0KICAgICAgICAgICAgICB2YWxpZFJlY3MuZm9yRWFjaCgocikgPT4gew0KICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRJdGVtID4gMCAmJiBjdXJyZW50SXRlbSAlIChjb2xzICogcm93cykgPT09IDApIGRvYy5hZGRQYWdlKCk7DQoNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVjZWlwdCA9IGZbMF07DQogICAgICAgICAgICAgICAgICBjb25zdCBkb25vck5hbWUgPSAiU2hyaS4vU210LiAiICsgZlsyXS50cmltKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBwaG9uZSA9IGZbM10gfHwgIiI7DQogICAgICAgICAgICAgICAgICBjb25zdCBwaW5Db2RlID0gZlsxNV0/LnRyaW0oKSB8fCAiIjsNCg0KICAgICAgICAgICAgICAgICAgLy8gVHJlYXQgfiBhcyBzcGFjZSBmb3IgbmF0dXJhbCBmbG93DQogICAgICAgICAgICAgICAgICBsZXQgZnVsbEFkZHIgPSBmWzRdLnJlcGxhY2UoL34vZywgJyAnKS50cmltKCk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHBhZ2VJZHggPSBjdXJyZW50SXRlbSAlIChjb2xzICogcm93cyksIGNvbCA9IHBhZ2VJZHggJSBjb2xzLCByb3cgPSBNYXRoLmZsb29yKHBhZ2VJZHggLyBjb2xzKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSBtYXJnaW4gKyAoY29sICogbGFiZWxXKSwgeSA9IG1hcmdpbiArIChyb3cgKiBsYWJlbEgpOw0KDQogICAgICAgICAgICAgICAgICAvLyBEYXJrIEJvcmRlcg0KICAgICAgICAgICAgICAgICAgZG9jLnNldERyYXdDb2xvcigwKTsNCiAgICAgICAgICAgICAgICAgIGRvYy5zZXRMaW5lV2lkdGgoMC40KTsNCiAgICAgICAgICAgICAgICAgIGRvYy5yZWN0KHgsIHksIGxhYmVsVywgbGFiZWxIKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gMS4gUmVmIEhlYWRlcg0KICAgICAgICAgICAgICAgICAgZG9jLnNldEZvbnRTaXplKDkpOw0KICAgICAgICAgICAgICAgICAgZG9jLnNldEZvbnQoImhlbHZldGljYSIsICJub3JtYWwiKTsNCiAgICAgICAgICAgICAgICAgIGRvYy50ZXh0KCJUTzoiLCB4ICsgNSwgeSArIDgpOw0KICAgICAgICAgICAgICAgICAgZG9jLnRleHQoIlJlZjogIiArIHJlY2VpcHQsIHggKyBsYWJlbFcgLSAzMCwgeSArIDgpOw0KDQogICAgICAgICAgICAgICAgICAvLyAyLiBOYW1lIC0gQm9sZCBhbmQgV3JhcHBlZA0KICAgICAgICAgICAgICAgICAgZG9jLnNldEZvbnRTaXplKDEzKTsNCiAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd3JhcHBlZE5hbWUgPSBkb2Muc3BsaXRUZXh0VG9TaXplKGRvbm9yTmFtZSwgODUpOw0KICAgICAgICAgICAgICAgICAgZG9jLnRleHQod3JhcHBlZE5hbWUsIHggKyA1LCB5ICsgMTcpOw0KDQogICAgICAgICAgICAgICAgICAvLyBTcGFjaW5nOiBFbmQgb2YgbmFtZSArIDVtbSBnYXAgZm9yIHZpc3VhbCBjbGFyaXR5DQogICAgICAgICAgICAgICAgICBsZXQgYWRkclkgPSB5ICsgMTcgKyAod3JhcHBlZE5hbWUubGVuZ3RoICogNS41KSArIDI7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDMuIEFkZHJlc3MgTG9naWMNCiAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAibm9ybWFsIik7DQogICAgICAgICAgICAgICAgICBkb2Muc2V0Rm9udFNpemUoMTEpOw0KDQogICAgICAgICAgICAgICAgICAvLyBTZXBhcmF0ZSBDaXR5IChMYXN0IFdvcmQpDQogICAgICAgICAgICAgICAgICBsZXQgd29yZHMgPSBmdWxsQWRkci5zcGxpdCgvXHMrLyk7DQogICAgICAgICAgICAgICAgICBsZXQgY2l0eSA9IHdvcmRzLmxlbmd0aCA+IDAgPyB3b3Jkcy5wb3AoKS5yZXBsYWNlKC9bLDpdJC8sICIiKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgbGV0IGFkZHJXaXRob3V0Q2l0eSA9IHdvcmRzLmpvaW4oIiAiKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gSHlicmlkIFdyYXBwaW5nIEFwcHJvYWNoDQogICAgICAgICAgICAgICAgICAvLyBGaXJzdCB0cnkgc3BsaXR0aW5nIGJ5IGV4aXN0aW5nIHB1bmN0dWF0aW9uDQogICAgICAgICAgICAgICAgICBsZXQgc2VnbWVudHMgPSBhZGRyV2l0aG91dENpdHkuc3BsaXQoL1ssOl0vKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKHMgPT4gcyAhPT0gIiIpOw0KICAgICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRMaW5lID0gIiI7DQogICAgICAgICAgICAgICAgICBjb25zdCBtYXhXaWR0aCA9IDg1Ow0KDQogICAgICAgICAgICAgICAgICBzZWdtZW50cy5mb3JFYWNoKChzZWdtZW50LCBpZHgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIHNlZ21lbnQgaXRzZWxmIGlzIHRvbyBsb25nIGZvciBhIGJsYW5rIGxpbmUNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZG9jLmdldFRleHRXaWR0aChzZWdtZW50KSA+IG1heFdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZPUkNFIFRFWFQgRkxPVyBmb3IgdGhpcyBzZWdtZW50IChTcGxpdCBieSBzcGFjZSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHN1YldvcmRzID0gc2VnbWVudC5zcGxpdCgvXHMrLyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHN1YldvcmRzLmZvckVhY2goc3cgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRlc3RMaW5lID0gY3VycmVudExpbmUgPT09ICIiID8gc3cgOiBjdXJyZW50TGluZSArICIgIiArIHN3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5nZXRUZXh0V2lkdGgodGVzdExpbmUpIDwgbWF4V2lkdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50TGluZSA9IHRlc3RMaW5lOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MudGV4dChjdXJyZW50TGluZSwgeCArIDUsIGFkZHJZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyWSArPSA1LjU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudExpbmUgPSBzdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhbmRhcmQgcGFja2luZw0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGVzdExpbmUgPSBjdXJyZW50TGluZSA9PT0gIiIgPyBzZWdtZW50IDogY3VycmVudExpbmUgKyAiLCAiICsgc2VnbWVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5nZXRUZXh0V2lkdGgodGVzdExpbmUpIDwgbWF4V2lkdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lID0gdGVzdExpbmU7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQcmludCBjdXJyZW50IGxpbmUgYW5kIHN0YXJ0IG5ldyBsaW5lIHdpdGggdGhpcyBzZWdtZW50DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MudGV4dChjdXJyZW50TGluZSArIChjdXJyZW50TGluZS5lbmRzV2l0aCgiLCIpID8gIiIgOiAiLCIpLCB4ICsgNSwgYWRkclkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkclkgKz0gNS41Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudExpbmUgPSBzZWdtZW50Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIFByaW50IGZpbmFsIGFkZHJlc3MgYm9keSBsaW5lDQogICAgICAgICAgICAgICAgICBpZiAoY3VycmVudExpbmUpIHsNCiAgICAgICAgICAgICAgICAgICAgICBkb2MudGV4dChjdXJyZW50TGluZSwgeCArIDUsIGFkZHJZKTsNCiAgICAgICAgICAgICAgICAgICAgICBhZGRyWSArPSA1LjU7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIC8vIENpdHkgLSBQaW5jb2RlDQogICAgICAgICAgICAgICAgICBjb25zdCBjaXR5UGluID0gY2l0eSArIChwaW5Db2RlID8gIiAtICIgKyBwaW5Db2RlIDogIiIpOw0KICAgICAgICAgICAgICAgICAgZG9jLnRleHQoY2l0eVBpbiwgeCArIDUsIGFkZHJZKTsNCiAgICAgICAgICAgICAgICAgIGFkZHJZICs9IDc7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDQuIFRlbGVwaG9uZSAoQm9sZCkNCiAgICAgICAgICAgICAgICAgIGlmIChwaG9uZSAmJiBwaG9uZS50cmltKCkgIT09ICIiKSB7DQogICAgICAgICAgICAgICAgICAgICAgZG9jLnNldEZvbnQoImhlbHZldGljYSIsICJib2xkIik7DQogICAgICAgICAgICAgICAgICAgICAgLy8gRW5zdXJlIHBob25lIGRvZXNuJ3QgZHJvcCBvZmYgdGhlIGxhYmVsDQogICAgICAgICAgICAgICAgICAgICAgbGV0IGZpbmFsUGhvbmVZID0gTWF0aC5taW4oYWRkclksIHkgKyBsYWJlbEggLSA2KTsNCiAgICAgICAgICAgICAgICAgICAgICBkb2MudGV4dCgiVGVsZXBob25lIDogIiArIHBob25lLCB4ICsgNSwgZmluYWxQaG9uZVkpOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgY3VycmVudEl0ZW0rKzsNCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlRGF0ZVN0cmluZygnZW4tR0InKS5yZXBsYWNlKC9cLy9nLCAnLScpOw0KICAgICAgICAgICAgICBkb2Muc2F2ZShgTGFiZWxzIC0gJHt0b2RheX0ucGRmYCk7DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAvLyAxLiBJbml0aWFsaXplIEF1ZGlvIGFuZCBoYW5kbGUgQnJvd3NlciBBdXRvcGxheSBQb2xpY3kNCiAgICAgICAgICBmdW5jdGlvbiBpbml0QXVkaW8oKSB7DQogICAgICAgICAgICAgIGNvbnN0IGF1ZGlvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JnTXVzaWMnKTsNCiAgICAgICAgICAgICAgYXVkaW8udm9sdW1lID0gMC4zOyAvLyBTZXQgdm9sdW1lIHRvIDMwJSBzbyBpdCdzIG5vdCB0b28gbG91ZA0KDQogICAgICAgICAgICAgIC8vIE1vZGVybiBicm93c2VycyBibG9jayBhdWRpbyB1bnRpbCB0aGUgdXNlciBjbGlja3Mgc29tZXRoaW5nDQogICAgICAgICAgICAgIGNvbnN0IHBsYXlBdHRlbXB0ID0gKCkgPT4gew0KICAgICAgICAgICAgICAgICAgYXVkaW8ucGxheSgpLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIC8vIE9uY2UgcGxheWluZyBzdGFydHMsIHJlbW92ZSB0aGUgImZpcnN0LWNsaWNrIiBsaXN0ZW5lcnMNCiAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlBdHRlbXB0KTsNCiAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgcGxheUF0dGVtcHQpOw0KICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIkF1ZGlvIHdhaXRpbmcgZm9yIHVzZXIgaW50ZXJhY3Rpb24uIik7DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgICAvLyBUcmlnZ2VyIHBsYXkgb24gdGhlIHZlcnkgZmlyc3QgY2xpY2sgb3Iga2V5cHJlc3MgdGhlIHVzZXIgbWFrZXMNCiAgICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5QXR0ZW1wdCk7DQogICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBwbGF5QXR0ZW1wdCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gMi4gVGhlIE11dGUvVW5tdXRlIFRvZ2dsZSBmdW5jdGlvbg0KICAgICAgICAgIGZ1bmN0aW9uIHRvZ2dsZU11dGUoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGF1ZGlvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2JnTXVzaWMnKTsNCiAgICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ211dGVCdG4nKTsNCg0KICAgICAgICAgICAgICBpZiAoYXVkaW8ubXV0ZWQpIHsNCiAgICAgICAgICAgICAgICAgIGF1ZGlvLm11dGVkID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICBidG4uaW5uZXJIVE1MID0gIvCflIcgTXV0ZSI7DQogICAgICAgICAgICAgICAgICBidG4uc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCAnI2VlZWVlZScsICdpbXBvcnRhbnQnKTsNCiAgICAgICAgICAgICAgICAgIGJ0bi5zdHlsZS5zZXRQcm9wZXJ0eSgnY29sb3InLCAnYmxhY2snLCAnaW1wb3J0YW50Jyk7DQogICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICBhdWRpby5tdXRlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICBidG4uaW5uZXJIVE1MID0gIvCflIogVW5tdXRlIjsNCiAgICAgICAgICAgICAgICAgIC8vIENoYW5nZXMgdG8gYSBzb2Z0IHJlZCBiYWNrZ3JvdW5kIHdpdGggZGFyayByZWQgdGV4dCB3aGVuIG11dGVkDQogICAgICAgICAgICAgICAgICBidG4uc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQnLCAnI2ZmZGFkYScsICdpbXBvcnRhbnQnKTsNCiAgICAgICAgICAgICAgICAgIGJ0bi5zdHlsZS5zZXRQcm9wZXJ0eSgnY29sb3InLCAnIzg4MDAwMCcsICdpbXBvcnRhbnQnKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIDMuIE1ha2Ugc3VyZSB0byBjYWxsIGluaXRBdWRpbyB3aGVuIHRoZSBwYWdlIGxvYWRzDQogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0QXVkaW8pOw0KDQoNCiAgICAgICAgICAvKioNCiogQW5vbnkgTWF0Y2g6IFBsYWNlaG9sZGVyIGZvciBmdXR1cmUgbG9naWMgdG8gbWF0Y2gNCiogYW5vbnltb3VzIGRvbmF0aW9ucyB3aXRoIHNwZWNpZmljIGRvbm9yIHJlY29yZHMuDQoqLw0KDQoNCiAgICAgICAgICAvLyBIZWxwZXIgdG8gY2xlYW4gdGhlIHJlZmVyZW5jZSBzdHJpbmcgb2YgYmFua2luZyBub2lzZQ0KICAgICAgICAgIGZ1bmN0aW9uIHNhbml0aXplUmVmKHN0cikgew0KICAgICAgICAgICAgICBpZiAoIXN0cikgcmV0dXJuICIiOw0KICAgICAgICAgICAgICBsZXQgY2xlYW4gPSBzdHIudG9VcHBlckNhc2UoKTsNCg0KICAgICAgICAgICAgICAvLyAxLiBSZW1vdmUgU3RhbmRhcmQgQmFua2luZyBQcmVmaXhlcw0KICAgICAgICAgICAgICBjb25zdCBub2lzZSA9IFsNCiAgICAgICAgICAgICAgICAgICJCWSBPTkwgVVBJLyIsICJCWSBORUZUIFRSRiIsICJCWSBPTkwgVFJGLyIsICJCWSBPTkwgSU1QUy8iLA0KICAgICAgICAgICAgICAgICAgIkJZIE9OTCBDUi8iLCAiQlkgT05MIE1CLyIsICJCWSBPTkwgQ0MvIiwgIkJZIE9OTCBEQy8iLA0KICAgICAgICAgICAgICAgICAgIkJZIFRSQU5TRkVSLSIsICJCWSBUUkFOU0ZFUi8iLCAiQlkgQ0FTSCIsICI6OjAwMDMyIiwgIjo6MDAwMDEiDQogICAgICAgICAgICAgIF07DQogICAgICAgICAgICAgIG5vaXNlLmZvckVhY2gocCA9PiB7IGNsZWFuID0gY2xlYW4uc3BsaXQocCkuam9pbigiIik7IH0pOw0KDQogICAgICAgICAgICAgIC8vIDIuIFJlbW92ZSBOdW1iZXJzIChJRHMsIElGU0MgY29kZXMsIERhdGVzKSB0byBmb2N1cyBvbiBuYW1lcy90ZXh0DQogICAgICAgICAgICAgIC8vIFdlIHJlcGxhY2UgZGlnaXRzIHdpdGggYSBzcGFjZSBzbyB3ZSBkb24ndCBhY2NpZGVudGFsbHkgam9pbiB0d28gd29yZHMNCiAgICAgICAgICAgICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9bMC05XS9nLCAiICIpOw0KDQogICAgICAgICAgICAgIC8vIDMuIFJlbW92ZSBTcGVjaWFsIENoYXJhY3RlcnMgYW5kIGV4dHJhIHNwYWNlcw0KICAgICAgICAgICAgICBjbGVhbiA9IGNsZWFuLnJlcGxhY2UoL1teQS1aIF0vZywgIiAiKTsNCg0KICAgICAgICAgICAgICAvLyA0LiBSZXR1cm4gY29uZGVuc2VkIHVwcGVyY2FzZSBzdHJpbmcgKGUuZy4sICJNWVRISUxJSUNJQ01ZSklOSlUiKQ0KICAgICAgICAgICAgICByZXR1cm4gY2xlYW4ucmVwbGFjZSgvXHMrL2csICIiKS50cmltKCk7DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAvKioNCiogU0FOSVRJWkFUSU9OIEVOR0lORQ0KKiBSZW1vdmVzIGJhbmsgcHJlZml4ZXMsIHRyYW5zYWN0aW9uIElEcywgYW5kIHN0YW5kYXJkIHN1ZmZpeGVzLg0KKi8NCiAgICAgICAgICBmdW5jdGlvbiBzYW5pdGl6ZVJlZihzdHIpIHsNCiAgICAgICAgICAgICAgaWYgKCFzdHIgfHwgdHlwZW9mIHN0ciAhPT0gJ3N0cmluZycpIHJldHVybiAiIjsNCiAgICAgICAgICAgICAgbGV0IGNsZWFuID0gc3RyLnRvVXBwZXJDYXNlKCk7DQoNCiAgICAgICAgICAgICAgLy8gMS4gTGlzdCBvZiBwaHJhc2VzIHRvIGlnbm9yZSAoRmluZS10dW5lIHRoaXMgbGlzdCBhcyBuZWVkZWQpDQogICAgICAgICAgICAgIGNvbnN0IG5vaXNlID0gWw0KICAgICAgICAgICAgICAgICAgIkJZIE9OTCBVUEkvIiwgIkJZIE5FRlQgVFJGIiwgIkJZIE9OTCBUUkYvIiwgIkJZIE9OTCBJTVBTLyIsDQogICAgICAgICAgICAgICAgICAiQlkgT05MIENSLyIsICJCWSBPTkwgTUIvIiwgIkJZIE9OTCBDQy8iLCAiQlkgT05MIERDLyIsDQogICAgICAgICAgICAgICAgICAiQlkgVFJBTlNGRVItIiwgIkJZIFRSQU5TRkVSLyIsICJCWSBDQVNIIiwgIjo6MDAwMzIiLCAiOjowMDAwMSIsDQogICAgICAgICAgICAgICAgICAiVFJBTlNGRVIgRlJPTSIsICJDSCBTQklOIiwgIkZEUkwvIiwgIklDSUMvIg0KICAgICAgICAgICAgICBdOw0KICAgICAgICAgICAgICBub2lzZS5mb3JFYWNoKHAgPT4geyBjbGVhbiA9IGNsZWFuLnNwbGl0KHApLmpvaW4oIiIpOyB9KTsNCg0KICAgICAgICAgICAgICAvLyAyLiBSZW1vdmUgYWxsIG51bWJlcnMgKHJlbW92ZXMgVVBJIElEcywgSUZTQyBjb2RlcywgYW5kIGRhdGVzKQ0KICAgICAgICAgICAgICBjbGVhbiA9IGNsZWFuLnJlcGxhY2UoL1swLTldL2csICIiKTsNCg0KICAgICAgICAgICAgICAvLyAzLiBSZW1vdmUgbm9uLWFscGhhIGNoYXJhY3RlcnMgKHNsYXNoZXMsIGNvbG9ucywgZG90cykNCiAgICAgICAgICAgICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9bXkEtWl0vZywgIiIpOw0KDQogICAgICAgICAgICAgIHJldHVybiBjbGVhbi50cmltKCk7DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAvKioNCiogU0FOSVRJWkFUSU9OIEVOR0lORQ0KKiBSZW1vdmVzIGJhbmsgcHJlZml4ZXMsIHRyYW5zYWN0aW9uIElEcywgYW5kIHN0YW5kYXJkIHN1ZmZpeGVzLg0KKi8NCiAgICAgICAgICBmdW5jdGlvbiBzYW5pdGl6ZVJlZihzdHIpIHsNCiAgICAgICAgICAgICAgaWYgKCFzdHIgfHwgdHlwZW9mIHN0ciAhPT0gJ3N0cmluZycpIHJldHVybiAiIjsNCiAgICAgICAgICAgICAgbGV0IGNsZWFuID0gc3RyLnRvVXBwZXJDYXNlKCk7DQoNCiAgICAgICAgICAgICAgLy8gMS4gTGlzdCBvZiBwaHJhc2VzIHRvIGlnbm9yZSAoRmluZS10dW5lIHRoaXMgbGlzdCBhcyBuZWVkZWQpDQogICAgICAgICAgICAgIGNvbnN0IG5vaXNlID0gWw0KICAgICAgICAgICAgICAgICAgIkJZIE9OTCBVUEkvIiwgIkJZIE5FRlQgVFJGIiwgIkJZIE9OTCBUUkYvIiwgIkJZIE9OTCBJTVBTLyIsDQogICAgICAgICAgICAgICAgICAiQlkgT05MIENSLyIsICJCWSBPTkwgTUIvIiwgIkJZIE9OTCBDQy8iLCAiQlkgT05MIERDLyIsDQogICAgICAgICAgICAgICAgICAiQlkgVFJBTlNGRVItIiwgIkJZIFRSQU5TRkVSLyIsICJCWSBDQVNIIiwgIjo6MDAwMzIiLCAiOjowMDAwMSIsDQogICAgICAgICAgICAgICAgICAiVFJBTlNGRVIgRlJPTSIsICJDSCBTQklOIiwgIkZEUkwvIiwgIklDSUMvIg0KICAgICAgICAgICAgICBdOw0KICAgICAgICAgICAgICBub2lzZS5mb3JFYWNoKHAgPT4geyBjbGVhbiA9IGNsZWFuLnNwbGl0KHApLmpvaW4oIiIpOyB9KTsNCg0KICAgICAgICAgICAgICAvLyAyLiBSZW1vdmUgYWxsIG51bWJlcnMgKHJlbW92ZXMgVVBJIElEcywgSUZTQyBjb2RlcywgYW5kIGRhdGVzKQ0KICAgICAgICAgICAgICBjbGVhbiA9IGNsZWFuLnJlcGxhY2UoL1swLTldL2csICIiKTsNCg0KICAgICAgICAgICAgICAvLyAzLiBSZW1vdmUgbm9uLWFscGhhIGNoYXJhY3RlcnMgKHNsYXNoZXMsIGNvbG9ucywgZG90cykNCiAgICAgICAgICAgICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9bXkEtWl0vZywgIiIpOw0KDQogICAgICAgICAgICAgIHJldHVybiBjbGVhbi50cmltKCk7DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICBmdW5jdGlvbiBkb3dubG9hZEFub255TWF0Y2goKSB7DQogICAgICAgICAgICAgIGNvbnN0IHRhYmxlQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXRjaFRhYmxlQm9keScpOw0KICAgICAgICAgICAgICBpZiAoIXRhYmxlQm9keSB8fCB0YWJsZUJvZHkucm93cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJObyByZXN1bHRzIHRvIGRvd25sb2FkLiIpOw0KICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgbGV0IHRleHRDb250ZW50ID0gIkFOT05ZTU9VUyBNQVRDSCBSRVNVTFRTXG4iOw0KICAgICAgICAgICAgICB0ZXh0Q29udGVudCArPSAiR2VuZXJhdGVkIG9uOiAiICsgbmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpICsgIlxuIjsNCiAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gIj0iLnJlcGVhdCg4MCkgKyAiXG5cbiI7DQoNCiAgICAgICAgICAgICAgY29uc3Qgcm93cyA9IHRhYmxlQm9keS5xdWVyeVNlbGVjdG9yQWxsKCd0cicpOw0KDQogICAgICAgICAgICAgIHJvd3MuZm9yRWFjaChyb3cgPT4gew0KICAgICAgICAgICAgICAgICAgLy8gU2tpcCB0aGUgZ3JheSBzcGFjZXIgcm93cw0KICAgICAgICAgICAgICAgICAgaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ3NwYWNlci1yb3cnKSB8fCByb3cuc3R5bGUuaGVpZ2h0ID09PSAiMTVweCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCArPSAiLSIucmVwZWF0KDgwKSArICJcblxuIjsgLy8gRGl2aWRlciBhZnRlciBldmVyeSBzZXQNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbHMgPSByb3cucXVlcnlTZWxlY3RvckFsbCgndGQnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCA8IDQpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVjZWlwdCA9IGNvbHNbMF0uaW5uZXJUZXh0LnJlcGxhY2UoL1xuL2csICIgfCAiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFtb3VudCA9IGNvbHNbMV0uaW5uZXJUZXh0Ow0KICAgICAgICAgICAgICAgICAgY29uc3QgZG9ub3IgPSBjb2xzWzJdLmlubmVyVGV4dC5yZXBsYWNlKC9cbi9nLCAiICIpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVmID0gY29sc1szXS5pbm5lclRleHQ7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdhbm9ueS1tYWluLXJvdycpKSB7DQogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gYFtUQVJHRVRdIFJlY2VpcHQ6ICR7cmVjZWlwdH0gfCBBbXQ6ICR7YW1vdW50fVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCArPSBgICAgICAgICAgUmVmOiAke3JlZn1cbmA7DQogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gIk1hdGNoZXMgRm91bmQ6XG4iOw0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCArPSBgICAgPj4gTWF0Y2g6ICR7cmVjZWlwdH0gfCBBbXQ6ICR7YW1vdW50fVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCArPSBgICAgICAgRG9ub3I6ICR7ZG9ub3J9XG5gOw0KICAgICAgICAgICAgICAgICAgICAgIHRleHRDb250ZW50ICs9IGAgICAgICBSZWY6ICAgJHtyZWZ9XG5cbmA7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIC8vIENyZWF0ZSB0aGUgZG93bmxvYWQgbGluaw0KICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3RleHRDb250ZW50XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7DQogICAgICAgICAgICAgIGNvbnN0IHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7DQogICAgICAgICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7DQogICAgICAgICAgICAgIGEuaHJlZiA9IHVybDsNCiAgICAgICAgICAgICAgYS5kb3dubG9hZCA9ICdBbm9ueU1hdGNoLnR4dCc7DQogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7DQogICAgICAgICAgICAgIGEuY2xpY2soKTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChhKTsNCiAgICAgICAgICAgICAgVVJMLnJldm9rZU9iamVjdFVSTCh1cmwpOw0KICAgICAgICAgIH0NCg0KDQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuQW5vbnlNYXRjaCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSB7DQogICAgICAgICAgICAgICAgICBsb2FkaW5nRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICAgICAgbG9hZGluZ0Rpdi5pbm5lckhUTUwgPSAiSW5pdGlhbGl6aW5nIE1hdGNoIGZvciBTZWxlY3RlZCBZZWFyLi4uIjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC8vIEdldCB0aGUgc2VsZWN0ZWQgeWVhciBmcm9tIHlvdXIgZGFzaGJvYXJkIHJhZGlvIGJ1dHRvbnMNCiAgICAgICAgICAgICAgY29uc3Qgc1llYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KDQogICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxMDApKTsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHNEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJyk7DQoNCiAgICAgICAgICAgICAgICAgIHJlc3VsdHNEaXYuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgcGFkZGluZzoxMHB4OyI+QW5vbnltb3VzIElkZW50aXR5IE1hdGNoIChGWSAke3NZZWFyfSk8L2gzPg0KICAgICAgICAgICAgICAgICAgPHRhYmxlIGlkPSJtYXRjaFRhYmxlIiBib3JkZXI9IjEiIHN0eWxlPSJ3aWR0aDoxMDAlOyBib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBzdHlsZT0iYmFja2dyb3VuZDojZjJmMmYyOyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9IndpZHRoOjIwJSI+UmVjZWlwdCAvIERhdGU8L3RoPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDowJSI+PC90aD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0id2lkdGg6MzAlIj5Eb25vciBEZXRhaWxzPC90aD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0id2lkdGg6NTAlIj5PcmlnaW5hbCBSZWZlcmVuY2U8L3RoPg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgIDwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgPHRib2R5IGlkPSJtYXRjaFRhYmxlQm9keSI+PC90Ym9keT4NCiAgICAgICAgICAgICAgICAgIDwvdGFibGU+YDsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgdGFibGVCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hdGNoVGFibGVCb2R5Jyk7DQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFsbFJlY29yZHMgPSB0ZXh0LnNwbGl0KCdcbicpLmZpbHRlcihyID0+IHIubGVuZ3RoID4gMjApOw0KDQogICAgICAgICAgICAgICAgICAvLyAxLiBJZGVudGlmeSBUYXJnZXQgQW5vbnltb3VzIFJlY29yZHMgT05MWSBmb3IgdGhlIHNlbGVjdGVkIEZpbmFuY2lhbCBZZWFyDQogICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRzID0gYWxsUmVjb3Jkcy5maWx0ZXIociA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3Qgck5vID0gKGZbMF0gfHwgIiIpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgckRhdGUgPSBwYXJzZURhdGUoZlsxXSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQW5vbiA9ICghZlsyXSB8fCBmWzJdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImFub255bW91cyIpKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0dXID0gck5vLnN0YXJ0c1dpdGgoIkdXIik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBBcHBseSBGaW5hbmNpYWwgWWVhciBMb2dpYyAoTWF0Y2hpbmcgeW91ciBydW5Bbm9ueW1vdXMgbG9naWMpDQogICAgICAgICAgICAgICAgICAgICAgbGV0IGluWWVhciA9IChzWWVhciA9PT0gImFsbCIpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5ZZWFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ5UyA9IHBhcnNlSW50KHNZZWFyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IHJEYXRlLmdldE1vbnRoKCkgKyAxLCB5ID0gckRhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5ZZWFyID0gKHkgPT09IGZ5UyAmJiBtID49IDQpIHx8ICh5ID09PSBmeVMgKyAxICYmIG0gPD0gMyk7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluWWVhciAmJiBpc0Fub24gJiYgIWlzQ2FuY2VsbGVkICYmICFpc0dXOw0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGlmICh0YXJnZXRzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdHNEaXYuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9J3BhZGRpbmc6MjBweDsgdGV4dC1hbGlnbjpjZW50ZXI7Jz5ObyBhbm9ueW1vdXMgcmVjb3JkcyBmb3VuZCBmb3IgRlkgJHtzWWVhcn0uPC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0RpdikgbG9hZGluZ0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hMZW5ndGggPSAxNTsNCiAgICAgICAgICAgICAgICAgIGxldCBjbHVzdGVyc0ZvdW5kID0gMDsNCg0KICAgICAgICAgICAgICAgICAgLy8gMi4gTG9vcCB0aHJvdWdoIHRoZSBZZWFyLVNwZWNpZmljIFRhcmdldHMNCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSBsb2FkaW5nRGl2LmlubmVySFRNTCA9IGBTY2FubmluZyBSZWNvcmQgJHtpICsgMX0gb2YgJHt0YXJnZXRzLmxlbmd0aH0uLi5gOw0KICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxKSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gdGFyZ2V0c1tpXS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1SZWZDbGVhbiA9IHNhbml0aXplUmVmKG1bMTBdKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtSUQgPSBtWzBdOw0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKG1SZWZDbGVhbi5sZW5ndGggPCBtYXRjaExlbmd0aCkgY29udGludWU7DQoNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2hlc0h0bWwgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF0Y2hDb3VudCA9IDA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyAzLiBTZWFyY2ggR0xPQkFMIGRhdGFiYXNlIGZvciBtYXRjaGVzIChObyB5ZWFyIHJlc3RyaWN0aW9uIGhlcmUpDQogICAgICAgICAgICAgICAgICAgICAgYWxsUmVjb3Jkcy5mb3JFYWNoKGRiUm93ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZCA9IGRiUm93LnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRObyA9IChkWzBdIHx8ICIiKS50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkWzBdID09PSBtSUQgfHwgZE5vLnN0YXJ0c1dpdGgoIkdXIikpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmRpZGF0ZUFub24gPSAoIWRbMl0gfHwgZFsyXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmRpZGF0ZUFub24pIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGRbMTNdPy50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYXNoID0gKGRbMTFdIHx8ICIiKS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDQVNIIikgfHwgKGRbOF0gfHwgIiIpLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNBU0giKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2FuY2VsbGVkIHx8IGlzQ2FzaCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRSZWZDbGVhbiA9IHNhbml0aXplUmVmKGRbMTBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRSZWZDbGVhbi5sZW5ndGggPCBtYXRjaExlbmd0aCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZE92ZXJsYXAgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRSZWZDbGVhbi5pbmNsdWRlcyhtUmVmQ2xlYW4pIHx8IG1SZWZDbGVhbi5pbmNsdWRlcyhkUmVmQ2xlYW4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZE92ZXJsYXAgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPD0gbVJlZkNsZWFuLmxlbmd0aCAtIG1hdGNoTGVuZ3RoOyB4KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZFJlZkNsZWFuLmluY2x1ZGVzKG1SZWZDbGVhbi5zdWJzdHJpbmcoeCwgeCArIG1hdGNoTGVuZ3RoKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRPdmVybGFwID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kT3ZlcmxhcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hDb3VudCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGlzdEFtdCA9IHBhcnNlRmxvYXQoZFs5XSB8fCAwKS50b0xvY2FsZVN0cmluZygnZW4tSU4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXNIdG1sICs9IGANCg0KPHRyIGNsYXNzPSJtYXRjaC1yZXN1bHQtcm93Ij4NCiAgICAgICAgICAgICAgPHRkPiR7ZFswXX08YnI+JHtkWzFdfTxicj574oK5JHtwYXJzZUZsb2F0KGRbOV0gfHwgMCkudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD4NCiAgICAgICAgICAgICAgPHRkPjwvdGQ+DQogICAgICAgICAgICAgIDx0ZD48Yj4ke2RbMl19PC9iPjxicj48c21hbGw+JHtkWzRdfTxicj5QSU46ICR7ZFsxNV19IHwgJHtkWzE5XX08YnI+VGVsOiAke2RbM119PC9zbWFsbD48L3RkPg0KICAgICAgICAgICAgICA8dGQgc3R5bGU9IndvcmQtYnJlYWs6YnJlYWstYWxsOyBmb250LXNpemU6MC43NXJlbTsiPg0KICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iY29sb3I6cHVycGxlOyBmb250LXdlaWdodDpib2xkOyBib3JkZXItYm90dG9tOjFweCBzb2xpZCAjZGRkOyBtYXJnaW4tYm90dG9tOjRweDsiPlQ6ICR7bVsxMF19PC9kaXY+DQogICAgICAgICAgICAgICAgICA8ZGl2Pk06ICR7ZFsxMF19PC9kaXY+DQogICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgPC90cj5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2hDb3VudCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY2x1c3RlcnNGb3VuZCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRBbXQgPSBwYXJzZUZsb2F0KG1bOV0gfHwgMCkudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlciA9IGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPSJhbm9ueS1tYWluLXJvdyIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNFMUJFRTcgIWltcG9ydGFudDsgZm9udC13ZWlnaHQ6IGJvbGQ7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke21bMF19PGJyPiR7bVsxXX08YnI+e+KCuSR7dGFyZ2V0QW10fX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPjwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9ImNvbG9yOnB1cnBsZTsgdGV4dC1hbGlnbjpjZW50ZXI7Ij48Yj5bIEFOT05ZTU9VUyBUQVJHRVQgXTwvYj48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3b3JkLWJyZWFrOmJyZWFrLWFsbDsgZm9udC1zaXplOjAuNzVyZW07Ij4ke21bMTBdfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVCb2R5Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgaGVhZGVyICsgbWF0Y2hlc0h0bWwgKyBgPHRyIHN0eWxlPSJoZWlnaHQ6MTVweDsgYmFja2dyb3VuZDojZjBmMGYwOyI+PHRkIGNvbHNwYW49IjQiPjwvdGQ+PC90cj5gKTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIC8vIDQuIFN1bW1hcnkgQmFyIHdpdGggRG93bmxvYWQgQnV0dG9uDQogICAgICAgICAgICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKTsNCiAgICAgICAgICAgICAgICAgIGIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgd2lkdGg6IDEwMCU7IHBhZGRpbmc6IDVweDsiPg0KICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPkZZICR7c1llYXJ9OiBGb3VuZCAke2NsdXN0ZXJzRm91bmR9IGRvbm9ycyBmb3IgJHt0YXJnZXRzLmxlbmd0aH0gYW5vbnltb3VzIHJlY29yZHMuPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZG93bmxvYWRBbm9ueU1hdGNoKCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9ImJhY2tncm91bmQ6ICMyOGE3NDUgIWltcG9ydGFudDsgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7IHdpZHRoOiBhdXRvOyBwYWRkaW5nOiA1cHggMTVweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICBEb3dubG9hZCBMaXN0ICgudHh0KQ0KICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgIGxvYWRpbmdEaXYuaW5uZXJIVE1MID0gIlBsZWFzZSB3YWl0IC0gV29ya2luZyBvbiB5b3VyIHJlcXVlc3QiOw0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJMb2dpYyBlcnJvcjogIiArIGVyci5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSBsb2FkaW5nRGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCg0KICAgICAgICAgIGZ1bmN0aW9uIHJlbmRlck1hdGNoUm93KGQpIHsNCiAgICAgICAgICAgICAgY29uc3QgYW10ID0gKHBhcnNlRmxvYXQoZFs5XSkgfHwgMCkudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyk7DQogICAgICAgICAgICAgIHJldHVybiBgDQogICAgICAgICAgICAgIDx0ciBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsiPg0KICAgICAgICAgICAgICAgICAgPHRkPiR7ZFswXX08YnI+JHtkWzFdfTwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQ+4oK5JHthbXR9PC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZD48Yj4ke2RbMl19PC9iPjxicj48c21hbGw+JHtkWzRdfTxicj5QSU46ICR7ZFsxNV19IHwgJHtkWzE5XX08YnI+VGVsOiAke2RbM119PC9zbWFsbD48L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3b3JkLWJyZWFrOmJyZWFrLWFsbDsgZm9udC1zaXplOjAuNzVyZW07Ij4ke2RbMTBdfTwvdGQ+DQogICAgICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgLy8gSGVscGVyIHRvIHJlbmRlciB0aGUgZG9ub3Igcm93DQogICAgICAgICAgZnVuY3Rpb24gcmVuZGVyTWF0Y2hSb3coZCkgew0KICAgICAgICAgICAgICByZXR1cm4gYA0KICAgICAgICAgICAgICA8dHIgY2xhc3M9Im1hdGNoLXJlc3VsdC1yb3ciPg0KICAgICAgICAgICAgICAgICAgPHRkPiR7ZFswXX08YnI+JHtkWzFdfTwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQ+JHtkWzVdfTwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQ+PGI+JHtkWzJdfTwvYj48YnI+PHNtYWxsPiR7ZFs0XX08YnI+UElOOiAke2RbMTVdfSB8ICR7ZFsxNF19PGJyPlRlbDogJHtkWzNdfTwvc21hbGw+PC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0id29yZC1icmVhazpicmVhay1hbGw7IGZvbnQtc2l6ZTowLjc1cmVtOyI+JHtkWzEwXX08L3RkPg0KICAgICAgICAgICAgICA8L3RyPmA7DQogICAgICAgICAgfQ0KDQoNCg0KDQogICAgICAgICAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGtlZXAgY29kZSBjbGVhbg0KICAgICAgICAgIGZ1bmN0aW9uIHJlbmRlck1hdGNoUm93KGQpIHsNCiAgICAgICAgICAgICAgY29uc3QgZG9ub3JEZXRhaWxzID0gYDxiPiR7ZFsyXX08L2I+PGJyPiR7ZFs0XX08YnI+UElOOiAke2RbMTVdfSB8ICR7ZFsxNF19PGJyPlRlbDogJHtkWzNdfWA7DQogICAgICAgICAgICAgIHJldHVybiBgPHRyIGNsYXNzPSJtYXRjaC1yZXN1bHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtkWzBdfTxicj4ke2RbMV19PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHtkWzVdfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgPHRkPiR7ZG9ub3JEZXRhaWxzfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgPHRkPiR7ZFsxMF19PC90ZD4NCiAgICAgICAgICAgICAgICAgICA8L3RyPmA7DQogICAgICAgICAgfQ0KDQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVVzZXJTdGF0dXMoKSB7DQogICAgICAgICAgICAgIGNvbnN0IG1vbml0b3JEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlck1vbml0b3InKTsNCiAgICAgICAgICAgICAgY29uc3QgdXNlckZpbGVVcmwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9nNzIzaXE4cGprcmptZDZlM3V2NnAvVXNlcnMudHh0P3Jsa2V5PTQzZHRrZDc2a3BkMDl3a2I4cmp3cncxb2Mmc3Q9YjJndW1kMWEmZGw9MSZub2NhY2hlPSIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKTsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1c2VyRmlsZVVybCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpOw0KDQogICAgICAgICAgICAgICAgICAvLyBQYXJzZSB1c2VyIG5hbWVzIGZyb20gdGhlIHBpcGUtZGVsaW1pdGVkIGZpbGUNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRVc2VycyA9IHRleHQuc3BsaXQoL1xyP1xuLykNCiAgICAgICAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4gbGluZS50cmltKCkpDQogICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihsaW5lID0+IGxpbmUuaW5jbHVkZXMoJ3wnKSkNCiAgICAgICAgICAgICAgICAgICAgICAubWFwKGxpbmUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGxpbmUuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcnRzWzFdID8gcGFydHNbMV0udHJpbSgpIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHUgPT4gdS5sZW5ndGggPiAwKTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRVc2Vycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICBtb25pdG9yRGl2LmNsYXNzTmFtZSA9ICJzdGF0dXMtZW1wdHkiOw0KICAgICAgICAgICAgICAgICAgICAgIG1vbml0b3JEaXYuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9ImNvbG9yOiM3NTc1NzU7Ij5ObyBvbmUgdXNpbmcgdGhlIE1haW4gU29mdHdhcmUgTm93PC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgbW9uaXRvckRpdi5jbGFzc05hbWUgPSAic3RhdHVzLWFjdGl2ZSI7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGlzcGxheUxpc3QgPSBjdXJyZW50VXNlcnMuam9pbigiIHwgIik7DQogICAgICAgICAgICAgICAgICAgICAgLy8gTGluZSAxOiBNYWluIFNvZnR3YXJlIFVzZXJzDQogICAgICAgICAgICAgICAgICAgICAgbW9uaXRvckRpdi5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0icGFkZGluZy1ib3R0b206MnB4OyI+PHNwYW4gY2xhc3M9ImxpdmUtZG90Ij48L3NwYW4+IDxzcGFuIHN0eWxlPSJjb2xvcjojZmZkNjAwOyI+TWFpbiBTb2Z0d2FyZSBVc2VyOjwvc3Bhbj4gWyAke2Rpc3BsYXlMaXN0fSBdPC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy8gTGluZSAyOiBBcHAgdXNlcnMgKENhbGN1bGF0ZWQgZnJvbSB5b3VyIGdsb2JhbCB2YXJpYWJsZSkNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFwcFVzZXJMYWJlbCA9ICh0eXBlb2YgZ2xvYmFsQXBwVXNlcklkZW50aXR5ICE9PSAndW5kZWZpbmVkJyAmJiBnbG9iYWxBcHBVc2VySWRlbnRpdHkpID8gZ2xvYmFsQXBwVXNlcklkZW50aXR5IDogIkFjdGl2ZSI7DQogICAgICAgICAgICAgICAgICBtb25pdG9yRGl2LmlubmVySFRNTCArPSBgPGRpdj48c3BhbiBjbGFzcz0ibGl2ZS1kb3QiPjwvc3Bhbj5BcHAgdXNlcnMgOiA8c3BhbiBpZD0iYWN0aXZlVXNlckxpc3QiPiR7YXBwVXNlckxhYmVsfTwvc3Bhbj48L2Rpdj5gOw0KDQogICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgcHJldmlvdXNVc2VyTGlzdCBmb3IgdGhlIGxvZ2luIG5vdGlmaWNhdGlvbiBsb2dpYyBlbHNld2hlcmUgaW4geW91ciBzY3JpcHQNCiAgICAgICAgICAgICAgICAgIHByZXZpb3VzVXNlckxpc3QgPSBjdXJyZW50VXNlcnM7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJNb25pdG9yIFN5bmMgRXJyb3I6IiwgZXJyKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCg0KDQogICAgICAgICAgLy8gQ2FsbCB0aGUgZnVuY3Rpb24gb24gbG9hZA0KICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgdXBkYXRlVXNlclN0YXR1cyk7DQogICAgICAgICAgLy8gT3B0aW9uYWw6IFJlZnJlc2ggZXZlcnkgNjAgc2Vjb25kcw0KICAgICAgICAgIHNldEludGVydmFsKHVwZGF0ZVVzZXJTdGF0dXMsIDYwMDAwKTsNCg0KDQogICAgICAgICAgLy8gTkVXOiBHbG9iYWwgdmFyaWFibGUgZm9yIHRoZSBJZGVudGl0eSBOYW1lDQogICAgICAgICAgbGV0IGFwcFVzZXJJZGVudGl0eSA9ICJVc2VyIjsNCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIE5FVyBGVU5DVElPTjogUmVhZHMgQXBwcm92ZWQyLnR4dCwgbWF0Y2hlcyB0aGUgSUQsDQogICAgICAgICAgICogYW5kIGV4dHJhY3RzIHRoZSBuYW1lIHBhcnQgYWZ0ZXIgdGhlICJ8IiBzZXBhcmF0b3IuDQogICAgICAgICAgICovDQoNCg0KDQoNCg0KDQogICAgICAgICAgLy8gLS0tIENPTkZJR1VSQVRJT04gLS0tDQogICAgICAgICAgY29uc3QgQklOX0lEID0gIjY5NjM1ZDhmZDBlYTg4MWY0MDYzYTcyZSI7DQogICAgICAgICAgY29uc3QgTUFTVEVSX0tFWSA9ICIkMmEkMTAkY0JzVUNiM1NycEdNSWZKMjZiMjguLmNxVHdSVDVqRkFzWEpzd2pOL1cvQ0Eza1FYdXVOMXUiOw0KICAgICAgICAgIHZhciBnbG9iYWxBcHBVc2VySWRlbnRpdHkgPSAiIjsNCg0KICAgICAgICAgIC8vIC0tLSAxLiBUSEUgQ0xPVUQgU1lOQyBMT0dJQyAoSGFuZGxlcyBTZWxmLUNsZWFuaW5nKSAtLS0NCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBzeW5jV2l0aEpzb25CaW4oKSB7DQogICAgICAgICAgICAgIGlmICghZ2xvYmFsQXBwVXNlcklkZW50aXR5KSByZXR1cm47DQoNCiAgICAgICAgICAgICAgY29uc3QgQklOX0lEID0gIjY5NjM1ZDhmZDBlYTg4MWY0MDYzYTcyZSI7DQogICAgICAgICAgICAgIGNvbnN0IE1BU1RFUl9LRVkgPSAiJDJhJDEwJGNCc1VDYjNTcnBHTUlmSjI2YjI4Li5jcVR3UlQ1akZBc1hKc3dqTi9XL0NBM2tRWHV1TjF1IjsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgLy8gV2UgYWRkID9ub2NhY2hlPS4uLiB0byBmb3JjZSB0aGUgYnJvd3NlciB0byBnZXQgdGhlIHJlYWwgZGF0YSBmcm9tIHRoZSBiaW4NCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLmpzb25iaW4uaW8vdjMvYi8ke0JJTl9JRH0vbGF0ZXN0P25vY2FjaGU9JHtEYXRlLm5vdygpfWAsIHsNCiAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICJYLU1hc3Rlci1LZXkiOiBNQVNURVJfS0VZIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsNCiAgICAgICAgICAgICAgICAgIGxldCByYXdOYW1lcyA9IGRhdGEucmVjb3JkLnVzZXJzIHx8ICIiOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGlyeUxpbWl0ID0gMTIwOyAvLyAyIG1pbnV0ZXMNCg0KICAgICAgICAgICAgICAgICAgbGV0IGFsbEVudHJpZXMgPSByYXdOYW1lcyA/IHJhd05hbWVzLnNwbGl0KCcsJykgOiBbXTsNCiAgICAgICAgICAgICAgICAgIGxldCB2YWxpZEVudHJpZXMgPSBbXTsNCiAgICAgICAgICAgICAgICAgIGxldCBkaXNwbGF5TmFtZXMgPSBbXTsNCg0KICAgICAgICAgICAgICAgICAgYWxsRW50cmllcy5mb3JFYWNoKGVudHJ5ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbbmFtZSwgdGltZXN0YW1wXSA9IGVudHJ5LnNwbGl0KCc6Jyk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZW50cnlUaW1lID0gcGFyc2VJbnQodGltZXN0YW1wKTsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHVzZXIgaXMgYWN0aXZlIHdpdGhpbiAyIG1pbnMsIGtlZXAgdGhlbQ0KICAgICAgICAgICAgICAgICAgICAgIGlmIChuYW1lID09PSBnbG9iYWxBcHBVc2VySWRlbnRpdHkgfHwgKG5vdyAtIGVudHJ5VGltZSkgPCBleHBpcnlMaW1pdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRpc3BsYXlOYW1lcy5pbmNsdWRlcyhuYW1lKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluYWxUaW1lID0gKG5hbWUgPT09IGdsb2JhbEFwcFVzZXJJZGVudGl0eSkgPyBub3cgOiBlbnRyeVRpbWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZEVudHJpZXMucHVzaChgJHtuYW1lfToke2ZpbmFsVGltZX1gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lcy5wdXNoKG5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGlmICghZGlzcGxheU5hbWVzLmluY2x1ZGVzKGdsb2JhbEFwcFVzZXJJZGVudGl0eSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICB2YWxpZEVudHJpZXMucHVzaChgJHtnbG9iYWxBcHBVc2VySWRlbnRpdHl9OiR7bm93fWApOw0KICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lcy5wdXNoKGdsb2JhbEFwcFVzZXJJZGVudGl0eSk7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWRTdHJpbmcgPSB2YWxpZEVudHJpZXMuam9pbignLCcpOw0KDQogICAgICAgICAgICAgICAgICAvLyBXcml0ZSBiYWNrIHRoZSBjbGVhbmVkIGxpc3QNCiAgICAgICAgICAgICAgICAgIGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5qc29uYmluLmlvL3YzL2IvJHtCSU5fSUR9YCwgew0KICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsDQogICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgICAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiWC1NYXN0ZXItS2V5IjogTUFTVEVSX0tFWQ0KICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VyczogdXBkYXRlZFN0cmluZyB9KQ0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBVSSBiYXINCiAgICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RTcGFuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FjdGl2ZVVzZXJMaXN0Jyk7DQogICAgICAgICAgICAgICAgICBsaXN0U3Bhbi5pbm5lclRleHQgPSBkaXNwbGF5TmFtZXMuam9pbignIHwgJyk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG1vbml0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXNlck1vbml0b3InKTsNCiAgICAgICAgICAgICAgICAgIG1vbml0b3IuY2xhc3NOYW1lID0gJ3N0YXR1cy1hY3RpdmUnOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3F1aXRCdG4nKS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlN5bmMgRXJyb3I6IiwgZSk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQoNCiAgICAgICAgICAvLyAtLS0gMi4gSURFTlRJVFkgQ0hFQ0sgLS0tDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlcklkZW50aXR5KG15SUQpIHsNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpLzB6MHdpczAyY2ExbXJjbnV0cXVjMC9BcHByb3ZlZDIudHh0P3Jsa2V5PXNrbDN1eng1MGo4bjAydWltc21hdjJ0aHQmZGw9MSIpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSAoYXdhaXQgcmVzLnRleHQoKSkuc3BsaXQoL1xyP1xuLyk7DQoNCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGxpbmUgb2YgbGluZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZS5pbmNsdWRlcyhteUlEKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxBcHBVc2VySWRlbnRpdHkgPSBsaW5lLnNwbGl0KCd8JylbMV0udHJpbSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBVSSB0byBhY3RpdmUgYW5kIHNob3cgcXVpdCBidXR0b24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJNb25pdG9yJykuY2xhc3NOYW1lID0gInN0YXR1cy1hY3RpdmUiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVpdEJ0bicpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbml0aWFsIHN5bmMgYW5kIHN0YXJ0IGxvb3ANCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zeW5jV2l0aEpzb25CaW4oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0SW50ZXJ2YWwoc3luY1dpdGhKc29uQmluLCA0NTAwMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7IGNvbnNvbGUuZXJyb3IoIklkZW50aXR5IGxvb2t1cCBmYWlsZWQuIik7IH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvLyAtLS0gMy4gVEhFIENPTlRST0xMRUQgUVVJVCAoRm9yZWdyb3VuZCBEZWxldGlvbikgLS0tDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcHJvcGVyUXVpdCgpIHsNCiAgICAgICAgICAgICAgaWYgKCFnbG9iYWxBcHBVc2VySWRlbnRpdHkpIHJldHVybjsNCg0KICAgICAgICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVpdEJ0bicpOw0KICAgICAgICAgICAgICBidG4uaW5uZXJUZXh0ID0gIkNsb3NpbmcuLi4iOw0KICAgICAgICAgICAgICBidG4uZGlzYWJsZWQgPSB0cnVlOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAvLyBXZSBzZW5kIGEgIlFVSVRfUkVRIiBiZWFjb24gZmlyc3QgYXMgYSBiYWNrdXAsIHRoZW4gdHJ5IGEgZnVsbCB3aXBlDQogICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbnVwRGF0YSA9IEpTT04uc3RyaW5naWZ5KHsgdXNlcnM6ICJRVUlUX1JFUSIgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NsZWFudXBEYXRhXSwgeyB0eXBlOiAnYXBwbGljYXRpb24vanNvbicgfSk7DQogICAgICAgICAgICAgICAgICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbihgaHR0cHM6Ly9hcGkuanNvbmJpbi5pby92My9iLyR7QklOX0lEfWAsIGJsb2IpOw0KDQogICAgICAgICAgICAgICAgICAvLyBFeHBsaWNpdGx5IGNsZWFyIHRoZSBpZGVudGl0eSBsb2NhbGx5IHNvIHRoZSBzYWZldHkgcHJvbXB0IGRvZXNuJ3QgdHJpZ2dlcg0KICAgICAgICAgICAgICAgICAgZ2xvYmFsQXBwVXNlcklkZW50aXR5ID0gIiI7DQogICAgICAgICAgICAgICAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBudWxsOw0KDQogICAgICAgICAgICAgICAgICBhbGVydCgiU2Vzc2lvbiBFbmRlZC4gSXQgaXMgbm93IHNhZmUgdG8gY2xvc2UgdGhpcyB0YWIuIik7DQogICAgICAgICAgICAgICAgICB3aW5kb3cuY2xvc2UoKTsNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkV4aXQgZXJyb3IuIFlvdSBjYW4gY2xvc2UgdGhlIHRhYiBtYW51YWxseS4iKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIC0tLSA0LiBTQUZFVFkgUFJPTVBUIC0tLQ0KICAgICAgICAgIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgaWYgKGdsb2JhbEFwcFVzZXJJZGVudGl0eSkgew0KICAgICAgICAgICAgICAgICAgcmV0dXJuICJQbGVhc2UgdXNlIHRoZSBSRUQgUVVJVCBCVVRUT04gdG8gbG9nIG91dCBjb3JyZWN0bHkuIjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH07DQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiByZWZyZXNoR2xvYmFsTGlzdCgpIHsNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIC8vIFJlYWQgdGhlIHNoYXJlZCBNQVNURVIga2V5DQogICAgICAgICAgICAgICAgICBjb25zdCBnZXRVUkwgPSBgaHR0cHM6Ly9rZXl2YWx1ZS5pbW1hbnVhbC53b3JrZXJzLmRldi9nZXQvTUFTVEVSX1VTRVJfTElTVD9ub2NhY2hlPWAgKyBEYXRlLm5vdygpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChnZXRVUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmF3RGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKHJhd0RhdGEgJiYgIXJhd0RhdGEuaW5jbHVkZXMoIktleSBub3QgZm91bmQiKSAmJiByYXdEYXRhLnRyaW0oKSAhPT0gIiIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IHNlcnZlciBjb21tYXMgdG8geW91ciBwcmVmZXJyZWQgcGlwZSBzZXBhcmF0b3INCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbkxpc3QgPSByYXdEYXRhLnNwbGl0KCcsJykuam9pbignIHwgJyk7DQogICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FjdGl2ZVVzZXJMaXN0JykuaW5uZXJUZXh0ID0gY2xlYW5MaXN0Ow0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiUmVhZCBmYWlsZWQgKENPUlMgb3IgTmV0d29yaykiKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICBpZiAoZ2xvYmFsQXBwVXNlcklkZW50aXR5KSB7DQogICAgICAgICAgICAgICAgICB2YXIgdW5pcXVlU2hhcmVkS2V5ID0gIkdMT0JBTF9TSEFSRURfTElTVF9WMSI7DQogICAgICAgICAgICAgICAgICBjb25zdCBsb2dvdXRVUkwgPSBgaHR0cHM6Ly9rZXl2YWx1ZS5pbW1hbnVhbC53b3JrZXJzLmRldi9yZW1vdmVfZnJvbV9zdHJpbmcvJHt1bmlxdWVTaGFyZWRLZXl9LyR7ZW5jb2RlVVJJQ29tcG9uZW50KGdsb2JhbEFwcFVzZXJJZGVudGl0eSl9YDsNCiAgICAgICAgICAgICAgICAgIG5hdmlnYXRvci5zZW5kQmVhY29uKGxvZ291dFVSTCk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuRGV0YWlsZWRNYXRjaFJlcG9ydCgpIHsNCiAgICAgICAgICAgICAgLy8gMS4gVEhFIEJSSURHRTogQ29udmVydCByYWRpbyB2YWx1ZSAoZS5nLiwgMjAyNSkgdG8geW91ciBlbmdpbmUncyBmb3JtYXQgKGUuZy4sIDI1LTI2KQ0KICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgIGlmICghcmFkaW8gfHwgcmFkaW8udmFsdWUgPT09ICJhbGwiKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIHNwZWNpZmljIEZpbmFuY2lhbCBZZWFyIGZpcnN0LiIpOw0KICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRWYWwgPSByYWRpby52YWx1ZS50b1N0cmluZygpOw0KICAgICAgICAgICAgICBjb25zdCB5cjJEaWdpdCA9IHNlbGVjdGVkVmFsLnNsaWNlKC0yKTsNCiAgICAgICAgICAgICAgY29uc3QgbmV4dFlyMkRpZ2l0ID0gKHBhcnNlSW50KHlyMkRpZ2l0KSArIDEpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgIGNvbnN0IHRhcmdldEZZID0gYCR7eXIyRGlnaXR9LSR7bmV4dFlyMkRpZ2l0fWA7DQogICAgICAgICAgICAgIGNvbnN0IGZ1bGxGWVN0cmluZyA9IGAke3NlbGVjdGVkVmFsfS0ke3BhcnNlSW50KHNlbGVjdGVkVmFsKSArIDF9YDsNCg0KICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKTsNCiAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IFtiYW5rUmVzLCBkYXRhUmVzLCBleHBSZXMsIHJldlJlcywgY2FzaFJlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goQkFOS19ORVdfVVJMKS50aGVuKHJlcyA9PiByZXMudGV4dCgpKSwNCiAgICAgICAgICAgICAgICAgICAgICBmZXRjaChEQVRBX1VSTCkudGhlbihyZXMgPT4gcmVzLnRleHQoKSksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goRVhQRU5TRVNfVVJMKS50aGVuKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goUkVWRVJTQUxTX1VSTCkudGhlbihyZXMgPT4gcmVzLnRleHQoKSksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goQ0FTSF9MSVNUX1VSTCkudGhlbihyZXMgPT4gcmVzLnRleHQoKSkNCiAgICAgICAgICAgICAgICAgIF0pOw0KDQogICAgICAgICAgICAgICAgICAvLyAtLS0gRVZFUllUSElORyBCRUxPVyBJUyBGUk9NIFlPVVIgdjE5LjAgQkFTRSAtLS0NCiAgICAgICAgICAgICAgICAgIGNvbnN0IGJhbmtMaW5lcyA9IGJhbmtSZXMuc3BsaXQoJ1xuJykuZmlsdGVyKGwgPT4gbC50cmltKCkuc3BsaXQoJ3wnKS5sZW5ndGggPj0gNSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGRhdGFSZXMuc3BsaXQoJ1xuJykubWFwKHIgPT4gci5zcGxpdCgnfCcpKS5maWx0ZXIoZiA9PiBmLmxlbmd0aCA+PSAxNSAmJiBmWzEzXT8udG9VcHBlckNhc2UoKSAhPT0gIllFUyIpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmV2ZXJzYWxzID0gcmV2UmVzLnNwbGl0KCdcbicpLm1hcChsaW5lID0+IGxpbmUuc3BsaXQoJ3wnKSkuZmlsdGVyKGYgPT4gZi5sZW5ndGggPj0gNyk7DQogICAgICAgICAgICAgICAgICBjb25zdCBjYXNoTGluZXMgPSBjYXNoUmVzLnNwbGl0KCdcbicpLmZpbHRlcihsID0+IGwuaW5jbHVkZXMoJ3wnKSk7DQogICAgICAgICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChuZXcgVWludDhBcnJheShleHBSZXMpLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBleHBSb3dzID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzBdXSwgeyBoZWFkZXI6IDEgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNyZWRpdEV4ZW1wdEtleXdvcmRzID0gWyJDUkVESVQgSU5URVJFU1QiLCAiQ0xPU1VSRSBPRiBGRCIsICJQQVJUIFdJVEhEUkFXTCIsICJGRCAiLCAiRkQ6IiwgIkJZIElOVCBUUkFOU0ZFUiIsICJIQU5ETElOR1JFViIsICJVUElNSSBDUiBBREoiLCAiTE9BTiIsICJSRVRVUk4iLCAiUkVWRVJTQUwiXTsNCg0KICAgICAgICAgICAgICAgICAgbGV0IHJlcG9ydCA9IGBNTVBUIFRSQU5TQUNUSU9OQUwgTUFUQ0ggUkVQT1JUICR7ZnVsbEZZU3RyaW5nfVxuYDsNCiAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSAiPSIucmVwZWF0KDIxNSkgKyAiXG4iOw0KICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGAkeyJEQVRFIi5wYWRFbmQoMTIpfSB8ICR7IlJFQ0VJUFQiLnBhZEVuZCgxMil9IHwgJHsiQU1PVU5UIi5wYWRTdGFydCgxNCl9IHwgJHsiVFlQRSIucGFkRW5kKDEyKX0gfCAkeyJERVRBSUxTIi5wYWRFbmQoODApfSB8IEJBTksgUkVGRVJFTkNFXG5gOw0KICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9ICItIi5yZXBlYXQoMjE1KSArICJcbiI7DQoNCiAgICAgICAgICAgICAgICAgIGJhbmtMaW5lcy5mb3JFYWNoKGxpbmUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGIgPSBsaW5lLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYkRhdGVSYXcgPSBiWzBdLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiUmVmUmF3ID0gKGJbMV0gfHwgIiIpLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiQW10ID0gcGFyc2VGbG9hdChiWzRdIHx8IGJbM10gfHwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDcmVkaXQgPSBiWzRdICE9PSAiIiAmJiBiWzRdICE9PSAiMCI7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0RlkoYkRhdGVSYXcpICE9PSB0YXJnZXRGWSkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYkRhdGVTdGQgPSBiRGF0ZVJhdy5yZXBsYWNlKC9bXC9cLl0vZywgJy0nKTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgcHJvY2Vzc2VkID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDcmVkaXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gLS0tIFVOVE9VQ0hFRCB2MTkuMCBDUkVESVQgTE9HSUMgLS0tDQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldk1hdGNoID0gcmV2ZXJzYWxzLmZpbmQociA9PiByWzBdLnRyaW0oKS5yZXBsYWNlKC9bXC9cLl0vZywgJy0nKSA9PT0gYkRhdGVTdGQgJiYgclsxXS50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gYlJlZlJhdy50b1VwcGVyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNFeGVtcHQgPSBjcmVkaXRFeGVtcHRLZXl3b3Jkcy5zb21lKGsgPT4gYlJlZlJhdy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKGspKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV2TWF0Y2ggfHwgaXNFeGVtcHQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGR0bCA9IHJldk1hdGNoID8gYFJFVkVSU0FMOiAke3Jldk1hdGNoWzZdfWAgOiBgQkFOSyBFWEVNUFQ6ICR7YlJlZlJhd31gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGAke2JEYXRlUmF3LnBhZEVuZCgxMil9IHwgJHsiIi5wYWRFbmQoMTIpfSB8ICR7YkFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiB9KS5wYWRTdGFydCgxNCl9IHwgJHsiQyBFeGVtcHQiLnBhZEVuZCgxMil9IHwgJHtkdGwucGFkRW5kKDgwKX0gfCAke2JSZWZSYXd9XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoZWREb25vcnMgPSBkYi5maWx0ZXIoZCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRSZWYgPSAoZFsxMF0gfHwgIiIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpLnNwbGl0KCcoJylbMF0uc3BsaXQoJ1snKVswXS50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRbMV0udHJpbSgpLnJlcGxhY2UoL1tcL1wuXS9nLCAnLScpID09PSBiRGF0ZVN0ZCAmJiBkUmVmICE9PSAiIiAmJiBiUmVmUmF3LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoZFJlZik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoZWREb25vcnMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWREb25vcnMuZm9yRWFjaCgobSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlU3RyID0gbWF0Y2hlZERvbm9ycy5sZW5ndGggPiAxID8gIk0gRG9ub3JzIiA6ICJEb25vciI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJjcHRObyA9IG1bMF0udHJpbSgpLnN1YnN0cmluZygwLCAxMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1EZXRhaWxzID0gYCR7bVsyXX0sICR7bVsxOV19LCAke21bMTVdfSwgJHttWzEyXX0sICR7bVsxMV19YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbUFtdCA9IHBhcnNlRmxvYXQobVs5XSkudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZlRvU2hvdyA9IG1hdGNoZWREb25vcnMubGVuZ3RoID09PSAxID8gYlJlZlJhdyA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnQgKz0gYCR7YkRhdGVSYXcucGFkRW5kKDEyKX0gfCAke3JjcHROby5wYWRFbmQoMTIpfSB8ICR7bUFtdC5wYWRTdGFydCgxNCl9IHwgJHt0eXBlU3RyLnBhZEVuZCgxMil9IHwgJHttRGV0YWlscy5zdWJzdHJpbmcoMCwgNzkpLnBhZEVuZCg4MCl9IHwgJHtyZWZUb1Nob3d9XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkRG9ub3JzLmxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGAkeyIiLnBhZEVuZCgxMil9IHwgJHsiIi5wYWRFbmQoMTIpfSB8ICR7Ii0tLS0tLS0tLS0tLSIucGFkU3RhcnQoMTQpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAkeygiKEJhbmsgVG90YWwgTWF0Y2g6IOKCuSIgKyBiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpICsgIikiKS5wYWRFbmQoODApfSB8ICR7YlJlZlJhd31cbmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXByb2Nlc3NlZCAmJiBiUmVmUmF3LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNBU0giKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hNYXRjaCA9IGNhc2hMaW5lcy5maW5kKGNsID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZCA9IGNsLnNwbGl0KCd8JylbMF0udHJpbSgpLnNwbGl0KC9ccysvKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGhlYWRbMF0gPT09IGJEYXRlUmF3ICYmIE1hdGguYWJzKHBhcnNlRmxvYXQoaGVhZFtoZWFkLmxlbmd0aCAtIDFdKSAtIGJBbXQpIDwgMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FzaE1hdGNoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHAgPSBjYXNoTWF0Y2guc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJlZml4ID0gcFsxXS50cmltKCkgPT09ICdNJyA/ICJNUFMiIDogIkNHIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcklkcyA9IHBbMl0uc3BsaXQoJywnKS5tYXAoaWQgPT4gcHJlZml4ICsgaWQudHJpbSgpLnBhZFN0YXJ0KHBbMV0udHJpbSgpID09PSAnTScgPyA3IDogNiwgJzAnKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJJZHMuZm9yRWFjaChpZCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gZGIuZmluZChkID0+IGRbMF0udHJpbSgpID09PSBpZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHtiRGF0ZVJhdy5wYWRFbmQoMTIpfSB8ICR7aWQuc3Vic3RyaW5nKDAsIDEyKS5wYWRFbmQoMTIpfSB8ICR7cGFyc2VGbG9hdChtWzldKS50b0xvY2FsZVN0cmluZygnZW4tSU4nLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiB9KS5wYWRTdGFydCgxNCl9IHwgJHsiTSBEb25vciIucGFkRW5kKDEyKX0gfCAkeyhgJHttWzJdfSwgJHttWzE5XX1gKS5zdWJzdHJpbmcoMCwgNzkpLnBhZEVuZCg4MCl9IHwgXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGAkeyIiLnBhZEVuZCgxMil9IHwgJHsiIi5wYWRFbmQoMTIpfSB8ICR7Ii0tLS0tLS0tLS0tLSIucGFkU3RhcnQoMTQpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAkeygiKENhc2ggRGVwb3NpdCBUb3RhbDog4oK5IiArIGJBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJykgKyAiKSIpLnBhZEVuZCg4MCl9IHwgJHtiUmVmUmF3fVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAtLS0gREVCSVQgTE9HSUMgLS0tDQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cE1hdGNoID0gZXhwUm93cy5maW5kKChyLCBpKSA9PiBpID4gMCAmJiByWzNdICYmIE1hdGguYWJzKHBhcnNlRmxvYXQoclszXSkgLSBiQW10KSA8IDAuMDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwTWF0Y2gpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4Y2VsRGV0YWlsID0gKGV4cE1hdGNoWzRdIHx8ICIiKS50b1N0cmluZygpLnRvVXBwZXJDYXNlKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFEREVEIExPR0lDOiBDaGVjayBmb3IgYm90aCAiRVhFTVBUIiAob3JpZ2luYWwpIGFuZCAiRlJFU0ggREVQT1NJVCIgKG5ldykNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0eXBlID0gIkV4cGVuc2UiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4Y2VsRGV0YWlsLmluY2x1ZGVzKCJFWEVNUFQiKSB8fCBleGNlbERldGFpbC5pbmNsdWRlcygiRlJFU0ggREVQT1NJVCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9ICJEIEV4ZW1wdCI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHtiRGF0ZVJhdy5wYWRFbmQoMTIpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAke2JBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSkucGFkU3RhcnQoMTQpfSB8ICR7dHlwZS5wYWRFbmQoMTIpfSB8ICR7KGV4cE1hdGNoWzRdIHx8IGJSZWZSYXcpLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDc5KS5wYWRFbmQoODApfSB8ICR7YlJlZlJhd31cbmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9jZXNzZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGAke2JEYXRlUmF3LnBhZEVuZCgxMil9IHwgJHsiIi5wYWRFbmQoMTIpfSB8ICR7YkFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nLCB7IG1pbmltdW1GcmFjdGlvbkRpZ2l0czogMiB9KS5wYWRTdGFydCgxNCl9IHwgJHsiUGVuZGluZyIucGFkRW5kKDEyKX0gfCAkeyIiLnBhZEVuZCg4MCl9IHwgJHtiUmVmUmF3fVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtyZXBvcnRdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7DQogICAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgICAgICAgICAgICAgICAgbGluay5kb3dubG9hZCA9IGBNTVBUIFRSQU5TQUNUSU9OQUwgTUFUQ0ggUkVQT1JUICR7ZnVsbEZZU3RyaW5nfS50eHRgOw0KICAgICAgICAgICAgICAgICAgbGluay5jbGljaygpOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCg0KDQoNCiAgICAgICAgICAvLyBFbnN1cmUgdGhlc2UgYXJlIGF0IHRoZSB0b3Agb2YgeW91ciBzY3JpcHQgd2l0aCBvdGhlciBVUkxzDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZU1hdGNoUmVwb3J0RnJvbU1lbnUoKSB7DQogICAgICAgICAgICAgIGNvbnN0IHllYXJSYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSB5ZWFyUmFkaW8gPyB5ZWFyUmFkaW8udmFsdWUgOiAiYWxsIjsNCg0KICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRGWSA9PT0gImFsbCIpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IGEgc3BlY2lmaWMgRmluYW5jaWFsIFllYXIgKGUuZy4sIDIzLTI0KSBmcm9tIHRoZSB0b3AgZmlsdGVycyBmaXJzdC4iKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC8vIFdyYXAgaW4geW91ciBwcm9qZWN0J3Mgc3RhbmRhcmQgbG9hZGluZyBzcGlubmVyDQogICAgICAgICAgICAgIHdyYXBMb2FkaW5nKGFzeW5jICgpID0+IHsNCiAgICAgICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcnVuRGV0YWlsZWRNYXRjaFJlcG9ydChzZWxlY3RlZEZZKTsNCiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOw0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJSZXBvcnQgRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkRG9uYXRpb25MaXN0RGlyZWN0KCkgew0KICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKTsNCiAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJhZGlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKTsNCiAgICAgICAgICAgICAgICAgIGlmICghcmFkaW8gfHwgcmFkaW8udmFsdWUgPT09ICJhbGwiKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzZWxlY3QgYSBzcGVjaWZpYyBGaW5hbmNpYWwgWWVhciBmaXJzdC4iKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkWWVhciA9IHJhZGlvLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0RlkgPSBgJHtzZWxlY3RlZFllYXIuc2xpY2UoLTIpfS0keyhwYXJzZUludChzZWxlY3RlZFllYXIuc2xpY2UoLTIpKSArIDEpfWA7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgcm93cyA9IHRleHQuc3BsaXQoJ1xuJykubWFwKHIgPT4gci5zcGxpdCgnfCcpKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgdGl0bGVzID0gWyJSZWNlaXB0IE5vLiIsICJEYXRlIiwgIk5hbWUiLCAiUGhvbmUiLCAiQWRkcmVzcyIsICJFbWFpbCIsICJQQU4iLCAiU3RhciIsICJHb3RocmFtIiwgIkFtb3VudCIsICJSZWZlcmVuY2UiLCAiTW9kZSIsICJUb3dhcmRzIiwgIkNhbmNlbCIsICJDb21tZW50cyIsICJQaW4gQ29kZSIsICJSZWNlaXB0IFByaW50ZWQiLCAiUHJhc2FkYW0gU2VudCIsICJDb3JwdXMgU2lnbmVkIiwgIkNvdW50cnkiXTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRhID0gW3RpdGxlc107DQoNCiAgICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaChmID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxNSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FuY2VsbGVkID0gZlsxM10gJiYgZlsxM10udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxlZCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgckRhdGUgPSBmWzFdPy50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEZZKHJEYXRlKSA9PT0gdGFyZ2V0RlkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZWxEYXRhLnB1c2goZi5zbGljZSgwLCAyMCkpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAoZXhjZWxEYXRhLmxlbmd0aCA8PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIk5vIGFjdGl2ZSByZWNvcmRzIGZvdW5kLiIpOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KGV4Y2VsRGF0YSk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBORVcgQVVUTy1XSURUSCBMT0dJQyBTVEFSVCAtLS0NCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbFdpZHRocyA9IHRpdGxlcy5tYXAoKHRpdGxlLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIGxvbmdlc3Qgc3RyaW5nIGluIHRoaXMgc3BlY2lmaWMgY29sdW1uDQogICAgICAgICAgICAgICAgICAgICAgbGV0IG1heExlbmd0aCA9IHRpdGxlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICBleGNlbERhdGEuZm9yRWFjaChyb3cgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsVmFsdWUgPSByb3dbaW5kZXhdID8gcm93W2luZGV4XS50b1N0cmluZygpIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZWxsVmFsdWUubGVuZ3RoID4gbWF4TGVuZ3RoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhMZW5ndGggPSBjZWxsVmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgLy8gUmV0dXJuIHdpZHRoIG9iamVjdCAocGFkZGluZyB3aXRoICsyIGZvciBjb21mb3J0KQ0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHdjaDogbWF4TGVuZ3RoICsgMiB9Ow0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB3c1snIWNvbHMnXSA9IGNvbFdpZHRoczsNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBORVcgQVVUTy1XSURUSCBMT0dJQyBFTkQgLS0tDQoNCiAgICAgICAgICAgICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAiRG9uYXRpb25zIik7DQogICAgICAgICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgYE1NUFRfRG9uYXRpb25fTGlzdF9GWV8ke3RhcmdldEZZfS54bHN4YCk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkVycm9yOiAiICsgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkQW5vbnltb3VzTGlzdERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoIXJhZGlvIHx8IHJhZGlvLnZhbHVlID09PSAiYWxsIikgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IGEgc3BlY2lmaWMgRmluYW5jaWFsIFllYXIgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFllYXIgPSByYWRpby52YWx1ZTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEZZID0gYCR7c2VsZWN0ZWRZZWFyLnNsaWNlKC0yKX0tJHsocGFyc2VJbnQoc2VsZWN0ZWRZZWFyLnNsaWNlKC0yKSkgKyAxKX1gOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChyID0+IHIuc3BsaXQoJ3wnKSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlcyA9IFsiUmVjZWlwdCBOby4iLCAiRGF0ZSIsICJOYW1lIiwgIlBob25lIiwgIkFkZHJlc3MiLCAiRW1haWwiLCAiUEFOIiwgIlN0YXIiLCAiR290aHJhbSIsICJBbW91bnQiLCAiUmVmZXJlbmNlIiwgIk1vZGUiLCAiVG93YXJkcyIsICJDYW5jZWwiLCAiQ29tbWVudHMiLCAiUGluIENvZGUiLCAiUmVjZWlwdCBQcmludGVkIiwgIlByYXNhZGFtIFNlbnQiLCAiQ29ycHVzIFNpZ25lZCIsICJDb3VudHJ5Il07DQogICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERhdGEgPSBbdGl0bGVzXTsNCg0KICAgICAgICAgICAgICAgICAgcm93cy5mb3JFYWNoKGYgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDE1KSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZSA9IGZbMV0/LnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdICYmIGZbMTNdLnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIFByb2JlZCBMb2dpYyBmcm9tIHYxOS4xOg0KICAgICAgICAgICAgICAgICAgICAgIC8vIEFub255bWl0eSBpcyBkZWZpbmVkIGFzOiBOYW1lIGlzIG1pc3NpbmcvZW1wdHkgT1IgbmFtZSBjb250YWlucyAnYW5vbnltb3VzJw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbm9yTmFtZSA9IChmWzJdIHx8ICIiKS50cmltKCkudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0Fub255bW91cyA9IChkb25vck5hbWUgPT09ICIiIHx8IGRvbm9yTmFtZS5pbmNsdWRlcygiYW5vbnltb3VzIikpOw0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEZZKHJEYXRlKSA9PT0gdGFyZ2V0RlkgJiYgIWlzQ2FuY2VsbGVkICYmIGlzQW5vbnltb3VzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5wdXNoKGYuc2xpY2UoMCwgMjApKTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGV4Y2VsRGF0YS5sZW5ndGggPD0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGBObyByZWNvcmRzIG1hdGNoaW5nIEFub255bW91cyBjcml0ZXJpYSBmb3VuZCBmb3IgRlkgJHt0YXJnZXRGWX0uYCk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAvLyBFeHBvcnQgd2l0aCBBdXRvLVdpZHRoDQogICAgICAgICAgICAgICAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoZXhjZWxEYXRhKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbFdpZHRocyA9IHRpdGxlcy5tYXAoKHRpdGxlLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXhMZW5ndGggPSB0aXRsZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgZXhjZWxEYXRhLmZvckVhY2gocm93ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbFZhbHVlID0gcm93W2luZGV4XSA/IHJvd1tpbmRleF0udG9TdHJpbmcoKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbFZhbHVlLmxlbmd0aCA+IG1heExlbmd0aCkgbWF4TGVuZ3RoID0gY2VsbFZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB3Y2g6IG1heExlbmd0aCArIDIgfTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgd3NbJyFjb2xzJ10gPSBjb2xXaWR0aHM7DQoNCiAgICAgICAgICAgICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAiQW5vbnltb3VzIExpc3QiKTsNCiAgICAgICAgICAgICAgICAgIFhMU1gud3JpdGVGaWxlKHdiLCBgTU1QVF9Bbm9ueW1vdXNfTGlzdF9GWV8ke3RhcmdldEZZfS54bHN4YCk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkVycm9yOiAiICsgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZG93bmxvYWRQZW5kaW5nQ29uc2VudERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoIXJhZGlvIHx8IHJhZGlvLnZhbHVlID09PSAiYWxsIikgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IGEgc3BlY2lmaWMgRmluYW5jaWFsIFllYXIgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFllYXIgPSByYWRpby52YWx1ZTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEZZID0gYCR7c2VsZWN0ZWRZZWFyLnNsaWNlKC0yKX0tJHsocGFyc2VJbnQoc2VsZWN0ZWRZZWFyLnNsaWNlKC0yKSkgKyAxKX1gOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChyID0+IHIuc3BsaXQoJ3wnKSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlcyA9IFsiUmVjZWlwdCBOby4iLCAiRGF0ZSIsICJOYW1lIiwgIlBob25lIiwgIkFkZHJlc3MiLCAiRW1haWwiLCAiUEFOIiwgIlN0YXIiLCAiR290aHJhbSIsICJBbW91bnQiLCAiUmVmZXJlbmNlIiwgIk1vZGUiLCAiVG93YXJkcyIsICJDYW5jZWwiLCAiQ29tbWVudHMiLCAiUGluIENvZGUiLCAiUmVjZWlwdCBQcmludGVkIiwgIlByYXNhZGFtIFNlbnQiLCAiQ29ycHVzIFNpZ25lZCIsICJDb3VudHJ5Il07DQogICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERhdGEgPSBbdGl0bGVzXTsNCg0KICAgICAgICAgICAgICAgICAgcm93cy5mb3JFYWNoKGYgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDE5KSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZSA9IGZbMV0/LnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdICYmIGZbMTNdLnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIExvZ2ljOiBUb3dhcmRzIG11c3QgYmUgQ09SUFVTIChJbmRleCAxMikNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b3dhcmRzID0gKGZbMTJdIHx8ICIiKS50cmltKCkudG9VcHBlckNhc2UoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIExvZ2ljOiBDb3JwdXMgU2lnbmVkIG11c3QgYmUgTk8gb3IgRW1wdHkgKEluZGV4IDE4KQ0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvcnB1c1NpZ25lZCA9IChmWzE4XSB8fCAiIikudHJpbSgpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNQZW5kaW5nID0gKGNvcnB1c1NpZ25lZCA9PT0gIk5PIiB8fCBjb3JwdXNTaWduZWQgPT09ICIiKTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRGWShyRGF0ZSkgPT09IHRhcmdldEZZICYmICFpc0NhbmNlbGxlZCAmJiB0b3dhcmRzID09PSAiQ09SUFVTIiAmJiBpc1BlbmRpbmcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZWxEYXRhLnB1c2goZi5zbGljZSgwLCAyMCkpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAoZXhjZWxEYXRhLmxlbmd0aCA8PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoYE5vIFBlbmRpbmcgQ29uc2VudCByZWNvcmRzIChUb3dhcmRzOiBDT1JQVVMsIFNpZ25lZDogTk8pIGZvdW5kIGZvciBGWSAke3RhcmdldEZZfS5gKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd3MgPSBYTFNYLnV0aWxzLmFvYV90b19zaGVldChleGNlbERhdGEpOw0KDQogICAgICAgICAgICAgICAgICAvLyBBdXRvLXdpZHRoIGxvZ2ljDQogICAgICAgICAgICAgICAgICBjb25zdCBjb2xXaWR0aHMgPSB0aXRsZXMubWFwKCh0aXRsZSwgaW5kZXgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4TGVuZ3RoID0gdGl0bGUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5mb3JFYWNoKHJvdyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxWYWx1ZSA9IHJvd1tpbmRleF0gPyByb3dbaW5kZXhdLnRvU3RyaW5nKCkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGxWYWx1ZS5sZW5ndGggPiBtYXhMZW5ndGgpIG1heExlbmd0aCA9IGNlbGxWYWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgd2NoOiBtYXhMZW5ndGggKyAyIH07DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIHdzWychY29scyddID0gY29sV2lkdGhzOw0KDQogICAgICAgICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgIlBlbmRpbmcgQ29uc2VudHMiKTsNCiAgICAgICAgICAgICAgICAgIFhMU1gud3JpdGVGaWxlKHdiLCBgTU1QVF9QZW5kaW5nX0NvbnNlbnRfRllfJHt0YXJnZXRGWX0ueGxzeGApOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBkb3dubG9hZFVuaXF1ZURvbm9yTGlzdERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBjb25zdCBpc0FsbFllYXJzID0gKCFyYWRpbyB8fCByYWRpby52YWx1ZSA9PT0gImFsbCIpOw0KDQogICAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0RlkgPSAiQWxsX1llYXJzIjsNCiAgICAgICAgICAgICAgICAgIGlmICghaXNBbGxZZWFycykgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkWWVhciA9IHJhZGlvLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEZZID0gYCR7c2VsZWN0ZWRZZWFyLnNsaWNlKC0yKX0tJHsocGFyc2VJbnQoc2VsZWN0ZWRZZWFyLnNsaWNlKC0yKSkgKyAxKX1gOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChyID0+IHIuc3BsaXQoJ3wnKSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbm9yTWFwID0gbmV3IE1hcCgpOw0KDQogICAgICAgICAgICAgICAgICByb3dzLmZvckVhY2goZiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMTUpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJEYXRlID0gZlsxXT8udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FuY2VsbGVkID0gZlsxM10gJiYgZlsxM10udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gU0tJUCBjYW5jZWxsZWQgYWx3YXlzDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2FuY2VsbGVkKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBZRUFSIEZJTFRFUjogT25seSBhcHBseSBpZiBhIHNwZWNpZmljIHllYXIgaXMgY2hvc2VuDQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0FsbFllYXJzICYmIGdldEZZKHJEYXRlKSAhPT0gdGFyZ2V0RlkpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgIGxldCBwaG9uZSA9IChmWzNdIHx8ICJOL0EiKS50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSAoZlsyXSB8fCAiQW5vbnltb3VzIikudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFtdCA9IHBhcnNlRmxvYXQoZls5XSkgfHwgMDsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIEFub255bW91cyBsb2dpYyAoOTk5OTkgLyA4ODg4OCkNCiAgICAgICAgICAgICAgICAgICAgICBpZiAocGhvbmUuc3RhcnRzV2l0aCgiOTk5OTkiKSB8fCBwaG9uZS5zdGFydHNXaXRoKCI4ODg4OCIpIHx8IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmUgPSAiQU5PTllNT1VTX0dST1VQIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9ICJBbm9ueW1vdXMgLyBHZW5lcmFsIERvbm9yIjsNCiAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoIWRvbm9yTWFwLmhhcyhwaG9uZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9ub3JNYXAuc2V0KHBob25lLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmU6IChwaG9uZSA9PT0gIkFOT05ZTU9VU19HUk9VUCIgPyAiTXVsdGlwbGUiIDogcGhvbmUpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzczogKHBob25lID09PSAiQU5PTllNT1VTX0dST1VQIiA/ICJOL0EiIDogKGZbNF0gfHwgIiIpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiAocGhvbmUgPT09ICJBTk9OWU1PVVNfR1JPVVAiID8gIk4vQSIgOiAoZls1XSB8fCAiIikpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGluY29kZTogKHBob25lID09PSAiQU5PTllNT1VTX0dST1VQIiA/ICIiIDogKGZbMTVdIHx8ICIiKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5OiAocGhvbmUgPT09ICJBTk9OWU1PVVNfR1JPVVAiID8gIiIgOiAoZlsxOV0gfHwgIiIpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQW1vdW50OiAwLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uYXRpb25Db3VudDogMA0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkb25vciA9IGRvbm9yTWFwLmdldChwaG9uZSk7DQogICAgICAgICAgICAgICAgICAgICAgZG9ub3IudG90YWxBbW91bnQgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgICAgIGRvbm9yLmRvbmF0aW9uQ291bnQgKz0gMTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAvLyBTb3J0IGJ5IFRvdGFsIEFtb3VudCAoRGVzY2VuZGluZykNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHNvcnRlZERvbm9ycyA9IEFycmF5LmZyb20oZG9ub3JNYXAudmFsdWVzKCkpLnNvcnQoKGEsIGIpID0+IGIudG90YWxBbW91bnQgLSBhLnRvdGFsQW1vdW50KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKHNvcnRlZERvbm9ycy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiTm8gcmVjb3JkcyBmb3VuZC4iKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlcyA9IFsiUmFuayIsICJOYW1lIiwgIlBob25lIE51bWJlciIsICJUb3RhbCBBbW91bnQgRG9uYXRlZCIsICJOby4gb2YgRG9uYXRpb25zIiwgIkFkZHJlc3MiLCAiUGluY29kZSIsICJFbWFpbCIsICJDb3VudHJ5Il07DQogICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERhdGEgPSBbdGl0bGVzXTsNCg0KICAgICAgICAgICAgICAgICAgc29ydGVkRG9ub3JzLmZvckVhY2goKGQsIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgZXhjZWxEYXRhLnB1c2goW2luZGV4ICsgMSwgZC5uYW1lLCBkLnBob25lLCBkLnRvdGFsQW1vdW50LCBkLmRvbmF0aW9uQ291bnQsIGQuYWRkcmVzcywgZC5waW5jb2RlLCBkLmVtYWlsLCBkLmNvdW50cnldKTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoZXhjZWxEYXRhKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gQXV0by13aWR0aA0KICAgICAgICAgICAgICAgICAgd3NbJyFjb2xzJ10gPSB0aXRsZXMubWFwKCh0aXRsZSwgaW5kZXgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4TGVuZ3RoID0gdGl0bGUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5mb3JFYWNoKHJvdyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxWYWx1ZSA9IHJvd1tpbmRleF0gPyByb3dbaW5kZXhdLnRvU3RyaW5nKCkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGxWYWx1ZS5sZW5ndGggPiBtYXhMZW5ndGgpIG1heExlbmd0aCA9IGNlbGxWYWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgd2NoOiBtYXhMZW5ndGggKyAyIH07DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MsICJVbmlxdWUgRG9ub3JzIik7DQogICAgICAgICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgYE1NUFRfVW5pcXVlX0Rvbm9yX0xpc3RfJHt0YXJnZXRGWX0ueGxzeGApOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBkb3dubG9hZFBlbmRpbmdDYXNoRGlyZWN0KCkgew0KICAgICAgICAgICAgICBjb25zdCBkYXRhID0gd2luZG93Lmdsb2JhbFBlbmRpbmdDYXB0dXJlOw0KDQogICAgICAgICAgICAgIGlmICghZGF0YSB8fCBkYXRhLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIk5vIGRhdGEgY2FwdHVyZWQuIFBsZWFzZSBsb2FkIHRoZSBQZW5kaW5nIENhc2ggZGFzaGJvYXJkIGZpcnN0LiIpOw0KICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHBlbmRpbmdSY3B0Tm9zID0gbmV3IFNldChkYXRhLm1hcChpdGVtID0+IGl0ZW0ucmNwdC50cmltKCkudG9VcHBlckNhc2UoKSkpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkYlJvd3MgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChyID0+IHIuc3BsaXQoJ3wnKSkuZmlsdGVyKGYgPT4gZi5sZW5ndGggPj0gMTUpOw0KDQogICAgICAgICAgICAgICAgICAvLyBZb3VyIDIwIERCIEhlYWRlcnMNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGxIZWFkZXJzID0gWw0KICAgICAgICAgICAgICAgICAgICAgICJSZWNlaXB0IE5vLiIsICJEYXRlIiwgIk5hbWUiLCAiQWRkcmVzcyIsICJQaG9uZSIsDQogICAgICAgICAgICAgICAgICAgICAgIkVtYWlsIiwgIlBBTi9JRCIsICJPY2Nhc2lvbiIsICJBbW91bnQgV29yZHMiLCAiQW1vdW50IiwNCiAgICAgICAgICAgICAgICAgICAgICAiUmVmZXJlbmNlIiwgIk1vZGUiLCAiVG93YXJkcyIsICJDYW5jZWxsZWQiLCAiVXNlciIsDQogICAgICAgICAgICAgICAgICAgICAgIlRpbWUiLCAiRjE3IiwgIkYxOCIsICJGMTkiLCAiRjIwIg0KICAgICAgICAgICAgICAgICAgXTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxSb3dzID0gW2Z1bGxIZWFkZXJzXTsNCg0KICAgICAgICAgICAgICAgICAgZGJSb3dzLmZvckVhY2goZiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFJjcHQgPSBmWzBdLnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nUmNwdE5vcy5oYXMoY3VycmVudFJjcHQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsUm93cy5wdXNoKGYpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgV29ya2Jvb2sgYW5kIFdvcmtzaGVldA0KICAgICAgICAgICAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KGV4Y2VsUm93cyk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBBVVRPIENPTFVNTiBXSURUSCBMT0dJQyAtLS0NCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbFdpZHRocyA9IGZ1bGxIZWFkZXJzLm1hcCgoaGVhZGVyLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIGxvbmdlc3Qgc3RyaW5nIGluIHRoaXMgc3BlY2lmaWMgY29sdW1uDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4Q29sdW1uTGVuZ3RoID0gZXhjZWxSb3dzLnJlZHVjZSgobWF4LCByb3cpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbFZhbHVlID0gcm93W2luZGV4XSA/IHJvd1tpbmRleF0udG9TdHJpbmcoKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgobWF4LCBjZWxsVmFsdWUubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICB9LCBoZWFkZXIubGVuZ3RoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIFJldHVybiB3aWR0aCB3aXRoIGEgbGl0dGxlIGV4dHJhIHBhZGRpbmcNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB3Y2g6IG1heENvbHVtbkxlbmd0aCArIDIgfTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICB3c1snIWNvbHMnXSA9IGNvbFdpZHRoczsNCiAgICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KICAgICAgICAgICAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MsICJQZW5kaW5nX0Nhc2hfRnVsbCIpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCB5ciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk/LnZhbHVlIHx8ICJSZXBvcnQiOw0KICAgICAgICAgICAgICAgICAgWExTWC53cml0ZUZpbGUod2IsIGBNTVBUX1BlbmRpbmdfQ2FzaF9GdWxsXyR7eXJ9Lnhsc3hgKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXhwb3J0IEVycm9yOiAiICsgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuQmFua1N0YXRlbWVudERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAvLyAxLiBHZXQgdGhlIHRhcmdldCB5ZWFyIGZyb20gdGhlIHJhZGlvIGJ1dHRvbnMNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJhZGlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKTsNCiAgICAgICAgICAgICAgICAgIGlmICghcmFkaW8pIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIFllYXIgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkWWVhciA9IHJhZGlvLnZhbHVlOyAvLyBlLmcuLCAiMjAyNSINCiAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRZZWFyU2hvcnQgPSAocGFyc2VJbnQoc2VsZWN0ZWRZZWFyLnNsaWNlKC0yKSkgKyAxKS50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0RlkgPSBgJHtzZWxlY3RlZFllYXIuc2xpY2UoLTIpfS0ke25leHRZZWFyU2hvcnR9YDsNCg0KICAgICAgICAgICAgICAgICAgLy8gMi4gRmV0Y2ggdGhlIGJhbmsgZmlsZQ0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChCQU5LX05FV19VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgnXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSAhPT0gIiIpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gWyJEYXRlIiwgIlJlZmVyZW5jZSIsICJDaHEgTm8uIiwgIkRlYml0IiwgIkNyZWRpdCIsICJCYWxhbmNlIl07DQogICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERhdGEgPSBbaGVhZGVyc107DQoNCiAgICAgICAgICAgICAgICAgIC8vIDMuIEZpbHRlciBhbmQgTWFwDQogICAgICAgICAgICAgICAgICBsaW5lcy5mb3JFYWNoKGxpbmUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbHMgPSBsaW5lLnNwbGl0KCd8JykubWFwKGMgPT4gYy50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2xzLmxlbmd0aCA+PSA2KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd0RhdGUgPSBjb2xzWzBdOyAvLyBGb3JtYXQ6IERELU1NLVlZWVkNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGluY2x1ZGUgaWYgZGF0ZSBiZWxvbmdzIHRvIHNlbGVjdGVkIEZZDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRGWShyb3dEYXRlKSA9PT0gdGFyZ2V0RlkpIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYW4gdXAgQW1vdW50czogSWYgZW1wdHkgb3IgMCwgbGVhdmUgYXMgZW1wdHkgc3RyaW5nICIiDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWJpdCA9IChjb2xzWzNdICYmIHBhcnNlRmxvYXQoY29sc1szXSkgIT09IDApID8gcGFyc2VGbG9hdChjb2xzWzNdKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3JlZGl0ID0gKGNvbHNbNF0gJiYgcGFyc2VGbG9hdChjb2xzWzRdKSAhPT0gMCkgPyBwYXJzZUZsb2F0KGNvbHNbNF0pIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiYWxhbmNlID0gKGNvbHNbNV0gIT09ICIiKSA/IHBhcnNlRmxvYXQoY29sc1s1XSkgOiAiIjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZWxEYXRhLnB1c2goWw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd0RhdGUsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sc1sxXSwgLy8gUmVmZXJlbmNlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sc1syXSwgLy8gQ2hxIE5vLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlYml0LCAgIC8vIEVtcHR5IGlmIG5vIHZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlZGl0LCAgLy8gRW1wdHkgaWYgbm8gdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWxhbmNlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAoZXhjZWxEYXRhLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGBObyBiYW5rIHJlY29yZHMgZm91bmQgZm9yIEZZICR7dGFyZ2V0Rll9YCk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAvLyA0LiBDcmVhdGUgRXhjZWwNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd3MgPSBYTFNYLnV0aWxzLmFvYV90b19zaGVldChleGNlbERhdGEpOw0KDQogICAgICAgICAgICAgICAgICAvLyA1LiBBdXRvLUZpdCBDb2x1bW4gV2lkdGhzDQogICAgICAgICAgICAgICAgICB3c1snIWNvbHMnXSA9IGhlYWRlcnMubWFwKChoZWFkZXIsIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4TGVuID0gZXhjZWxEYXRhLnJlZHVjZSgobWF4LCByb3cpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsID0gKHJvd1tpbmRleF0gIT09IHVuZGVmaW5lZCAmJiByb3dbaW5kZXhdICE9PSBudWxsKSA/IHJvd1tpbmRleF0udG9TdHJpbmcoKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgobWF4LCB2YWwubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICB9LCBoZWFkZXIubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB3Y2g6IG1heExlbiArIDIgfTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgIkJhbmsgU3RhdGVtZW50Iik7DQogICAgICAgICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgYE1NUFRfQmFua19TdGF0ZW1lbnRfJHt0YXJnZXRGWX0ueGxzeGApOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5FeHBlbnNlc0V4cG9ydCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAvLyAxLiBGaW5hbmNpYWwgWWVhciBGaWx0ZXINCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJhZGlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKTsNCiAgICAgICAgICAgICAgICAgIGlmICghcmFkaW8pIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIFllYXIgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFllYXIgPSByYWRpby52YWx1ZTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEZZID0gYCR7c2VsZWN0ZWRZZWFyLnNsaWNlKC0yKX0tJHsocGFyc2VJbnQoc2VsZWN0ZWRZZWFyLnNsaWNlKC0yKSkgKyAxKX1gOw0KDQogICAgICAgICAgICAgICAgICAvLyAyLiBGZXRjaCB0aGUgRXhwZW5zZSBFeGNlbCBGaWxlDQogICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKEVYUEVOU0VTX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IHJlc3BvbnNlLmFycmF5QnVmZmVyKCk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDMuIFJlYWQgdGhlIFdvcmtib29rDQogICAgICAgICAgICAgICAgICBjb25zdCB3b3JrYm9vayA9IFhMU1gucmVhZChhcnJheUJ1ZmZlciwgeyB0eXBlOiAnYXJyYXknLCBjZWxsRGF0ZXM6IHRydWUgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBmaXJzdFNoZWV0ID0gd29ya2Jvb2suU2hlZXRzW3dvcmtib29rLlNoZWV0TmFtZXNbMF1dOw0KDQogICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IHRvIEFycmF5IG9mIEFycmF5cyAoaGVhZGVyOiAxIGtlZXBzIGl0IGFzIHJvd3MpDQogICAgICAgICAgICAgICAgICBjb25zdCBhbGxSb3dzID0gWExTWC51dGlscy5zaGVldF90b19qc29uKGZpcnN0U2hlZXQsIHsgaGVhZGVyOiAxIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAoYWxsUm93cy5sZW5ndGggPCAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIkV4cGVuc2UgZmlsZSBpcyBlbXB0eS4iKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBhbGxSb3dzWzBdOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhwb3J0RGF0YSA9IFtoZWFkZXJzXTsNCg0KICAgICAgICAgICAgICAgICAgLy8gNC4gRmlsdGVyaW5nIExvb3ANCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgYWxsUm93cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IGFsbFJvd3NbaV07DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVWYWwgPSByb3dbMF07IC8vIEFzc3VtaW5nIERhdGUgaXMgY29sdW1uIDENCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRlVmFsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaGVja0RhdGUgPSAiIjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBIYW5kbGUgaWYgRXhjZWwgZ2l2ZXMgYSBEYXRlIE9iamVjdCBvciBhIFN0cmluZw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZVZhbCBpbnN0YW5jZW9mIERhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRkID0gU3RyaW5nKGRhdGVWYWwuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW0gPSBTdHJpbmcoZGF0ZVZhbC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHl5eXkgPSBkYXRlVmFsLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja0RhdGUgPSBgJHtkZH0tJHttbX0tJHt5eXl5fWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja0RhdGUgPSBkYXRlVmFsLnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYXRjaCBhZ2FpbnN0IHlvdXIgWWVhciBGaWx0ZXINCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEZZKGNoZWNrRGF0ZSkgPT09IHRhcmdldEZZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHBvcnREYXRhLnB1c2gocm93KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgaWYgKGV4cG9ydERhdGEubGVuZ3RoID09PSAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoYE5vIGV4cGVuc2VzIGZvdW5kIGZvciBGWSAke3RhcmdldEZZfWApOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy8gNS4gQ3JlYXRlIE91dHB1dCBGaWxlDQogICAgICAgICAgICAgICAgICBjb25zdCBuZXdXYiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1dzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoZXhwb3J0RGF0YSk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBBVVRPIENPTFVNTiBXSURUSCAtLS0NCiAgICAgICAgICAgICAgICAgIG5ld1dzWychY29scyddID0gaGVhZGVycy5tYXAoKGgsIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4TGVuID0gZXhwb3J0RGF0YS5yZWR1Y2UoKG1heCwgcm93KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IHJvd1tpbmRleF0gPyByb3dbaW5kZXhdLnRvU3RyaW5nKCkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgdmFsLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgfSwgaCA/IGgudG9TdHJpbmcoKS5sZW5ndGggOiAxMCk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgd2NoOiBtYXhMZW4gKyAyIH07DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldChuZXdXYiwgbmV3V3MsICJFeHBlbnNlcyIpOw0KICAgICAgICAgICAgICAgICAgWExTWC53cml0ZUZpbGUobmV3V2IsIGBNTVBUX0V4cGVuc2VzXyR7dGFyZ2V0Rll9Lnhsc3hgKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJFeHBlbnNlIEVycm9yOiIsIGUpOw0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkNvdWxkIG5vdCBwcm9jZXNzIEV4cGVuc2UgZmlsZTogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5Bbm9ueU1hdGNoRGlyZWN0KCkgew0KICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKTsNCiAgICAgICAgICAgICAgaWYgKGxvYWRpbmdEaXYpIHsNCiAgICAgICAgICAgICAgICAgIGxvYWRpbmdEaXYuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgICAgICBsb2FkaW5nRGl2LmlubmVySFRNTCA9ICJJbml0aWFsaXppbmcgRGVlcCBNYXRjaCBmb3IgU2VsZWN0ZWQgWWVhci4uLiI7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxMDApKTsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgLy8gLS0tIFVJIENMRUFSSU5HIENPTU1FTlRFRCBPVVQgLS0tDQogICAgICAgICAgICAgICAgICAvLyBjbGVhcldvcmtzcGFjZSgpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFsbFJlY29yZHMgPSB0ZXh0LnNwbGl0KCdcbicpLmZpbHRlcihyID0+IHIubGVuZ3RoID4gMjApOw0KDQogICAgICAgICAgICAgICAgICAvLyAxLiBFWEFDVCBZZWFyIExvZ2ljIGZyb20geW91ciBvcmlnaW5hbA0KICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0cyA9IGFsbFJlY29yZHMuZmlsdGVyKHIgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJObyA9IChmWzBdIHx8ICIiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJEYXRlID0gcGFyc2VEYXRlKGZbMV0pOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FuY2VsbGVkID0gZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0Fub24gPSAoIWZbMl0gfHwgZlsyXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNHVyA9IHJOby5zdGFydHNXaXRoKCJHVyIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgbGV0IGluWWVhciA9IChzWWVhciA9PT0gImFsbCIpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmICghaW5ZZWFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ5UyA9IHBhcnNlSW50KHNZZWFyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IHJEYXRlLmdldE1vbnRoKCkgKyAxLCB5ID0gckRhdGUuZ2V0RnVsbFllYXIoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaW5ZZWFyID0gKHkgPT09IGZ5UyAmJiBtID49IDQpIHx8ICh5ID09PSBmeVMgKyAxICYmIG0gPD0gMyk7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpblllYXIgJiYgaXNBbm9uICYmICFpc0NhbmNlbGxlZCAmJiAhaXNHVzsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydChgTm8gYW5vbnltb3VzIHJlY29yZHMgZm91bmQgZm9yIEZZICR7c1llYXJ9LmApOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSBsb2FkaW5nRGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaExlbmd0aCA9IDE1Ow0KICAgICAgICAgICAgICAgICAgbGV0IHJlcG9ydFRleHQgPSBgTU1QVCBBTk9OWU1PVVMgTUFUQ0hJTkcgUkVQT1JUIC0gRlkgJHtzWWVhcn1cbmA7DQogICAgICAgICAgICAgICAgICByZXBvcnRUZXh0ICs9IGA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuYDsNCg0KICAgICAgICAgICAgICAgICAgLy8gMi4gTG9vcCB0aHJvdWdoIFllYXItU3BlY2lmaWMgVGFyZ2V0cyAoRGVlcCBNYXRjaGluZykNCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSBsb2FkaW5nRGl2LmlubmVySFRNTCA9IGBTY2FubmluZyBSZWNvcmQgJHtpICsgMX0gb2YgJHt0YXJnZXRzLmxlbmd0aH0uLi5gOw0KICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAxKSk7IC8vIFByZXZlbnRzIGJyb3dzZXIgaGFuZw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IHRhcmdldHNbaV0uc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtUmVmQ2xlYW4gPSBzYW5pdGl6ZVJlZihtWzEwXSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbUlEID0gbVswXTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChtUmVmQ2xlYW4ubGVuZ3RoIDwgbWF0Y2hMZW5ndGgpIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldEhlYWRlckFkZGVkID0gZmFsc2U7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyAzLiBTZWFyY2ggR0xPQkFMIGRhdGFiYXNlIGZvciBtYXRjaGVzDQogICAgICAgICAgICAgICAgICAgICAgYWxsUmVjb3Jkcy5mb3JFYWNoKGRiUm93ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZCA9IGRiUm93LnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRObyA9IChkWzBdIHx8ICIiKS50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkWzBdID09PSBtSUQgfHwgZE5vLnN0YXJ0c1dpdGgoIkdXIikpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmRpZGF0ZUFub24gPSAoIWRbMl0gfHwgZFsyXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmRpZGF0ZUFub24pIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGRbMTNdPy50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYXNoID0gKGRbMTFdIHx8ICIiKS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDQVNIIikgfHwgKGRbOF0gfHwgIiIpLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNBU0giKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2FuY2VsbGVkIHx8IGlzQ2FzaCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRSZWZDbGVhbiA9IHNhbml0aXplUmVmKGRbMTBdKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRSZWZDbGVhbi5sZW5ndGggPCBtYXRjaExlbmd0aCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmb3VuZE92ZXJsYXAgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRSZWZDbGVhbi5pbmNsdWRlcyhtUmVmQ2xlYW4pIHx8IG1SZWZDbGVhbi5pbmNsdWRlcyhkUmVmQ2xlYW4pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZE92ZXJsYXAgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPD0gbVJlZkNsZWFuLmxlbmd0aCAtIG1hdGNoTGVuZ3RoOyB4KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZFJlZkNsZWFuLmluY2x1ZGVzKG1SZWZDbGVhbi5zdWJzdHJpbmcoeCwgeCArIG1hdGNoTGVuZ3RoKSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRPdmVybGFwID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kT3ZlcmxhcCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXRIZWFkZXJBZGRlZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydFRleHQgKz0gYFxuVEFSR0VUOiAke21bMF19IHwgJHttWzFdfSB8IEFtdDogJHttWzldfSB8IFJlZjogJHttWzEwXX1cbmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0VGV4dCArPSBgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldEhlYWRlckFkZGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydFRleHQgKz0gYCAgID4+IE1BVENIOiAke2RbMF19IHwgJHtkWzJdfSB8IFRlbDogJHtkWzNdfSB8IFJlZjogJHtkWzEwXX1cbmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy8gNC4gVHJpZ2dlciBBdXRvLURvd25sb2FkIChSZXBsYWNpbmcgdGhlIE1hbnVhbCBEb3dubG9hZCBCdXR0b24pDQogICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3JlcG9ydFRleHRdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7DQogICAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgICAgICAgICAgICAgICAgbGluay5kb3dubG9hZCA9IGBBbm9ueW1vdXNfTWF0Y2hfUmVwb3J0XyR7c1llYXJ9LnR4dGA7DQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGxpbmspOw0KICAgICAgICAgICAgICAgICAgbGluay5jbGljaygpOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChsaW5rKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJMb2dpYyBlcnJvcjogIiArIGVyci5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSBsb2FkaW5nRGl2LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQoNCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5Tb2Z0Y29waWVzRGlyZWN0KCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCBwTXNnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKTsNCiAgICAgICAgICAgICAgY29uc3Qgc1llYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICBjb25zdCBGWV9ESVNQTEFZID0gc1llYXIgPT09ICJhbGwiID8gIkFsbCBZZWFycyIgOiBgJHtzWWVhcn0tJHtwYXJzZUludChzWWVhcikgKyAxfWA7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcC50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByZWNvcmRzID0gdGV4dC5zcGxpdCgnXG4nKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgeyBqc1BERiB9ID0gd2luZG93LmpzcGRmOw0KICAgICAgICAgICAgICAgICAgbGV0IHZhbGlkUmVjb3JkcyA9IFtdOw0KDQogICAgICAgICAgICAgICAgICAvLyAxLiBGaWx0ZXIgdmFsaWQgcmVjb3JkcyBiYXNlZCBvbiBGWSBzZWxlY3Rpb24NCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVjb3Jkcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgIGxldCBmID0gcmVjb3Jkc1tpXS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDEzKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZVN0ciA9IGZbMV0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJEYXRlT2JqID0gcGFyc2VEYXRlKHJEYXRlU3RyKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtID0gckRhdGVPYmouZ2V0TW9udGgoKSArIDE7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgeSA9IHJEYXRlT2JqLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IHJlY29yZEZZID0gKG0gPCA0KSA/ICh5IC0gMSkudG9TdHJpbmcoKSA6IHkudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoc1llYXIgPT09ICJhbGwiIHx8IHNZZWFyID09PSByZWNvcmRGWSkgdmFsaWRSZWNvcmRzLnB1c2goZik7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRvdGFsVG9Qcm9jZXNzID0gdmFsaWRSZWNvcmRzLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgIGlmICh0b3RhbFRvUHJvY2VzcyA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJObyByZWNlaXB0cyBmb3VuZCBmb3IgdGhlIHNlbGVjdGVkIHBlcmlvZC4iKTsNCiAgICAgICAgICAgICAgICAgICAgICBoaWRlTG9hZGluZygpOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy8gMi4gQ0hVTksgTE9HSUMgKDEwMDAgUmVjZWlwdHMgcGVyIGZpbGUpDQogICAgICAgICAgICAgICAgICBjb25zdCBDSFVOS19TSVpFID0gMTAwMDsNCiAgICAgICAgICAgICAgICAgIGxldCBwYXJ0TnVtYmVyID0gMTsNCg0KICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbFRvUHJvY2VzczsgaSArPSBDSFVOS19TSVpFKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGRmID0gbmV3IGpzUERGKCdwJywgJ3B0JywgJ2E0Jyk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEJhdGNoID0gdmFsaWRSZWNvcmRzLnNsaWNlKGksIGkgKyBDSFVOS19TSVpFKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiYXRjaFBhZ2VDb3VudCA9IE1hdGguY2VpbChjdXJyZW50QmF0Y2gubGVuZ3RoIC8gMik7DQoNCiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGN1cnJlbnRCYXRjaC5sZW5ndGg7IGorKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZiA9IGN1cnJlbnRCYXRjaFtqXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGdsb2JhbENvdW50ID0gaSArIGogKyAxOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByb2dyZXNzIGRpc3BsYXk6ICJQYXJ0IDEgLSBQcm9jZXNzaW5nIDUwNSAoNTA1LzI1MDApIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBwTXNnLmlubmVyVGV4dCA9IGBQbGVhc2UgV2FpdCA6IFBhcnQgJHtwYXJ0TnVtYmVyfSAtIFByb2Nlc3NpbmcgJHtmWzBdfSAoJHtnbG9iYWxDb3VudH0vJHt0b3RhbFRvUHJvY2Vzc30pYDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWdEYXRhID0gYXdhaXQgcmVuZGVyT3JpZ2luYWxSZWNlaXB0VG9JbWFnZShmKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoYWxmUGFnZSA9IDQyMTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVjZWlwdEhlaWdodCA9IDMzNTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeU9mZnNldCA9IChoYWxmUGFnZSAtIHJlY2VpcHRIZWlnaHQpIC8gMjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAyIHJlY2VpcHRzIHBlciBwYWdlIGxvZ2ljDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqICUgMiA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGogPiAwKSBwZGYuYWRkUGFnZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQREYgSGVhZGVyDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYuc2V0Rm9udFNpemUoMTApOyBwZGYuc2V0Rm9udCgiaGVsdmV0aWNhIiwgImJvbGQiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi50ZXh0KGBSZWNlaXB0cyBHZW5lcmF0ZWQgaW4gdGhlIEZpbmFuY2lhbCBZZWFyIDogJHtGWV9ESVNQTEFZfSAoUGFydCAke3BhcnROdW1iZXJ9KWAsIDQwLCAzMCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFBERiBGb290ZXINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi5zZXRGb250U2l6ZSg5KTsgcGRmLnNldEZvbnQoImhlbHZldGljYSIsICJub3JtYWwiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQYWdlID0gTWF0aC5jZWlsKChqICsgMSkgLyAyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi50ZXh0KGBQYWdlICR7Y3VycmVudFBhZ2V9IG9mICR7YmF0Y2hQYWdlQ291bnR9YCwgNTAwLCA4MjApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNaWQtcGFnZSBjdXR0aW5nIGd1aWRlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYuc2V0RHJhd0NvbG9yKDIwMCk7IHBkZi5zZXRMaW5lRGFzaFBhdHRlcm4oWzUsIDVdLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi5saW5lKDAsIGhhbGZQYWdlLCA1OTUsIGhhbGZQYWdlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRmLmFkZEltYWdlKGltZ0RhdGEsICdKUEVHJywgNTAsIHlPZmZzZXQgKyAyMCwgNDk1LCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi5hZGRJbWFnZShpbWdEYXRhLCAnSlBFRycsIDUwLCBoYWxmUGFnZSArIHlPZmZzZXQsIDQ5NSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIHRoZSBmaWxlIGZvciB0aGlzIGJhdGNoDQogICAgICAgICAgICAgICAgICAgICAgcGRmLnNhdmUoYE1NUFQgUmVjZWlwdHMgJHtGWV9ESVNQTEFZfSBQYXJ0ICR7cGFydE51bWJlcn0ucGRmYCk7DQogICAgICAgICAgICAgICAgICAgICAgcGFydE51bWJlcisrOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpOw0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkNyaXRpY2FsIEVycm9yOiAiICsgZXJyLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7IGFsZXJ0KCJBbGwgcGFydHMgZG93bmxvYWRlZCBzdWNjZXNzZnVsbHkhIik7DQoNCiAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcmVuZGVyT3JpZ2luYWxSZWNlaXB0VG9JbWFnZShmKSB7DQogICAgICAgICAgICAgIGNvbnN0IGlzQ2FuY2VsbGVkID0gZlsxM10/LnRvTG93ZXJDYXNlKCkudHJpbSgpID09PSAneWVzJzsNCiAgICAgICAgICAgICAgY29uc3QgdGVtcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgICAgICAgICAgICB0ZW1wRGl2LnN0eWxlID0gIndpZHRoOiA0ODBwdDsgcGFkZGluZzogMTBweCAyMHB4OyBiYWNrZ3JvdW5kOiAjZmZmOyBib3JkZXI6IDJweCBzb2xpZCAjMDAwOyBmb250LWZhbWlseTogJ1RpbWVzIE5ldyBSb21hbicsIHNlcmlmOyBjb2xvcjogIzAwMDsgcG9zaXRpb246IGFic29sdXRlOyBsZWZ0OiAtOTk5OXB4OyI7DQoNCiAgICAgICAgICAgICAgLy8gU3RydWN0dXJlOiBBZGRyZXNzKDQpLCBDb3VudHJ5KDE5KSwgUGluIENvZGUoMTUpDQogICAgICAgICAgICAgIGNvbnN0IGFkZHIgPSBmWzRdID8gZls0XS50cmltKCkgOiAiIjsNCiAgICAgICAgICAgICAgY29uc3QgY291bnRyeSA9IGZbMTldID8gZlsxOV0udHJpbSgpIDogIiI7DQogICAgICAgICAgICAgIGNvbnN0IHBpbiA9IGZbMTVdID8gZlsxNV0udHJpbSgpIDogIiI7DQoNCiAgICAgICAgICAgICAgbGV0IGZ1bGxBZGRyZXNzID0gYWRkcjsNCiAgICAgICAgICAgICAgaWYgKGNvdW50cnkpIGZ1bGxBZGRyZXNzICs9ICIsICIgKyBjb3VudHJ5Ow0KICAgICAgICAgICAgICBpZiAocGluKSBmdWxsQWRkcmVzcyArPSAiLCAiICsgcGluOw0KDQogICAgICAgICAgICAgIHRlbXBEaXYuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJwb3NpdGlvbjogcmVsYXRpdmU7Ij4NCiAgICAgICAgICAgICAgICAgICR7aXNDYW5jZWxsZWQgPyAnPGRpdiBzdHlsZT0icG9zaXRpb246YWJzb2x1dGU7IHRvcDo1MCU7IGxlZnQ6NTAlOyB0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSkgcm90YXRlKC00NWRlZyk7IGZvbnQtc2l6ZTo3MHB0OyBjb2xvcjpyZ2JhKDIxNyw4Myw3OSwwLjE1KTsgZm9udC13ZWlnaHQ6Ym9sZDsgYm9yZGVyOjhwdCBzb2xpZCByZ2JhKDIxNyw4Myw3OSwwLjE1KTsgcGFkZGluZzoxMHB4IDMwcHg7IHotaW5kZXg6MTAwOyB3aGl0ZS1zcGFjZTpub3dyYXA7Ij5DQU5DRUxMRUQ8L2Rpdj4nIDogJyd9DQogICAgICAgICAgICAgICAgICA8dGFibGUgc3R5bGU9IndpZHRoOiAxMDAlOyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyI+DQogICAgICAgICAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9IndpZHRoOiA3NXB0OyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyI+PGltZyBzcmM9Imh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkvYnVwM25zM2I0eDdmZ3hvNjQ3ZnlkL1Blcml5YXZhLmpwZz9ybGtleT1mM2s4Z2MxaHdsanVleXl2NGM3MzZpZ2lyJmRsPTEiIHN0eWxlPSJ3aWR0aDoxMDAlIiBjcm9zc29yaWdpbj0iYW5vbnltb3VzIj48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjsgdmVydGljYWwtYWxpZ246IHRvcDsgcGFkZGluZy1sZWZ0OiA1cHQ7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMTNwdDsgZm9udC13ZWlnaHQ6IGJvbGQ7Ij5NWUxBSSBNQUhBUEVSSVlBVkEgQU5VU0hBTSBUUlVTVCAoUkVHRC4pPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDguNXB0OyBsaW5lLWhlaWdodDogMS4yOyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTmV3IE5vLiA0LCBPbGQgTm8uIDIzLCBQaXRjaHVwaWxsYWkgU3RyZWV0LCBNeWxhcG9yZSwgQ2hlbm5haS02MDAgMDA0Ljxicj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBQaG9uZTogNjM4MDg5ODIzMSwgODYxMDIxNDEzOC48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg8J+TpyB0aGlydW15bGFpYW51c2hhbUBnbWFpbC5jb20g8J+MkCB3d3cubXlsYWltYWhhcGVyaXlhdmF0ZW1wbGUuY29tPGJyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKTlSB3d3cuZmFjZWJvb2suY29tL3RoaXJ1bXlsYWkuYW51c2hhbSA6IFdoYXRzQXBwOiA2MzgwODk4MjMxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgPC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6IDVwdDsgZGlzcGxheTogZmxleDsganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXRvcDogMnB4IHNvbGlkICMwMDA7IGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjMDAwOyBwYWRkaW5nOiAycHQgMDsgZm9udC1zaXplOiA5LjVwdDsiPg0KICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJ3aWR0aDoxMzBwdCI+RGF0ZTogJHtmWzFdfTwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0idGV4dC1kZWNvcmF0aW9uOiB1bmRlcmxpbmU7Ij5SRUNFSVBUPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJ3aWR0aDoxMzBwdDsgdGV4dC1hbGlnbjpyaWdodCI+Tm86ICR7ZlswXX08L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6IDhwdDsgZm9udC1zaXplOiAxMC41cHQ7IHRleHQtYWxpZ246IGp1c3RpZnk7IGxpbmUtaGVpZ2h0OiAxLjM7Ij4NCiAgICAgICAgICAgICAgICAgICAgICBSZWNlaXZlZCB3aXRoIHRoYW5rcyBScy4gPGI+JHtmWzldfTwvYj4gKDxiPlJ1cGVlcyAke3RvV29yZHMoZls5XSl9IG9ubHk8L2I+KSBmb3IgPGI+JHtmWzEyXX08L2I+IHZpYSAke2ZbMTFdfSA8Yj4ke2ZbMTBdfTwvYj4gZnJvbToNCiAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYm9yZGVyLXRvcDogMXB4IHNvbGlkICMwMDA7IG1hcmdpbjogNHB0IDA7Ij48L2Rpdj4NCiAgICAgICAgICAgICAgICAgIDx0YWJsZSBzdHlsZT0id2lkdGg6IDEwMCU7IGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkIHN0eWxlPSJ3aWR0aDogODVwdDsgZm9udC1zaXplOiA5LjVwdDsgcGFkZGluZzogMS41cHQgMDsiPk5hbWU8L3RkPjx0ZCBzdHlsZT0iZm9udC1zaXplOiA5LjVwdDsgZm9udC13ZWlnaHQ6IGJvbGQ7Ij5TaHJpLi9TbXQuICR7ZlsyXX08L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZCBzdHlsZT0iZm9udC1zaXplOiA5LjVwdDsgcGFkZGluZzogMS41cHQgMDsiPlBBTjwvdGQ+PHRkIHN0eWxlPSJmb250LXNpemU6IDkuNXB0OyBmb250LXdlaWdodDogYm9sZDsiPiR7Zls2XSB8fCAnTi9BJ308L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZCBzdHlsZT0iZm9udC1zaXplOiA5LjVwdDsgcGFkZGluZzogMS41cHQgMDsiPlBob25lPC90ZD48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+JHtmWzNdIHx8ICdOL0EnfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkIHN0eWxlPSJmb250LXNpemU6IDkuNXB0OyBwYWRkaW5nOiAxLjVwdCAwOyI+RW1haWw8L3RkPjx0ZCBzdHlsZT0iZm9udC1zaXplOiA5LjVwdDsgZm9udC13ZWlnaHQ6IGJvbGQ7Ij4ke2ZbNV0gfHwgJ04vQSd9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IHBhZGRpbmc6IDEuNXB0IDA7IHZlcnRpY2FsLWFsaWduOiB0b3A7Ij5BZGRyZXNzPC90ZD48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+JHtmdWxsQWRkcmVzc308L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICA8L3RhYmxlPg0KICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iYm9yZGVyLXRvcDogMXB4IHNvbGlkICMwMDA7IG1hcmdpbjogNHB0IDA7Ij48L2Rpdj4NCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgYWxpZ24taXRlbXM6IGZsZXgtZW5kOyBtYXJnaW4tdG9wOiA1cHQ7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDdwdDsgZm9udC1zdHlsZTogaXRhbGljOyB3aWR0aDogNTAlOyI+KkNvbXB1dGVyIEdlbmVyYXRlZCBSZWNlaXB0LU5vIHNpZ25hdHVyZSBSZXF1aXJlZDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0OyB3aWR0aDogNTAlOyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+Zm9yIE1ZTEFJIE1BSEFQRVJJWUFWQSBBTlVTSEFNIFRSVVNUPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogOHB0OyBmb250LXdlaWdodDogYm9sZDsgbWFyZ2luLXRvcDogMnB0OyI+U2VjIDEyLUEgVmFsaWQgdGlsbCAzMS0wMy0yMDI2IHwgUEFOIEFBRVRNNTE0NUo8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICBgOw0KDQogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGVtcERpdik7DQogICAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGF3YWl0IGh0bWwyY2FudmFzKHRlbXBEaXYsIHsgdXNlQ09SUzogdHJ1ZSwgc2NhbGU6IDIgfSk7DQogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGVtcERpdik7DQogICAgICAgICAgICAgIHJldHVybiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9qcGVnJywgMS4wKTsNCiAgICAgICAgICB9DQoNCg0KDQoNCg0KDQogICAgICAgICAgLyoqDQoqIE5ldyBEb3dubG9hZCBNZW51IEZ1bmN0aW9uOiBDbGVhcnMgd29ya3NwYWNlIGFuZCBwcm92aWRlcyBjb25zb2xpZGF0ZWQNCiogZG93bmxvYWQgYnV0dG9ucyB0aGF0IGF1dG8tYWRqdXN0IHRvIHNjcmVlbiB3aWR0aC4NCiovDQoNCiAgICAgICAgICBmdW5jdGlvbiBzaG93RG93bmxvYWRNZW51KCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCByZXN1bHRzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpOw0KDQogICAgICAgICAgICAgIC8vIEVhY2ggYnV0dG9uIGhhcyBhIHVuaXF1ZSBiYWNrZ3JvdW5kIGFuZCBoaWdoLWNvbnRyYXN0IHRleHQgY29sb3INCiAgICAgICAgICAgICAgY29uc3QgaHRtbCA9IGANCiAgICAgICAgICAgICAgPGRpdiBpZD0iZG93bmxvYWRDZW50ZXJUb3AiIHN0eWxlPSJwYWRkaW5nOiAxNXB4OyBkaXNwbGF5OiBmbGV4OyBmbGV4LWRpcmVjdGlvbjogY29sdW1uOyBnYXA6IDEwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IG1heC13aWR0aDogODAwcHg7IG1hcmdpbjogMCBhdXRvOyI+DQogICAgICAgICAgICAgICAgICA8aDMgc3R5bGU9ImNvbG9yOiB2YXIoLS1wcmltYXJ5LWJsdWUpOyBtYXJnaW4tYm90dG9tOiA1cHg7Ij5NTVBUIERvd25sb2FkIENlbnRlcjwvaDM+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcocnVuU29mdGNvcGllc0RpcmVjdCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjMkU3RDMyOyBjb2xvcjogI0ZGRkZGRjsgYm9yZGVyOiAxcHggc29saWQgIzFCNUUyMDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgMS4gU29mdGNvcGllcyBvZiBSZWNlaXB0cyAoUERGKQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZ2VuZXJhdGVSUkxhYmVscygpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0ZGRjlDNDsgY29sb3I6ICMwMDAwMDA7IGJvcmRlcjogMXB4IHNvbGlkICNGQkMwMkQ7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDIuIExhYmVscyBmb3IgUmVhZHkgUmVjZWlwdHMgKFBERikNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvd25sb2FkRG9uYXRpb25MaXN0RGlyZWN0KCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjRTNGMkZEOyBjb2xvcjogIzBENDdBMTsgYm9yZGVyOiAxcHggc29saWQgIzIxOTZGMzsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgMy4gRG9uYXRpb24gTGlzdCAoRXhjZWwpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJkb3dubG9hZFVuaXF1ZURvbm9yTGlzdERpcmVjdCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0U4RjVFOTsgY29sb3I6ICMxQjVFMjA7IGJvcmRlcjogMXB4IHNvbGlkICM0Q0FGNTA7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDQuIFVuaXF1ZSBEb25vciBMaXN0IChUb3AgRG9ub3JzIEV4Y2VsKQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZG93bmxvYWRQZW5kaW5nQ2FzaERpcmVjdCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0VGRUJFOTsgY29sb3I6ICM0RTM0MkU7IGJvcmRlcjogMXB4IHNvbGlkICM4RDZFNjM7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDUuIFBlbmRpbmcgQ2FzaCBEZXBvc2l0cyAoRXhjZWwpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJkb3dubG9hZFBlbmRpbmdDb25zZW50RGlyZWN0KCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjRkJFOUU3OyBjb2xvcjogI0JGMzYwQzsgYm9yZGVyOiAxcHggc29saWQgI0ZGNTcyMjsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgNi4gUGVuZGluZyBDb25zZW50IExldHRlcnMgKENvcnB1cyBFeGNlbCkNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvd25sb2FkQW5vbnltb3VzTGlzdERpcmVjdCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0YzRTVGNTsgY29sb3I6ICM0QTE0OEM7IGJvcmRlcjogMXB4IHNvbGlkICM5QzI3QjA7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDcuIEFub255bW91cyBMaXN0IChFeGNlbCkNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InJ1bkFub255TWF0Y2hEaXJlY3QoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICM0QTE0OEM7IGNvbG9yOiAjRkZGRkZGOyBib3JkZXI6IDFweCBzb2xpZCAjMzExQjkyOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA4LiBBbm9ueW1vdXMgTWF0Y2ggTGlzdCAoVFhUKQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0icnVuQmFua1N0YXRlbWVudERpcmVjdCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogIzAwNjA2NDsgY29sb3I6ICNFMEY3RkE7IGJvcmRlcjogMXB4IHNvbGlkICMwMDgzOEY7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDkuIEJhbmsgU3RhdGVtZW50IChFeGNlbCkNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InJ1bkRldGFpbGVkTWF0Y2hSZXBvcnQoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICMwMTU3OUI7IGNvbG9yOiAjRTFGNUZFOyBib3JkZXI6IDFweCBzb2xpZCAjMDI3N0JEOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAxMC4gRGV0YWlsZWQgQmFuayBNYXRjaCBSZXBvcnQgKFRYVCkNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InJ1bkV4cGVuc2VzRXhwb3J0KCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjQjcxQzFDOyBjb2xvcjogI0ZGRUJFRTsgYm9yZGVyOiAxcHggc29saWQgI0M2MjgyODsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgMTEuIEV4cGVuc2VzIFJlcG9ydCAoRXhjZWwpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InJ1bk1vbnRobHlTdGF0ZW1lbnRzKCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjQjcxQzFDOyBjb2xvcjogI0ZGRUJFRTsgYm9yZGVyOiAxcHggc29saWQgI0M2MjgyODsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgMTIuIE1vbnRobHkgUmVwb3J0IChQREYpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImhpZGVVdGlsaXRpZXMoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDQ1cHg7IGJhY2tncm91bmQ6ICMzMzM7IGNvbG9yOiB3aGl0ZTsgYm9yZGVyOiBub25lOyBtYXJnaW4tdG9wOiAxNXB4OyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIOKGkCBCQUNLIFRPIERBU0hCT0FSRA0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxwIGlkPSJkb3dubG9hZENlbnRlckJvdHRvbSIgc3R5bGU9ImZvbnQtc2l6ZTogMC44cmVtOyBjb2xvcjogIzY2NjsgbWFyZ2luLXRvcDogMTBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICogRW5zdXJlIEZZIEZpbHRlciBpcyBhcHBsaWVkIGJlZm9yZSBkb3dubG9hZGluZy4NCiAgICAgICAgICAgICAgICAgIDwvcD4NCiAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgYDsNCiAgICAgICAgICAgICAgcmVzdWx0c0Rpdi5pbm5lckhUTUwgPSBodG1sOw0KICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IDAsIGJlaGF2aW9yOiAnc21vb3RoJyB9KTsNCiAgICAgICAgICB9DQoNCg0KICAgICAgICAgIGZ1bmN0aW9uIHRvV29yZHMobikgew0KICAgICAgICAgICAgICBpZiAobiA9PSAwKSByZXR1cm4gJ1plcm8nOw0KICAgICAgICAgICAgICBsZXQgYSA9IFsnJywgJ09uZSAnLCAnVHdvICcsICdUaHJlZSAnLCAnRm91ciAnLCAnRml2ZSAnLCAnU2l4ICcsICdTZXZlbiAnLCAnRWlnaHQgJywgJ05pbmUgJywgJ1RlbiAnLCAnRWxldmVuICcsICdUd2VsdmUgJywgJ1RoaXJ0ZWVuICcsICdGb3VydGVlbiAnLCAnRmlmdGVlbiAnLCAnU2l4dGVlbiAnLCAnU2V2ZW50ZWVuICcsICdFaWdodGVlbiAnLCAnTmluZXRlZW4gJ107DQogICAgICAgICAgICAgIGxldCBiID0gWycnLCAnJywgJ1R3ZW50eScsICdUaGlydHknLCAnRm9ydHknLCAnRmlmdHknLCAnU2l4dHknLCAnU2V2ZW50eScsICdFaWdodHknLCAnTmluZXR5J107DQoNCiAgICAgICAgICAgICAgbGV0IG51bSA9ICgnMDAwMDAwMDAwJyArIHBhcnNlSW50KG4pKS5zdWJzdHIoLTkpLm1hdGNoKC9eKFxkezJ9KShcZHsyfSkoXGR7Mn0pKFxkezF9KShcZHsyfSkkLyk7DQogICAgICAgICAgICAgIGlmICghbnVtKSByZXR1cm4gIiI7DQoNCiAgICAgICAgICAgICAgbGV0IHN0ciA9ICcnOw0KICAgICAgICAgICAgICBzdHIgKz0gKG51bVsxXSAhPSAwKSA/IChhW051bWJlcihudW1bMV0pXSB8fCBiW251bVsxXVswXV0gKyAnICcgKyBhW251bVsxXVsxXV0pICsgJ0Nyb3JlICcgOiAnJzsNCiAgICAgICAgICAgICAgc3RyICs9IChudW1bMl0gIT0gMCkgPyAoYVtOdW1iZXIobnVtWzJdKV0gfHwgYltudW1bMl1bMF1dICsgJyAnICsgYVtudW1bMl1bMV1dKSArICdMYWtoICcgOiAnJzsNCiAgICAgICAgICAgICAgc3RyICs9IChudW1bM10gIT0gMCkgPyAoYVtOdW1iZXIobnVtWzNdKV0gfHwgYltudW1bM11bMF1dICsgJyAnICsgYVtudW1bM11bMV1dKSArICdUaG91c2FuZCAnIDogJyc7DQogICAgICAgICAgICAgIHN0ciArPSAobnVtWzRdICE9IDApID8gKGFbTnVtYmVyKG51bVs0XSldIHx8IGJbbnVtWzRdWzBdXSArICcgJyArIGFbbnVtWzRdWzFdXSkgKyAnSHVuZHJlZCAnIDogJyc7DQogICAgICAgICAgICAgIHN0ciArPSAobnVtWzVdICE9IDApID8gKChzdHIgIT0gJycpID8gJ2FuZCAnIDogJycpICsgKGFbTnVtYmVyKG51bVs1XSldIHx8IGJbbnVtWzVdWzBdXSArICcgJyArIGFbbnVtWzVdWzFdXSkgOiAnJzsNCg0KICAgICAgICAgICAgICByZXR1cm4gc3RyLnRyaW0oKTsNCiAgICAgICAgICB9DQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHNob3dEb25vck1hdGNoTGlzdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgIGNvbnN0IFJFVkVSU0FMU19VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9rNmNsdmtlN2gycXhoZ24wN3ZtYjUvUmV2ZXJzYWxzLnR4dD9ybGtleT0xeTlkbnJldmQ2bW1uczAwM2x5ZHV3OTVtJmRsPTEiOw0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZEZZID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IFtiYW5rUmVzLCBkYXRhUmVzLCBleHBSZXMsIHJldlJlcywgY2FzaFJlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goQkFOS19ORVdfVVJMKSwgZmV0Y2goREFUQV9VUkwpLA0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKEVYUEVOU0VTX1VSTCkudGhlbihyZXMgPT4gcmVzLmFycmF5QnVmZmVyKCkpLA0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKFJFVkVSU0FMU19VUkwpLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpLA0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKENBU0hfTElTVF9VUkwpLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpDQogICAgICAgICAgICAgICAgICBdKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgYmFua0xpbmVzID0gKGF3YWl0IGJhbmtSZXMudGV4dCgpKS5zcGxpdCgnXG4nKS5maWx0ZXIobCA9PiBsLnRyaW0oKS5zcGxpdCgnfCcpLmxlbmd0aCA+PSA1KTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbm9yUmVjcyA9IChhd2FpdCBkYXRhUmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkYiA9IGRvbm9yUmVjcy5tYXAociA9PiByLnNwbGl0KCd8JykpLmZpbHRlcihmID0+IGYubGVuZ3RoID49IDE1ICYmIGZbMTNdPy50b1VwcGVyQ2FzZSgpICE9PSAiWUVTIik7DQogICAgICAgICAgICAgICAgICBjb25zdCByZXZlcnNhbHMgPSByZXZSZXMuc3BsaXQoJ1xuJykubWFwKGxpbmUgPT4gbGluZS5zcGxpdCgnfCcpKS5maWx0ZXIoZiA9PiBmLmxlbmd0aCA+PSA3KTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNhc2hMaW5lcyA9IGNhc2hSZXMuc3BsaXQoJ1xuJykuZmlsdGVyKGwgPT4gbC50cmltKCkgIT09ICIiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdvcmtib29rID0gWExTWC5yZWFkKGV4cFJlcywgeyB0eXBlOiAnYXJyYXknIH0pOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgcm93cyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1swXV0sIHsgaGVhZGVyOiAxIH0pOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBjcmVkaXRFeGVtcHRLZXl3b3JkcyA9IFsiQ1JFRElUIElOVEVSRVNUIiwgIkNMT1NVUkUgT0YgRkQiLCAiUEFSVCBXSVRIRFJBV0wiLCAiRkQgIiwgIkZEOiIsICJCWSBJTlQgVFJBTlNGRVIiLCAiSEFORExJTkdSRVYiLCAiVVBJTUkgQ1IgQURKIiwgIkxPQU4iLCAiUkVUVVJOIiwgIlJFVkVSU0FMIl07DQoNCiAgICAgICAgICAgICAgICAgIGxldCBtYWluTWFzdGVySHRtbCA9ICIiLCBleGVtcHRDcmVkaXRzSHRtbCA9ICIiLCBleGVtcHREZWJpdHNIdG1sID0gIiIsIHBlbmRpbmdSb3dzSHRtbCA9ICIiOw0KICAgICAgICAgICAgICAgICAgbGV0IGJhbmtTdGF0ZW1lbnRDb3VudCA9IDA7DQogICAgICAgICAgICAgICAgICBsZXQgbWF0Y2hlZFJlY2VpcHRzU2V0ID0gbmV3IFNldCgpOw0KICAgICAgICAgICAgICAgICAgbGV0IGF1ZGl0VG93YXJkc01hcCA9IHt9OyBsZXQgYXVkaXRNb2RlTWFwID0ge307DQoNCiAgICAgICAgICAgICAgICAgIGxldCBtYXRjaGVkRXhwZW5zZUluZGljZXMgPSBuZXcgU2V0KCk7IC8vIFRvIHRyYWNrIHdoaWNoIEV4Y2VsIHJvd3MgYXJlIGFscmVhZHkgbGlua2VkDQoNCiAgICAgICAgICAgICAgICAgIGJhbmtMaW5lcy5mb3JFYWNoKGxpbmUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGIgPSBsaW5lLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYkRhdGVSYXcgPSBiWzBdLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiUmVmUmF3ID0gKGJbMV0gfHwgIiIpLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiQW10ID0gcGFyc2VGbG9hdChiWzRdIHx8IGJbM10gfHwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDcmVkaXQgPSBiWzRdICE9PSAiIiAmJiBiWzRdICE9PSAiMCIgJiYgYls0XSAhPT0gIjAuMDAiICYmIGJbNF0gIT09IHVuZGVmaW5lZDsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRGWSAhPT0gImFsbCIgJiYgIjIwIiArIGdldEZZKGJEYXRlUmF3KS5zcGxpdCgnLScpWzBdICE9PSBzZWxlY3RlZEZZKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgYmFua1N0YXRlbWVudENvdW50Kys7DQoNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgcm93U3R5bGUgPSAiIiwgZGV0YWlsQ29sSHRtbCA9ICIiLCByZWNIdG1sID0gIiIsIGlzTWF0Y2hlZCA9IGZhbHNlLCBtYXRjaGVkRG9ub3JzID0gW107DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGlzRXhlbXB0Q3JlZGl0ID0gZmFsc2UsIGlzRXhlbXB0RGViaXQgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgYW10Q2xhc3MgPSBpc0NyZWRpdCA/ICJhbXQtY3JlZGl0IiA6ICJhbXQtZGViaXQiOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXRTdWJMYWJlbCA9ICIiOw0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3JlZGl0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJEYXRlU3RkID0gYkRhdGVSYXcucmVwbGFjZSgvW1wvXC5dL2csICctJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJldk1hdGNoID0gcmV2ZXJzYWxzLmZpbmQociA9PiByWzBdLnRyaW0oKS5yZXBsYWNlKC9bXC9cLl0vZywgJy0nKSA9PT0gYkRhdGVTdGQgJiYgclsxXS50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gYlJlZlJhdy50b1VwcGVyQ2FzZSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldk1hdGNoKSB7IGlzTWF0Y2hlZCA9IHRydWU7IGlzRXhlbXB0Q3JlZGl0ID0gdHJ1ZTsgcm93U3R5bGUgPSAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2UzZjJmZDsiJzsgZGV0YWlsQ29sSHRtbCA9ICc8Yj5SRVZFUlNBTDo8L2I+ICcgKyByZXZNYXRjaFs2XTsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChjcmVkaXRFeGVtcHRLZXl3b3Jkcy5zb21lKGsgPT4gYlJlZlJhdy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKGspKSkgeyBpc01hdGNoZWQgPSB0cnVlOyBpc0V4ZW1wdENyZWRpdCA9IHRydWU7IHJvd1N0eWxlID0gJ3N0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiNlM2YyZmQ7Iic7IGRldGFpbENvbEh0bWwgPSAnPGI+QkFOSyBFWEVNUFQ6PC9iPiAnICsgYlJlZlJhdzsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiUmVmUmF3LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNBU0ggREVQT1NJVCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNsTWF0Y2ggPSBjYXNoTGluZXMuZmluZChjbCA9PiB7IGNvbnN0IHBhcnRzID0gY2wuc3BsaXQoJ3wnKVswXS50cmltKCkuc3BsaXQoJyAnKTsgcmV0dXJuIHBhcnRzWzBdLnJlcGxhY2UoL1tcL1wuXS9nLCAnLScpID09PSBiRGF0ZVN0ZCAmJiBNYXRoLmFicyhwYXJzZUZsb2F0KHBhcnRzWzFdKSAtIGJBbXQpIDwgMC4wMTsgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsTWF0Y2gpIHsgaXNNYXRjaGVkID0gdHJ1ZTsgY29uc3QgcCA9IGNsTWF0Y2guc3BsaXQoJ3wnKTsgY29uc3QgcHJlZml4ID0gcFsxXS50cmltKCkgPT09ICdNJyA/ICJNUFMiIDogIkNHIjsgY29uc3Qgckxpc3QgPSBwWzJdLnNwbGl0KCcsJykubWFwKHIgPT4gcHJlZml4ICsgci50cmltKCkucGFkU3RhcnQocFsxXS50cmltKCkgPT09ICdNJyA/IDcgOiA2LCAnMCcpKTsgbWF0Y2hlZERvbm9ycyA9IGRiLmZpbHRlcihkID0+IHJMaXN0LmluY2x1ZGVzKGRbMF0udHJpbSgpKSk7IH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsgbWF0Y2hlZERvbm9ycyA9IGRiLmZpbHRlcihkID0+IGRbMV0udHJpbSgpLnJlcGxhY2UoL1tcL1wuXS9nLCAnLScpID09PSBiRGF0ZVN0ZCAmJiBNYXRoLmFicyhwYXJzZUZsb2F0KGRbOV0pIC0gYkFtdCkgPCAwLjAxICYmIGRbMTFdLnRvVXBwZXJDYXNlKCkgPT09ICJDQVNIIik7IGlmIChtYXRjaGVkRG9ub3JzLmxlbmd0aCA+IDApIGlzTWF0Y2hlZCA9IHRydWU7IH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlZERvbm9ycyA9IGRiLmZpbHRlcihkID0+IHsgbGV0IGRSZWYgPSAoZFsxMF0gfHwgIiIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpLnNwbGl0KCcoJylbMF0uc3BsaXQoJ1snKVswXS50cmltKCk7IHJldHVybiBkWzFdLnRyaW0oKS5yZXBsYWNlKC9bXC9cLl0vZywgJy0nKSA9PT0gYkRhdGVTdGQgJiYgZFJlZiAhPT0gIiIgJiYgYlJlZlJhdy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKGRSZWYpOyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2hlZERvbm9ycy5sZW5ndGggPiAwKSBpc01hdGNoZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2UgZmluZEluZGV4IHNvIHdlIGtub3cgZXhhY3RseSB3aGljaCByb3cgd2UgYXJlIHBpY2tpbmcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGV4cE1hdGNoSWR4ID0gcm93cy5maW5kSW5kZXgoKHIsIGkpID0+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID4gMCAmJg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIW1hdGNoZWRFeHBlbnNlSW5kaWNlcy5oYXMoaSkgJiYgLy8gT05MWSBwaWNrIGEgcm93IG5vdCBhbHJlYWR5IG1hdGNoZWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbM10gJiYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGguYWJzKHBhcnNlRmxvYXQoclszXSkgLSBiQW10KSA8IDAuMDENCiAgICAgICAgICAgICAgICAgICAgICAgICAgKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwTWF0Y2hJZHggIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXhwTWF0Y2ggPSByb3dzW2V4cE1hdGNoSWR4XTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWRFeHBlbnNlSW5kaWNlcy5hZGQoZXhwTWF0Y2hJZHgpOyAvLyBNYXJrIHRoaXMgcm93IGFzICJ1c2VkIg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc01hdGNoZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW10U3ViTGFiZWwgPSAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjAuNjVyZW07IGNvbG9yOmluaGVyaXQ7IGZvbnQtd2VpZ2h0OmJvbGQ7Ij5FeHBlbnNlPC9kaXY+JzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwTm90ZSA9IChleHBNYXRjaFs0XSB8fCAiIikudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXhwTm90ZS5pbmNsdWRlcygiRVhFTVBUIikgfHwgZXhwTm90ZS5pbmNsdWRlcygiRlJFU0ggREVQT1NJVCIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNFeGVtcHREZWJpdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93U3R5bGUgPSAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNiNzFjMWM7IGNvbG9yOiAjZmZmZmZmICFpbXBvcnRhbnQ7Iic7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd1N0eWxlID0gJ3N0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjZmNlNGVjOyInOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsQ29sSHRtbCA9ICc8Yj4nICsgKGV4cE1hdGNoWzRdIHx8IGJSZWZSYXcpICsgJzwvYj4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCg0KICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgIGxldCBmaW5hbEFtdFN0eWxlID0gaXNFeGVtcHREZWJpdCA/ICdzdHlsZT0iY29sb3I6I2ZmZmZmZiAhaW1wb3J0YW50OyBmb250LXdlaWdodDpib2xkOyInIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGFtdENvbEh0bWwgPSBg4oK5JHtiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfSR7YW10U3ViTGFiZWx9YDsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NyZWRpdCAmJiBpc01hdGNoZWQgJiYgbWF0Y2hlZERvbm9ycy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElNUExFTUVOVEVEOiBDbGlja2FibGUgUmVjZWlwdCBMaW5rcyBmb3IgTWF0Y2hlZCBEb25vcnMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjSHRtbCA9IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6MC43cmVtOyBtYXJnaW4tdG9wOjNweDsiPiR7bWF0Y2hlZERvbm9ycy5tYXAobSA9PiBgPHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHttWzBdLnRyaW0oKX0nKSI+JHttWzBdLnRyaW0oKX08L3NwYW4+YCkuam9pbignPGJyPicpfTwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkRG9ub3JzLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93U3R5bGUgPSAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2ZmZmRlNzsiJzsgY29uc3QgbSA9IG1hdGNoZWREb25vcnNbMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXRDb2xIdG1sID0gYOKCuSR7YkFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08YnI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTowLjY1cmVtOyBjb2xvcjojNTU1OyI+VG93YXJkczogJHttWzEyXX08L3NwYW4+PGJyPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MC42NXJlbTsgY29sb3I6IzU1NTsiPk1vZGU6ICR7bVsxMV19PC9zcGFuPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxDb2xIdG1sID0gYDxiPiR7bVsyXX08L2I+IHwgJHttWzE5XX0gfCAke21bMTVdfTxicj5QQU46ICR7bVs2XX08YnI+UnMuJHtwYXJzZUZsb2F0KG1bOV0pLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfSA6IFRvd2FyZHMgOiAke21bMTJdfWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dTdHlsZSA9ICdzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojZmZmMTc2OyInOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW10Q29sSHRtbCA9IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6MC43cmVtOyBmb250LXdlaWdodDpib2xkOyBjb2xvcjojMzMzOyI+TXVsdGlwbGUgRG9ub3JzPC9kaXY+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2ZmOTgwMDsgY29sb3I6d2hpdGU7IHBhZGRpbmc6MnB4IDRweDsgYm9yZGVyLXJhZGl1czozcHg7IGRpc3BsYXk6aW5saW5lLWJsb2NrOyBmb250LXdlaWdodDpib2xkOyI+4oK5JHtiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvc3Bhbj48ZGl2IHN0eWxlPSJmb250LXNpemU6MC42NXJlbTsgbWFyZ2luLXRvcDoycHg7IGNvbG9yOiM1NTU7Ij5Nb2RlOiAke21hdGNoZWREb25vcnNbMF1bMTFdfTwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxDb2xIdG1sID0gYDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7IHRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7IGNvbG9yOiMwZDQ3YTE7IG1hcmdpbi1ib3R0b206NXB4OyI+RG9ub3IgRGV0YWlsczwvZGl2PmAgKyBtYXRjaGVkRG9ub3JzLm1hcChtID0+IGA8Yj4ke21bMl19PC9iPiB8ICR7bVsxOV19IHwgJHttWzE1XX08YnI+UEFOOiAke21bNl19PGJyPlJzLiR7cGFyc2VGbG9hdChtWzldKS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX0gOiBUb3dhcmRzIDogJHttWzEyXX1gKS5qb2luKCc8aHIgc3R5bGU9ImJvcmRlcjpub25lOyBib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjOyBtYXJnaW46OHB4IDA7Ij4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVkRG9ub3JzLmZvckVhY2gobSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KG1bOV0pIHx8IDA7IG1hdGNoZWRSZWNlaXB0c1NldC5hZGQobVswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdWRpdFRvd2FyZHNNYXBbbVsxMl1dKSBhdWRpdFRvd2FyZHNNYXBbbVsxMl1dID0geyBhbXQ6IDAsIHJTZXQ6IG5ldyBTZXQoKSB9OyBhdWRpdFRvd2FyZHNNYXBbbVsxMl1dLmFtdCArPSB2YWw7IGF1ZGl0VG93YXJkc01hcFttWzEyXV0uclNldC5hZGQobVswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdWRpdE1vZGVNYXBbbVsxMV1dKSBhdWRpdE1vZGVNYXBbbVsxMV1dID0geyBhbXQ6IDAsIHJTZXQ6IG5ldyBTZXQoKSB9OyBhdWRpdE1vZGVNYXBbbVsxMV1dLmFtdCArPSB2YWw7IGF1ZGl0TW9kZU1hcFttWzExXV0uclNldC5hZGQobVswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc01hdGNoZWQpIHsgcm93U3R5bGUgPSBpc0NyZWRpdCA/ICdzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IicgOiAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNlOGY1ZTk7Iic7IGRldGFpbENvbEh0bWwgPSBgPGkgc3R5bGU9ImNvbG9yOiM2NjY7Ij5CYW5rIFJlZjogJHtiUmVmUmF3fTwvaT5gOyB9DQogICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93U3RyID0gYDx0ciAke2lzRXhlbXB0RGViaXQgPyAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2I3MWMxYzsgY29sb3I6I2ZmZmZmZiAhaW1wb3J0YW50OyInIDogcm93U3R5bGV9Pjx0ZCBzdHlsZT0id2lkdGg6MTAlIj48Yj4ke2JEYXRlUmF3fTwvYj4ke3JlY0h0bWx9PC90ZD48dGQgc3R5bGU9IndpZHRoOjEwJSIgY2xhc3M9IiR7aXNFeGVtcHREZWJpdCA/ICcnIDogYW10Q2xhc3N9IiAke2ZpbmFsQW10U3R5bGV9PiR7YW10Q29sSHRtbH08L3RkPjx0ZCBzdHlsZT0id2lkdGg6ODAlIj4ke2RldGFpbENvbEh0bWx9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgbWFpbk1hc3Rlckh0bWwgKz0gcm93U3RyOyBpZiAoaXNFeGVtcHRDcmVkaXQpIGV4ZW1wdENyZWRpdHNIdG1sICs9IHJvd1N0cjsgaWYgKGlzRXhlbXB0RGViaXQpIGV4ZW1wdERlYml0c0h0bWwgKz0gcm93U3RyOyBpZiAoIWlzTWF0Y2hlZCkgcGVuZGluZ1Jvd3NIdG1sICs9IHJvd1N0cjsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBsZXQgdW5tYXRjaGVkSHRtbCA9ICIiLCB1bm1hdGNoZWRUb3RhbEFtdCA9IDAsIHVubWF0Y2hlZENvdW50ID0gMDsNCiAgICAgICAgICAgICAgICAgIGRiLmZpbHRlcihtID0+IHsgY29uc3QgbUZZID0gIjIwIiArIGdldEZZKG1bMV0udHJpbSgpKS5zcGxpdCgnLScpWzBdOyByZXR1cm4gIW1hdGNoZWRSZWNlaXB0c1NldC5oYXMobVswXS50cmltKCkpICYmIChzZWxlY3RlZEZZID09PSAiYWxsIiB8fCBtRlkgPT09IHNlbGVjdGVkRlkpOyB9KQ0KICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKG0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkQW10ID0gcGFyc2VGbG9hdChtWzldIHx8IDApOyB1bm1hdGNoZWRUb3RhbEFtdCArPSBkQW10OyB1bm1hdGNoZWRDb3VudCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJTVBMRU1FTlRFRDogQ2xpY2thYmxlIFJlY2VpcHQgTGlua3MgZm9yIFVubWF0Y2hlZCBUYWJsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB1bm1hdGNoZWRIdG1sICs9IGA8dHIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2ZhZmFmYTsiPjx0ZCBzdHlsZT0id2lkdGg6MTAlIj48Yj4ke21bMV19PC9iPjxicj48ZGl2IGNsYXNzPSJyY3B0LWxpbmsiIHN0eWxlPSJmb250LXNpemU6MC43cmVtOyIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHttWzBdLnRyaW0oKX0nKSI+JHttWzBdLnRyaW0oKX08L2Rpdj48L3RkPjx0ZCBzdHlsZT0id2lkdGg6MTAlIiBjbGFzcz0iYW10LWNyZWRpdCI+4oK5JHtkQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTxicj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjAuNjVyZW07IGNvbG9yOiM1NTU7Ij5Ub3dhcmRzOiAke21bMTJdfTwvc3Bhbj48YnI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTowLjY1cmVtOyBjb2xvcjojNTU1OyI+TW9kZTogJHttWzExXX08L3NwYW4+PC90ZD48dGQgc3R5bGU9IndpZHRoOjgwJSI+PGI+JHttWzJdfTwvYj4gfCAke21bMTldfSB8ICR7bVsxNV19PGJyPlBBTjogJHttWzZdfTxicj5Scy4ke2RBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9IDogVG93YXJkcyA6ICR7bVsxMl19PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB1bm1hdGNoZWRIdG1sICs9IGA8dHIgc3R5bGU9ImJhY2tncm91bmQ6IzQ0NDsgY29sb3I6d2hpdGU7IGZvbnQtd2VpZ2h0OmJvbGQ7Ij48dGQgc3R5bGU9IndpZHRoOjEwJSI+VE9UQUw8L3RkPjx0ZCBzdHlsZT0id2lkdGg6MTAlIj7igrkke3VubWF0Y2hlZFRvdGFsQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDo4MCUiPkNvdW50OiAke3VubWF0Y2hlZENvdW50fSBSZWNlaXB0cyBOb3QgRm91bmQgaW4gQmFuayBTdGF0ZW1lbnRzPC90ZD48L3RyPmA7DQoNCiAgICAgICAgICAgICAgICAgIGxldCBhdWRpdFRvdGFsQW10ID0gMDsgT2JqZWN0LnZhbHVlcyhhdWRpdFRvd2FyZHNNYXApLmZvckVhY2godiA9PiBhdWRpdFRvdGFsQW10ICs9IHYuYW10KTsNCiAgICAgICAgICAgICAgICAgIGxldCBhdWRpdFJvd3MgPSBgPHRyPjx0ZCBzdHlsZT0id2lkdGg6MTAlIj48Yj5UT1RBTDwvYj48L3RkPjx0ZCBzdHlsZT0id2lkdGg6MTAlOyB0ZXh0LWFsaWduOmNlbnRlcjsiPjxiPiR7bWF0Y2hlZFJlY2VpcHRzU2V0LnNpemV9PC9iPjwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDo4MCU7IHRleHQtYWxpZ246cmlnaHQ7Ij48Yj7igrkke2F1ZGl0VG90YWxBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9iPjwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoYXVkaXRUb3dhcmRzTWFwKS5zb3J0KCkuZm9yRWFjaCh0dyA9PiB7IGF1ZGl0Um93cyArPSBgPHRyPjx0ZD5Ub3dhcmRzICR7dHd9PC90ZD48dGQgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JHthdWRpdFRvd2FyZHNNYXBbdHddLnJTZXQuc2l6ZX08L3RkPjx0ZCBzdHlsZT0idGV4dC1hbGlnbjpyaWdodDsiPuKCuSR7YXVkaXRUb3dhcmRzTWFwW3R3XS5hbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPmA7IH0pOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCB0YWJsZUhlYWRlciA9ICc8dGhlYWQ+PHRyPjx0aCBzdHlsZT0id2lkdGg6MTAlIj5EYXRlPC90aD48dGggc3R5bGU9IndpZHRoOjEwJSI+QW1vdW50PC90aD48dGggc3R5bGU9IndpZHRoOjgwJSI+RG9ub3IgLyBSZWNvcmQgRGV0YWlsczwvdGg+PC90cj48L3RoZWFkPic7DQogICAgICAgICAgICAgICAgICBjb25zdCBhdWRpdEhlYWRlciA9ICc8dGhlYWQgc3R5bGU9ImJhY2tncm91bmQ6IzBkNDdhMTsgY29sb3I6d2hpdGU7Ij48dHI+PHRoIHN0eWxlPSJ3aWR0aDoxMCUiPkl0ZW08L3RoPjx0aCBzdHlsZT0id2lkdGg6MTAlIj5Eb25vcnM8L3RoPjx0aCBzdHlsZT0id2lkdGg6ODAlIj5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD4nOw0KDQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7IGp1c3RpZnktY29udGVudDpjZW50ZXI7IGdhcDoxMHB4OyBtYXJnaW4tYm90dG9tOjIwcHg7IGZvbnQtc2l6ZTowLjc1cmVtOyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iYmFja2dyb3VuZDojZmZmZGU3OyBwYWRkaW5nOjRweCA4cHg7IGJvcmRlcjoxcHggc29saWQgI2RkZDsiPlNpbmdsZSBNYXRjaDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kOiNmZmYxNzY7IHBhZGRpbmc6NHB4IDhweDsgYm9yZGVyOjFweCBzb2xpZCAjZGRkOyI+TXVsdGktRG9ub3I8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iYmFja2dyb3VuZDojZTNmMmZkOyBwYWRkaW5nOjRweCA4cHg7IGJvcmRlcjoxcHggc29saWQgI2RkZDsiPkV4ZW1wdC9SZXY8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iYmFja2dyb3VuZDojYjcxYzFjOyBjb2xvcjp3aGl0ZTsgcGFkZGluZzo0cHggOHB4OyI+RXhlbXB0IERlYml0PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImJhY2tncm91bmQ6I2U4ZjVlOTsgcGFkZGluZzo0cHggOHB4OyBib3JkZXI6MXB4IHNvbGlkICNkZGQ7Ij5FeHBlbnNlPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJiYW5rLXRpdGxlIj5NYXN0ZXIgTWF0Y2g8L2gyPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGUgY2xhc3M9Im1hdGNoVGFibGUiPiR7dGFibGVIZWFkZXJ9PHRib2R5PiR7bWFpbk1hc3Rlckh0bWx9PC90Ym9keT48L3RhYmxlPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgcGFkZGluZzoxMHB4OyBiYWNrZ3JvdW5kOiNlZWU7IGZvbnQtd2VpZ2h0OmJvbGQ7IG1hcmdpbjoxMHB4IDA7Ij5bVG90YWwgMzYzMSByZWNvcmRzIHwgUHJvY2Vzc2VkICR7YmFua1N0YXRlbWVudENvdW50fSBiYW5rIHJvd3NdPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxoMiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9ImNvbG9yOiMxNTY1YzA7Ij5FeGVtcHRlZCBDcmVkaXRzPC9oMj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlIGNsYXNzPSJtYXRjaFRhYmxlIj4ke3RhYmxlSGVhZGVyfTx0Ym9keT4ke2V4ZW1wdENyZWRpdHNIdG1sfTwvdGJvZHk+PC90YWJsZT48L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0iY29sb3I6I2I3MWMxYzsiPkV4ZW1wdGVkIERlYml0czwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZSBjbGFzcz0ibWF0Y2hUYWJsZSI+JHt0YWJsZUhlYWRlcn08dGJvZHk+JHtleGVtcHREZWJpdHNIdG1sfTwvdGJvZHk+PC90YWJsZT48L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0iY29sb3I6IzFiNWUyMDsiPlBlbmRpbmcgRW50cmllczwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZSBjbGFzcz0ibWF0Y2hUYWJsZSI+JHt0YWJsZUhlYWRlcn08dGJvZHk+JHtwZW5kaW5nUm93c0h0bWx9PC90Ym9keT48L3RhYmxlPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3M9ImJhbmstdGl0bGUiPkZpbmFsIEF1ZGl0PC9oMj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlIGNsYXNzPSJtYXRjaFRhYmxlIj4ke2F1ZGl0SGVhZGVyfTx0Ym9keT4ke2F1ZGl0Um93c308L3Rib2R5PjwvdGFibGU+PC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxoMiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9ImNvbG9yOiNlNjUxMDA7Ij5SZWNlaXB0cyBub3QgTWF0Y2hlZCBpbiBCYW5rIFN0YXRlbWVudHM8L2gyPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGUgY2xhc3M9Im1hdGNoVGFibGUiPiR7dGFibGVIZWFkZXJ9PHRib2R5PiR7dW5tYXRjaGVkSHRtbH08L3Rib2R5PjwvdGFibGU+PC9kaXY+YDsNCg0KDQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBBRERFRDogRE9XTkxPQUQgQlVUVE9OIElOSkVDVElPTiAtLS0NCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRvd25sb2FkQnRuSHRtbCA9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IG1hcmdpbjogNDBweCAwOyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJidG5Eb3dubG9hZE1hdGNoIiBjbGFzcz0ibmF2LXNjcm9sbC1idG4iIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0icG9zaXRpb246c3RhdGljOyB3aWR0aDphdXRvOyBoZWlnaHQ6YXV0bzsgcGFkZGluZzoxMnB4IDI0cHg7IGJvcmRlci1yYWRpdXM6OHB4OyBiYWNrZ3JvdW5kOiMxYjVlMjA7IGZvbnQtc2l6ZToxcmVtOyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljaz0iZG93bmxvYWRNYXRjaExpc3QoKSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRG93bmxvYWQgQmFuay1Eb25vci1FeHBlbnNlLU1hdGNoIExpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgZG93bmxvYWRCdG5IdG1sKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gLS0tIFRIRSBET1dOTE9BRCBIQU5ETEVSIC0tLQ0KICAgICAgICAgICAgICAgICAgd2luZG93LmRvd25sb2FkTWF0Y2hMaXN0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWF0Y2hUYWJsZTpmaXJzdC1vZi10eXBlIHRyJyk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBgQkFOSy1ET05PUi1FWFBFTlNFLU1BVENIIExJU1QgfCBGWTogJHtzZWxlY3RlZEZZfVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGBHZW5lcmF0ZWQgb246ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA9ImAucmVwZWF0KDUwKSArIGBcblxuYDsNCg0KICAgICAgICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xzID0gcm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoLCB0ZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYERBVEVgLnBhZEVuZCgxNSkgKyBgIHwgYCArIGBBTU9VTlRgLnBhZEVuZCgyMCkgKyBgIHwgYCArIGBERVRBSUxTXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgLWAucmVwZWF0KDEwMCkgKyBgXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZSA9IGNvbHNbMF0uaW5uZXJUZXh0LnJlcGxhY2UoL1xuL2csICcgJykudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW10ID0gY29sc1sxXS5pbm5lclRleHQucmVwbGFjZSgvXG4vZywgJyAnKS50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXRhaWxzID0gY29sc1syXS5pbm5lclRleHQucmVwbGFjZSgvXG4vZywgJyB8ICcpLnRyaW0oKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBkYXRlLnBhZEVuZCgxNSkgKyBgIHwgYCArIGFtdC5wYWRFbmQoMjApICsgYCB8IGAgKyBkZXRhaWxzICsgYFxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYC1gLnJlcGVhdCgxMDApICsgYFxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb250ZW50XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgICAgICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSBgQmFuay1Eb25vci1FeHBlbnNlLU1hdGNoIExpc3RfJHtzZWxlY3RlZEZZfS50eHRgOw0KICAgICAgICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTsNCiAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBGT1JDRUQgTkFWSUdBVElPTiBCVVRUT05TIElOSkVDVElPTiAoUmVtYWluIGF0IGJvdHRvbSkgLS0tDQoNCg0KICAgICAgICAgICAgICAgICAgLy9jb25zdCBuYXZIdG1sID0gYDxidXR0b24gaWQ9ImZVcCIgc3R5bGU9InBvc2l0aW9uOmZpeGVkOyBib3R0b206ODBweDsgcmlnaHQ6MjBweDsgei1pbmRleDo5OTk5OTsgd2lkdGg6NDVweDsgaGVpZ2h0OjQ1cHg7IGJvcmRlci1yYWRpdXM6NTAlOyBiYWNrZ3JvdW5kOiMzMzM7IGNvbG9yOiNmZmY7IGJvcmRlcjpub25lOyBjdXJzb3I6cG9pbnRlcjsgZm9udC1zaXplOjIwcHg7IGJveC1zaGFkb3c6MCAycHggNXB4IHJnYmEoMCwwLDAsMC4zKTsiIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOjAsIGJlaGF2aW9yOidzbW9vdGgnfSkiPuKGkTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJmRG93biIgc3R5bGU9InBvc2l0aW9uOmZpeGVkOyBib3R0b206MjBweDsgcmlnaHQ6MjBweDsgei1pbmRleDo5OTk5OTsgd2lkdGg6NDVweDsgaGVpZ2h0OjQ1cHg7IGJvcmRlci1yYWRpdXM6NTAlOyBiYWNrZ3JvdW5kOiMzMzM7IGNvbG9yOiNmZmY7IGJvcmRlcjpub25lOyBjdXJzb3I6cG9pbnRlcjsgZm9udC1zaXplOjIwcHg7IGJveC1zaGFkb3c6MCAycHggNXB4IHJnYmEoMCwwLDAsMC4zKTsiIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOmRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjonc21vb3RoJ30pIj7ihpM8L2J1dHRvbj5gOw0KICAgICAgICAgICAgICAgICAgLy9kb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgbmF2SHRtbCk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKGUpOyBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOyB9IGZpbmFsbHkgeyBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0NCiAgICAgICAgICB9DQoNCg0KDQogICAgICA8L3NjcmlwdD4NCg0KICAgICAgPGJ1dHRvbiBpZD0iYnRuR29Cb3R0b20iDQogICAgICAgICAgICAgIGNsYXNzPSJuYXYtc2Nyb2xsLWJ0biINCiAgICAgICAgICAgICAgb25jbGljaz0id2luZG93LnNjcm9sbFRvKHt0b3A6IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjogJ3Ntb290aCd9KSINCiAgICAgICAgICAgICAgdGl0bGU9IkdvIHRvIEJvdHRvbSI+DQogICAgICAgICAg4oaTDQogICAgICA8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gaWQ9ImJ0bkdvVG9wIg0KICAgICAgICAgICAgICBjbGFzcz0ibmF2LXNjcm9sbC1idG4iDQogICAgICAgICAgICAgIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCd9KSINCiAgICAgICAgICAgICAgdGl0bGU9IkdvIHRvIFRvcCI+DQogICAgICAgICAg4oaRDQogICAgICA8L2J1dHRvbj4NCg0KICAgICAgPHNjcmlwdD4NCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuTW9udGhseVN0YXRlbWVudHMoKSB7DQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoIXJhZGlvIHx8IHJhZGlvLnZhbHVlID09PSAiYWxsIikgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IGEgc3BlY2lmaWMgRmluYW5jaWFsIFllYXIgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCBzdGFydFllYXIgPSBwYXJzZUludChyYWRpby52YWx1ZSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBmeUxhYmVsID0gYCR7c3RhcnRZZWFyfS0keyhzdGFydFllYXIgKyAxKS50b1N0cmluZygpLnNsaWNlKC0yKX1gOw0KDQogICAgICAgICAgICAgICAgICAvLyBTaG93IGxvYWRpbmcgb3ZlcmxheQ0KICAgICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nJykgfHwgeyBzdHlsZToge30gfTsNCiAgICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgYWxsUmVjb3JkcyA9IHRleHQuc3BsaXQoJ1xuJykuZmlsdGVyKHIgPT4gci5sZW5ndGggPiAyMCk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHsganNQREYgfSA9IHdpbmRvdy5qc3BkZjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRvYyA9IG5ldyBqc1BERigpOw0KDQogICAgICAgICAgICAgICAgICBsZXQgb3RoZXJNb2RlUmVjZWlwdHMgPSBbXTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgaW50ZXJuYWxQYXJzZURhdGUgPSAoc3RyKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdHIpIHJldHVybiBuZXcgRGF0ZSgwKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gc3RyLnNwbGl0KC9bLS9dLyk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHBbMl0sIHBbMV0gLSAxLCBwWzBdKTsNCiAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGFwcGx5UGFnZVN0eWxlID0gKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGRvYy5zZXRGaWxsQ29sb3IoMjU1LCAyNDQsIDIyOSk7IC8vIExpZ2h0IFNhZmZyb24NCiAgICAgICAgICAgICAgICAgICAgICBkb2MucmVjdCgwLCAwLCAyMTAsIDI5NywgJ0YnKTsNCiAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG1vbnRocyA9IFsNCiAgICAgICAgICAgICAgICAgICAgICB7IG06IDQsIHk6IHN0YXJ0WWVhciwgbmFtZTogIkFwcmlsIiB9LCB7IG06IDUsIHk6IHN0YXJ0WWVhciwgbmFtZTogIk1heSIgfSwNCiAgICAgICAgICAgICAgICAgICAgICB7IG06IDYsIHk6IHN0YXJ0WWVhciwgbmFtZTogIkp1bmUiIH0sIHsgbTogNywgeTogc3RhcnRZZWFyLCBuYW1lOiAiSnVseSIgfSwNCiAgICAgICAgICAgICAgICAgICAgICB7IG06IDgsIHk6IHN0YXJ0WWVhciwgbmFtZTogIkF1Z3VzdCIgfSwgeyBtOiA5LCB5OiBzdGFydFllYXIsIG5hbWU6ICJTZXB0ZW1iZXIiIH0sDQogICAgICAgICAgICAgICAgICAgICAgeyBtOiAxMCwgeTogc3RhcnRZZWFyLCBuYW1lOiAiT2N0b2JlciIgfSwgeyBtOiAxMSwgeTogc3RhcnRZZWFyLCBuYW1lOiAiTm92ZW1iZXIiIH0sDQogICAgICAgICAgICAgICAgICAgICAgeyBtOiAxMiwgeTogc3RhcnRZZWFyLCBuYW1lOiAiRGVjZW1iZXIiIH0sIHsgbTogMSwgeTogc3RhcnRZZWFyICsgMSwgbmFtZTogIkphbnVhcnkiIH0sDQogICAgICAgICAgICAgICAgICAgICAgeyBtOiAyLCB5OiBzdGFydFllYXIgKyAxLCBuYW1lOiAiRmVicnVhcnkiIH0sIHsgbTogMywgeTogc3RhcnRZZWFyICsgMSwgbmFtZTogIk1hcmNoIiB9DQogICAgICAgICAgICAgICAgICBdOw0KDQogICAgICAgICAgICAgICAgICBsZXQgZnlHcmFuZFRvdGFsID0gMDsNCiAgICAgICAgICAgICAgICAgIGxldCBzdW1tYXJ5RGF0YSA9IFtdOw0KICAgICAgICAgICAgICAgICAgbGV0IHBhZ2VDb3VudCA9IDA7DQoNCiAgICAgICAgICAgICAgICAgIG1vbnRocy5mb3JFYWNoKChtb24pID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtb250aGx5UmVjcyA9IGFsbFJlY29yZHMuZmlsdGVyKHIgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkID0gaW50ZXJuYWxQYXJzZURhdGUoZlsxXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FuY2VsbGVkID0gZlsxM10gJiYgZlsxM10udG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoZC5nZXRNb250aCgpICsgMSA9PT0gbW9uLm0pICYmIChkLmdldEZ1bGxZZWFyKCkgPT09IG1vbi55KSAmJiAhaXNDYW5jZWxsZWQ7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobW9udGhseVJlY3MubGVuZ3RoID09PSAwKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICBkb2MuYWRkUGFnZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIHBhZ2VDb3VudCsrOw0KICAgICAgICAgICAgICAgICAgICAgIGFwcGx5UGFnZVN0eWxlKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBIZWFkZXINCiAgICAgICAgICAgICAgICAgICAgICBkb2Muc2V0Rm9udFNpemUoMTYpOyBkb2Muc2V0VGV4dENvbG9yKDEyOCwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoYE1vbnRobHkgRG9uYXRpb24gUmVwb3J0OiBGWSAke2Z5TGFiZWx9YCwgMTA1LCAxNSwgeyBhbGlnbjogImNlbnRlciIgfSk7DQogICAgICAgICAgICAgICAgICAgICAgZG9jLnNldEZvbnRTaXplKDE0KTsNCiAgICAgICAgICAgICAgICAgICAgICBkb2MudGV4dChgJHttb24ubmFtZX0gLSAke21vbi55fWAsIDEwNSwgMjMsIHsgYWxpZ246ICJjZW50ZXIiIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGVUb3RhbHMgPSB7fTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgdG93YXJkc1RvdGFscyA9IHt9Ow0KICAgICAgICAgICAgICAgICAgICAgIGxldCBtb250aFRvdGFsID0gMDsNCg0KICAgICAgICAgICAgICAgICAgICAgIG1vbnRobHlSZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2VpcHRObyA9IGZbMF0gfHwgIk4vQSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGFtdCA9IE1hdGgucm91bmQocGFyc2VGbG9hdChmWzldKSB8fCAwKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbW9kZSA9IChmWzExXSB8fCAiIikudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG93YXJkcyA9IChmWzEyXSB8fCAiIikudHJpbSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZWVkc0F1ZGl0ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhdWRpdFJlYXNvbiA9IFtdOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIE1vZGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtb2RlIHx8IG1vZGUudG9VcHBlckNhc2UoKSA9PT0gIk9USEVSIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmVlZHNBdWRpdCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdWRpdFJlYXNvbi5wdXNoKCJNaXNzaW5nL090aGVyIE1vZGUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGUgPSAiT3RoZXIgKFJldmlldyBSZXEpIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIFRvd2FyZHMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0b3dhcmRzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZWVkc0F1ZGl0ID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1ZGl0UmVhc29uLnB1c2goIk1pc3NpbmcgVG93YXJkcyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG93YXJkcyA9ICJHZW5lcmFsIChSZXZpZXcgUmVxKSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmVlZHNBdWRpdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3RoZXJNb2RlUmVjZWlwdHMucHVzaChgJHtyZWNlaXB0Tm99IHwgJHttb24ubmFtZX0gfCBBbXQ6ICR7YW10fSB8IElzc3VlczogJHthdWRpdFJlYXNvbi5qb2luKCIgJiAiKX1gKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVUb3RhbHNbbW9kZV0gPSAobW9kZVRvdGFsc1ttb2RlXSB8fCAwKSArIGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdG93YXJkc1RvdGFsc1t0b3dhcmRzXSA9ICh0b3dhcmRzVG90YWxzW3Rvd2FyZHNdIHx8IDApICsgYW10Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICBtb250aFRvdGFsICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGZ5R3JhbmRUb3RhbCArPSBtb250aFRvdGFsOw0KICAgICAgICAgICAgICAgICAgICAgIHN1bW1hcnlEYXRhLnB1c2goeyBtb250aDogbW9uLm5hbWUsIHRvdGFsOiBtb250aFRvdGFsIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gVGFibGUgMTogTW9kZXMNCiAgICAgICAgICAgICAgICAgICAgICBkb2MuYXV0b1RhYmxlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRZOiAzMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZDogW1snTW9kZSBvZiBQYXltZW50JywgJ0Ftb3VudCAoUnMuKSddXSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogT2JqZWN0LmVudHJpZXMobW9kZVRvdGFscykubWFwKChbaywgdl0pID0+IFtrLCB2LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Q6IFtbJ01vbnRobHkgVG90YWwnLCBtb250aFRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiAnc3RyaXBlZCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRTdHlsZXM6IHsgZmlsbENvbG9yOiBbMCwgNTEsIDEwMl0gfSwgLy8gTmF2eSBCbHVlDQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RTdHlsZXM6IHsgZmlsbENvbG9yOiBbMTI4LCAwLCAwXSB9ICAvLyBNYXJvb24NCiAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIFRhYmxlIDI6IFRvd2FyZHMNCiAgICAgICAgICAgICAgICAgICAgICBkb2MuYXV0b1RhYmxlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRZOiBkb2MubGFzdEF1dG9UYWJsZS5maW5hbFkgKyAxMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZDogW1snVG93YXJkcyBDYXRlZ29yeScsICdBbW91bnQgKFJzLiknXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IE9iamVjdC5lbnRyaWVzKHRvd2FyZHNUb3RhbHMpLm1hcCgoW2ssIHZdKSA9PiBbaywgdi50b0xvY2FsZVN0cmluZygnZW4tSU4nKV0pLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBmb290OiBbWydNb250aGx5IFRvdGFsJywgbW9udGhUb3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKV1dLA0KICAgICAgICAgICAgICAgICAgICAgICAgICB0aGVtZTogJ3N0cmlwZWQnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkU3R5bGVzOiB7IGZpbGxDb2xvcjogWzQ2LCAxMjUsIDUwXSB9LCAvLyBHcmVlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICBmb290U3R5bGVzOiB7IGZpbGxDb2xvcjogWzEyOCwgMCwgMF0gfQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChwYWdlQ291bnQgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiTm8gZGF0YSBmb3VuZCBmb3IgdGhlIHNlbGVjdGVkIEZpbmFuY2lhbCBZZWFyLiIpOw0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyAtLS0gU1VNTUFSWSBQQUdFIC0tLQ0KICAgICAgICAgICAgICAgICAgICAgIGRvYy5hZGRQYWdlKCk7DQogICAgICAgICAgICAgICAgICAgICAgYXBwbHlQYWdlU3R5bGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICBkb2Muc2V0Rm9udFNpemUoMjApOyBkb2Muc2V0VGV4dENvbG9yKDEyOCwgMCwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoIkFOTlVBTCBTVU1NQVJZIiwgMTA1LCAyNSwgeyBhbGlnbjogImNlbnRlciIgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICBkb2MuYXV0b1RhYmxlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRZOiAzNSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZDogW1snTW9udGgnLCAnVG90YWwgKFJzLiknXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IHN1bW1hcnlEYXRhLm1hcChzID0+IFtzLm1vbnRoLCBzLnRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpXSksDQogICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3Q6IFtbJ0dSQU5EIFRPVEFMJywgZnlHcmFuZFRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpXV0sDQogICAgICAgICAgICAgICAgICAgICAgICAgIHRoZW1lOiAnZ3JpZCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRTdHlsZXM6IHsgZmlsbENvbG9yOiBbMCwgMCwgMF0gfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9vdFN0eWxlczogeyBmaWxsQ29sb3I6IFsxMjgsIDAsIDBdLCBmb250U2l6ZTogMTMgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgZG9jLmRlbGV0ZVBhZ2UoMSk7IC8vIFJlbW92ZSBpbml0aWFsIGJsYW5rIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgICBkb2Muc2F2ZShgTU1QVF9Nb250aGx5X1JlcG9ydF8ke2Z5TGFiZWx9LnBkZmApOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gLS0tIEFVRElUIEZJTEUgLS0tDQogICAgICAgICAgICAgICAgICAgICAgaWYgKG90aGVyTW9kZVJlY2VpcHRzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHR4dCA9IGBNTVBUIEFVRElUIFJFUVVJUkVEIC0gRlkgJHtmeUxhYmVsfVxuPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gYFJFQ0VJUFQgTk8gfCBNT05USCB8IEFNT1VOVCB8IEFVRElUIFJFQVNPTlxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0eHQgKz0gb3RoZXJNb2RlUmVjZWlwdHMuam9pbignXG4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFt0eHRdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5kb3dubG9hZCA9IGBNTVBUX0F1ZGl0X1JlcXVpcmVkXyR7ZnlMYWJlbH0udHh0YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGluay5jbGljaygpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlcnIubWVzc2FnZSk7DQogICAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmcnKSkgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmcnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgPC9zY3JpcHQ+DQogIDwvYm9keT4NCjwvaHRtbD4NCg=="))));</script>