<script>document.write(decodeURIComponent(escape(atob("PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQogIDxoZWFkPg0KICAgIDxtZXRhIGNoYXJzZXQ9IlVURi04IiAvPg0KICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIiAvPg0KICAgIDxtZXRhDQogICAgICBodHRwLWVxdWl2PSJDYWNoZS1Db250cm9sIg0KICAgICAgY29udGVudD0ibm8tY2FjaGUsIG5vLXN0b3JlLCBtdXN0LXJldmFsaWRhdGUiDQogICAgLz4NCiAgICA8bWV0YSBodHRwLWVxdWl2PSJQcmFnbWEiIGNvbnRlbnQ9Im5vLWNhY2hlIiAvPg0KICAgIDxtZXRhIGh0dHAtZXF1aXY9IkV4cGlyZXMiIGNvbnRlbnQ9IjAiIC8+DQoNCiAgICA8dGl0bGU+TU1QVCBEYXRhYmFzZSAtIHYyMC4wPC90aXRsZT4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9jaGFydC5qcyI+PC9zY3JpcHQ+DQogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3hsc3gvMC4xOC41L3hsc3guZnVsbC5taW4uanMiPjwvc2NyaXB0Pg0KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9qc3BkZi8yLjUuMS9qc3BkZi51bWQubWluLmpzIj48L3NjcmlwdD4NCiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvaHRtbDJjYW52YXMvMS40LjEvaHRtbDJjYW52YXMubWluLmpzIj48L3NjcmlwdD4NCg0KDQogICAgPHN0eWxlPg0KDQoNCiAgICAgICAgLyogTmF2aWdhdGlvbiBidXR0b25zIGZpeCAqLw0KICAgICAgICAubmF2LXNjcm9sbC1idG4gew0KICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgcmlnaHQ6IDIwcHg7DQogICAgICAgICAgICB3aWR0aDogNTBweDsNCiAgICAgICAgICAgIGhlaWdodDogNTBweDsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMzMzMgIWltcG9ydGFudDsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgI2ZmZjsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTsNCiAgICAgICAgICAgIGZvbnQtc2l6ZTogMjRweDsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDsgLyogRm9yY2VzIHZpc2liaWxpdHkgKi8NCiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgICAgIHotaW5kZXg6IDk5OTk5OyAvKiBIaWdoZXIgdGhhbiBldmVyeXRoaW5nIGVsc2UgKi8NCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEwcHggcmdiYSgwLDAsMCwwLjUpOw0KICAgICAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMnM7DQogICAgICAgIH0NCg0KICAgICAgICAgICAgLm5hdi1zY3JvbGwtYnRuOmFjdGl2ZSB7DQogICAgICAgICAgICAgICAgdHJhbnNmb3JtOiBzY2FsZSgwLjkpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICNidG5Hb1RvcCB7DQogICAgICAgICAgICBib3R0b206IDkwcHg7DQogICAgICAgIH0NCg0KICAgICAgICAjYnRuR29Cb3R0b20gew0KICAgICAgICAgICAgYm90dG9tOiAzMHB4Ow0KICAgICAgICB9DQoNCg0KICAgICAgICAvKiAtLS0gTmV3IE1hdGNoIFRhYmxlIFN0eWxlcyAtLS0gKi8NCiAgICAgICAgI21hdGNoVGFibGUgew0KICAgICAgICAgICAgdGFibGUtbGF5b3V0OiBmaXhlZDsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAjbWF0Y2hUYWJsZSB0aCwgI21hdGNoVGFibGUgdGQgew0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweCA0cHg7DQogICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgICAgICAgICAgICAgICB3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7DQogICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDsNCiAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvKiBTcGVjaWZpYyBDb2x1bW4gV2lkdGhzOiAxMCUgfCAxNSUgfCA3NSUgKi8NCiAgICAgICAgICAgICAgICAvKiBVcGRhdGVkIHdpZHRoczogQ29sIDE6IDEwJSwgQ29sIDI6IDEwJSwgQ29sIDM6IDgwJSAqLw0KICAgICAgICAgICAgICAgICNtYXRjaFRhYmxlIHRoOm50aC1jaGlsZCgxKSwgI21hdGNoVGFibGUgdGQ6bnRoLWNoaWxkKDEpIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwJSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgI21hdGNoVGFibGUgdGg6bnRoLWNoaWxkKDIpLCAjbWF0Y2hUYWJsZSB0ZDpudGgtY2hpbGQoMikgew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTAlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgI21hdGNoVGFibGUgdGg6bnRoLWNoaWxkKDMpLCAjbWF0Y2hUYWJsZSB0ZDpudGgtY2hpbGQoMykgew0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogODAlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvKiBIZWFkZXIgU3R5bGluZyB3aXRoIHR3by1saW5lIHN1cHBvcnQgKi8NCiAgICAgICAgICAgICNtYXRjaFRhYmxlIHRoIHsNCiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOWZhOw0KICAgICAgICAgICAgICAgIGNvbG9yOiAjMzMzOw0KICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAvKiBEZWJpdC9DcmVkaXQgQ29sb3JzICovDQogICAgICAgIC5hbXQtZGViaXQgew0KICAgICAgICAgICAgY29sb3I6ICNGRjAwMDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQoNCiAgICAgICAgLmFtdC1jcmVkaXQgew0KICAgICAgICAgICAgY29sb3I6ICMwMDY0MDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQoNCg0KDQoNCiAgICAgICAgLyogU3R5bGUgZm9yIHRoZSBuZXcgUXVpdCBCdXR0b24gKi8NCiAgICAgICAgLnF1aXQtYnRuIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmZjQ0NDQgIWltcG9ydGFudDsNCiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBwYWRkaW5nOiA4cHggMTVweDsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDE1cHg7DQogICAgICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7DQogICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOw0KICAgICAgICB9DQoNCiAgICAgICAgICAgIC5xdWl0LWJ0bjpob3ZlciB7DQogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogI2NjMDAwMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAucXVpdC1idG46ZGlzYWJsZWQgew0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICM5OTkgIWltcG9ydGFudDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAuYW5vbnktbWFpbi1yb3cgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0UxQkVFNyAhaW1wb3J0YW50OyAvKiBQdXJwbGUgZm9yIGN1cnJlbnQgeWVhciB0YXJnZXQgKi8NCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQoNCiAgICAgICAgLm1hdGNoLXJlc3VsdC1yb3cgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsgLyogV2hpdGUgZm9yIGhpc3RvcmljYWwgbWF0Y2hlcyAqLw0KICAgICAgICB9DQoNCiAgICAgICAgLnNwYWNlci1yb3cgew0KICAgICAgICAgICAgaGVpZ2h0OiAxNXB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjBmMDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5hbm9ueS1tYWluLXJvdyB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTFCRUU3ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5tYXRjaC1yZXN1bHQtcm93IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7DQogICAgICAgIH0NCg0KICAgICAgICAuYnRuLXJvdzUgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0UxQkVFNyAhaW1wb3J0YW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgLyogSGlnaGxpZ2h0IHRoZSBBbm9ueW1vdXMgcmVjb3JkIGJlaW5nIG1hdGNoZWQgKi8NCiAgICAgICAgLmFub255LW1haW4tcm93IHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY5YzQgIWltcG9ydGFudDsgLyogQ2hhbmdlIHRvIFllbGxvdyAqLzsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICB9DQogICAgICAgIC8qIFN0eWxlIGZvciBzZWFyY2ggcmVzdWx0IHJvd3MgKi8NCiAgICAgICAgLm1hdGNoLXJlc3VsdC1yb3cgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTsNCiAgICAgICAgfQ0KDQogICAgICAjZGV0YWlsZWRSZXN1bHRzIHRhYmxlIHsNCiAgICAgICAgICB0YWJsZS1sYXlvdXQ6IGZpeGVkOyAvKiBLZWVwcyBjb2x1bW5zIGFsaWduZWQgYWNyb3NzIHRhYmxlcyAqLw0KICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQogICAgICAgICAgd29yZC13cmFwOiBicmVhay13b3JkOyAvKiBGb3JjZXMgbG9uZyB0ZXh0IHRvIGJyZWFrICovDQogICAgICB9DQoNCiAgICAgIC8qIERlZmluZSBzcGVjaWZpYyB3aWR0aHMgZm9yIGVhY2ggY29sdW1uICovDQogICAgICAjZGV0YWlsZWRSZXN1bHRzIHRoOm50aC1jaGlsZCgxKSwgI2RldGFpbGVkUmVzdWx0cyB0ZDpudGgtY2hpbGQoMSkgeyB3aWR0aDogMTglOyB9IC8qIFJlY2VpcHQgKi8NCiAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDIpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCgyKSB7IHdpZHRoOiAxOCU7IH0gLyogRGF0ZSAqLw0KICAgICAgI2RldGFpbGVkUmVzdWx0cyB0aDpudGgtY2hpbGQoMyksICNkZXRhaWxlZFJlc3VsdHMgdGQ6bnRoLWNoaWxkKDMpIHsgd2lkdGg6IDIyJTsgfSAvKiBBbW91bnQgKi8NCiAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDQpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCg0KSB7IHdpZHRoOiA0MiU7IH0gLyogUmVmZXJlbmNlICovDQoNCiAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGQsICNkZXRhaWxlZFJlc3VsdHMgdGggew0KICAgICAgICAgIHBhZGRpbmc6IDhweCA0cHg7DQogICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDsgICAgLyogS2VlcHMgdGV4dCBhbGlnbmVkIHRvIHRoZSB0b3AgaWYgYSBuZWlnaGJvciB3cmFwcyAqLw0KICAgICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7IC8qIEFsbG93cyBicmVha2luZyBsb25nIHN0cmluZ3MgbGlrZSBVUEkgSURzICovDQogICAgICAgICAgd2hpdGUtc3BhY2U6IG5vcm1hbDsgICAgLyogRklYRUQ6IEFsbG93cyB0ZXh0IHRvIGZsb3cgdG8gdGhlIG5leHQgbGluZSAqLw0KICAgICAgICAgIG92ZXJmbG93OiB2aXNpYmxlOyAgICAgIC8qIEZJWEVEOiBObyBtb3JlIGN1dHRpbmcgb2ZmIHRleHQgKi8NCiAgICAgIH0NCg0KICAgICAgLyogU3BlY2lmaWMgZml4IGZvciBBbW91bnQgY29sdW1uIHRvIGtlZXAgY3VycmVuY3kgc3ltYm9scyB0b2dldGhlciAqLw0KICAgICAgI2RldGFpbGVkUmVzdWx0cyB0ZDpudGgtY2hpbGQoMykgew0KICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICB9DQoNCiAgICAgICAgICAgICAgOnJvb3Qgew0KICAgICAgICAgICAgICAgICAgLS1wcmltYXJ5LWJsdWU6ICMwMDAwOEI7DQogICAgICAgICAgICAgICAgICAtLWJnLXNhZmZyb246ICNGRkQ1ODA7DQogICAgICAgICAgICAgICAgICAtLXdoaXRlOiAjZmZmZmZmOw0KICAgICAgICAgICAgICAgICAgLS1jYW5jZWwtcmVkOiAjZmYwMDAwOw0KICAgICAgICAgICAgICAgICAgLS1ndy1ncmVlbjogIzAwNjQwMDsNCiAgICAgICAgICAgICAgICAgIC0tcm95YWwtYmx1ZTogIzAwMjM2NjsNCiAgICAgICAgICAgICAgICAgIC0tZ29sZDogI0ZGRDcwMDsNCiAgICAgICAgICAgICAgICAgIC0tZGFyay10ZXh0OiAjMWExYTFhOw0KICAgICAgICAgICAgICAgICAgLS12aWJyYW50LWJsdWU6ICMwMDMzY2M7DQogICAgICAgICAgICAgICAgICAtLWxvYW4tZ3JlZW46ICMwMDY0MDA7DQogICAgICAgICAgICAgICAgICAtLWRlcG9zaXQtcHVycGxlOiAjNEIwMDgyOw0KICAgICAgICAgICAgICAgICAgLS1leGVtcHQtZ3JheTogIzU1NTU1NTsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgIGJvZHkgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmctc2FmZnJvbik7DQogICAgICAgICAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgICAgICAgICAgIG1hcmdpbjogMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgfQ0KDQogICAgICAgICAgICAgICNsb2dpbk92ZXJsYXkgew0KICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgICAgICAgdG9wOiAwOw0KICAgICAgICAgICAgICAgICAgbGVmdDogMDsNCiAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tYmctc2FmZnJvbik7DQogICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgICAgICAgIHotaW5kZXg6IDIwMDA7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAubG9naW4tYm94IHsNCiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXdoaXRlKTsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDI1cHg7DQogICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAxNXB4Ow0KICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAxMHB4IDI1cHggcmdiYSgwLDAsMCwwLjIpOw0KICAgICAgICAgICAgICAgICAgd2lkdGg6IDI4MHB4Ow0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLmxvZ2luLWJveCBpbWcgew0KICAgICAgICAgICAgICAgICAgd2lkdGg6IDgwcHg7DQogICAgICAgICAgICAgICAgICBoZWlnaHQ6IDgwcHg7DQogICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMTVweDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICNtYWluQ29udGVudCB7DQogICAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgLmRhc2gtdGFibGUgew0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBtYXgtd2lkdGg6IDYwMHB4Ow0KICAgICAgICAgICAgbWFyZ2luOiAwIGF1dG8gNXB4IGF1dG87IC8qIFJlZHVjZWQgYm90dG9tIG1hcmdpbiBmcm9tIDE1cHggdG8gNXB4ICovDQogICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsgLyogU2xpZ2h0bHkgdGlnaHRlciBjb3JuZXJzICovDQogICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IHNlcGFyYXRlOw0KICAgICAgICAgICAgYm9yZGVyLXNwYWNpbmc6IDA7DQogICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgICAgICAgZm9udC1zaXplOiAwLjgwcmVtOyAvKiBTbGlnaHRseSBzbWFsbGVyIGZvbnQgKi8NCiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjE1KTsNCiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7DQogICAgICAgIH0NCg0KICAgICAgICAgICAgLmRhc2gtdGFibGUgdGQgew0KICAgICAgICAgICAgICAgIHBhZGRpbmc6IDRweCAxMnB4OyAvKiBSZWR1Y2VkIHZlcnRpY2FsIHBhZGRpbmcgZnJvbSA2cHggdG8gNHB4ICovDQogICAgICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAgIC5kYXNoLWxhYmVsIHsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA4MDA7DQogICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tZGFyay10ZXh0KTsNCiAgICAgICAgICAgICAgICAgIHdpZHRoOiA0MiU7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZjFmMWYxOw0KICAgICAgICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1yaWdodDogMnB4IHNvbGlkICNkZGQ7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuZGFzaC12YWwgew0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDgwMDsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS12aWJyYW50LWJsdWUpOw0KICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogcmlnaHQ7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuZGFzaC10YWJsZSB0cjpsYXN0LWNoaWxkIHRkIHsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1ib3R0b206IG5vbmU7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAjbG9hZGluZ01zZyB7DQogICAgICAgICAgICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOw0KICAgICAgICAgICAgICAgICAgdG9wOiA1MCU7DQogICAgICAgICAgICAgICAgICBsZWZ0OiA1MCU7DQogICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsNCiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwwLDEzOSwwLjkpOw0KICAgICAgICAgICAgICAgICAgY29sb3I6IHdoaXRlOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMjBweCA0MHB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgICAgICAgICAgICAgICAgIHotaW5kZXg6IDMwMDA7DQogICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5zZWFyY2gtYXJlYSB7DQogICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0td2hpdGUpOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuZmlsdGVyLWdyb3VwIHsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEycHg7DQogICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgICAgICAgZmxleC13cmFwOiB3cmFwOw0KICAgICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgICAgICAgICBnYXA6IDhweDsNCiAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5maWx0ZXItZ3JvdXAgbGFiZWwgew0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogI2YwZjBmMDsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDVweCAxMHB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4Ow0KICAgICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5maWx0ZXItZ3JvdXAgbGFiZWw6aGFzKGlucHV0OmNoZWNrZWQpIHsNCiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICNlMGUwZmY7DQogICAgICAgICAgICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBpbnB1dFt0eXBlPSJ0ZXh0Il0sIGlucHV0W3R5cGU9InBhc3N3b3JkIl0gew0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTBweDsNCiAgICAgICAgICAgICAgICAgIHdpZHRoOiA4NSU7DQogICAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDMwMHB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBidXR0b24gew0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTBweCAxNXB4Ow0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS13aGl0ZSk7DQogICAgICAgICAgICAgICAgICBib3JkZXI6IG5vbmU7DQogICAgICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbjogMnB4Ow0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgI3V0aWxpdGllc01lbnUgew0KICAgICAgICAgICAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICAgICAgICAgICAgICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogcmVwZWF0KDMsIDFmcik7DQogICAgICAgICAgICAgICAgICBnYXA6IDhweDsNCiAgICAgICAgICAgICAgICAgIGp1c3RpZnktaXRlbXM6IHN0cmV0Y2g7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAudXRpbC1tZW51LWJ0biB7DQogICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzJyZW07DQogICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDJweDsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgICAgICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgICAgICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOw0KICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgICAgICAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICM5OTk7DQogICAgICAgICAgICAgIH0NCg0KDQogICAgICAgIC5idG4tcm93MSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjQUREOEU2ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCg0KICAgICAgICAuYnRuLXJvdzIgew0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzkwRUU5MCAhaW1wb3J0YW50Ow0KICAgICAgICB9DQoNCiAgICAgICAgLmJ0bi1yb3czIHsNCiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkEwN0EgIWltcG9ydGFudDsNCiAgICAgICAgfQ0KDQogICAgICAgIC5idG4tcm93NCB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkZGOUM0ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCiAgICAgICAgLyogWWVsbG93ICovDQogICAgICAgIC5idG4tcm93NSB7DQogICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTFCRUU3ICFpbXBvcnRhbnQ7DQogICAgICAgIH0NCiAgICAgICAgLyogUHVycGxlICovDQoNCiAgICAgICAgICAgICAgLmJ0bi13YSB7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjVEMzY2ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICBjb2xvcjogI2ZmZiAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDY1MHB4Ow0KICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICAgICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IGF1dG87DQogICAgICAgICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IGF1dG87DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuYnRuLXJvdGF0ZSB7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNmM3NTdkICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogNjUwcHg7DQogICAgICAgICAgICAgICAgICBtYXJnaW46IDVweCBhdXRvOw0KICAgICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBtYXJrIHsgYmFja2dyb3VuZC1jb2xvcjogeWVsbG93OyBjb2xvcjogYmxhY2s7IGZvbnQtd2VpZ2h0OiBib2xkOyB9DQoNCiAgICAgICAgICAgICAgLmNhbmNlbGxlZC1yb3csIC5jYW5jZWxsZWQtcm93IHRkIHsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1jYW5jZWwtcmVkKSAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5ndy1yb3cgew0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tZ3ctZ3JlZW4pICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0td2hpdGUpICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuZ3ctcm93IC5yY3B0LWxpbmsgeyBjb2xvcjogIzkwRUU5MCAhaW1wb3J0YW50OyB9DQoNCiAgICAgICAgICAgICAgLnJjcHQtbGluayB7DQogICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOw0KICAgICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAubGF0ZXN0LWFkZHItYm94IHsNCiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmZmZkZTc7DQogICAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjZmJjMDJkOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTJweDsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDE1cHg7DQogICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMS40Ow0KICAgICAgICAgICAgICAgICAgY29sb3I6ICMzMzM7DQogICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLmxhdGVzdC1hZGRyLWhlYWRlciB7DQogICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAxcmVtOw0KICAgICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogNXB4Ow0KICAgICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAucGVuZGluZy1jb25zZW50LWxpbmUgew0KICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogOHB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyLXRvcDogMXB4IGRhc2hlZCAjY2NjOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZy10b3A6IDVweDsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1jYW5jZWwtcmVkKTsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLmNvbnNlbnQtZnktYmx1ZSB7IGNvbG9yOiB2YXIoLS1yb3lhbC1ibHVlKTsgZm9udC13ZWlnaHQ6IGJvbGQ7IH0NCg0KICAgICAgICAgICAgICAudGFibGUtd3JhcCB7DQogICAgICAgICAgICAgICAgICBvdmVyZmxvdy14OiBhdXRvOw0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0td2hpdGUpOw0KICAgICAgICAgICAgICAgICAgbWFyZ2luOiAxMHB4IDA7DQogICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICB0YWJsZSB7DQogICAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQogICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzVyZW07DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICB0aCwgdGQgew0KICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweDsNCiAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGxlZnQ7DQogICAgICAgICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgdGggew0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1ibHVlKTsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiAjZmZmOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLmFtdC1jcmVkaXQgeyBjb2xvcjogIzAwMDBGRjsgZm9udC13ZWlnaHQ6IGJvbGQ7IHRleHQtYWxpZ246IHJpZ2h0OyB9DQogICAgICAgICAgICAgIC5hbXQtZGViaXQgeyBjb2xvcjogI0ZGMDAwMDsgZm9udC13ZWlnaHQ6IGJvbGQ7IHRleHQtYWxpZ246IHJpZ2h0OyB9DQogICAgICAgICAgICAgIC5iYW5rLXRpdGxlIHsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICAgICAgICBtYXJnaW46IDEwcHggMDsNCiAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMS4xcmVtOw0KICAgICAgICAgICAgICB9DQoNCg0KDQogICAgICAvKiBDb250YWluZXIgZm9yIGVhY2ggc2VhcmNoIHJlc3VsdCBjYXJkICovDQogICAgICAucmVjb3JkIHsNCiAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjOw0KICAgICAgICAgIHBhZGRpbmc6IDE1cHg7DQogICAgICAgICAgbWFyZ2luOiAxMHB4IDVweDsNCiAgICAgICAgICBib3JkZXItcmFkaXVzOiA4cHg7DQogICAgICAgICAgYm94LXNoYWRvdzogMCAycHggNXB4IHJnYmEoMCwwLDAsMC4xKTsNCiAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7IC8qIEluZGljYXRlcyBpdCBjYW4gYmUgY2xpY2tlZCAqLw0KICAgICAgfQ0KDQogICAgICAuZmllbGQtcm93IHsNCiAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsNCiAgICAgICAgICBwYWRkaW5nOiA1cHggMDsNCiAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2VlZTsNCiAgICAgIH0NCg0KICAgICAgLmZpZWxkLWhlYWRlciB7DQogICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgY29sb3I6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgbWluLXdpZHRoOiAxNDBweDsNCiAgICAgICAgICBmbGV4LXNocmluazogMDsNCiAgICAgIH0NCg0KICAgICAgLyogTW9iaWxlIFNwZWNpZmljOiBIaWRlIG5vbi1lc3NlbnRpYWwgZmllbGRzIGJ5IGRlZmF1bHQgKi8NCiAgICAgIEBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDYwMHB4KSB7DQogICAgICAgICAgLmZpZWxkLXJvdyB7DQogICAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0Ow0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qIEhpZGUgYWxsIHJvd3MgZXhjZXB0IHRoZSBmaXJzdCAzIChSZWNlaXB0LCBEYXRlLCBOYW1lLCBBbW91bnQpIG9uIG1vYmlsZSAqLw0KICAgICAgICAgIC5yZWNvcmQuY29sbGFwc2VkIC5maWVsZC1yb3c6bnRoLWNoaWxkKG4rNSkgew0KICAgICAgICAgICAgICBkaXNwbGF5OiBub25lOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qIEFkZCBhICJUYXAgdG8gc2VlIG1vcmUiIGluZGljYXRvciAqLw0KICAgICAgICAgIC5yZWNvcmQuY29sbGFwc2VkOjphZnRlciB7DQogICAgICAgICAgICAgIGNvbnRlbnQ6ICLilrwgVGFwIHRvIHNob3cgZGV0YWlscyI7DQogICAgICAgICAgICAgIGRpc3BsYXk6IGJsb2NrOw0KICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsNCiAgICAgICAgICAgICAgY29sb3I6ICM4ODg7DQogICAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLnJlY29yZC5leHBhbmRlZDo6YWZ0ZXIgew0KICAgICAgICAgICAgICBjb250ZW50OiAi4payIFRhcCB0byBoaWRlIGRldGFpbHMiOw0KICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jazsNCiAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgICBmb250LXNpemU6IDAuNzVyZW07DQogICAgICAgICAgICAgIGNvbG9yOiAjODg4Ow0KICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAxMHB4Ow0KICAgICAgICAgIH0NCiAgICAgIH0NCg0KDQogICAgICAgICAgICAgIC5yZWNlaXB0LXZpZXdwb3J0IHsNCiAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiBhdXRvOw0KICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgICAgICAgICAgIC13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOiB0b3VjaDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5yZWNlaXB0LWNvbnRhaW5lciB7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7DQogICAgICAgICAgICAgICAgICB3aWR0aDogNjUwcHg7DQogICAgICAgICAgICAgICAgICBtaW4td2lkdGg6IDY1MHB4Ow0KICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuM3MgZWFzZTsNCiAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybS1vcmlnaW46IGNlbnRlcjsNCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICAgICAgICAgICAgICAgIHotaW5kZXg6IDEwOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLnJlY2VpcHQtaHRtbCB7DQogICAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgICAgICAgIGZvbnQtZmFtaWx5OiAiVGltZXMgTmV3IFJvbWFuIiwgc2VyaWY7DQogICAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjMDAwOw0KICAgICAgICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiAjMDAwOw0KICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgICAgICAgICAgei1pbmRleDogMjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5yZWNlaXB0LWh0bWwgdGQgew0KICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzAwMDsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDZweCAxMHB4Ow0KICAgICAgICAgICAgICAgICAgdmVydGljYWwtYWxpZ246IHRvcDsNCiAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMXJlbTsNCiAgICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjI7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAucm90YXRlZCB7IHRyYW5zZm9ybTogcm90YXRlKDkwZGVnKSBzY2FsZSgwLjc1KTsgbWFyZ2luOiAwOyB9DQogICAgICAgICAgICAgIC5zcy1zcGFjZXIgeyBoZWlnaHQ6IDA7IHdpZHRoOiAxMDAlOyB0cmFuc2l0aW9uOiBoZWlnaHQgMC4zcyBlYXNlOyB9DQogICAgICAgICAgICAgIC5zcy1zcGFjZXIuYWN0aXZlIHsgaGVpZ2h0OiAyNTBweDsgfQ0KDQogICAgICAgICAgICAgIC53YXRlcm1hcmsgew0KICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICAgICAgICAgICAgdG9wOiA1MCU7DQogICAgICAgICAgICAgICAgICBsZWZ0OiA1MCU7DQogICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSByb3RhdGUoLTMwZGVnKTsNCiAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogODBweDsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiByZ2JhKDAsIDAsIDEzOSwgMC4yKTsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICAgICAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgICAgICAgICAgICAgICAgei1pbmRleDogNTsNCiAgICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgICAgICAgICAgICBib3JkZXI6IDEwcHggc29saWQgcmdiYSgwLCAwLCAxMzksIDAuMik7DQogICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTVweDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5zdW0tdGFibGUgew0KICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAwLjhyZW07DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgICAgICAgICAgICAgICB0YWJsZS1sYXlvdXQ6IGZpeGVkOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLnN1bS10YWJsZSB0aCB7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZDNkM2QzOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogOHB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzg4ODsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiAjMDAwOw0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuc3VtLXRhYmxlIHRoOm50aC1jaGlsZCgxKSwgLnN1bS10YWJsZSB0ZDpudGgtY2hpbGQoMSkgeyB3aWR0aDogNDAlOyB9DQogICAgICAgICAgICAgIC5zdW0tdGFibGUgdGg6bnRoLWNoaWxkKDIpLCAuc3VtLXRhYmxlIHRkOm50aC1jaGlsZCgyKSB7IHdpZHRoOiAyNSU7IHRleHQtYWxpZ246IGNlbnRlcjsgfQ0KICAgICAgICAgICAgICAuc3VtLXRhYmxlIHRoOm50aC1jaGlsZCgzKSwgLnN1bS10YWJsZSB0ZDpudGgtY2hpbGQoMykgeyB3aWR0aDogMzUlOyB0ZXh0LWFsaWduOiByaWdodDsgfQ0KDQogICAgICAgICAgICAgIC5zZWN0aW9uLWhkciB7IGZvbnQtd2VpZ2h0OiBib2xkOyBiYWNrZ3JvdW5kOiAjZjlmOWY5OyBjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKTsgdGV4dC1hbGlnbjogbGVmdDsgfQ0KDQogICAgICAgICAgICAgIC5jaGFydC13cmFwcGVyIHsgZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgYWxpZ24taXRlbXM6IGNlbnRlcjsgd2lkdGg6IDEwMCU7IH0NCiAgICAgICAgICAgICAgLmNoYXJ0LWNvbnRhaW5lciB7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDE1cHg7DQogICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxNXB4Ow0KICAgICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgICAgICAgICAgICAgICAgIGhlaWdodDogMzIwcHg7DQogICAgICAgICAgICAgICAgICB3aWR0aDogOTUlOw0KICAgICAgICAgICAgICAgICAgbWF4LXdpZHRoOiA1MDBweDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICNzZWFyY2hTdW1tYXJ5QmFyIHsNCiAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgICAgICAgICAgICAgIGJvdHRvbTogMDsNCiAgICAgICAgICAgICAgICAgIGxlZnQ6IDA7DQogICAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0td2hpdGUpOw0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTVweDsNCiAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICAgICAgei1pbmRleDogOTk5Ow0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLmNhc2gtc3VtLWJveCB7DQogICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1iZy1zYWZmcm9uKTsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDEwcHg7DQogICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7DQogICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuZXhlYy1zdW1tYXJ5IHsNCiAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgICAgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgICAgICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAuZXhlYy1zdW1tYXJ5IHRoIHsNCiAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLXByaW1hcnktYmx1ZSk7DQogICAgICAgICAgICAgICAgICBjb2xvcjogd2hpdGU7DQogICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMHB4Ow0KICAgICAgICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC43NXJlbTsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5leGVjLXN1bW1hcnkgdGQgew0KICAgICAgICAgICAgICAgICAgcGFkZGluZzogMTBweDsNCiAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI2RkZDsNCiAgICAgICAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NXJlbTsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC5leHAtYmFyIHsNCiAgICAgICAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsNCiAgICAgICAgICAgICAgICAgIHBhZGRpbmc6IDhweDsNCiAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAgICAgICAgICAgICAgIG1hcmdpbjogMTBweCAwOw0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgICAgICAgICBmb250LXNpemU6IDAuODVyZW07DQogICAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgLm1haW4tYmFyIHsgYmFja2dyb3VuZDogdmFyKC0tcHJpbWFyeS1ibHVlKTsgfQ0KICAgICAgICAgICAgICAuZGVwb3NpdC1iYXIgeyBiYWNrZ3JvdW5kOiB2YXIoLS1kZXBvc2l0LXB1cnBsZSk7IH0NCiAgICAgICAgICAgICAgLmxvYW4tYmFyIHsgYmFja2dyb3VuZDogdmFyKC0tbG9hbi1ncmVlbik7IH0NCiAgICAgICAgICAgICAgLmV4ZW1wdC1iYXIgeyBiYWNrZ3JvdW5kOiB2YXIoLS1leGVtcHQtZ3JheSk7IH0NCg0KICAgICAgICAgICAgICAuYW10IHsgZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiAjQjIyMjIyOyB0ZXh0LWFsaWduOiByaWdodDsgfQ0KICAgICAgICAgICAgICAudmVyc2lvbi1sYWJlbCB7IGNvbG9yOiB2YXIoLS1yb3lhbC1ibHVlKTsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc2l6ZTogMC45cmVtOyBtYXJnaW4tdG9wOiA1cHg7IGRpc3BsYXk6IGJsb2NrOyB9DQoNCiAgICAgICAgICAgICAgLnRvdGFsLWhpZ2hsaWdodC1yb3cgew0KICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0ZGRkYwMCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICMwMDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIC50b3RhbC1oaWdobGlnaHQtcm93IHRkIHsgY29sb3I6ICMwMDAgIWltcG9ydGFudDsgfQ0KICAgICAgICAgICAgICAudG90YWwtaGlnaGxpZ2h0LXJvdyAuYW10IHsgY29sb3I6ICNCMjIyMjIgIWltcG9ydGFudDsgfQ0KDQogICAgICAgICAgICAgIC5wcm9maXQtdGV4dCB7IGNvbG9yOiB2YXIoLS1ndy1ncmVlbik7IGZvbnQtd2VpZ2h0OiBib2xkOyBmb250LXNpemU6IDEuMXJlbTsgbWFyZ2luOiAxNXB4IDA7IH0NCiAgICAgICAgICAgICAgLmxvc3MtdGV4dCB7IGNvbG9yOiB2YXIoLS1jYW5jZWwtcmVkKTsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc2l6ZTogMS4xcmVtOyBtYXJnaW46IDE1cHggMDsgfQ0KDQogICAgICAJLyogRmxvYXRpbmcgTmF2aWdhdGlvbiBCdXR0b25zIC0gSW1wcm92ZWQgZm9yIE1vYmlsZSAqLw0KICAgICAgCS5uYXYtc2Nyb2xsLWJ0biB7DQogICAgICAJICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgIAkgICAgcmlnaHQ6IDIwcHg7IC8qIERlZmF1bHQgZm9yIERlc2t0b3AgKi8NCiAgICAgIAkgICAgd2lkdGg6IDUwcHg7DQogICAgICAJICAgIGhlaWdodDogNTBweDsNCiAgICAgIAkgICAgYm9yZGVyLXJhZGl1czogNTAlOw0KICAgICAgCSAgICBiYWNrZ3JvdW5kOiB2YXIoLS1wcmltYXJ5LWJsdWUpOw0KICAgICAgCSAgICBjb2xvcjogd2hpdGU7DQogICAgICAJICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWdvbGQpOw0KICAgICAgCSAgICBjdXJzb3I6IHBvaW50ZXI7DQogICAgICAJICAgIGZvbnQtc2l6ZTogMjRweDsNCiAgICAgIAkgICAgZGlzcGxheTogbm9uZTsgLyogSGlkZGVuIGJ5IGRlZmF1bHQgKi8NCiAgICAgIAkgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgIAkgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAJICAgIHotaW5kZXg6IDk5OTk7IC8qIEVuc3VyZSBpdCdzIGFib3ZlIGV2ZXJ5dGhpbmcgKi8NCiAgICAgIAkgICAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuNCk7DQogICAgICAJICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzOw0KICAgICAgCSAgICB0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjsgLyogUHJldmVudHMgem9vbWluZyBvbiBmYXN0IHRhcHMgKi8NCiAgICAgIAl9DQoNCiAgICAgIAkjYnRuR29Cb3R0b20geyBib3R0b206IDkwcHg7IH0NCiAgICAgIAkjYnRuR29Ub3AgeyBib3R0b206IDI1cHg7IH0NCg0KICAgICAgCS8qIE1vYmlsZS1TcGVjaWZpYyBBZGp1c3RtZW50cyAqLw0KICAgICAgCUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6IDYwMHB4KSB7DQogICAgICAJICAgIC5uYXYtc2Nyb2xsLWJ0biB7DQogICAgICAgICAgICAgIAlyaWdodDogMTVweDsgLyogUHVsbCBpbiBzbGlnaHRseSAqLw0KICAgICAgCSAgICAgICAgd2lkdGg6IDU1cHg7ICAvKiBNYWtlIHNsaWdodGx5IGJpZ2dlciBmb3IgdGh1bWJzICovDQogICAgICAgICAgICAgIAloZWlnaHQ6IDU1cHg7DQogICAgICAJICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDEzOSwgMC44KTsgLyogU2xpZ2h0IHRyYW5zcGFyZW5jeSBzbyB5b3UgY2FuIHNlZSB0ZXh0IGJlaGluZCBpdCAqLw0KICAgICAgCSAgICAgICAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCk7IC8qIE1vZGVybiBibHVyIGVmZmVjdCAqLw0KICAgICAgCSAgICB9DQoNCiAgICAgIAkgICAgI2J0bkdvQm90dG9tIHsgYm90dG9tOiAxMDBweDsgfQ0KICAgICAgCSAgICAjYnRuR29Ub3AgeyBib3R0b206IDMwcHg7IH0NCiAgICAgIAl9DQoNCg0KICAgICAgICAvKiBGT1JDRSBXUkFQUElORyBJTiBBTk9OWU1BVENIIFRBQkxFICovDQogICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGFibGUgew0KICAgICAgICAgICAgdGFibGUtbGF5b3V0OiBmaXhlZCAhaW1wb3J0YW50OyAvKiBBYnNvbHV0ZSBtdXN0OiBmb3JjZXMgY29sdW1ucyB0byBzdGF5IGluIHRoZWlyICUgd2lkdGggKi8NCiAgICAgICAgICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0ZCwNCiAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0aCB7DQogICAgICAgICAgICAvKiBUaGVzZSB0aHJlZSBsaW5lcyB0b2dldGhlciBraWxsIHRoZSBvdmVyZmxvdyAqLw0KICAgICAgICAgICAgd29yZC1icmVhazogYnJlYWstYWxsICFpbXBvcnRhbnQ7DQogICAgICAgICAgICBvdmVyZmxvdy13cmFwOiBicmVhay13b3JkICFpbXBvcnRhbnQ7DQogICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm9ybWFsICFpbXBvcnRhbnQ7DQogICAgICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wOw0KICAgICAgICAgICAgcGFkZGluZzogNXB4Ow0KICAgICAgICAgICAgZm9udC1zaXplOiAwLjhyZW07IC8qIFNsaWdodGx5IHNtYWxsZXIgZm9udCBoZWxwcyBtb2JpbGUgZml0ICovDQogICAgICAgIH0NCg0KICAgICAgICAgICAgLyogU3BlY2lmaWMgY29sdW1uIHdpZHRoIGNvbnRyb2wgdG8gZW5zdXJlIGJhbGFuY2UgKi8NCiAgICAgICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDEpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCgxKSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDIwJTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8qIFJlY2VpcHQgKi8NCiAgICAgICAgICAgICNkZXRhaWxlZFJlc3VsdHMgdGg6bnRoLWNoaWxkKDIpLCAjZGV0YWlsZWRSZXN1bHRzIHRkOm50aC1jaGlsZCgyKSB7DQogICAgICAgICAgICAgICAgd2lkdGg6IDE1JTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC8qIEFtb3VudCAqLw0KICAgICAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0aDpudGgtY2hpbGQoMyksICNkZXRhaWxlZFJlc3VsdHMgdGQ6bnRoLWNoaWxkKDMpIHsNCiAgICAgICAgICAgICAgICB3aWR0aDogMzMlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLyogRGV0YWlscyAqLw0KICAgICAgICAgICAgI2RldGFpbGVkUmVzdWx0cyB0aDpudGgtY2hpbGQoNCksICNkZXRhaWxlZFJlc3VsdHMgdGQ6bnRoLWNoaWxkKDQpIHsNCiAgICAgICAgICAgICAgICB3aWR0aDogMzIlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAvKiBSZWZlcmVuY2UgKi8NCiAgICA8L3N0eWxlPg0KICA8L2hlYWQ+DQogIDxib2R5IG9ubG9hZD0iY2hlY2tEZXZpY2VBdXRoKCkiPg0KDQogICAgICA8YnV0dG9uIGlkPSJidG5Hb1RvcCIgY2xhc3M9Im5hdi1zY3JvbGwtYnRuIiBvbmNsaWNrPSJ3aW5kb3cuc2Nyb2xsVG8oe3RvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnfSkiPuKWsjwvYnV0dG9uPg0KICAgICAgPGJ1dHRvbiBpZD0iYnRuR29Cb3R0b20iIGNsYXNzPSJuYXYtc2Nyb2xsLWJ0biIgb25jbGljaz0id2luZG93LnNjcm9sbFRvKHt0b3A6IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjogJ3Ntb290aCd9KSI+4pa8PC9idXR0b24+DQoNCiAgICAgIDxhdWRpbyBpZD0iYmdNdXNpYyIgbG9vcD4NCiAgICAgICAgICA8c291cmNlIHNyYz0iaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS8xd2lyaHp3YXF1eno2dXNocWp1YzQvSmF5YUpheWEubXAzP3Jsa2V5PXViZmdtazR3dHZvMG90aGpscnhubnQydmwmZGw9MSIgdHlwZT0iYXVkaW8vbXBlZyI+DQogICAgICA8L2F1ZGlvPg0KDQogICAgICA8ZGl2IGlkPSJsb2FkaW5nTXNnIj5QbGVhc2Ugd2FpdCAtIFdvcmtpbmcgb24geW91ciByZXF1ZXN0Li4uPC9kaXY+DQoNCiAgICAgIDxkaXYgaWQ9ImxvZ2luT3ZlcmxheSI+DQogICAgICAgICAgPGRpdiBjbGFzcz0ibG9naW4tYm94Ij4NCiAgICAgICAgICAgICAgPGltZyBzcmM9Imh0dHBzOi8vd3d3LmdhbmVzYXNhcm1hLmNvbS9QZXJpeWF2YS5qcGciIGFsdD0iUGVyaXlhdmEiIC8+DQogICAgICAgICAgICAgIDxoMz5NTVBUIERhdGFiYXNlIEF1dGhvcml6YXRpb248L2gzPg0KICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0idmVyc2lvbi1sYWJlbCI+VmVyc2lvbjogMjAuMDwvc3Bhbj4NCiAgICAgICAgICAgICAgPGRpdiBpZD0iYXV0aFN0YXR1cyI+Q2hlY2tpbmcgZGV2aWNlLi4uPC9kaXY+DQogICAgICAgICAgPC9kaXY+DQogICAgICA8L2Rpdj4NCg0KICAgICAgPGRpdiBpZD0ibWFpbkNvbnRlbnQiPg0KICAgICAgICAgIDxoMiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IGNvbG9yOnZhcigtLXByaW1hcnktYmx1ZSk7IGZvbnQtc2l6ZTogY2xhbXAoMTZweCwgNS4ydncsIDI0cHgpOyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsgbWFyZ2luOiAwOyBwYWRkaW5nOiA3MHB4IDFweCA1cHggMTFweDsiPg0KICAgICAgICAgICAgICBNeWxhaSBNYWhhcGVyaXlhdmEgQW51c2hhbSBUcnVzdA0KICAgICAgICAgIDwvaDI+DQoNCiAgICAgICAgICA8ZGl2IGlkPSJ1c2VyTW9uaXRvciIgY2xhc3M9InN0YXR1cy1lbXB0eSI+DQogICAgICAgICAgICAgIDxzcGFuIGlkPSJhY3RpdmVVc2VyTGlzdCI+SW5pdGlhbGlzaW5nIFN5c3RlbSBNb25pdG9yLi4uPC9zcGFuPg0KICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJxdWl0QnRuIiBjbGFzcz0icXVpdC1idG4iIG9uY2xpY2s9InByb3BlclF1aXQoKSIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPlF1aXQgQXBwPC9idXR0b24+DQogICAgICAgICAgPC9kaXY+DQoNCg0KICAgICAgICAgIDx0YWJsZSBjbGFzcz0iZGFzaC10YWJsZSIgaWQ9ImRhc2hib2FyZFRhYmxlIj4NCiAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLWxhYmVsIj5MYXN0IFJlY3B0IE5vLjwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImRhc2gtdmFsIiBpZD0iZEFic29sdXRlTGFzdCI+Li4uPC90ZD4NCiAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgPHRyPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLWxhYmVsIj5MYXRlc3QgUmVjcHQgTm8uPC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC12YWwiIGlkPSJkTGFzdFJjcHQiPi4uLjwvdGQ+DQogICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC1sYWJlbCI+UmVjZWlwdHMgUmVhZHk8L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkYXNoLXZhbCIgaWQ9ImRSY3B0UmVhZHkiPi4uLjwvdGQ+DQogICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC1sYWJlbCI+QmFuayBTdG1udCB0aWxsPC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC12YWwiIGlkPSJkQmFua0RhdGUiPi4uLjwvdGQ+DQogICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC1sYWJlbCI+Q2FzaCB0byBEZXBvc2l0PC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iZGFzaC12YWwiIGlkPSJkQ2FzaERlcG9zaXQiPi4uLjwvdGQ+DQogICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgPC90YWJsZT4NCg0KICAgICAgICAgIDxzdHlsZT4NCiAgICAgICAgICAgICAgICAvKiBQdXNoaW5nIHRoZSBjb250cmFzdCBhbmQgYWRkaW5nIGEgcHVsc2UgZm9yIHRoZSAnTGl2ZScgZmVlbCAqLw0KDQoNCiAgICAgICAgICAgICAgICAjdXNlck1vbml0b3Igew0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgICAgICAgICAgICAgIHRvcDogMDsNCiAgICAgICAgICAgICAgICAgICAgbGVmdDogMDsNCiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IDA7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgICAgICAgICB6LWluZGV4OiAxMDAwMDsNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDAgIWltcG9ydGFudDsNCiAgICAgICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICAgICAgICAgICAgICBwYWRkaW5nOiAxMnB4Ow0KICAgICAgICAgICAgICAgICAgICBtYXJnaW46IGF1dG87DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiA5NSU7DQogICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDhweDsNCiAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6ICdTZWdvZSBVSScsIFRhaG9tYSwgR2VuZXZhLCBWZXJkYW5hLCBzYW5zLXNlcmlmOw0KICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCA0cHggNnB4IHJnYmEoMCwwLDAsMC4xKTsNCiAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTsNCiAgICAgICAgICAgICAgICAgICAgLyogLS0tIEFERC9WRVJJRlkgVEhFU0UgQkVMT1cgLS0tICovDQoNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7IC8qIEVuc3VyZXMgaXQgYWN0cyBhcyBhIGZ1bGwtd2lkdGggY29udGFpbmVyICovDQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogYXV0bzsgLyogQUxMT1dTIHRoZSBoZWlnaHQgdG8gZ3JvdyB3aXRoIGNvbnRlbnQgKi8NCiAgICAgICAgICAgICAgICAgICAgbWluLWhlaWdodDogZml0LWNvbnRlbnQ7IC8qIEVuc3VyZXMgaXQgc3RheXMgYXQgbGVhc3QgYXMgYmlnIGFzIHRoZSB0ZXh0ICovDQogICAgICAgICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAxLjU7IC8qIEFkZHMgYnJlYXRoaW5nIHJvb20gYmV0d2VlbiB0aGUgbGluZXMgKi8NCg0KICAgICAgICAgICAgICAgICAgICB3aGl0ZS1zcGFjZTogbm9ybWFsOyAvKiBSRU1PVkUgJ25vd3JhcCcgaWYgaXQgd2FzIHRoZXJlIGVsc2V3aGVyZSAqLw0KICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdzogdmlzaWJsZTsgLyogRW5zdXJlcyB0ZXh0IGlzbid0IGN1dCBvZmYgaWYgaXQgZ3Jvd3MgKi8NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvKiNhY3RpdmVVc2VyTGlzdCB7DQogICAgICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAxNHB4ICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICAgICAgICAgICAgICAgIGhlaWdodDogMjBweCAhaW1wb3J0YW50OyovIC8qIEZvcmNlIExpbmUgMSAqLw0KICAgICAgICAgICAgICAgIC8qbWFyZ2luOiAwICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogMjBweCAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgICB9Ki8NCg0KICAgICAgICAgICAgICAgICNxdWl0QnRuIHsNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXRvcDogMnB4ICFpbXBvcnRhbnQ7IC8qIEZvcmNlIExpbmUgMiAqLw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC5zdGF0dXMtYWN0aXZlIHsNCiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzFhMjM3ZTsgLyogRGVlcCBOYXZ5IEJsdWUgKi8NCiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICNmZmZmZmY7IC8qIENyaXNwIFdoaXRlICovDQogICAgICAgICAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICNmZmQ2MDA7IC8qIEJyaWdodCBZZWxsb3cgQm9yZGVyICovDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLnN0YXR1cy1lbXB0eSB7DQogICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7DQogICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjNzU3NTc1Ow0KICAgICAgICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjZGRkOw0KICAgICAgICAgICAgICAgIH0NCg0KDQogICAgICAgICAgICAgICAgLyogVXBkYXRlIHRoaXMgc2VjdGlvbiBpbiB5b3VyIGZpbGUgKi8NCg0KICAgICAgICAgICAgICAgIC8qIExJR0hUIEdSRUVOIFBVTFNFIEZPUiBEQVJLIEJMVUUgQkFSICovDQogICAgICAgICAgICAgICAgLmxpdmUtZG90IHsNCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiAxMHB4Ow0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogMTBweDsNCiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwRkYwMDsgLyogVmlicmFudCBHcmVlbiAqLw0KICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsNCiAgICAgICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiA4cHg7DQogICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogcHVsc2UgMS41cyBpbmZpbml0ZTsNCiAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDhweCAjMDBGRjAwOyAvKiBDb25zdGFudCBncmVlbiBnbG93ICovDQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgQGtleWZyYW1lcyBwdWxzZSB7DQogICAgICAgICAgICAgICAgICAgIDAlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7DQogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwRkYwMDsgLyogUHVyZSBHcmVlbiAqLw0KICAgICAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCAjMDBGRjAwOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgNTAlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuODsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMS4zKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNDQ0ZGMDA7IC8qIEVsZWN0cmljIExpbWUgR3JlZW4gZm9yIGhpZ2ggY29udHJhc3QgKi8NCiAgICAgICAgICAgICAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCAxOHB4ICNDQ0ZGMDA7IC8qIExhcmdlIGdsb3dpbmcgcHVsc2UgKi8NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIDEwMCUgew0KICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDBGRjAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwIDVweCAjMDBGRjAwOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgLnN0YXR1cy1hY3RpdmUgew0KICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMWEyMzdlOw0KICAgICAgICAgICAgICAgICAgICBjb2xvcjogI2ZmZmZmZjsNCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzAwRkYwMDsgLyogQ2hhbmdlZCBmcm9tIFllbGxvdyB0byBWaWJyYW50IEdyZWVuICovDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgIDwvc3R5bGU+DQoNCiAgICAgICAgICA8ZGl2IGNsYXNzPSJzZWFyY2gtYXJlYSI+DQogICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZpbHRlci1ncm91cCIgaWQ9InllYXJGaWx0ZXJHcm91cCI+DQogICAgICAgICAgICAgICAgICA8bGFiZWw+DQogICAgICAgICAgICAgICAgICAgICAgPGlucHV0IHR5cGU9InJhZGlvIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJ5ZWFyRmlsdGVyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZD0iZkFsbCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9ImFsbCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tlZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbmNoYW5nZT0iY2xlYXJXb3Jrc3BhY2UoKSIgLz4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5BbGw8L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgPGxhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT0ieWVhckZpbHRlciINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9ImYyMDIxIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iMjAyMSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jaGFuZ2U9ImNsZWFyV29ya3NwYWNlKCkiIC8+DQogICAgICAgICAgICAgICAgICAgICAgPHNwYW4+MjEtMjI8L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgPGxhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT0ieWVhckZpbHRlciINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9ImYyMDIyIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iMjAyMiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jaGFuZ2U9ImNsZWFyV29ya3NwYWNlKCkiIC8+DQogICAgICAgICAgICAgICAgICAgICAgPHNwYW4+MjItMjM8L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgPGxhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT0ieWVhckZpbHRlciINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9ImYyMDIzIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iMjAyMyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jaGFuZ2U9ImNsZWFyV29ya3NwYWNlKCkiIC8+DQogICAgICAgICAgICAgICAgICAgICAgPHNwYW4+MjMtMjQ8L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgPGxhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT0ieWVhckZpbHRlciINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9ImYyMDI0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iMjAyNCINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jaGFuZ2U9ImNsZWFyV29ya3NwYWNlKCkiIC8+DQogICAgICAgICAgICAgICAgICAgICAgPHNwYW4+MjQtMjU8L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgPGxhYmVsPg0KICAgICAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJyYWRpbyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZT0ieWVhckZpbHRlciINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9ImYyMDI1Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT0iMjAyNSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jaGFuZ2U9ImNsZWFyV29ya3NwYWNlKCkiIC8+DQogICAgICAgICAgICAgICAgICAgICAgPHNwYW4+MjUtMjY8L3NwYW4+DQogICAgICAgICAgICAgICAgICA8L2xhYmVsPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBpZD0ibXV0ZUJ0biIgb25jbGljaz0idG9nZ2xlTXV0ZSgpIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDE1cHg7IHBhZGRpbmc6IDRweCAxMHB4OyBjdXJzb3I6IHBvaW50ZXI7IGJvcmRlci1yYWRpdXM6IDRweDsgYm9yZGVyOiAxcHggc29saWQgI2NjYzsgYmFja2dyb3VuZDogI2VlZWVlZSAhaW1wb3J0YW50OyBjb2xvcjogYmxhY2sgIWltcG9ydGFudDsgZm9udC1mYW1pbHk6IGluaGVyaXQ7IGZvbnQtd2VpZ2h0OiBib2xkOyBmb250LXNpemU6IDEzcHg7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgdmVydGljYWwtYWxpZ246IG1pZGRsZTsiPg0KICAgICAgICAgICAgICAgICAgICAgIPCflIcgTXV0ZQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQogICAgICAgICAgICAgIDwvZGl2Pg0KDQogICAgICAgICAgICAgIDxkaXYgaWQ9InNlYXJjaENvbnRyb2xzIj4NCiAgICAgICAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0Ig0KICAgICAgICAgICAgICAgICAgICAgICAgIGlkPSJzZWFyY2hJbnB1dCINCiAgICAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj0iU2VhcmNoICgnLCcgZm9yIEFORCwgJzsnIGZvciBPUikiIC8+DQogICAgICAgICAgICAgICAgICA8YnIgLz4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcoZmV0Y2hBbmRTZWFyY2gpIiBzdHlsZT0id2lkdGg6NDUlOyI+DQogICAgICAgICAgICAgICAgICAgICAgU2VhcmNoDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0ic2hvd1V0aWxpdGllcygpIiBzdHlsZT0id2lkdGg6NDUlOyI+DQogICAgICAgICAgICAgICAgICAgICAgVXRpbGl0eSBNZW51DQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICAgICAgPGRpdiBpZD0idXRpbGl0aWVzTWVudSI+DQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1blN1bW1hcnkpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93MSI+U3VtbWFyeTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5Bbm9ueW1vdXMpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93MSI+QW5vbnltb3VzPC9idXR0b24+DQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1bkNhc2hEZXApIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93MSI+Q2FzaCBEZXA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5QQ29uc2VudCkiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3cyIj5QIENvbnNlbnQ8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcocnVuRG9ub3JMaXN0KSIgY2xhc3M9InV0aWwtbWVudS1idG4gYnRuLXJvdzIiPkRvbm9yIExpc3Q8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0id3JhcExvYWRpbmcocnVuRVJlY2VpcHQpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93MiI+ZVJlY2VpcHQ8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5CYW5rU3RhdGVtZW50KSIgY2xhc3M9InV0aWwtbWVudS1idG4gYnRuLXJvdzMiPkJhbmsgU3RhdGVtZW50czwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5FeHBlbnNlcykiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3czIj5FeHBlbnNlczwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJ3cmFwTG9hZGluZyhydW5BY2NvdW50cykiIGNsYXNzPSJ1dGlsLW1lbnUtYnRuIGJ0bi1yb3czIj5BY2NvdW50czwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1bkRvbmF0aW9uKSIgY2xhc3M9InV0aWwtbWVudS1idG4gYnRuLXJvdzQiPkRvbmF0aW9uIExpc3Q8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0icnVuQW5vbnlNYXRjaCgpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93NCI+QW5vbnkgTWF0Y2g8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0ic2hvd0Rvd25sb2FkTWVudSgpIiBjbGFzcz0idXRpbC1tZW51LWJ0biBidG4tcm93NCIgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7IGJvcmRlcjogMnB4IHNvbGlkICMxNTY1YzA7Ij5Eb3dubG9hZHM8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJzaG93RG9ub3JNYXRjaExpc3QoKSIgc3R5bGU9ImdyaWQtY29sdW1uOiAxIC8gc3BhbiAyOyBiYWNrZ3JvdW5kLWNvbG9yOiAjMjE5NkYzICFpbXBvcnRhbnQ7IGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50OyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyOiAxcHggc29saWQgIzk5OTsiPiBEb25vci1CYW5rLUV4cGVuc2UtTWF0Y2ggTGlzdCA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iaGlkZVV0aWxpdGllcygpIiBjbGFzcz0idXRpbC1tZW51LWJ0biIgc3R5bGU9ImJhY2tncm91bmQ6IzY2NiAhaW1wb3J0YW50OyBjb2xvcjogd2hpdGUgIWltcG9ydGFudDsiPkJhY2s8L2J1dHRvbj4NCiAgICAgICAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgICA8L2Rpdj4NCg0KICAgICAgICAgIDxkaXYgaWQ9Im51bWVyaWNSZXN1bHRzIj48L2Rpdj4NCiAgICAgICAgICA8ZGl2IGlkPSJkZXRhaWxlZFJlc3VsdHMiPjwvZGl2Pg0KICAgICAgPC9kaXY+DQoNCiAgICAgIDxkaXYgaWQ9InNlYXJjaFN1bW1hcnlCYXIiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij48L2Rpdj4NCg0KICAgICAgPHNjcmlwdD4NCg0KICAgICAgICAgIGxldCBNYWluU3dVc2VyTmFtZSA9ICcnOw0KDQogICAgICAgICAgdmFyIGdsb2JhbFBlbmRpbmdDYXB0dXJlID0gW107DQogICAgICAgICAgbGV0IGdsb2JhbERhc2hib2FyZENhc2hUb3RhbCA9IDA7DQogICAgICAgICAgbGV0IGdsb2JhbERhc2hib2FyZENhc2hSZWNlaXB0cyA9IDA7DQoNCiAgICAgICAgICBsZXQgcHJldmlvdXNVc2VyTGlzdCA9IFtdOw0KDQogICAgICAgICAgY29uc3QgUkVWRVJTQUxTX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL2s2Y2x2a2U3aDJxeGhnbjA3dm1iNS9SZXZlcnNhbHMudHh0P3Jsa2V5PTF5OWRucmV2ZDZtbW5zMDAzbHlkdXc5NW0mZGw9MSI7DQoNCiAgICAgICAgICAvL2NvbnN0IERBVEFfVVJMID0gImh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkvczlyN3hmbjNhOGs1d3lyc3dvaHpoL01NUFQyLktQP3Jsa2V5PTl0emFlc3R3eHA4bnVuZWRyc3dxOW82anImcmF3PTEiOw0KICAgICAgICAgIGNvbnN0IERBVEFfVVJMID0gImh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkvajZ1M2hvMTRkeHlkcjV2Nmg1aGJpL01NUFQyLktQP3Jsa2V5PTNla3VycnE4d2t6MDhic3BpeHpnamo1enImc3Q9M3NvN2M5NWcmZGw9MSI7DQoNCiAgICAgICAgICBjb25zdCBQQVNTX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL3hwejU4NTltajEyd3huaXgweGJhMi9kZXZvdGVlLnR4dD9ybGtleT01ejZ2bWdjaWp5N3U5anl3bWUzb2V4ZTY2JnJhdz0xIjsNCiAgICAgICAgICAvL3NhbWUgZm9yIHBhc3N3b3JkDQoNCg0KICAgICAgICAgIGNvbnN0IENBU0hfTElTVF9VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS8xNm9zcjNlanpxYzBkZ2RsemJvcDgvQ2FzaC1MaXN0LnR4dD9ybGtleT1sM25yNndtdHp1bDE3M3hodnBjNThieW12JnJhdz0xIjsNCiAgICAgICAgICAvL3NhbWUgDQoNCiAgICAgICAgICBjb25zdCBFWFBFTlNFU19VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9hNWU4OHZqemI2dzJxbWVsM3lzeXgvRXhwZW5zZXMueGxzeD9ybGtleT1qbWQ4aTBqczFza3hsMnZ5YXZzN3BvOHlwJmRsPTEiOw0KICAgICAgICAgIC8vc2FtZQ0KDQogICAgICAgICAgLy9jb25zdCBCQU5LX05FV19VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9qbDNpNXdxcThrejByZXRlZTdqdGovTU1QVDMuS1A/cmxrZXk9YnNzcHF5NXhwMGJybDNnY281eW9sMWN5aSZkbD0xIjsNCiAgICAgICAgICBjb25zdCBCQU5LX05FV19VUkwgPSAiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS9saG1hMDV3aDUzYjY2dmxjcWM5NGkvTU1QVDMuS1A/cmxrZXk9bDR0OHc1amFoMWhieWd0M28xamRua2JtNSZzdD00dTZib2ZmMiZkbD0xIjsNCg0KICAgICAgICAgIA0KDQoNCg0KICAgICAgICAgIGNvbnN0IFRJVExFUyA9IFsiUmVjZWlwdCBOby4iLCAiRGF0ZSIsICJOYW1lIiwgIlBob25lIiwgIkFkZHJlc3MiLCAiRW1haWwiLCAiUEFOIiwgIlN0YXIiLCAiR290aHJhbSIsICJBbW91bnQiLCAiUmVmZXJlbmNlIiwgIk1vZGUiLCAiVG93YXJkcyIsICJDYW5jZWwiLCAiQ29tbWVudHMiLCAiUGluIENvZGUiLCAiUmVjZWlwdCBQcmludGVkIiwgIlByYXNhZGFtIFNlbnQiLCAiQ29ycHVzIFNpZ25lZCIsICJDb3VudHJ5Il07DQogICAgICAgICAgY29uc3QgQ1VUT0ZGX0RBVEUgPSBuZXcgRGF0ZSgnMjAyNS0wNC0wMScpOw0KICAgICAgICAgIGxldCBhY3RpdmVDaGFydHMgPSBbXTsNCg0KICAgICAgICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICAgICAgICAgIC8vIENPUkUgQVBQTElDQVRJT04gRlVOQ1RJT05TDQogICAgICAgICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBHbG9iYWwgV3JhcHBlcjogU2hvd3MgdGhlIGxvYWRpbmcgbWVzc2FnZSBiZWZvcmUgZXhlY3V0aW5nIGEgZnVuY3Rpb24NCiAgICAgICAgICAgKiBhbmQgaGlkZXMgaXQgb25jZSB0aGUgZnVuY3Rpb24gY29tcGxldGVzLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gd3JhcExvYWRpbmcoZm4pIHsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7DQogICAgICAgICAgICAgICAgICBhd2FpdCBmbigpOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9LCA1MCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogQXV0aGVudGljYXRpb246IFZhbGlkYXRlcyB0aGUgZW50ZXJlZCBwYXNzd29yZCBhZ2FpbnN0IHRoZQ0KICAgICAgICAgICAqIHJlbW90ZSB0ZXh0IGZpbGUgYW5kIGluaXRpYWxpemVzIHRoZSBkYXNoYm9hcmQgb24gc3VjY2Vzcy4NCiAgICAgICAgICAgKi8NCg0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogRGFzaGJvYXJkIFNldHVwOiBGZXRjaGVzIG1hc3RlciBkYXRhIGFuZCBiYW5rIGZpbGVzIHRvIGNhbGN1bGF0ZQ0KICAgICAgICAgICAqIHRoZSBoaWdoLWxldmVsIG1ldHJpY3MgKExhc3QgUmVjZWlwdCwgUGVuZGluZyBDb3VudCwgZXRjLikgc2hvd24gb24gdGhlIG1haW4gc2NyZWVuLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gaW5pdERhc2hib2FyZCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGxldCByZWFkeUNvdW50ID0gMCwgcmVhZHlBbXQgPSAwOw0KICAgICAgICAgICAgICBsZXQgbGF0ZXN0UmNwdE51bSA9ICIiLCBsYXRlc3RSY3B0RGF0ZSA9ICIiLCBiYW5rRGF0ZSA9ICItLS0iOw0KICAgICAgICAgICAgICBsZXQgbWF4RGF0ZU9iaiA9IG5ldyBEYXRlKDApOw0KICAgICAgICAgICAgICBsZXQgbGFzdEVudHJ5ID0gcmVjc1tyZWNzLmxlbmd0aCAtIDJdOw0KICAgICAgICAgICAgICBsZXQgbGYgPSBsYXN0RW50cnkuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgbGV0IGFic0xhc3RTdHIgPSAobGYubGVuZ3RoID49IDIpID8gYCR7bGZbMF19IDogJHtsZlsxXX1gIDogIi0tLSI7DQoNCiAgICAgICAgICAgICAgcmVjcy5mb3JFYWNoKHIgPT4gew0KICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAyMCkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgck5vID0gZlswXS50cmltKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZVN0ciA9IGZbMV0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgckRhdGVPYmogPSBwYXJzZURhdGUockRhdGVTdHIpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaXNDID0gZlsxM10/LnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgYWRkclJhdyA9IGZbNF0/LnRyaW0oKSB8fCAiIjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQW5vbiA9ICghZlsyXSB8fCBmWzJdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImFub255bW91cyIpKTsNCiAgICAgICAgICAgICAgICAgIGlmIChyRGF0ZU9iaiA+IG1heERhdGVPYmopIHsNCiAgICAgICAgICAgICAgICAgICAgICBtYXhEYXRlT2JqID0gckRhdGVPYmo7DQogICAgICAgICAgICAgICAgICAgICAgbGF0ZXN0UmNwdE51bSA9IHJObzsNCiAgICAgICAgICAgICAgICAgICAgICBsYXRlc3RSY3B0RGF0ZSA9IHJEYXRlU3RyOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgaWYgKHJOby5zdGFydHNXaXRoKCJDRyIpICYmIHJEYXRlT2JqID49IENVVE9GRl9EQVRFICYmICFpc0MgJiYgIWlzQW5vbiAmJiBhZGRyUmF3ICE9PSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJjcHRQID0gZlsxNl0/LnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByYXNTID0gZlsxN10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmICgocmNwdFAgPT09ICJOTyIgfHwgcmNwdFAgPT09ICIiKSAmJiAocHJhc1MgPT09ICJOTyIgfHwgcHJhc1MgPT09ICIiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICByZWFkeUNvdW50Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5QW10ICs9IHBhcnNlRmxvYXQoZls5XSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIGF3YWl0IHJ1bkNhc2hEZXAodHJ1ZSk7DQoNCiAgICAgICAgICAgICAgY29uc3QgYlJlcyA9IGF3YWl0IGZldGNoKEJBTktfTkVXX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IGJMaW5lcyA9IChhd2FpdCBiUmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGNvbnN0IGJMYXN0ID0gYkxpbmVzW2JMaW5lcy5sZW5ndGggLSAyXT8uc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgaWYgKGJMYXN0KSBiYW5rRGF0ZSA9IGJMYXN0WzBdOw0KDQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkQWJzb2x1dGVMYXN0JykuaW5uZXJUZXh0ID0gYWJzTGFzdFN0cjsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RMYXN0UmNwdCcpLmlubmVyVGV4dCA9IGAke2xhdGVzdFJjcHROdW19IDogJHtsYXRlc3RSY3B0RGF0ZX1gOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZFJjcHRSZWFkeScpLmlubmVyVGV4dCA9IGAke3JlYWR5Q291bnR9IFJlY2VpcHRzIChScy4gJHtyZWFkeUFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX0pYDsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RCYW5rRGF0ZScpLmlubmVyVGV4dCA9IGJhbmtEYXRlOw0KDQogICAgICAgICAgICAgIC8vIFNldCBDYXNoIHJvdyBmcm9tIHRoZSBHbG9iYWwgdmFyaWFibGUNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RDYXNoRGVwb3NpdCcpLmlubmVySFRNTCA9IChnbG9iYWxEYXNoYm9hcmRDYXNoVG90YWwgPiAwKSA/DQogICAgICAgICAgICAgICAgICBgPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMC44ZW07IGNvbG9yOiAjNjY2OyI+KCR7Z2xvYmFsRGFzaGJvYXJkQ2FzaFJlY2VpcHRzfSBSZWNlaXB0cyk8L3NwYW4+IOKCuSR7Z2xvYmFsRGFzaGJvYXJkQ2FzaFRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfWAgOiAiTmlsIjsNCg0KICAgICAgICAgICAgICBzeW5jV2l0aEpzb25CaW4oKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBEYXRlIFBhcnNlcjogQ29udmVydHMgc3RhbmRhcmQgREQtTU0tWVlZWSBvciBERC9NTS9ZWVlZIHN0cmluZ3MNCiAgICAgICAgICAgKiBpbnRvIHZhbGlkIEphdmFTY3JpcHQgRGF0ZSBvYmplY3RzIGZvciBjb21wYXJpc29ucy4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGZ1bmN0aW9uIHBhcnNlRGF0ZShkYXRlU3RyKSB7DQogICAgICAgICAgICAgIGlmICghZGF0ZVN0cikgcmV0dXJuIG5ldyBEYXRlKDApOw0KICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGRhdGVTdHIuc3BsaXQoL1stL10vKTsNCiAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMykgcmV0dXJuIG5ldyBEYXRlKDApOw0KICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUocGFydHNbMl0sIHBhcnRzWzFdIC0gMSwgcGFydHNbMF0pOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIEZZIENhbGN1bGF0b3I6IERldGVybWluZXMgdGhlIEZpbmFuY2lhbCBZZWFyIGxhYmVsIChlLmcuLCAiMjQtMjUiKQ0KICAgICAgICAgICAqIGJhc2VkIG9uIHRoZSB0cmFuc2FjdGlvbiBkYXRlIHByb3ZpZGVkLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gZ2V0RlkoZGF0ZVN0cikgew0KICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGRhdGVTdHIuc3BsaXQoL1stL10vKTsNCiAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCAhPT0gMykgcmV0dXJuICIiOw0KICAgICAgICAgICAgICBsZXQgbSA9IHBhcnNlSW50KHBhcnRzWzFdKSwgeSA9IHBhcnNlSW50KHBhcnRzWzJdKTsNCiAgICAgICAgICAgICAgbGV0IHN0YXJ0WWVhciA9IChtIDwgNCkgPyB5IC0gMSA6IHk7DQogICAgICAgICAgICAgIGxldCBlbmRZZWFyID0gKHN0YXJ0WWVhciArIDEpLnRvU3RyaW5nKCkuc2xpY2UoLTIpOw0KICAgICAgICAgICAgICByZXR1cm4gYCR7c3RhcnRZZWFyLnRvU3RyaW5nKCkuc2xpY2UoLTIpfS0ke2VuZFllYXJ9YDsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBSZWNlaXB0IE5vcm1hbGl6ZXI6IFN0cmlwcyBsZWFkaW5nIHplcm9zIGFuZCBzdGFuZGFyZGl6ZXMgcmVjZWlwdA0KICAgICAgICAgICAqIHByZWZpeCBmb3JtYXR0aW5nIGZvciBlYXNpZXIgc2VhcmNoaW5nLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gbm9ybWFsaXplUmNwdChzKSB7DQogICAgICAgICAgICAgIGlmICghcykgcmV0dXJuICIiOw0KICAgICAgICAgICAgICByZXR1cm4gcy50b1VwcGVyQ2FzZSgpLnJlcGxhY2UoL14oW0EtWl0rKTArLywgJyQxJykudHJpbSgpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFRleHQgSGlnaGxpZ2h0ZXI6IEluamVjdHMgPG1hcms+IHRhZ3MgaW50byBhIHN0cmluZyB0byBoaWdobGlnaHQNCiAgICAgICAgICAgKiBzZWFyY2ggdGVybXMgZm91bmQgd2l0aGluIHRoZSByZXN1bHRzLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gaGlnaGxpZ2h0VGV4dCh0ZXh0LCB0ZXJtcykgew0KICAgICAgICAgICAgICBpZiAoIXRlcm1zIHx8ICF0ZXJtcy5sZW5ndGggfHwgIXRleHQpIHJldHVybiB0ZXh0IHx8ICIiOw0KICAgICAgICAgICAgICBsZXQgaCA9IFN0cmluZyh0ZXh0KTsNCiAgICAgICAgICAgICAgdGVybXMuZm9yRWFjaCh0ID0+IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgKCR7dH0pYCwgJ2dpJyk7DQogICAgICAgICAgICAgICAgICBoID0gaC5yZXBsYWNlKHJlZ2V4LCAnPG1hcms+JDE8L21hcms+Jyk7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICByZXR1cm4gaDsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBTZWFyY2ggTG9naWMgRXZhbHVhdG9yOiBIYW5kbGVzIG11bHRpLXRlcm0gc2VhcmNoaW5nIHVzaW5nDQogICAgICAgICAgICogY29tbWFzIGZvciAnQU5EJyBsb2dpYyBhbmQgc2VtaWNvbG9ucyBmb3IgJ09SJyBsb2dpYy4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGZ1bmN0aW9uIGV2YWx1YXRlTG9naWMocm93U3RyLCBxUmF3KSB7DQogICAgICAgICAgICAgIGxldCBsb2dpYyA9ICJBTkQiOw0KICAgICAgICAgICAgICBsZXQgdGVybXMgPSBbXTsNCiAgICAgICAgICAgICAgaWYgKHFSYXcuaW5jbHVkZXMoJzsnKSkgew0KICAgICAgICAgICAgICAgICAgbG9naWMgPSAiT1IiOw0KICAgICAgICAgICAgICAgICAgdGVybXMgPSBxUmF3LnRvTG93ZXJDYXNlKCkuc3BsaXQoJzsnKS5tYXAodCA9PiB0LnRyaW0oKSkuZmlsdGVyKHQgPT4gdCAhPT0gIiIpOw0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgdGVybXMgPSBxUmF3LnRvTG93ZXJDYXNlKCkuc3BsaXQoJywnKS5tYXAodCA9PiB0LnRyaW0oKSkuZmlsdGVyKHQgPT4gdCAhPT0gIiIpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIGlmIChsb2dpYyA9PT0gIk9SIikgcmV0dXJuIHsgbWF0Y2hlczogdGVybXMuc29tZSh0ID0+IHJvd1N0ci5pbmNsdWRlcyh0KSksIHRlcm1zOiB0ZXJtcyB9Ow0KICAgICAgICAgICAgICBlbHNlIHJldHVybiB7IG1hdGNoZXM6IHRlcm1zLmV2ZXJ5KHQgPT4gcm93U3RyLmluY2x1ZGVzKHQpKSwgdGVybXM6IHRlcm1zIH07DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogVUkgQ2xlYW51cDogQ2xlYXJzIGFsbCBjdXJyZW50IHJlc3VsdHMsIGNoYXJ0cywgYW5kIHN1bW1hcnkgYmFycw0KICAgICAgICAgICAqIHRvIHByZXBhcmUgdGhlIHdvcmtzcGFjZSBmb3IgYSBuZXcgb3BlcmF0aW9uLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gY2xlYXJXb3Jrc3BhY2UoKSB7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdudW1lcmljUmVzdWx0cycpLmlubmVySFRNTCA9ICIiOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gIiI7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hTdW1tYXJ5QmFyJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgYWN0aXZlQ2hhcnRzLmZvckVhY2goYyA9PiB7IGlmIChjKSBjLmRlc3Ryb3koKTsgfSk7DQogICAgICAgICAgICAgIGFjdGl2ZUNoYXJ0cyA9IFtdOw0KDQogICAgICAgICAgICAgIC8vIEhpZGUgYnV0dG9ucyB3aGVuIGNsZWFyaW5nDQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnMoZmFsc2UpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIE1lbnUgQ29udHJvbGxlciAoU2hvdyk6IERpc3BsYXlzIHRoZSBVdGlsaXR5IGdyaWQgYW5kIGhpZGVzIHN0YW5kYXJkIHNlYXJjaCBjb250cm9scy4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGZ1bmN0aW9uIHNob3dVdGlsaXRpZXMoKSB7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hDb250cm9scycpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1dGlsaXRpZXNNZW51Jykuc3R5bGUuZGlzcGxheSA9ICdncmlkJzsNCiAgICAgICAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgICAgY29uc3QgY3VyRlkgPSAobm93LmdldE1vbnRoKCkgPCAzKSA/IG5vdy5nZXRGdWxsWWVhcigpIC0gMSA6IG5vdy5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2YnICsgY3VyRlkpKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZicgKyBjdXJGWSkuY2hlY2tlZCA9IHRydWU7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogTWVudSBDb250cm9sbGVyIChIaWRlKTogU3dpdGNoZXMgYmFjayB0byB0aGUgc2VhcmNoIGlucHV0IGFuZCBoaWRlcyB0aGUgVXRpbGl0eSBncmlkLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgZnVuY3Rpb24gaGlkZVV0aWxpdGllcygpIHsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaENvbnRyb2xzJykuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1dGlsaXRpZXNNZW51Jykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZBbGwnKS5jaGVja2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBOYXZpZ2F0aW9uIFNob3J0Y3V0OiBQcm9ncmFtbWF0aWNhbGx5IG9wZW5zIHRoZSBVdGlsaXR5IE1lbnUNCiAgICAgICAgICAgKiBhbmQgdHJpZ2dlcnMgdGhlIGVSZWNlaXB0IHZpZXcgZm9yIGEgc3BlY2lmaWMgcmVjZWlwdCBudW1iZXIuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBmdW5jdGlvbiBqdW1wVG9SZWNlaXB0KHJjcHRObykgew0KICAgICAgICAgICAgICBzaG93VXRpbGl0aWVzKCk7DQogICAgICAgICAgICAgIHJ1bkVSZWNlaXB0KHJjcHRObyk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogQmFuayBTdGF0ZW1lbnQgVmlld2VyOiBGaWx0ZXJzIGFuZCBkaXNwbGF5cyBiYW5rIHRyYW5zYWN0aW9uIHJlY29yZHMgZnJvbSB0aGUgTU1QVDMgZmlsZQ0KICAgICAgICAgICAqIGJhc2VkIG9uIHRoZSBzZWxlY3RlZCBGaW5hbmNpYWwgWWVhci4gSXQgaGlnaGxpZ2h0cyBjcmVkaXRzIGluIGJsdWUgYW5kIGRlYml0cyBpbiByZWQuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5CYW5rU3RhdGVtZW50KCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IGZ5TGFiZWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnBhcmVudEVsZW1lbnQuaW5uZXJUZXh0LnRyaW0oKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goQkFOS19ORVdfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSAoYXdhaXQgcmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGxldCB0Q3IgPSAwLCB0RHIgPSAwLCB0ciA9ICIiOw0KICAgICAgICAgICAgICBsaW5lcy5mb3JFYWNoKGxpbmUgPT4gew0KICAgICAgICAgICAgICAgICAgbGV0IGYgPSBsaW5lLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCA1KSByZXR1cm47DQogICAgICAgICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gZlswXS50cmltKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkT2JqID0gcGFyc2VEYXRlKGRhdGVTdHIpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZHIgPSBwYXJzZUZsb2F0KGZbM10pIHx8IDA7DQogICAgICAgICAgICAgICAgICBjb25zdCBjciA9IHBhcnNlRmxvYXQoZls0XSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgIGxldCBpblllYXIgPSAoc1llYXIgPT09ICJhbGwiKTsNCiAgICAgICAgICAgICAgICAgIGlmICghaW5ZZWFyKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZnlTID0gcGFyc2VJbnQoc1llYXIpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSBkT2JqLmdldE1vbnRoKCkgKyAxLCB5ID0gZE9iai5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgIGluWWVhciA9ICh5ID09PSBmeVMgJiYgbSA+PSA0KSB8fCAoeSA9PT0gZnlTICsgMSAmJiBtIDw9IDMpOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgaWYgKGluWWVhcikgew0KICAgICAgICAgICAgICAgICAgICAgIHRDciArPSBjcjsgdERyICs9IGRyOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXQgPSBjciA+IDAgPyBgPHNwYW4gY2xhc3M9ImFtdC1jcmVkaXQiPiR7Y3IudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9zcGFuPmAgOiBgPHNwYW4gY2xhc3M9ImFtdC1kZWJpdCI+JHtkci50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3NwYW4+YDsNCiAgICAgICAgICAgICAgICAgICAgICB0ciArPSBgPHRyPjx0ZD4ke2ZbMF19PC90ZD48dGQ+JHtmWzFdfTwvdGQ+PHRkPiR7YW10fTwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImJhbmstdGl0bGUiPkJhbmsgU3RhdGVtZW50cyBmb3IgRlkgOiAke3NZZWFyID09PSAiYWxsIiA/ICJBbGwiIDogZnlMYWJlbH08L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT48dHI+PHRoPkRhdGU8L3RoPjx0aD5EZXRhaWxzPC90aD48dGg+QW1vdW50PC90aD48L3RyPiR7dHJ9PC90YWJsZT48L2Rpdj5gOw0KICAgICAgICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKTsNCiAgICAgICAgICAgICAgYi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBgVG90YWwgQ3I6IOKCuSR7dENyLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfSB8IFRvdGFsIERyOiDigrkke3REci50b0xvY2FsZVN0cmluZygnZW4tSU4nKX1gOw0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIEV4cGVuc2UgVHJhY2tlcjogRG93bmxvYWRzIGFuZCBwYXJzZXMgdGhlIEV4cGVuc2VzIEV4Y2VsIGZpbGUuIEl0IGNhdGVnb3JpemVzDQogICAgICAgICAgICogc3BlbmRpbmcgaW50byBHZW5lcmFsLCBEZXBvc2l0cywgTG9hbnMsIGFuZCBFeGVtcHRlZCBncm91cHMgZm9yIHRoZSBzZWxlY3RlZCBwZXJpb2QuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5FeHBlbnNlcygpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goRVhQRU5TRVNfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC5yZWFkKG5ldyBVaW50OEFycmF5KGF3YWl0IHJlcy5hcnJheUJ1ZmZlcigpKSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3Yi5TaGVldHNbd2IuU2hlZXROYW1lc1swXV0sIHsgaGVhZGVyOiAxIH0pOw0KICAgICAgICAgICAgICAgICAgbGV0IGh0bWxNYXAgPSB7IG1haW46ICIiLCBsb2FuOiAiIiwgZXhlbXB0OiAiIiwgZGVwb3NpdDogIiIgfTsNCiAgICAgICAgICAgICAgICAgIGxldCBjb3VudE1hcCA9IHsgbWFpbjogMCwgbG9hbjogMCwgZGVwb3NpdDogMCwgZXhlbXB0OiAwIH07DQogICAgICAgICAgICAgICAgICBsZXQgdG90YWxNYXAgPSB7IG1haW46IDAsIGxvYW46IDAsIGRlcG9zaXQ6IDAsIGV4ZW1wdDogMCB9Ow0KICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93ID0gZGF0YVtpXTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJvdyB8fCByb3cubGVuZ3RoIDwgMikgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGRPYmogPSAodHlwZW9mIHJvd1swXSA9PT0gJ251bWJlcicpID8gWExTWC51dGlscy5zaGVldF90b19kYXRlKHJvd1swXSkgOiBwYXJzZURhdGUocm93WzBdKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZE9iai5nZXRUaW1lKCkpKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgbSA9IGRPYmouZ2V0TW9udGgoKSArIDEsIHkgPSBkT2JqLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IHJvd0ZZID0gKG0gPj0gNCkgPyB5LnRvU3RyaW5nKCkgOiAoeSAtIDEpLnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkRlkgIT09ICJhbGwiICYmIHJvd0ZZICE9PSBzZWxlY3RlZEZZKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgYW10ID0gcGFyc2VGbG9hdChyb3dbM10pIHx8IDAsIGRlc2MgPSAocm93WzRdIHx8IHJvd1sxXSB8fCAiIikudG9TdHJpbmcoKSwgcyA9IGRlc2MudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgcm93SHRtbCA9IGA8dHI+PHRkPiR7ZE9iai50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLUdCJyl9PC90ZD48dGQ+JHtkZXNjfTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7YW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChzLmluY2x1ZGVzKCJleGVtcHQiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sTWFwLmV4ZW1wdCArPSByb3dIdG1sOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudE1hcC5leGVtcHQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxNYXAuZXhlbXB0ICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHMuaW5jbHVkZXMoImRlcG9zaXQiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sTWFwLmRlcG9zaXQgKz0gcm93SHRtbDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRNYXAuZGVwb3NpdCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbE1hcC5kZXBvc2l0ICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHMuaW5jbHVkZXMoImxvYW4iKSB8fCBzLmluY2x1ZGVzKCJjbG9zdXJlIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbE1hcC5sb2FuICs9IHJvd0h0bWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50TWFwLmxvYW4rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxNYXAubG9hbiArPSBhbXQ7DQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbE1hcC5tYWluICs9IHJvd0h0bWw7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50TWFwLm1haW4rKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxNYXAubWFpbiArPSBhbXQ7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ251bWVyaWNSZXN1bHRzJykuaW5uZXJIVE1MID0gYDx0YWJsZSBjbGFzcz0iZXhlYy1zdW1tYXJ5Ij48dHI+PHRoPkl0ZW08L3RoPjx0aD5Db3VudDwvdGg+PHRoPlRvdGFsPC90aD48L3RyPjx0ciBzdHlsZT0iY29sb3I6dmFyKC0tcHJpbWFyeS1ibHVlKTsiPjx0ZD5HZW5lcmFsPC90ZD48dGQ+JHtjb3VudE1hcC5tYWlufTwvdGQ+PHRkPuKCuSR7dG90YWxNYXAubWFpbi50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PHRyIHN0eWxlPSJjb2xvcjp2YXIoLS1kZXBvc2l0LXB1cnBsZSk7Ij48dGQ+RGVwb3NpdHM8L3RkPjx0ZD4ke2NvdW50TWFwLmRlcG9zaXR9PC90ZD48dGQ+4oK5JHt0b3RhbE1hcC5kZXBvc2l0LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48dHIgc3R5bGU9ImNvbG9yOnZhcigtLWxvYW4tZ3JlZW4pOyI+PHRkPkxvYW5zPC90ZD48dGQ+JHtjb3VudE1hcC5sb2FufTwvdGQ+PHRkPuKCuSR7dG90YWxNYXAubG9hbi50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PHRyIHN0eWxlPSJjb2xvcjp2YXIoLS1leGVtcHQtZ3JheSk7Ij48dGQ+RXhlbXB0ZWQ8L3RkPjx0ZD4ke2NvdW50TWFwLmV4ZW1wdH08L3RkPjx0ZD7igrkke3RvdGFsTWFwLmV4ZW1wdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PC90YWJsZT5gOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPSJleHAtYmFyIG1haW4tYmFyIj48c3Bhbj5HRU5FUkFMPC9zcGFuPjxzcGFuPuKCuSR7dG90YWxNYXAubWFpbi50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3NwYW4+PC9kaXY+PGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPiR7aHRtbE1hcC5tYWlufTwvdGFibGU+PC9kaXY+PGRpdiBjbGFzcz0iZXhwLWJhciBkZXBvc2l0LWJhciI+PHNwYW4+REVQT1NJVFM8L3NwYW4+PHNwYW4+4oK5JHt0b3RhbE1hcC5kZXBvc2l0LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvc3Bhbj48L2Rpdj48ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGU+JHtodG1sTWFwLmRlcG9zaXR9PC90YWJsZT48L2Rpdj48ZGl2IGNsYXNzPSJleHAtYmFyIGxvYW4tYmFyIj48c3Bhbj5MT0FOUzwvc3Bhbj48c3Bhbj7igrkke3RvdGFsTWFwLmxvYW4udG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9zcGFuPjwvZGl2PjxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT4ke2h0bWxNYXAubG9hbn08L3RhYmxlPjwvZGl2PjxkaXYgY2xhc3M9ImV4cC1iYXIgZXhlbXB0LWJhciI+PHNwYW4+RVhFTVBURUQ8L3NwYW4+PHNwYW4+4oK5JHt0b3RhbE1hcC5leGVtcHQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9zcGFuPjwvZGl2PjxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT4ke2h0bWxNYXAuZXhlbXB0fTwvdGFibGU+PC9kaXY+YDsNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkVycm9yOiAiICsgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIENvbnNlbnQgTWFuYWdlcjogSWRlbnRpZmllcyAiQ29ycHVzIiBkb25hdGlvbnMgd2hlcmUgdGhlIG1hbmRhdG9yeSBjb25zZW50IGZvcm0NCiAgICAgICAgICAgKiBoYXMgbm90IHlldCBiZWVuIHNpZ25lZCAoQ29ycHVzIFNpZ25lZCA9IE5PKS4gSGVscHMgaW4gdHJhY2tpbmcgcmVndWxhdG9yeSBjb21wbGlhbmNlLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuUENvbnNlbnQoKSB7DQogICAgICAgICAgICAgIGxldCBxID0gcHJvbXB0KCJTZWFyY2g/IChCbGFuayBmb3IgQWxsKSIsICIiKTsNCiAgICAgICAgICAgICAgaWYgKHEgPT09IG51bGwpIHJldHVybjsNCiAgICAgICAgICAgICAgbGV0IHFSYXcgPSBxLnRyaW0oKS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IChhd2FpdCByZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IHJlc3VsdHMgPSBbXTsNCiAgICAgICAgICAgICAgbGV0IHNjID0gMCwgc2EgPSAwOw0KICAgICAgICAgICAgICByZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDIwKSByZXR1cm47DQogICAgICAgICAgICAgICAgICBjb25zdCBkUCA9IGZbMV0uc3BsaXQoL1stL10vKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG1tID0gcGFyc2VJbnQoZFBbMV0pLCB5eSA9IHBhcnNlSW50KGRQWzJdKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGluWWVhciA9IChzWWVhciA9PT0gImFsbCIpIHx8ICgoeXkgPT09IHBhcnNlSW50KHNZZWFyKSAmJiBtbSA+PSA0KSB8fCAoeXkgPT09IHBhcnNlSW50KHNZZWFyKSArIDEgJiYgbW0gPD0gMykpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFpblllYXIgfHwgZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIiB8fCBmWzEyXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgIT09ICJDT1JQVVMiIHx8IChmWzE4XT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgcm93U3RyID0gci50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXZhbCA9IChxUmF3ID09PSAiIikgPyB7IG1hdGNoZXM6IHRydWUsIHRlcm1zOiBbXSB9IDogZXZhbHVhdGVMb2dpYyhyb3dTdHIsIHFSYXcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGV2YWwubWF0Y2hlcykgew0KICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXQgPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgc2MrKzsNCiAgICAgICAgICAgICAgICAgICAgICBzYSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICAgICAgcmVzdWx0cy5wdXNoKHsgcmNwdDogZlswXSwgZGF0ZTogZlsxXSwgYW10OiBhbXQsIG5hbWU6IGZbMl0sIHBob25lOiBmWzNdIHx8ICItLS0iLCBhZGRyOiBmWzRdPy5yZXBsYWNlKC9+L2csICcsICcpLCBwaW46IGZbMTVdLCBjb3VudHJ5OiBmWzE5XSB9KTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIHJlc3VsdHMuc29ydCgoYSwgYikgPT4gYi5hbXQgLSBhLmFtdCk7DQogICAgICAgICAgICAgIGxldCB0ciA9ICIiOw0KICAgICAgICAgICAgICByZXN1bHRzLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgICAgICAgICBjb25zdCByY3B0TGluayA9IGA8c3BhbiBjbGFzcz0icmNwdC1saW5rIiBvbmNsaWNrPSJqdW1wVG9SZWNlaXB0KCcke2l0ZW0ucmNwdH0nKSI+JHtpdGVtLnJjcHR9PC9zcGFuPmA7DQogICAgICAgICAgICAgICAgICBsZXQgbmFtZURpc3BsYXkgPSAoIWl0ZW0ubmFtZSB8fCBpdGVtLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpID8gYDxzcGFuIHN0eWxlPSJjb2xvcjp2YXIoLS1jYW5jZWwtcmVkKTsgZm9udC13ZWlnaHQ6Ym9sZDsgZm9udC1zaXplOjEuMXJlbTsiPkFOT05ZTU9VUzwvc3Bhbj5gIDogaXRlbS5uYW1lOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZ2VvID0gYCR7aXRlbS5waW59JHtpdGVtLnBpbiAmJiBpdGVtLmNvdW50cnkgPyAnIC0gJyA6ICcnfSR7aXRlbS5jb3VudHJ5fWA7DQogICAgICAgICAgICAgICAgICB0ciArPSBgPHRyPjx0ZCB3aWR0aD0iMzUlIj48ZGl2IHN0eWxlPSJmb250LXdlaWdodDpib2xkOyBjb2xvcjp2YXIoLS1wcmltYXJ5LWJsdWUpOyBmb250LXNpemU6MC44NXJlbTsiPiR7cmNwdExpbmt9PC9kaXY+PGRpdiBzdHlsZT0iZm9udC1zaXplOjAuNzJyZW07IGNvbG9yOiMzMzM7IGxpbmUtaGVpZ2h0OjEuNDsiPiR7aXRlbS5kYXRlfTxicj48Yj7igrkke2l0ZW0uYW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvYj48L2Rpdj48L3RkPjx0ZD48ZGl2IHN0eWxlPSJmb250LXdlaWdodDpib2xkOyBjb2xvcjp2YXIoLS1wcmltYXJ5LWJsdWUpOyBmb250LXNpemU6MC44NXJlbTsiPiR7bmFtZURpc3BsYXl9PC9kaXY+PGRpdiBzdHlsZT0iZm9udC1zaXplOjAuNzJyZW07IGNvbG9yOiMzMzM7IGxpbmUtaGVpZ2h0OjEuNDsiPiR7aXRlbS5hZGRyfSAke2dlbyA/ICcoJyArIGdlbyArICcpJyA6ICcnfTxicj48c3BhbiBzdHlsZT0iY29sb3I6dmFyKC0tcHJpbWFyeS1ibHVlKSI+JHtpdGVtLnBob25lfTwvc3Bhbj48L2Rpdj48L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSB0ciA/IGA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGU+PHRyPjx0aD5SZWNlaXB0L0RhdGUvQW10PC90aD48dGg+RG9ub3IgRGV0YWlsczwvdGg+PC90cj4ke3RyfTwvdGFibGU+PC9kaXY+YCA6ICJObyByZWNvcmRzLiI7DQogICAgICAgICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoU3VtbWFyeUJhcicpOw0KICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGBQLUNvbnNlbnQ6ICR7c2N9IHwgVG90YWw6IOKCuSR7c2EudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9YDsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBDYXNoIFJlY29uY2lsaWF0aW9uOiBDb21wYXJlcyB0aGUgbWFudWFsIENhc2gtTGlzdCB0ZXh0IGZpbGUgYWdhaW5zdCB0aGUNCiAgICAgICAgICAgKiBtYXN0ZXIgZGF0YWJhc2UgdG8gdmVyaWZ5IHRoYXQgYWxsIHBoeXNpY2FsIGNhc2ggcmVjZWl2ZWQgaGFzIGJlZW4gcmVjb3JkZWQuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5DYXNoRGVwKGlzRGFzaCA9IGZhbHNlKSB7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCBjYXNoUmVzID0gYXdhaXQgZmV0Y2goQ0FTSF9MSVNUX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBjYXNoVGV4dCA9IGF3YWl0IGNhc2hSZXMudGV4dCgpOw0KICAgICAgICAgICAgICAgICAgbGV0IGRlcG9zaXRlZFNldCA9IG5ldyBTZXQoKTsNCiAgICAgICAgICAgICAgICAgIGNhc2hUZXh0LnNwbGl0KCdcbicpLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsaW5lLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnRzLmxlbmd0aCA8IDIpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyc2VEYXRlKHBhcnRzWzBdLnRyaW0oKSkgPCBDVVRPRkZfREFURSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBwYXJ0c1sxXS50cmltKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXS5zcGxpdCgnLCcpLmZvckVhY2gobiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjbiA9IG4udHJpbSgpOyBpZiAoIWNuKSByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAiTSIgfHwgdHlwZSA9PT0gIkIiKSBkZXBvc2l0ZWRTZXQuYWRkKCJNUFMiICsgY24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gIkMiIHx8IHR5cGUgPT09ICJCIikgZGVwb3NpdGVkU2V0LmFkZCgiQ0ciICsgY24pOw0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBkYlJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSAoYXdhaXQgZGJSZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nUmVjb3JkcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgbGV0IHRvdGFsUGVuZGluZ0FtdCA9IDA7DQogICAgICAgICAgICAgICAgICByZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMTMpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBub3JtUmNwdCA9IG5vcm1hbGl6ZVJjcHQoZlswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZURhdGUoZlsxXSkgPj0gQ1VUT0ZGX0RBVEUgJiYgKGZbMTFdIHx8ICIiKS50b1VwcGVyQ2FzZSgpLnRyaW0oKSA9PT0gIkNBU0giICYmIChmWzEzXSB8fCAiIikudG9VcHBlckNhc2UoKS50cmltKCkgIT09ICJZRVMiICYmICEoZlsxMF0gfHwgIiIpLnRyaW0oKSAmJiAhQXJyYXkuZnJvbShkZXBvc2l0ZWRTZXQpLnNvbWUoZCA9PiBub3JtYWxpemVSY3B0KGQpID09PSBub3JtUmNwdCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1JlY29yZHMucHVzaCh7IHJjcHQ6IGZbMF0sIGRhdGU6IGZbMV0sIGFtdDogcGFyc2VGbG9hdChmWzldKSB8fCAwIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFBlbmRpbmdBbXQgKz0gcGFyc2VGbG9hdChmWzldKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAvLyBGSU5EIFRISVMgQVJFQSBJTiBZT1VSIE9SSUdJTkFMIHJ1bkNhc2hEZXA6DQogICAgICAgICAgICAgICAgICAvLyBwZW5kaW5nUmVjb3Jkcy5wdXNoKGYpOw0KICAgICAgICAgICAgICAgICAgLy8gfSAoZW5kIG9mIGxvb3ApDQoNCiAgICAgICAgICAgICAgICAgIC8vIElOU0VSVCBUSElTIExJTkUgUklHSFQgSEVSRToNCiAgICAgICAgICAgICAgICAgIHdpbmRvdy5nbG9iYWxQZW5kaW5nQ2FwdHVyZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocGVuZGluZ1JlY29yZHMpKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gLS0tIFNUUkFURUdZIElOU0VSVDogQXNzaWduIEdsb2JhbCAmIFJldHVybiBpZiBEYXNoYm9hcmQgLS0tDQogICAgICAgICAgICAgICAgICBnbG9iYWxEYXNoYm9hcmRDYXNoVG90YWwgPSB0b3RhbFBlbmRpbmdBbXQ7DQogICAgICAgICAgICAgICAgICBnbG9iYWxEYXNoYm9hcmRDYXNoUmVjZWlwdHMgPSBwZW5kaW5nUmVjb3Jkcy5sZW5ndGgNCg0KICAgICAgICAgICAgICAgICAgaWYgKGlzRGFzaCkgew0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsgLy8gVGhpcyBleGl0cyB0aGUgZnVuY3Rpb24gaW1tZWRpYXRlbHkNCiAgICAgICAgICAgICAgICAgIH0gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NCg0KICAgICAgICAgICAgICAgICAgbGV0IGggPSBgPGRpdiBjbGFzcz0iY2FzaC1zdW0tYm94Ij48c3Bhbj5Ub3RhbDog4oK5JHt0b3RhbFBlbmRpbmdBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9zcGFuPjxzcGFuPlJlY2VpcHRzOiAke3BlbmRpbmdSZWNvcmRzLmxlbmd0aH08L3NwYW4+PC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nUmVjb3Jkcy5sZW5ndGggPT09IDApIGggKz0gIjxwIHN0eWxlPSd0ZXh0LWFsaWduOmNlbnRlcjsnPk5vIHBlbmRpbmcgY2FzaCBkZXBvc2l0cy48L3A+IjsNCiAgICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gIjxkaXYgY2xhc3M9J3RhYmxlLXdyYXAnPjx0YWJsZT48dHI+PHRoPlJlY2VpcHQ8L3RoPjx0aD5EYXRlPC90aD48dGg+QW1vdW50PC90aD48L3RyPiI7DQogICAgICAgICAgICAgICAgICAgICAgcGVuZGluZ1JlY29yZHMuc29ydCgoYSwgYikgPT4gcGFyc2VEYXRlKGEuZGF0ZSkgLSBwYXJzZURhdGUoYi5kYXRlKSkuZm9yRWFjaChyZWMgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBoICs9IGA8dHI+PHRkPjxzcGFuIGNsYXNzPSJyY3B0LWxpbmsiIG9uY2xpY2s9Imp1bXBUb1JlY2VpcHQoJyR7cmVjLnJjcHR9JykiPiR7cmVjLnJjcHR9PC9zcGFuPjwvdGQ+PHRkPiR7cmVjLmRhdGV9PC90ZD48dGQ+4oK5JHtyZWMuYW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gIjwvdGFibGU+PC9kaXY+IjsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSBoOw0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQoNCiAgICAgICAgICB9DQoNCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIGVSZWNlaXB0IFRvb2w6IEdlbmVyYXRlcyBhIHByaW50YWJsZSwgcHJvZmVzc2lvbmFsIEhUTUwgcmVjZWlwdCBmb3IgYSBzcGVjaWZpYw0KICAgICAgICAgICAqIHJlY2VpcHQgbnVtYmVyLiBJdCBpbmNsdWRlcyBhIHdhdGVybWFyayBhbmQgdHJ1c3Qtc3BlY2lmaWMgbGVnYWwgd29yZGluZy4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkVSZWNlaXB0KHByZWZpbGxlZElEID0gbnVsbCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBsZXQgcSA9IHByb21wdCgiRW50ZXIgUmVjZWlwdCBObzoiLCBwcmVmaWxsZWRJRCB8fCAiIik7DQogICAgICAgICAgICAgIGlmICghcSkgcmV0dXJuOw0KICAgICAgICAgICAgICBxID0gcS50cmltKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gKGF3YWl0IHJlcy50ZXh0KCkpLnNwbGl0KCdcbicpOw0KICAgICAgICAgICAgICBsZXQgZm91bmQgPSByZWNzLmZpbmQociA9PiByLnNwbGl0KCd8JylbMF0udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09IHEpOw0KICAgICAgICAgICAgICBpZiAoIWZvdW5kKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiTm90IGluIERhdGFiYXNlIik7DQogICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgbGV0IGYgPSBmb3VuZC5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICBjb25zdCBpc0MgPSAoZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIik7DQogICAgICAgICAgICAgIGxldCB3YXRlcm1hcmtIdG1sID0gaXNDID8gJzxkaXYgY2xhc3M9IndhdGVybWFyayI+Q0FOQ0VMTEVEPC9kaXY+JyA6ICIiOw0KICAgICAgICAgICAgICBjb25zdCBiYXNlQWRkciA9IChmWzRdIHx8ICIiKS5yZXBsYWNlKC9+L2csICc8YnI+JyksIHBpbiA9IGZbMTVdIHx8ICIiLCBjb3VudHJ5ID0gZlsxOV0gfHwgIiI7DQogICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlBZGRyID0gYmFzZUFkZHIgKyAoKHBpbiB8fCBjb3VudHJ5KSA/ICgiPGJyPiIgKyBwaW4gKyAiICIgKyBjb3VudHJ5KSA6ICIiKTsNCiAgICAgICAgICAgICAgbGV0IGggPSBgPGJ1dHRvbiBjbGFzcz0iYnRuLXJvdGF0ZSIgb25jbGljaz0idG9nZ2xlUm90YXRpb24oKSI+Um90YXRlICg5MMKwKTwvYnV0dG9uPjxkaXYgY2xhc3M9InJlY2VpcHQtdmlld3BvcnQiPjxkaXYgaWQ9InNwYWNlclRvcCIgY2xhc3M9InNzLXNwYWNlciI+PC9kaXY+PGRpdiBpZD0icmVjZWlwdENvbnRhaW5lciIgY2xhc3M9InJlY2VpcHQtY29udGFpbmVyICR7aXNDID8gJ2NhbmNlbGxlZC1yb3cnIDogJyd9Ij4ke3dhdGVybWFya0h0bWx9PHRhYmxlIGNsYXNzPSJyZWNlaXB0LWh0bWwiPjx0cj48dGQgd2lkdGg9IjEzMCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+PGltZyBzcmM9Imh0dHBzOi8vd3d3LmdhbmVzYXNhcm1hLmNvbS9QZXJpeWF2YS5qcGciIHdpZHRoPSIxMTAiPjwvdGQ+PHRkPjxjZW50ZXI+PGI+TVlMQUkgTUFIQVBFUklZQVZBIEFOVVNIQU0gVFJVU1QgKFJFR0QuKSw8L2I+PGJyPlBpdGNodXBpbGxhaSBTdHJlZXQsIE15bGFwb3JlLCBDaGVubmFpLTQuPGJyPlBoOiA2MzgwODk4MjMxLCA4NjEwMjE0MTM4Ljxicj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjExcHg7Ij50aGlydW15bGFpYW51c2hhbUBnbWFpbC5jb208L3NwYW4+PGJyPjxkaXYgc3R5bGU9Im1hcmdpbi10b3A6NXB4OyBkaXNwbGF5OmZsZXg7IGp1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuOyB3aWR0aDoxMDAlOyI+PHNwYW4+PGI+JHtmWzFdfTwvYj48L3NwYW4+PHNwYW4+PGI+UmVjZWlwdDwvYj48L3NwYW4+PHNwYW4+PGI+JHtmWzBdfTwvYj48L3NwYW4+PC9kaXY+PC9jZW50ZXI+PC90ZD48L3RyPjx0cj48dGQgY29sc3Bhbj0iMiI+PHA+UmVjZWl2ZWQgUnMuIDxiPiR7Zls5XX08L2I+IGZvciA8Yj4ke2ZbMTJdfTwvYj4gdmlhIDxiPiR7ZlsxMV19ICR7ZlsxMF0gfHwgIiJ9PC9iPiBmcm9tOjwvcD48L3RkPjwvdHI+PHRyPjx0ZD48Yj5OYW1lPC9iPjwvdGQ+PHRkPjxiPlNocmkuL1NtdC4gJHtmWzJdfTwvYj48L3RkPjwvdHI+PHRyPjx0ZD48Yj5QQU48L2I+PC90ZD48dGQ+JHtmWzZdIHx8ICIifTwvdGQ+PC90cj48dHI+PHRkPjxiPlBob25lPC9iPjwvdGQ+PHRkPiR7ZlszXX08L3RkPjwvdHI+PHRyPjx0ZD48Yj5BZGRyZXNzPC9iPjwvdGQ+PHRkPiR7ZGlzcGxheUFkZHJ9PC90ZD48L3RyPjx0cj48dGQgY29sc3Bhbj0iMiIgc3R5bGU9InRleHQtYWxpZ246cmlnaHQ7IGJvcmRlci10b3A6MnB4IHNvbGlkICMwMDA7Ij5mb3IgPGI+TVlMQUkgTUFIQVBFUklZQVZBIEFOVVNIQU0gVFJVU1Q8L2I+PGJyPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTFweDsgZm9udC13ZWlnaHQ6Ym9sZDsiPlNlY3Rpb24gMTItQSByZWdpc3RyYXRpb24gdmFsaWQgdGlsbCAzMS0wMy0yMDI2PC9zcGFuPjwvdGQ+PC90cj48L3RhYmxlPjwvZGl2PjxkaXYgaWQ9InNwYWNlckJvdHRvbSIgY2xhc3M9InNzLXNwYWNlciI+PC9kaXY+PC9kaXY+PGJ1dHRvbiBjbGFzcz0iYnRuLXdhIiBvbmNsaWNrPSdzZW5kV2hhdHNBcHAoJHtKU09OLnN0cmluZ2lmeShmKX0pJz5TZW5kIHZpYSBXaGF0c0FwcDwvYnV0dG9uPmA7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSBoOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFN0YXRpc3RpY2FsIFN1bW1hcnk6IEdlbmVyYXRlcyBhIGhpZ2gtbGV2ZWwgb3ZlcnZpZXcgb2YgdG90YWwgaW5jb21lLA0KICAgICAgICAgICAqIGRvbm9yIGNvdW50cywgYW5kIGNhdGVnb3JpY2FsIGJyZWFrZG93bnMgKENvcnB1cyB2cy4gR2VuZXJhbCkgd2l0aCB2aXN1YWwgY2hhcnRzLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuU3VtbWFyeSgpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgY29uc3Qgc1llYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSAoYXdhaXQgcmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGxldCBzID0geyB0QW10OiAwLCB0Q250OiAwLCB0b3dhcmRzOiB7fSwgbW9kZToge30sIHRyZW5kOiB7fSwgYW5vbkE6IDAsIGFub25DOiAwLCBub05hbWVBOiAwLCBub05hbWVDOiAwLCBub1Bob25lQTogMCwgbm9QaG9uZUM6IDAsIG5vUGFuQTogMCwgbm9QYW5DOiAwLCBwZW5kQ29ycEE6IDAsIHBlbmRDb3JwQzogMCB9Ow0KICAgICAgICAgICAgICBjb25zdCBtb24gPSBbIkFwciIsICJNYXkiLCAiSnVuIiwgIkp1bCIsICJBdWciLCAiU2VwIiwgIk9jdCIsICJOb3YiLCAiRGVjIiwgIkphbiIsICJGZWIiLCAiTWFyIl07DQogICAgICAgICAgICAgIHJlY3MuZm9yRWFjaChyID0+IHsNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMTMgfHwgZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIikgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZFAgPSBmWzFdLnNwbGl0KC9bLS9dLyk7DQogICAgICAgICAgICAgICAgICBjb25zdCBtID0gcGFyc2VJbnQoZFBbMV0pLCB5ID0gcGFyc2VJbnQoZFBbMl0pOw0KICAgICAgICAgICAgICAgICAgaWYgKHNZZWFyICE9PSAiYWxsIiAmJiAhKCh5ID09PSBwYXJzZUludChzWWVhcikgJiYgbSA+PSA0KSB8fCAoeSA9PT0gcGFyc2VJbnQoc1llYXIpICsgMSAmJiBtIDw9IDMpKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgbGV0IGFtdCA9IHBhcnNlRmxvYXQoZls5XSkgfHwgMDsNCiAgICAgICAgICAgICAgICAgIHMudEFtdCArPSBhbXQ7DQogICAgICAgICAgICAgICAgICBzLnRDbnQrKzsNCiAgICAgICAgICAgICAgICAgIGxldCB0dyA9IChmWzEyXSB8fCAiT1RIRVJTIikudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgIGlmICghcy50b3dhcmRzW3R3XSkgcy50b3dhcmRzW3R3XSA9IHsgYTogMCwgYzogMCB9Ow0KICAgICAgICAgICAgICAgICAgcy50b3dhcmRzW3R3XS5hICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgIHMudG93YXJkc1t0d10uYysrOw0KICAgICAgICAgICAgICAgICAgbGV0IG1kID0gKGZbMTFdIHx8ICJVUEkiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFzLm1vZGVbbWRdKSBzLm1vZGVbbWRdID0geyBhOiAwLCBjOiAwIH07DQogICAgICAgICAgICAgICAgICBzLm1vZGVbbWRdLmEgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgcy5tb2RlW21kXS5jKys7DQogICAgICAgICAgICAgICAgICBpZiAoIWZbMl0/LnRyaW0oKSB8fCBmWzJdLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImFub255bW91cyIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgcy5hbm9uQysrOw0KICAgICAgICAgICAgICAgICAgICAgIHMuYW5vbkEgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgaWYgKCFmWzJdPy50cmltKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICBzLm5vTmFtZUMrKzsNCiAgICAgICAgICAgICAgICAgICAgICBzLm5vTmFtZUEgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgaWYgKCFmWzNdPy50cmltKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICBzLm5vUGhvbmVDKys7DQogICAgICAgICAgICAgICAgICAgICAgcy5ub1Bob25lQSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAoIWZbNl0/LnRyaW0oKSkgew0KICAgICAgICAgICAgICAgICAgICAgIHMubm9QYW5DKys7DQogICAgICAgICAgICAgICAgICAgICAgcy5ub1BhbkEgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgaWYgKGZbMTJdPy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDT1JQVVMiKSAmJiBmWzE4XT8udG9VcHBlckNhc2UoKSAhPT0gIllFUyIpIHsNCiAgICAgICAgICAgICAgICAgICAgICBzLnBlbmRDb3JwQysrOw0KICAgICAgICAgICAgICAgICAgICAgIHMucGVuZENvcnBBICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGxldCBsYmwgPSAoc1llYXIgPT09ICJhbGwiKSA/IHkgOiBtb25bKG0gKyA4KSAlIDEyXTsNCiAgICAgICAgICAgICAgICAgIHMudHJlbmRbbGJsXSA9IChzLnRyZW5kW2xibF0gfHwgMCkgKyBhbXQ7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICBsZXQgaCA9IGA8ZGl2IHN0eWxlPSJiYWNrZ3JvdW5kOndoaXRlOyBwYWRkaW5nOjEwcHg7IGJvcmRlci1yYWRpdXM6MTBweDsiPjx0YWJsZSBjbGFzcz0ic3VtLXRhYmxlIj48dGhlYWQ+PHRyPjx0aD5JdGVtPC90aD48dGg+RG9ub3JzPC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+PHRyIHN0eWxlPSJmb250LXdlaWdodDpib2xkOyI+PHRkPlRvdGFsPC90ZD48dGQ+JHtzLnRDbnR9PC90ZD48dGQ+JHtzLnRBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPjx0ciBjbGFzcz0ic2VjdGlvbi1oZHIiPjx0ZCBjb2xzcGFuPSIzIj5Ub3dhcmRzPC90ZD48L3RyPmA7DQogICAgICAgICAgICAgIGZvciAobGV0IHQgaW4gcy50b3dhcmRzKSBoICs9IGA8dHI+PHRkPiR7dH08L3RkPjx0ZD4ke3MudG93YXJkc1t0XS5jfTwvdGQ+PHRkPiR7cy50b3dhcmRzW3RdLmEudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgIGggKz0gYDx0ciBjbGFzcz0ic2VjdGlvbi1oZHIiPjx0ZCBjb2xzcGFuPSIzIj5Nb2RlPC90ZD48L3RyPmA7DQogICAgICAgICAgICAgIGZvciAobGV0IG0gaW4gcy5tb2RlKSBoICs9IGA8dHI+PHRkPiR7bX08L3RkPjx0ZD4ke3MubW9kZVttXS5jfTwvdGQ+PHRkPiR7cy5tb2RlW21dLmEudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgIGggKz0gYDx0ciBjbGFzcz0ic2VjdGlvbi1oZHIiPjx0ZCBjb2xzcGFuPSIzIj5BbmFseXRpY3M8L3RkPjwvdHI+PHRyPjx0ZD5Bbm9ueW1vdXM8L3RkPjx0ZD4ke3MuYW5vbkN9PC90ZD48dGQ+JHtzLmFub25BLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48dHI+PHRkPlBlbmRpbmcgQ29uc2VudDwvdGQ+PHRkPiR7cy5wZW5kQ29ycEN9PC90ZD48dGQ+JHtzLnBlbmRDb3JwQS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PHRyPjx0ZD5OTyBOQU1FPC90ZD48dGQ+JHtzLm5vTmFtZUN9PC90ZD48dGQ+JHtzLm5vTmFtZUEudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPjx0cj48dGQ+Tk8gUEhPTkU8L3RkPjx0ZD4ke3Mubm9QaG9uZUN9PC90ZD48dGQ+JHtzLm5vUGhvbmVBLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj48dHI+PHRkPk5PIFBBTjwvdGQ+PHRkPiR7cy5ub1BhbkN9PC90ZD48dGQ+JHtzLm5vUGFuQS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+PC90YWJsZT48ZGl2IGNsYXNzPSJjaGFydC13cmFwcGVyIj48ZGl2IGNsYXNzPSJjaGFydC1jb250YWluZXIiPjxjYW52YXMgaWQ9ImMxIj48L2NhbnZhcz48L2Rpdj48ZGl2IGNsYXNzPSJjaGFydC1jb250YWluZXIiPjxjYW52YXMgaWQ9ImMyIj48L2NhbnZhcz48L2Rpdj48ZGl2IGNsYXNzPSJjaGFydC1jb250YWluZXIiPjxjYW52YXMgaWQ9ImMzIj48L2NhbnZhcz48L2Rpdj48L2Rpdj48L2Rpdj5gOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gaDsNCiAgICAgICAgICAgICAgYWN0aXZlQ2hhcnRzLnB1c2gobmV3IENoYXJ0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjMScpLCB7IHR5cGU6ICdiYXInLCBkYXRhOiB7IGxhYmVsczogT2JqZWN0LmtleXMocy50cmVuZCksIGRhdGFzZXRzOiBbeyBsYWJlbDogJ1RyZW5kJywgZGF0YTogT2JqZWN0LnZhbHVlcyhzLnRyZW5kKSwgYmFja2dyb3VuZENvbG9yOiAnIzAwMDA4QicgfV0gfSB9KSk7DQogICAgICAgICAgICAgIGFjdGl2ZUNoYXJ0cy5wdXNoKG5ldyBDaGFydChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYzInKSwgeyB0eXBlOiAncGllJywgZGF0YTogeyBsYWJlbHM6IE9iamVjdC5rZXlzKHMubW9kZSksIGRhdGFzZXRzOiBbeyBkYXRhOiBPYmplY3QudmFsdWVzKHMubW9kZSkubWFwKHggPT4geC5hKSwgYmFja2dyb3VuZENvbG9yOiBbJyNGRjYzODQnLCAnIzM2QTJFQicsICcjRkZDRTU2JywgJyM0QkMwQzAnXSB9XSB9IH0pKTsNCiAgICAgICAgICAgICAgYWN0aXZlQ2hhcnRzLnB1c2gobmV3IENoYXJ0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjMycpLCB7IHR5cGU6ICdwaWUnLCBkYXRhOiB7IGxhYmVsczogT2JqZWN0LmtleXMocy50b3dhcmRzKSwgZGF0YXNldHM6IFt7IGRhdGE6IE9iamVjdC52YWx1ZXMocy50b3dhcmRzKS5tYXAoeCA9PiB4LmEpLCBiYWNrZ3JvdW5kQ29sb3I6IFsnIzk5NjZGRicsICcjNEJDMEMwJywgJyNGRjlGNDAnLCAnI0ZGNjM4NCcsICcjMzZBMkVCJ10gfV0gfSB9KSk7DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQoNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBNYWluIFNlYXJjaCBFbmdpbmU6IEZldGNoZXMgdGhlIG1hc3RlciBkYXRhYmFzZSBhbmQgYXBwbGllcyB1c2VyLWRlZmluZWQNCiAgICAgICAgICAgKiBmaWx0ZXJzIChZZWFyLCBTZWFyY2ggVGVybXMpIHRvIGRpc3BsYXkgbWF0Y2hpbmcgcmVjb3JkcyBpbiBhIGRldGFpbGVkIGxpc3QgZm9ybWF0Lg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZmV0Y2hBbmRTZWFyY2goKSB7DQogICAgICAgICAgICAgIGNvbnN0IHFSYXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoSW5wdXQnKS52YWx1ZS50cmltKCk7DQogICAgICAgICAgICAgIGlmICghcVJhdykgcmV0dXJuOw0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IGlzTnVtZXJpY1NlYXJjaCA9IC9eXGQrJC8udGVzdChxUmF3LnJlcGxhY2UoL1xEL2csICcnKSk7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSB0ZXh0LnNwbGl0KCdcbicpOw0KICAgICAgICAgICAgICBsZXQgdHIgPSAiIiwgZGV0ID0gIiIsIHNjID0gMCwgc2EgPSAwLCBsYXRlc3RSZWMgPSBudWxsLCBsYXRlc3REYXRlID0gbmV3IERhdGUoMCksIHBlbmRpbmdDb25zZW50cyA9IFtdOw0KICAgICAgICAgICAgICBmb3IgKGxldCByIG9mIHJlY3MpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGV2YWwgPSBldmFsdWF0ZUxvZ2ljKHIudG9Mb3dlckNhc2UoKSwgcVJhdyk7DQogICAgICAgICAgICAgICAgICBpZiAoZXZhbC5tYXRjaGVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMjApIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNkID0gcGFyc2VEYXRlKGZbMV0pLCBkUCA9IGZbMV0uc3BsaXQoL1stL10vKSwgbW0gPSBwYXJzZUludChkUFsxXSksIHl5ID0gcGFyc2VJbnQoZFBbMl0pOw0KICAgICAgICAgICAgICAgICAgICAgIGlmICgoc1llYXIgPT09ICJhbGwiKSB8fCAoKHl5ID09PSBwYXJzZUludChzWWVhcikgJiYgbW0gPj0gNCkgfHwgKHl5ID09PSBwYXJzZUludChzWWVhcikgKyAxICYmIG1tIDw9IDMpKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0MgPSAoZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHNjKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNDKSBzYSArPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNDICYmIGZbMTJdPy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDT1JQVVMiKSAmJiBmWzE4XT8udG9VcHBlckNhc2UoKSAhPT0gIllFUyIgfHwgZlswXS5zdGFydHNXaXRoKCJHVyIpKSBwZW5kaW5nQ29uc2VudHMucHVzaCh7IG51bTogZlswXSwgZnk6IGdldEZZKGZbMV0pIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOdW1lcmljU2VhcmNoICYmIGNkID4gbGF0ZXN0RGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXN0RGF0ZSA9IGNkOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF0ZXN0UmVjID0gZjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByY3B0TGluayA9IGA8c3BhbiBjbGFzcz0icmNwdC1saW5rIiBvbmNsaWNrPSJqdW1wVG9SZWNlaXB0KCcke2ZbMF19JykiPiR7aGlnaGxpZ2h0VGV4dChmWzBdLCBldmFsLnRlcm1zKX08L3NwYW4+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTnVtZXJpY1NlYXJjaCkgdHIgKz0gYDx0ciBjbGFzcz0iJHtpc0MgPyAnY2FuY2VsbGVkLXJvdycgOiAnJ30iPjx0ZD4ke3JjcHRMaW5rfTwvdGQ+PHRkPiR7ZlsxXX08L3RkPjx0ZD4ke2hpZ2hsaWdodFRleHQoZlsyXSwgZXZhbC50ZXJtcyl9PC90ZD48dGQ+JHtoaWdobGlnaHRUZXh0KGZbMTJdLCBldmFsLnRlcm1zKX08L3RkPjx0ZD7igrkke2ZbOV19PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBmbGQgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBUSVRMRVMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWwgPSAoaSA9PT0gMCkgPyByY3B0TGluayA6IGhpZ2hsaWdodFRleHQoZltpXSB8fCAiLS0tIiwgZXZhbC50ZXJtcyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGQgKz0gYDxkaXYgY2xhc3M9ImZpZWxkLXJvdyI+PHNwYW4gY2xhc3M9ImZpZWxkLWhlYWRlciI+JHtUSVRMRVNbaV19Ojwvc3Bhbj48c3BhbiBjbGFzcz0iZmllbGQtdmFsIj4ke3ZhbH08L3NwYW4+PC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBkZXQgKz0gYDxkaXYgY2xhc3M9InJlY29yZCAke2lzQyA/ICdjYW5jZWxsZWQtcm93JyA6ICcnfSI+JHtmbGR9PC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgbGV0IGFkZHJlc3NCb3hIdG1sID0gIiI7DQogICAgICAgICAgICAgIGlmIChpc051bWVyaWNTZWFyY2ggJiYgbGF0ZXN0UmVjKSB7DQogICAgICAgICAgICAgICAgICBsZXQgY29uc2VudExpbmVzID0gcGVuZGluZ0NvbnNlbnRzLm1hcChjID0+IGAke2MubnVtfSA8c3BhbiBjbGFzcz0iY29uc2VudC1meS1ibHVlIj5bJHtjLmZ5fV08L3NwYW4+YCkuam9pbignLCAnKTsNCiAgICAgICAgICAgICAgICAgIGFkZHJlc3NCb3hIdG1sID0gYDxkaXYgY2xhc3M9ImxhdGVzdC1hZGRyLWJveCI+PHNwYW4gY2xhc3M9ImxhdGVzdC1hZGRyLWhlYWRlciI+TGF0ZXN0IEFkZHJlc3M8L3NwYW4+PGI+TmFtZTo8L2I+ICR7bGF0ZXN0UmVjWzJdfTxicj48Yj5BZGRyZXNzOjwvYj4gJHtsYXRlc3RSZWNbNF0ucmVwbGFjZSgvfi9nLCAnLCAnKX08YnI+PGI+UGluY29kZTo8L2I+ICR7bGF0ZXN0UmVjWzE1XSB8fCAiLS0tIn08YnI+PGI+UGhvbmU6PC9iPiAke2xhdGVzdFJlY1szXX0ke3BlbmRpbmdDb25zZW50cy5sZW5ndGggPiAwID8gYDxkaXYgY2xhc3M9InBlbmRpbmctY29uc2VudC1saW5lIj5QZW5kaW5nIENvbnNlbnQgTGV0dGVyczogJHtjb25zZW50TGluZXN9PC9kaXY+YCA6ICcnfTwvZGl2PmA7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ251bWVyaWNSZXN1bHRzJykuaW5uZXJIVE1MID0gYWRkcmVzc0JveEh0bWwgKyAoaXNOdW1lcmljU2VhcmNoICYmIHRyID8gYDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT48dHI+PHRoPk5vLjwvdGg+PHRoPkRhdGU8L3RoPjx0aD5OYW1lPC90aD48dGg+VG93YXJkczwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj4ke3RyfTwvdGFibGU+PC9kaXY+YCA6ICIiKTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGRldCB8fCAiTm8gcmVjb3JkcyBmb3VuZC4iOw0KICAgICAgICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKTsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCiAgICAgICAgICAgICAgYi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBgRm91bmQ6ICR7c2N9IHwgVG90YWw6IOKCuSR7c2EudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9YDsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCg0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIEFub255bW91cyBGaWx0ZXI6IElzb2xhdGVzIGFuZCB0b3RhbHMgYWxsIGRvbmF0aW9ucyBtYXJrZWQgYXMgJ0Fub255bW91cycNCiAgICAgICAgICAgKiB0byBlbnN1cmUgdGhleSBhcmUgaGFuZGxlZCBhY2NvcmRpbmcgdG8gdHJ1c3QgYWNjb3VudGluZyBzdGFuZGFyZHMuDQogICAgICAgICAgICovDQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuQW5vbnltb3VzKCkgew0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KDQogICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICBjb25zdCBmeUxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS5wYXJlbnRFbGVtZW50LmlubmVyVGV4dC50cmltKCk7DQogICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlUaXRsZSA9IHNlbGVjdGVkRlkgPT09ICdhbGwnID8gJ0FsbCBZZWFycycgOiBmeUxhYmVsOw0KDQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gc2VsZWN0ZWRGWTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gKGF3YWl0IHJlcy50ZXh0KCkpLnNwbGl0KCdcbicpOw0KDQogICAgICAgICAgICAgIGxldCBhbm9uTGlzdCA9IFtdLCBzYyA9IDAsIHNhID0gMDsNCg0KICAgICAgICAgICAgICAvLyAxLiBQUk9DRVNTIERBVEENCiAgICAgICAgICAgICAgcmVjcy5mb3JFYWNoKHIgPT4gew0KICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxMyB8fCAoZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIikpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRQID0gZlsxXS5zcGxpdCgvWy0vXS8pLCBtbSA9IHBhcnNlSW50KGRQWzFdKSwgeXkgPSBwYXJzZUludChkUFsyXSk7DQoNCiAgICAgICAgICAgICAgICAgIGlmICgoc1llYXIgPT09ICJhbGwiKSB8fCAoKHl5ID09PSBwYXJzZUludChzWWVhcikgJiYgbW0gPj0gNCkgfHwgKHl5ID09PSBwYXJzZUludChzWWVhcikgKyAxICYmIG1tIDw9IDMpKSkgew0KICAgICAgICAgICAgICAgICAgICAgIGlmICghZlsyXS50cmltKCkgfHwgZlsyXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYW10ID0gcGFyc2VGbG9hdChmWzldKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBzYysrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBzYSArPSBhbXQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGFub25MaXN0LnB1c2goeyByY3B0OiBmWzBdLCBkYXRlOiBmWzFdLCBhbXQ6IGFtdCwgcmVmOiBmWzEwXSB8fCAiLS0tIiB9KTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIGFub25MaXN0LnNvcnQoKGEsIGIpID0+IGIuYW10IC0gYS5hbXQpOw0KDQogICAgICAgICAgICAgIGNvbnN0IHRhYmxlSGVhZGVyID0gYDx0cj48dGg+UmVjZWlwdDwvdGg+PHRoPkRhdGU8L3RoPjx0aD5BbW91bnQ8L3RoPjx0aD5SZWY8L3RoPjwvdHI+YDsNCg0KICAgICAgICAgICAgICAvLyAyLiBHRU5FUkFURSBST1dTIEZPUiBUQUJMRSAxOiBDSEVRVUUNCiAgICAgICAgICAgICAgbGV0IHRyQ2hxID0gIiI7DQogICAgICAgICAgICAgIGFub25MaXN0LmZvckVhY2gocmVjID0+IHsNCiAgICAgICAgICAgICAgICAgIGlmIChyZWMucmVmLnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoIkNIUSIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmNwdExpbmsgPSBgPHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHtyZWMucmNwdH0nKSI+JHtyZWMucmNwdH08L3NwYW4+YDsNCiAgICAgICAgICAgICAgICAgICAgICB0ckNocSArPSBgPHRyIGNsYXNzPSIke3JlYy5yY3B0LnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgiR1ciKSA/ICdndy1yb3cnIDogJyd9Ij48dGQ+JHtyY3B0TGlua308L3RkPjx0ZD4ke3JlYy5kYXRlfTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7cmVjLmFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjx0ZD4ke3JlYy5yZWZ9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIC8vIDMuIEdFTkVSQVRFIFJPV1MgRk9SIFRBQkxFIDI6IFVQSSArIFBIT05FDQogICAgICAgICAgICAgIGxldCB0clVQSSA9ICIiOw0KICAgICAgICAgICAgICBhbm9uTGlzdC5mb3JFYWNoKHJlYyA9PiB7DQogICAgICAgICAgICAgICAgICBjb25zdCByZWZlcmVuY2UgPSByZWMucmVmLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICBpZiAocmVmZXJlbmNlLmluY2x1ZGVzKCJVUEkiKSAmJiAvXC9cZHsxMH1cLy8udGVzdChyZWZlcmVuY2UpKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmNwdExpbmsgPSBgPHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHtyZWMucmNwdH0nKSI+JHtyZWMucmNwdH08L3NwYW4+YDsNCiAgICAgICAgICAgICAgICAgICAgICB0clVQSSArPSBgPHRyIGNsYXNzPSIke3JlYy5yY3B0LnRvVXBwZXJDYXNlKCkuc3RhcnRzV2l0aCgiR1ciKSA/ICdndy1yb3cnIDogJyd9Ij48dGQ+JHtyY3B0TGlua308L3RkPjx0ZD4ke3JlYy5kYXRlfTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7cmVjLmFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjx0ZD4ke3JlYy5yZWZ9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIC8vIDQuIEdFTkVSQVRFIFJPV1MgRk9SIFRBQkxFIDM6IFNUQU5EQVJEDQogICAgICAgICAgICAgIGxldCB0clN0YW5kYXJkID0gIiI7DQogICAgICAgICAgICAgIGFub25MaXN0LmZvckVhY2gocmVjID0+IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJjcHRMaW5rID0gYDxzcGFuIGNsYXNzPSJyY3B0LWxpbmsiIG9uY2xpY2s9Imp1bXBUb1JlY2VpcHQoJyR7cmVjLnJjcHR9JykiPiR7cmVjLnJjcHR9PC9zcGFuPmA7DQogICAgICAgICAgICAgICAgICB0clN0YW5kYXJkICs9IGA8dHIgY2xhc3M9IiR7cmVjLnJjcHQudG9VcHBlckNhc2UoKS5zdGFydHNXaXRoKCJHVyIpID8gJ2d3LXJvdycgOiAnJ30iPjx0ZD4ke3JjcHRMaW5rfTwvdGQ+PHRkPiR7cmVjLmRhdGV9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtyZWMuYW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PHRkPiR7cmVjLnJlZn08L3RkPjwvdHI+YDsNCiAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgLy8gNS4gQVNTRU1CTEUgQUxMIFRBQkxFUw0KICAgICAgICAgICAgICBsZXQgZmluYWxIdG1sID0gIiI7DQoNCiAgICAgICAgICAgICAgLy8gVGFibGUgMTogQ2hlcXVlDQogICAgICAgICAgICAgIGZpbmFsSHRtbCArPSBgPGRpdiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9Im1hcmdpbi10b3A6MzBweDsiPkFub255bW91cyBDaGVxdWUgRG9ub3JzPC9kaXY+YDsNCiAgICAgICAgICAgICAgZmluYWxIdG1sICs9IGA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGU+JHt0YWJsZUhlYWRlcn0ke3RyQ2hxIHx8ICc8dHI+PHRkIGNvbHNwYW49IjQiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPk5vIENoZXF1ZSByZWNvcmRzIGZvdW5kLjwvdGQ+PC90cj4nfTwvdGFibGU+PC9kaXY+YDsNCg0KICAgICAgICAgICAgICBmaW5hbEh0bWwgKz0gYDxociBzdHlsZT0ibWFyZ2luOiA0MHB4IDA7IGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXByaW1hcnktYmx1ZSk7Ij5gOw0KDQogICAgICAgICAgICAgIC8vIFRhYmxlIDI6IFVQSSArIFBob25lDQogICAgICAgICAgICAgIGZpbmFsSHRtbCArPSBgPGRpdiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9Im1hcmdpbi10b3A6MzBweDsiPkFub255bW91cyBVUEkgRG9ub3JzIHdpdGggVGVsZXBob25lIE51bWJlcnM8L2Rpdj5gOw0KICAgICAgICAgICAgICBmaW5hbEh0bWwgKz0gYDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZT4ke3RhYmxlSGVhZGVyfSR7dHJVUEkgfHwgJzx0cj48dGQgY29sc3Bhbj0iNCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+Tm8gVVBJIFBob25lIHJlY29yZHMgZm91bmQuPC90ZD48L3RyPid9PC90YWJsZT48L2Rpdj5gOw0KDQogICAgICAgICAgICAgIGZpbmFsSHRtbCArPSBgPGhyIHN0eWxlPSJtYXJnaW46IDQwcHggMDsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tcHJpbWFyeS1ibHVlKTsiPmA7DQoNCiAgICAgICAgICAgICAgLy8gVGFibGUgMzogRnVsbCBMaXN0DQogICAgICAgICAgICAgIGZpbmFsSHRtbCArPSBgPGRpdiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9Im1hcmdpbi10b3A6MzBweDsiPkFub255bW91cyBEb25vcnMgZm9yIEZpbmFuY2lhbCBZZWFyIDogJHtkaXNwbGF5VGl0bGV9PC9kaXY+YDsNCiAgICAgICAgICAgICAgZmluYWxIdG1sICs9IGA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGU+JHt0YWJsZUhlYWRlcn0ke3RyU3RhbmRhcmQgfHwgJzx0cj48dGQgY29sc3Bhbj0iNCIgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+Tm8gcmVjb3JkcyBmb3VuZC48L3RkPjwvdHI+J308L3RhYmxlPjwvZGl2PmA7DQoNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmlubmVySFRNTCA9IGZpbmFsSHRtbDsNCg0KICAgICAgICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKTsNCiAgICAgICAgICAgICAgYi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBgQW5vbnltb3VzOiAke3NjfSB8IFRvdGFsOiDigrkke3NhLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfWA7DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQogICAgICAgICAgfQ0KDQoNCg0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogTWFpbGluZyBMaXN0IEdlbmVyYXRvcjogQ29tcGlsZXMgYSB1bmlxdWUgbGlzdCBvZiBkb25vcnMgd2l0aCB2YWxpZCBhZGRyZXNzZXMNCiAgICAgICAgICAgKiBmb3IgdGhlIHNlbGVjdGVkIHllYXIsIHNwZWNpZmljYWxseSBleGNsdWRpbmcgdGhvc2UgbWFya2VkIGFzICdBbm9ueW1vdXMnLg0KICAgICAgICAgICAqLw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuRG9ub3JMaXN0KCkgew0KICAgICAgICAgICAgICBsZXQgcSA9IHByb21wdCgiU2VhcmNoIERvbm9yPyIsICIiKTsNCiAgICAgICAgICAgICAgaWYgKHEgPT09IG51bGwpIHJldHVybjsNCiAgICAgICAgICAgICAgbGV0IHFSYXcgPSBxLnRyaW0oKS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgICAgICBjbGVhcldvcmtzcGFjZSgpOw0KICAgICAgICAgICAgICBjb25zdCBzWWVhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJykudmFsdWU7DQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVjcyA9IChhd2FpdCByZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IGRvbm9ycyA9IHt9Ow0KICAgICAgICAgICAgICByZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDIwIHx8IGZbMTNdPy50b1VwcGVyQ2FzZSgpID09PSAiWUVTIiB8fCBmWzBdLnN0YXJ0c1dpdGgoIkdXIikpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHBob25lID0gZlszXT8udHJpbSgpIHx8ICIiOw0KICAgICAgICAgICAgICAgICAgaWYgKHBob25lLnN0YXJ0c1dpdGgoIjk5OTk5IikgfHwgcGhvbmUuc3RhcnRzV2l0aCgiODg4ODgiKSB8fCAhcGhvbmUpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRQID0gZlsxXS5zcGxpdCgvWy0vXS8pLCBtbSA9IHBhcnNlSW50KGRQWzFdKSwgeXkgPSBwYXJzZUludChkUFsyXSk7DQogICAgICAgICAgICAgICAgICBpZiAoc1llYXIgIT09ICJhbGwiICYmICEoKHl5ID09PSBwYXJzZUludChzWWVhcikgJiYgbW0gPj0gNCkgfHwgKHl5ID09PSBwYXJzZUludChzWWVhcikgKyAxICYmIG1tIDw9IDMpKSkgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgaWYgKHFSYXcgIT09ICIiICYmICFyLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocVJhdykpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGlmICghZG9ub3JzW3Bob25lXSkgZG9ub3JzW3Bob25lXSA9IHsgcGg6IHBob25lLCBjbnQ6IDAsIGFtdDogMCwgbGF0ZXN0OiBuZXcgRGF0ZSgwKSwgbmFtZTogIiIsIGFkZHI6ICIiIH07DQogICAgICAgICAgICAgICAgICBkb25vcnNbcGhvbmVdLmNudCsrOw0KICAgICAgICAgICAgICAgICAgZG9ub3JzW3Bob25lXS5hbXQgKz0gcGFyc2VGbG9hdChmWzldKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgbGV0IGRPYmogPSBwYXJzZURhdGUoZlsxXSk7DQogICAgICAgICAgICAgICAgICBpZiAoZE9iaiA+IGRvbm9yc1twaG9uZV0ubGF0ZXN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgZG9ub3JzW3Bob25lXS5sYXRlc3QgPSBkT2JqOw0KICAgICAgICAgICAgICAgICAgICAgIGRvbm9yc1twaG9uZV0ubmFtZSA9IGZbMl07DQogICAgICAgICAgICAgICAgICAgICAgZG9ub3JzW3Bob25lXS5hZGRyID0gZls0XS5yZXBsYWNlKC9+L2csICcsICcpOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgY29uc3Qgc29ydGVkID0gT2JqZWN0LnZhbHVlcyhkb25vcnMpLnNvcnQoKGEsIGIpID0+IGIuYW10IC0gYS5hbXQpOw0KICAgICAgICAgICAgICBsZXQgdHIgPSAiIjsNCiAgICAgICAgICAgICAgc29ydGVkLmZvckVhY2goZCA9PiB7DQogICAgICAgICAgICAgICAgICB0ciArPSBgPHRyPjx0ZD4ke2QucGh9PGJyPiR7ZC5jbnR9IHRpbWVzPGJyPjxiPlJzLiAke2QuYW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvYj48L3RkPjx0ZD48c3BhbiBzdHlsZT0iY29sb3I6dmFyKC0tcHJpbWFyeS1ibHVlKTsgZm9udC13ZWlnaHQ6Ym9sZDsiPiR7ZC5uYW1lfTwvc3Bhbj48YnI+JHtkLmFkZHJ9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gdHIgPyBgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlPjx0cj48dGg+RG9ub3IgU3RhdHM8L3RoPjx0aD5MYXRlc3QgRGV0YWlsczwvdGg+PC90cj4ke3RyfTwvdGFibGU+PC9kaXY+YCA6ICJObyBkb25vcnMgZm91bmQuIjsNCiAgICAgICAgICAgICAgY29uc3QgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hTdW1tYXJ5QmFyJyk7DQogICAgICAgICAgICAgIGIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogICAgICAgICAgICAgIGIuaW5uZXJIVE1MID0gYFVuaXF1ZSBEb25vcnM6ICR7c29ydGVkLmxlbmd0aH1gOw0KICAgICAgICAgICAgICB0b2dnbGVTY3JvbGxCdXR0b25zKHRydWUpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIEZpbmFuY2lhbCBTdGF0ZW1lbnRzOiBQZXJmb3JtcyBhIGNyb3NzLWZpbGUgYW5hbHlzaXMgYmV0d2VlbiBJbmNvbWUgKE1NUFQyKQ0KICAgICAgICAgICAqIGFuZCBFeHBlbnNlcyAoRXhjZWwpIHRvIGdlbmVyYXRlIGEgUHJvZml0ICYgTG9zcyBzdHlsZSB2aWV3IGZvciB0aGUgRmluYW5jaWFsIFllYXIuDQogICAgICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBydW5BY2NvdW50cygpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgY29uc3Qgc1llYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICBjb25zdCBmeUxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS5wYXJlbnRFbGVtZW50LmlubmVyVGV4dC50cmltKCk7DQoNCiAgICAgICAgICAgICAgLy8gMS4gRmV0Y2ggRG9uYXRpb24gRGF0YQ0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gdGV4dC5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgbGV0IGNvcnB1c0NvdW50ID0gMCwgY29ycHVzVG90YWwgPSAwLCBub25Db3JwdXNDb3VudCA9IDAsIG5vbkNvcnB1c1RvdGFsID0gMDsNCiAgICAgICAgICAgICAgbGV0IHRvdGFsRG9uYXRpb25Db3VudCA9IDAsIHRvdGFsRG9uYXRpb25BbW91bnQgPSAwOw0KDQogICAgICAgICAgICAgIHJlY3MuZm9yRWFjaChyID0+IHsNCiAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMTMgfHwgZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIikgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZFAgPSBmWzFdLnNwbGl0KC9bLS9dLyk7DQogICAgICAgICAgICAgICAgICBjb25zdCBtbSA9IHBhcnNlSW50KGRQWzFdKSwgeXkgPSBwYXJzZUludChkUFsyXSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBpblllYXIgPSAoc1llYXIgPT09ICJhbGwiKSB8fCAoKHl5ID09PSBwYXJzZUludChzWWVhcikgJiYgbW0gPj0gNCkgfHwgKHl5ID09PSBwYXJzZUludChzWWVhcikgKyAxICYmIG1tIDw9IDMpKTsNCiAgICAgICAgICAgICAgICAgIGlmIChpblllYXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgYW10ID0gcGFyc2VGbG9hdChmWzldKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCB0b3dhcmRzID0gKGZbMTJdIHx8ICIiKS50cmltKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAodG93YXJkcyA9PT0gIkNPUlBVUyIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29ycHVzQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29ycHVzVG90YWwgKz0gYW10Ow0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIG5vbkNvcnB1c0NvdW50Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgIG5vbkNvcnB1c1RvdGFsICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgdG90YWxEb25hdGlvbkNvdW50Kys7DQogICAgICAgICAgICAgICAgICAgICAgdG90YWxEb25hdGlvbkFtb3VudCArPSBhbXQ7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIC8vIDIuIEZldGNoIEludGVyZXN0IERhdGENCiAgICAgICAgICAgICAgY29uc3QgYmFua1JlcyA9IGF3YWl0IGZldGNoKEJBTktfTkVXX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IGJhbmtMaW5lcyA9IChhd2FpdCBiYW5rUmVzLnRleHQoKSkuc3BsaXQoJ1xuJyk7DQogICAgICAgICAgICAgIGxldCBpbnRlcmVzdENvdW50ID0gMCwgaW50ZXJlc3RUb3RhbCA9IDA7DQoNCiAgICAgICAgICAgICAgYmFua0xpbmVzLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IGxpbmUuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDUpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRlc2MgPSAoZlsxXSB8fCAiIikudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNyID0gcGFyc2VGbG9hdChmWzRdKSB8fCAwOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZE9iaiA9IHBhcnNlRGF0ZShmWzBdKTsNCg0KICAgICAgICAgICAgICAgICAgbGV0IGluWWVhciA9IChzWWVhciA9PT0gImFsbCIpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFpblllYXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmeVMgPSBwYXJzZUludChzWWVhcik7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IGRPYmouZ2V0TW9udGgoKSArIDEsIHkgPSBkT2JqLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgaW5ZZWFyID0gKHkgPT09IGZ5UyAmJiBtID49IDQpIHx8ICh5ID09PSBmeVMgKyAxICYmIG0gPD0gMyk7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBpZiAoaW5ZZWFyICYmIChkZXNjLmluY2x1ZGVzKCJJTlRFUkVTVCIpIHx8IGRlc2MuaW5jbHVkZXMoIklOVCBUUkYgRlJNIikpICYmIGNyID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgIGludGVyZXN0Q291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICBpbnRlcmVzdFRvdGFsICs9IGNyOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICBjb25zdCBjb21iaW5lZEluY29tZUNvdW50ID0gdG90YWxEb25hdGlvbkNvdW50ICsgaW50ZXJlc3RDb3VudDsNCiAgICAgICAgICAgICAgY29uc3QgY29tYmluZWRJbmNvbWVUb3RhbCA9IHRvdGFsRG9uYXRpb25BbW91bnQgKyBpbnRlcmVzdFRvdGFsOw0KDQogICAgICAgICAgICAgIC8vIFN0YXJ0IEJ1aWxkaW5nIEhUTUwNCiAgICAgICAgICAgICAgbGV0IGggPSBgPGRpdiBzdHlsZT0iYmFja2dyb3VuZDp3aGl0ZTsgcGFkZGluZzoxNXB4OyBib3JkZXItcmFkaXVzOjEwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDIgc3R5bGU9ImNvbG9yOnZhcigtLXByaW1hcnktYmx1ZSk7IG1hcmdpbi10b3A6MDsiPkFjY291bnRzIGZvciB0aGUgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9oMj4NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBzdHlsZT0iY29sb3I6dmFyKC0tZGFyay10ZXh0KTsgbWFyZ2luLWJvdHRvbTo1cHg7Ij5JbmNvbWUgZHVyaW5nIEZpbmFuY2lhbCBZZWFyIDogJHtmeUxhYmVsfTwvaDM+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0IHN0eWxlPSJjb2xvcjp2YXIoLS12aWJyYW50LWJsdWUpOyBtYXJnaW4tYm90dG9tOjEwcHg7Ij5JbmNvbWUgYnkgRG9uYXRpb25zIDo8L2g0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz0ic3VtLXRhYmxlIiBzdHlsZT0ibWFyZ2luLWJvdHRvbToyMHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPkl0ZW08L3RoPjx0aD5Eb25vcnM8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZD5Db3JwdXMgRG9uYXRpb25zPC90ZD48dGQ+JHtjb3JwdXNDb3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke2NvcnB1c1RvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+Tm9uIENvcnB1cyBEb25hdGlvbnM8L3RkPjx0ZD4ke25vbkNvcnB1c0NvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7bm9uQ29ycHVzVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPSJ0b3RhbC1oaWdobGlnaHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+VG90YWwgRG9uYXRpb25zPC90ZD48dGQ+JHt0b3RhbERvbmF0aW9uQ291bnR9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImFtdCI+4oK5JHt0b3RhbERvbmF0aW9uQW1vdW50LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgc3R5bGU9ImNvbG9yOnZhcigtLXZpYnJhbnQtYmx1ZSk7IG1hcmdpbi1ib3R0b206MTBweDsiPkluY29tZSBieSBJbnRlcmVzdCA6PC9oND4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9InN1bS10YWJsZSIgc3R5bGU9Im1hcmdpbi1ib3R0b206MjBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5JdGVtPC90aD48dGg+Q291bnQ8L3RoPjx0aD5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRyIGNsYXNzPSJ0b3RhbC1oaWdobGlnaHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+VG90YWwgSW50ZXJlc3QgRWFybmVkPC90ZD48dGQ+JHtpbnRlcmVzdENvdW50fTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJhbXQiPuKCuSR7aW50ZXJlc3RUb3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0IHN0eWxlPSJjb2xvcjp2YXIoLS12aWJyYW50LWJsdWUpOyBtYXJnaW4tYm90dG9tOjEwcHg7Ij5Ub3RhbCBJbmNvbWUgOjwvaDQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5JdGVtczwvdGg+PHRoPkNvdW50PC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+QnkgRG9uYXRpb25zPC90ZD48dGQ+JHt0b3RhbERvbmF0aW9uQ291bnR9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHt0b3RhbERvbmF0aW9uQW1vdW50LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+QnkgSW50ZXJlc3Q8L3RkPjx0ZD4ke2ludGVyZXN0Q291bnR9PC90ZD48dGQgY2xhc3M9ImFtdCI+4oK5JHtpbnRlcmVzdFRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0idG90YWwtaGlnaGxpZ2h0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPlRvdGFsIEluY29tZTwvdGQ+PHRkPiR7Y29tYmluZWRJbmNvbWVDb3VudH08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkke2NvbWJpbmVkSW5jb21lVG90YWwudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT5gOw0KDQogICAgICAgICAgICAgIC8vIFZhcmlhYmxlcyBmb3IgQW5hbHlzaXMNCiAgICAgICAgICAgICAgY29uc3QgdG90YWxBbGxvd2VkU3BlbmQgPSBub25Db3JwdXNUb3RhbCArIGludGVyZXN0VG90YWw7DQogICAgICAgICAgICAgIGNvbnN0IHRvdGFsQWxsb3dlZENvdW50ID0gbm9uQ29ycHVzQ291bnQgKyBpbnRlcmVzdENvdW50Ow0KDQogICAgICAgICAgICAgIC8vIDMuIEZldGNoIEV4cGVuc2UgRGF0YSAoQW5hbHlzaXMgJiBCYWxhbmNlIFNoZWV0KQ0KICAgICAgICAgICAgICBpZiAoc1llYXIgIT09ICJhbGwiICYmIHBhcnNlSW50KHNZZWFyKSA+PSAyMDI0KSB7DQogICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cFJlcyA9IGF3YWl0IGZldGNoKEVYUEVOU0VTX1VSTCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnJlYWQobmV3IFVpbnQ4QXJyYXkoYXdhaXQgZXhwUmVzLmFycmF5QnVmZmVyKCkpLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3Yi5TaGVldHNbd2IuU2hlZXROYW1lc1swXV0sIHsgaGVhZGVyOiAxIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBnZW5Db3VudCA9IDAsIGdlblRvdGFsID0gMDsNCiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93ID0gZGF0YVtpXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFyb3cgfHwgcm93Lmxlbmd0aCA8IDIpIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZE9iaiA9ICh0eXBlb2Ygcm93WzBdID09PSAnbnVtYmVyJykgPyBYTFNYLnV0aWxzLnNoZWV0X3RvX2RhdGUocm93WzBdKSA6IHBhcnNlRGF0ZShyb3dbMF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZE9iai5nZXRUaW1lKCkpKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG0gPSBkT2JqLmdldE1vbnRoKCkgKyAxLCB5ID0gZE9iai5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgcm93RlkgPSAobSA+PSA0KSA/IHkudG9TdHJpbmcoKSA6ICh5IC0gMSkudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJvd0ZZICE9PSBzWWVhcikgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXQgPSBwYXJzZUZsb2F0KHJvd1szXSkgfHwgMCwgZGVzYyA9IChyb3dbNF0gfHwgcm93WzFdIHx8ICIiKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGVzYy5pbmNsdWRlcygiZXhlbXB0IikgJiYgIWRlc2MuaW5jbHVkZXMoImRlcG9zaXQiKSAmJiAhZGVzYy5pbmNsdWRlcygibG9hbiIpICYmICFkZXNjLmluY2x1ZGVzKCJjbG9zdXJlIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdlbkNvdW50Kys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZW5Ub3RhbCArPSBhbXQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICBoICs9IGANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDMgc3R5bGU9ImNvbG9yOnZhcigtLWRhcmstdGV4dCk7IG1hcmdpbi10b3A6MzBweDsgbWFyZ2luLWJvdHRvbTo1cHg7Ij5FeHBlbnNlcyBmb3IgdGhlIEZpbmFuY2lhbCBZZWFyIDogJHtmeUxhYmVsfTwvaDM+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGg0IHN0eWxlPSJjb2xvcjp2YXIoLS12aWJyYW50LWJsdWUpOyBtYXJnaW4tYm90dG9tOjEwcHg7Ij5HZW5lcmFsIEV4cGVuc2VzIDo8L2g0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz0ic3VtLXRhYmxlIj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjx0cj48dGg+SXRlbXM8L3RoPjx0aD5Db3VudDwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj48L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9InRvdGFsLWhpZ2hsaWdodC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5Ub3RhbCBFeHBlbnNlczwvdGQ+PHRkPiR7Z2VuQ291bnR9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImFtdCI+4oK5JHtnZW5Ub3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPmA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBCYWxhbmNlIFNoZWV0IFNlY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgICBsZXQgYmFsYW5jZSA9IGNvbWJpbmVkSW5jb21lVG90YWwgLSBnZW5Ub3RhbDsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgYmFsYW5jZVRleHQgPSAoYmFsYW5jZSA+PSAwKSA/DQogICAgICAgICAgICAgICAgICAgICAgICAgIGA8ZGl2IGNsYXNzPSJwcm9maXQtdGV4dCI+VHJ1c3QgaW4gUHJvZml0IGZvciBGaW5hbmNpYWwgWWVhciA6ICR7ZnlMYWJlbH08L2Rpdj5gIDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgYDxkaXYgY2xhc3M9Imxvc3MtdGV4dCI+VHJ1c3QgaW4gTG9zcyBmb3IgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9kaXY+YDsNCg0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBzdHlsZT0iY29sb3I6dmFyKC0tZGFyay10ZXh0KTsgbWFyZ2luLXRvcDozMHB4OyBtYXJnaW4tYm90dG9tOjVweDsiPkJhbGFuY2UgU2hlZXQgZm9yIEZpbmFuY2lhbCBZZWFyIDogJHtmeUxhYmVsfTwvaDM+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGhlYWQ+PHRyPjx0aD5JdGVtczwvdGg+PHRoPkNvdW50PC90aD48dGg+QW1vdW50PC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+SW5jb21lPC90ZD48dGQ+JHtjb21iaW5lZEluY29tZUNvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7Y29tYmluZWRJbmNvbWVUb3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkPkV4cGVuc2VzPC90ZD48dGQ+JHtnZW5Db3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke2dlblRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0idG90YWwtaGlnaGxpZ2h0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPkJhbGFuY2UgU2hlZXQ8L3RkPjx0ZD48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkke2JhbGFuY2UudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAke2JhbGFuY2VUZXh0fQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxociBzdHlsZT0iYm9yZGVyOiAwOyBib3JkZXItdG9wOiAycHggc29saWQgI2NjYzsgbWFyZ2luOiAyMHB4IDA7Ij5gOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gQU5BTFlTSVMgU0VDVElPTg0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMyBzdHlsZT0iY29sb3I6dmFyKC0tZGFyay10ZXh0KTsgbWFyZ2luLXRvcDozMHB4OyBtYXJnaW4tYm90dG9tOjVweDsiPkFuYWx5c2lzPC9oMz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgc3R5bGU9ImNvbG9yOnZhcigtLXZpYnJhbnQtYmx1ZSk7IG1hcmdpbi1ib3R0b206MTBweDsiPlRydXN0IGFsbG93ZWQgdG8gU3BlbmQgZHVyaW5nIHRoZSBGaW5hbmNpYWwgWWVhciA6ICR7ZnlMYWJlbH08L2g0Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBjbGFzcz0ic3VtLXRhYmxlIiBzdHlsZT0ibWFyZ2luLWJvdHRvbToyMHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPkl0ZW08L3RoPjx0aD5Db3VudDwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj48L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkPk5vbiBDb3JwdXMgRG9uYXRpb25zPC90ZD48dGQ+JHtub25Db3JwdXNDb3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke25vbkNvcnB1c1RvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+SW5jb21lIGJ5IEludGVyZXN0PC90ZD48dGQ+JHtpbnRlcmVzdENvdW50fTwvdGQ+PHRkIGNsYXNzPSJhbXQiPuKCuSR7aW50ZXJlc3RUb3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9InRvdGFsLWhpZ2hsaWdodC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5Ub3RhbCBFeHBlbnNlcyBBbGxvd2VkPC90ZD48dGQ+JHt0b3RhbEFsbG93ZWRDb3VudH08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkke3RvdGFsQWxsb3dlZFNwZW5kLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Rib2R5Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aDQgc3R5bGU9ImNvbG9yOnZhcigtLXZpYnJhbnQtYmx1ZSk7IG1hcmdpbi1ib3R0b206MTBweDsiPkdlbmVyYWwgRXhwZW5zZXMgOjwvaDQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRhYmxlIGNsYXNzPSJzdW0tdGFibGUiIHN0eWxlPSJtYXJnaW4tYm90dG9tOjIwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjx0cj48dGg+SXRlbXM8L3RoPjx0aD5Db3VudDwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj48L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgY2xhc3M9InRvdGFsLWhpZ2hsaWdodC1yb3ciPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD5Ub3RhbCBFeHBlbnNlczwvdGQ+PHRkPiR7Z2VuQ291bnR9PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImFtdCI+4oK5JHtnZW5Ub3RhbC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPg0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJjb2xvcjp2YXIoLS1kYXJrLXRleHQpOyBtYXJnaW4tdG9wOjMwcHg7IG1hcmdpbi1ib3R0b206NXB4OyI+QmFsYW5jZSBTaGVldCBmb3IgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9oMz4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGFibGUgY2xhc3M9InN1bS10YWJsZSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aGVhZD48dHI+PHRoPkl0ZW08L3RoPjx0aD5Db3VudDwvdGg+PHRoPkFtb3VudDwvdGg+PC90cj48L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGJvZHk+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkPkFsbG93ZWQgSW5jb21lIHRvIFNwZW5kPC90ZD48dGQ+JHt0b3RhbEFsbG93ZWRDb3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke3RvdGFsQWxsb3dlZFNwZW5kLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQ+QWN0dWFsIEV4cGVuc2VzPC90ZD48dGQ+JHtnZW5Db3VudH08L3RkPjx0ZCBjbGFzcz0iYW10Ij7igrkke2dlblRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0idG90YWwtaGlnaGxpZ2h0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkPkJhbGFuY2UgU2hlZXQ8L3RkPjx0ZD48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iYW10Ij7igrkkeyh0b3RhbEFsbG93ZWRTcGVuZCAtIGdlblRvdGFsKS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPmA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBGSU5BTCBDT01NRU5UUyBTRUNUSU9ODQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmluYWxCYWxhbmNlID0gdG90YWxBbGxvd2VkU3BlbmQgLSBnZW5Ub3RhbDsNCiAgICAgICAgICAgICAgICAgICAgICBoICs9IGA8aDMgc3R5bGU9ImNvbG9yOnZhcigtLWRhcmstdGV4dCk7IG1hcmdpbi10b3A6MzBweDsgbWFyZ2luLWJvdHRvbToxMHB4OyI+RmluYWwgQ29tbWVudHM8L2gzPmA7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZmluYWxCYWxhbmNlID49IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaCArPSBgPGRpdiBzdHlsZT0iY29sb3I6ICMwMDY0MDA7IGZvbnQtd2VpZ2h0OiBib2xkOyBmb250LXNpemU6IDEuMWVtOyBtYXJnaW4tYm90dG9tOiAyMHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJ1c3QgaXMgd2l0aGluIGl0cyBzcGVuZGluZyBsaW1pdHMuIFRoZXJlIGlzIGEgc3VycGx1cyBvZiA6IOKCuSR7ZmluYWxCYWxhbmNlLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlZmljaXRBbXQgPSBNYXRoLmFicyhmaW5hbEJhbGFuY2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBoICs9IGA8ZGl2IHN0eWxlPSJjb2xvcjogI2ZmMDAwMDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc2l6ZTogMS4xZW07IG1hcmdpbi1ib3R0b206IDIwcHg7IGxpbmUtaGVpZ2h0OiAxLjU7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUcnVzdCBhY2NvdW50IGlzIGluIGRlZmljaXQuIFdlIG5lZWQgdG8gbW92ZSBScy4gJHtkZWZpY2l0QW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZyb20gQ09SUFVTIGFjY291bnQgdG8gRXhwZW5zZSBBY2NvdW50LiBSZXF1aXJlZCBSZXNvbHV0aW9uIGRvY3VtZW50IGF1dGhvcml6aW5nDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG8gdXNlIGNvcnB1cyBhbW91bnRzIGJlIHByZXBhcmVkIGZyb20gdGhlIFRydXN0ZWVzIGZvciBSZWNvcmRzLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgIGggKz0gYDxociBzdHlsZT0iYm9yZGVyOiAwOyBib3JkZXItdG9wOiAzcHggZG91YmxlIHZhcigtLXByaW1hcnktYmx1ZSk7IG1hcmdpbjogMzBweCAwOyI+YDsNCg0KICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJFeHBlbnNlIGZldGNoIGVycm9yIiwgZSk7DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBoICs9IGA8L2Rpdj5gOw0KDQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKS5pbm5lckhUTUwgPSBoOw0KICAgICAgICAgICAgICBjb25zdCBiID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaFN1bW1hcnlCYXInKTsNCiAgICAgICAgICAgICAgYi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBgQWNjb3VudHMgRlkgJHtmeUxhYmVsfSB8IFRvdGFsIEluY29tZTog4oK5JHtjb21iaW5lZEluY29tZVRvdGFsLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfWA7DQogICAgICAgICAgICAgIHRvZ2dsZVNjcm9sbEJ1dHRvbnModHJ1ZSk7DQoNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBXaGF0c0FwcCBJbnRlZ3JhdG9yOiBGb3JtYXRzIGEgcmVjZWlwdCBzdW1tYXJ5IGludG8gYSBzdHJ1Y3R1cmVkIG1lc3NhZ2UNCiAgICAgICAgICAgKiBhbmQgb3BlbnMgdGhlIFdoYXRzQXBwIEFQSSB0byBzZW5kIGl0IGRpcmVjdGx5IHRvIHRoZSBkb25vcidzIHBob25lIG51bWJlci4NCiAgICAgICAgICAgKi8NCg0KICAgICAgICAgIGZ1bmN0aW9uIHNlbmRXaGF0c0FwcChmKSB7DQogICAgICAgICAgICAgIGxldCBwaCA9IGZbM10ucmVwbGFjZSgvXEQvZywgJycpOw0KICAgICAgICAgICAgICBpZiAocGgubGVuZ3RoID09PSAxMCkgcGggPSAnOTEnICsgcGg7DQogICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSAiPT09PT09PT09PT09PT09PT09PT09PSI7DQogICAgICAgICAgICAgIGxldCBtID0gYCpNWUxBSSBNQUhBUEVSSVlBVkEgQU5VU0hBTSBUUlVTVCpcbiR7bGluZX1cbipSZWNlaXB0IE5vOiogJHtmWzBdfVxuKkRhdGU6KiAke2ZbMV19XG5SZWNlaXZlZCB3aXRoIHRoYW5rcyBScy4gKiR7Zls5XX0qXG5mb3IgKiR7ZlsxMl19KiBmcm9tICpTaHJpLi9TbXQuICR7ZlsyXX0qXG4ke2xpbmV9XG5fVHJ1c3QgcmVnaXN0cmF0aW9uIHZhbGlkIHRpbGwgMzEtMDMtMjAyNl9gOw0KICAgICAgICAgICAgICB3aW5kb3cub3BlbihgaHR0cHM6Ly93YS5tZS8ke3BofT90ZXh0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KG0pfWAsICdfYmxhbmsnKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVSb3RhdGlvbigpIHsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY2VpcHRDb250YWluZXInKS5jbGFzc0xpc3QudG9nZ2xlKCdyb3RhdGVkJyk7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzcGFjZXJUb3AnKS5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwYWNlckJvdHRvbScpLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIEdsb2JhbCB2YXJpYWJsZSB0byBob2xkIGRhdGEgc2FmZWx5IGZvciBkb3dubG9hZA0KICAgICAgICAgIGxldCBjdXJyZW50RG9uYXRpb25EYXRhID0gIiI7DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBEb25hdGlvbiBMaXN0IFZpZXdlcjogRmlsdGVycyB0aGUgbWFzdGVyIGRhdGFiYXNlIGJ5IEZpbmFuY2lhbCBZZWFyIGFuZA0KICAgICAgICAgICAqIGRpc3BsYXlzIGEgZGV0YWlsZWQgMy1jb2x1bW4gdGFibGUgd2l0aCBhIHJvYnVzdCBkb3dubG9hZCBvcHRpb24uDQogICAgICAgICAgICovDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuRG9uYXRpb24oKSB7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICBjb25zdCBmeUxhYmVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS5wYXJlbnRFbGVtZW50LmlubmVyVGV4dC50cmltKCk7DQoNCiAgICAgICAgICAgICAgLy8gTG9naWMgdG8gZW5zdXJlIHN1ZmZpeCBpcyAiMjUtMjYiIGZvcm1hdA0KICAgICAgICAgICAgICBsZXQgdGFyZ2V0RlkgPSBzZWxlY3RlZEZZOw0KICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRGWSAhPT0gImFsbCIpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHNob3J0WWVhciA9IHNlbGVjdGVkRlkuc2xpY2UoLTIpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgbmV4dFllYXIgPSAocGFyc2VJbnQoc2hvcnRZZWFyKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsNCiAgICAgICAgICAgICAgICAgIHRhcmdldEZZID0gYCR7c2hvcnRZZWFyfS0ke25leHRZZWFyfWA7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXMudGV4dCgpOw0KICAgICAgICAgICAgICBjb25zdCByZWNzID0gdGV4dC5zcGxpdCgnXG4nKTsNCg0KICAgICAgICAgICAgICBsZXQgdG90YWxDb3VudCA9IDA7DQogICAgICAgICAgICAgIGxldCB0b3RhbEFtb3VudCA9IDA7DQogICAgICAgICAgICAgIGxldCB0YWJsZVJvd3MgPSAiIjsNCg0KICAgICAgICAgICAgICAvLyBSZXNldCBhbmQgc3RhcnQgYnVpbGRpbmcgdGV4dCBjb250ZW50IGZvciBkb3dubG9hZA0KICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhID0gYERPTkFUSU9OIExJU1QgRk9SIEZZOiAke2Z5TGFiZWx9XG5gOw0KICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGBHZW5lcmF0ZWQgb246ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfVxuYDsNCiAgICAgICAgICAgICAgY3VycmVudERvbmF0aW9uRGF0YSArPSBgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuYDsNCg0KICAgICAgICAgICAgICByZWNzLmZvckVhY2gociA9PiB7DQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDIwKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJjcHRObyA9IGZbMF0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0ciA9IGZbMV0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBmWzEzXT8udG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICBjb25zdCBhbW91bnQgPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZZICE9PSAiYWxsIiAmJiBnZXRGWShkYXRlU3RyKSAhPT0gdGFyZ2V0RlkpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxlZCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICB0b3RhbENvdW50Kys7DQogICAgICAgICAgICAgICAgICB0b3RhbEFtb3VudCArPSBhbW91bnQ7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBmWzJdIHx8ICJBbm9ueW1vdXMiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgYWRkciA9IChmWzRdIHx8ICIiKS5yZXBsYWNlKC9+L2csICcsICcpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcGluID0gZlsxNV0gfHwgIiI7DQogICAgICAgICAgICAgICAgICBjb25zdCBjb3VudHJ5ID0gZlsxOV0gfHwgIiI7DQogICAgICAgICAgICAgICAgICBjb25zdCBwaG9uZSA9IGZbM10gfHwgIi0tLSI7DQogICAgICAgICAgICAgICAgICBjb25zdCBwYW4gPSBmWzZdIHx8ICItLS0iOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdG93YXJkcyA9IGZbMTJdIHx8ICIiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZ2VvSW5mbyA9IFthZGRyLCBwaW4sIGNvdW50cnldLmZpbHRlcih4ID0+IHgudHJpbSgpICE9PSAiIikuam9pbigiIC0gIik7DQoNCiAgICAgICAgICAgICAgICAgIC8vIEJ1aWxkIFBsYWluIFRleHQgRW50cnkNCiAgICAgICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYFJlY2VpcHQ6ICR7cmNwdE5vfSB8IERhdGU6ICR7ZGF0ZVN0cn1cbmA7DQogICAgICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGBBbW91bnQ6IFJzLiAke2Ftb3VudH0gfCBUb3dhcmRzOiAke3Rvd2FyZHN9XG5gOw0KICAgICAgICAgICAgICAgICAgY3VycmVudERvbmF0aW9uRGF0YSArPSBgRG9ub3I6ICR7bmFtZX1cbmA7DQogICAgICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGBBZGRyZXNzOiAke2dlb0luZm99XG5gOw0KICAgICAgICAgICAgICAgICAgY3VycmVudERvbmF0aW9uRGF0YSArPSBgUGhvbmU6ICR7cGhvbmV9IHwgUEFOOiAke3Bhbn1cbmA7DQogICAgICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuYDsNCg0KICAgICAgICAgICAgICAgICAgLy8gQnVpbGQgSFRNTCBUYWJsZSBSb3cNCiAgICAgICAgICAgICAgICAgIHRhYmxlUm93cyArPSBgDQogICAgICAgICAgICAgICAgICAgICAgICA8dHI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3aGl0ZS1zcGFjZTpub3dyYXA7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHtyY3B0Tm99JykiPiR7cmNwdE5vfTwvc3Bhbj48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD4ke2RhdGVTdHJ9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjpyaWdodDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8Yj7igrkke2Ftb3VudC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08L2I+PGJyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGwgc3R5bGU9ImNvbG9yOnZhcigtLXByaW1hcnktYmx1ZSk7Ij4ke3Rvd2FyZHN9PC9zbWFsbD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGI+JHtuYW1lfTwvYj48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbD4ke2dlb0luZm99PC9zbWFsbD48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzbWFsbCBzdHlsZT0iY29sb3I6IzU1NTsiPltQaG9uZTogJHtwaG9uZX1dIFtQQU46ICR7cGFufV08L3NtYWxsPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgICA8L3RyPmA7DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIGN1cnJlbnREb25hdGlvbkRhdGEgKz0gYFxuVE9UQUwgVFJBTlNBQ1RJT05TOiAke3RvdGFsQ291bnR9XG5gOw0KICAgICAgICAgICAgICBjdXJyZW50RG9uYXRpb25EYXRhICs9IGBUT1RBTCBBTU9VTlQ6IFJzLiAke3RvdGFsQW1vdW50LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfVxuYDsNCg0KICAgICAgICAgICAgICBjb25zdCBtYWluVGl0bGUgPSBgPGgzIGNsYXNzPSJiYW5rLXRpdGxlIj5MaXN0IG9mIERvbmF0aW9ucyBmb3IgRmluYW5jaWFsIFllYXIgOiAke2Z5TGFiZWx9PC9oMz5gOw0KDQogICAgICAgICAgICAgIC8vIERvd25sb2FkIEJ1dHRvbiAtIG5vdyBzaW1wbGlmaWVkIHRvIGF2b2lkIHNjcmlwdCBlcnJvcnMNCiAgICAgICAgICAgICAgY29uc3QgZG93bmxvYWRCdG4gPSBgDQogICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyBtYXJnaW4tdG9wOjIwcHg7IHBhZGRpbmctYm90dG9tOjYwcHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZG93bmxvYWRGaWxlKCcke3RhcmdldEZZfScpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjp2YXIoLS1ndy1ncmVlbik7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjE1cHggMzBweDsgZm9udC1zaXplOjFyZW07IGJvcmRlci1yYWRpdXM6OHB4OyBjdXJzb3I6cG9pbnRlcjsgYm9yZGVyOm5vbmU7IGZvbnQtd2VpZ2h0OmJvbGQ7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEb3dubG9hZCBEb25hdGlvbnNfJHt0YXJnZXRGWX0udHh0DQogICAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsNCg0KICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgICAke21haW5UaXRsZX0NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+DQogICAgICAgICAgICAgICAgICAgICAgICA8dGFibGU+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPjx0cj48dGg+Uk5vICYgRGF0ZTwvdGg+PHRoPkFtb3VudCAmIFRvd2FyZHM8L3RoPjx0aD5Eb25vciBEZXRhaWxzPC90aD48L3RyPjwvdGhlYWQ+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRib2R5PiR7dGFibGVSb3dzIHx8ICc8dHI+PHRkIGNvbHNwYW49IjMiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPk5vIHJlY29yZHMgZm91bmQuPC90ZD48L3RyPid9PC90Ym9keT4NCiAgICAgICAgICAgICAgICAgICAgICAgIDwvdGFibGU+DQogICAgICAgICAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAke3RvdGFsQ291bnQgPiAwID8gZG93bmxvYWRCdG4gOiAiIn1gOw0KDQogICAgICAgICAgICAgIGNvbnN0IGIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoU3VtbWFyeUJhcicpOw0KICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICBiLmlubmVySFRNTCA9IGBUb3RhbCAke3RvdGFsQ291bnR9IFRyYW5zYWN0aW9ucyA6IOKCuSR7dG90YWxBbW91bnQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9YDsNCiAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBSb2J1c3QgRG93bmxvYWQgSGVscGVyDQogICAgICAgICAgICogVXNlcyB0aGUgZ2xvYmFsIGN1cnJlbnREb25hdGlvbkRhdGEgdmFyaWFibGUNCiAgICAgICAgICAgKi8NCiAgICAgICAgICBmdW5jdGlvbiBkb3dubG9hZEZpbGUoZnlTdWZmaXgpIHsNCiAgICAgICAgICAgICAgaWYgKCFjdXJyZW50RG9uYXRpb25EYXRhKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiTm8gZGF0YSBhdmFpbGFibGUgdG8gZG93bmxvYWQuIik7DQogICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjdXJyZW50RG9uYXRpb25EYXRhXSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7DQogICAgICAgICAgICAgIGVsZW1lbnQuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7DQogICAgICAgICAgICAgIGVsZW1lbnQuZG93bmxvYWQgPSBgRG9uYXRpb25zXyR7ZnlTdWZmaXh9LnR4dGA7DQogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWxlbWVudCk7DQogICAgICAgICAgICAgIGVsZW1lbnQuY2xpY2soKTsNCiAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtZW50KTsNCiAgICAgICAgICB9DQoNCg0KICAgICAgICAgIGNvbnN0IEFQUFJPVkVEX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL256aWx6YmtmOGwydGx4MjFweWI4NC9BcHByb3ZlZC50eHQ/cmxrZXk9b2t6ZnZtem1wZmI5a3Voejc0ZGJlMGFkcyZkbD0xIjsNCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIE5FVzogRGV2aWNlIEF1dGhvcml6YXRpb24gQ2hlY2sNCiAgICAgICAgICAgKiBSZXBsYWNlcyB0aGUgbWFudWFsIHBhc3N3b3JkIGxvZ2luDQogICAgICAgICAgICovDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gY2hlY2tEZXZpY2VBdXRoKCkgew0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY29uc3QgbXlJRCA9IGdlbmVyYXRlRmluZ2VycHJpbnQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKEFQUFJPVkVEX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gU3BsaXQgYnkgbGluZXMsIHRyaW0gc3BhY2VzLCBhbmQgcmVtb3ZlIGVtcHR5IGxpbmVzDQogICAgICAgICAgICAgICAgICBjb25zdCBhcHByb3ZlZElEcyA9IHRleHQuc3BsaXQoL1xyP1xuLykubWFwKGlkID0+IGlkLnRyaW0oKSkuZmlsdGVyKGlkID0+IGlkICE9PSAiIik7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChhcHByb3ZlZElEcy5pbmNsdWRlcyhteUlEKSkgew0KICAgICAgICAgICAgICAgICAgICAgIC8vIFNVQ0NFU1M6IEhpZGUgbG9naW4gc2NyZWVuIGFuZCBsb2FkIGRhc2hib2FyZA0KICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dpbk92ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluQ29udGVudCcpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICAgICAgICAgIHdyYXBMb2FkaW5nKGluaXREYXNoYm9hcmQpOw0KICAgICAgICAgICAgICAgICAgICAgIC8vIFNUUkFURUdZOiBDYWxsIHRoZSBuZXcgaWRlbnRpdHkgZnVuY3Rpb24gYXQgdGhlIGVuZA0KICAgICAgICAgICAgICAgICAgICAgIGdldFVzZXJJZGVudGl0eShteUlEKTsNCg0KICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyBGQUlMOiBEaXNwbGF5IHRoZSBEZXZpY2UgSUQgZm9yIHJlZ2lzdHJhdGlvbg0KICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhdXRoU3RhdHVzJykuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MjBweDsgYm9yZGVyLXRvcDoxcHggc29saWQgI2VlZTsgcGFkZGluZy10b3A6MTBweDsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YiBzdHlsZT0iY29sb3I6dmFyKC0tY2FuY2VsLXJlZCk7Ij5ERVZJQ0UgTk9UIEFVVEhPUklaRUQ8L2I+PGJyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c21hbGw+WW91ciBEZXZpY2UgSUQgaXM6PC9zbWFsbD48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgYmFja2dyb3VuZDojZjRmNGY0OyBwYWRkaW5nOjhweDsgbWFyZ2luOjEwcHggMDsgYm9yZGVyOjFweCBkYXNoZWQgIzk5OTsgd29yZC1icmVhazpicmVhay1hbGw7IGZvbnQtc2l6ZTowLjlyZW07Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR7bXlJRH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwIHN0eWxlPSJmb250LXNpemU6MC43NXJlbTsiPkNvcHkgdGhpcyBJRCBhbmQgc2VuZCBpdCB0byB0aGUgYWRtaW4gdG8gZW5hYmxlIGFjY2Vzcy48L3A+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2F1dGhTdGF0dXMnKS5pbm5lckhUTUwgPSAiQ29ubmVjdGlvbiBFcnJvci4gUGxlYXNlIGNoZWNrIGludGVybmV0LiI7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCJBdXRoIGVycm9yOiIsIGUpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgICAgICogTkVXOiBHZW5lcmF0ZXMgYSB1bmlxdWUgSUQgZm9yIHRoaXMgc3BlY2lmaWMgZGV2aWNlL2Jyb3dzZXINCiAgICAgICAgICAgKi8NCiAgICAgICAgICBmdW5jdGlvbiBnZW5lcmF0ZUZpbmdlcnByaW50KCkgew0KICAgICAgICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsNCiAgICAgICAgICAgICAgY29uc3QgZ2wgPSBjYW52YXMuZ2V0Q29udGV4dCgnd2ViZ2wnKTsNCiAgICAgICAgICAgICAgY29uc3QgZGVidWdJbmZvID0gZ2wgPyBnbC5nZXRFeHRlbnNpb24oJ1dFQkdMX2RlYnVnX3JlbmRlcmVyX2luZm8nKSA6IG51bGw7DQogICAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVyID0gZGVidWdJbmZvID8gZ2wuZ2V0UGFyYW1ldGVyKGRlYnVnSW5mby5VTk1BU0tFRF9SRU5ERVJFUl9XRUJHTCkgOiAic3RhbmRhcmQtYnJvd3NlciI7DQoNCiAgICAgICAgICAgICAgLy8gQ29tYmluZSBoYXJkd2FyZSBzcGVjcyB0byBjcmVhdGUgYSB1bmlxdWUgc3RyaW5nDQogICAgICAgICAgICAgIGNvbnN0IHJhd0lkID0gYCR7cmVuZGVyZXJ9LSR7c2NyZWVuLndpZHRofXgke3NjcmVlbi5oZWlnaHR9LSR7bmV3IERhdGUoKS5nZXRUaW1lem9uZU9mZnNldCgpfWA7DQoNCiAgICAgICAgICAgICAgLy8gQ29udmVydCBzdHJpbmcgdG8gYSBudW1lcmljIGhhc2gNCiAgICAgICAgICAgICAgbGV0IGhhc2ggPSAwOw0KICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJhd0lkLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICBoYXNoID0gKChoYXNoIDw8IDUpIC0gaGFzaCkgKyByYXdJZC5jaGFyQ29kZUF0KGkpOw0KICAgICAgICAgICAgICAgICAgaGFzaCB8PSAwOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIHJldHVybiAiTU1QVC1ERVYtIiArIE1hdGguYWJzKGhhc2gpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8qKg0KICAgICAgICAgICAqIFVJIEhlbHBlcjogU2hvd3Mgb3IgaGlkZXMgdGhlIGZsb2F0aW5nIHNjcm9sbCBidXR0b25zIGJhc2VkIG9uIGNvbnRlbnQgcHJlc2VuY2UuDQogICAgICAgICAgICovDQogICAgICAgICAgZnVuY3Rpb24gdG9nZ2xlU2Nyb2xsQnV0dG9ucyhzaG93KSB7DQogICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlTdHlsZSA9IHNob3cgPyAnZmxleCcgOiAnbm9uZSc7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG5Hb1RvcCcpLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5U3R5bGU7DQogICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG5Hb0JvdHRvbScpLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5U3R5bGU7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLyoqDQogICAgICAgKiBSUiBMYWJlbHM6IFByZXBhcmVkIGZvciBnZW5lcmF0aW5nIGFkZHJlc3MgbGFiZWxzIGZvciBkb25vcnMuDQogICAgICAgKiBMb2dpYyB0byBiZSBpbXBsZW1lbnRlZCBpbiB0aGUgbmV4dCBzdGVwLg0KICAgICAgICovDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVJSTGFiZWxzKCkgew0KICAgICAgICAgICAgICBjb25zdCB7IGpzUERGIH0gPSB3aW5kb3cuanNwZGY7DQogICAgICAgICAgICAgIGNvbnN0IGRvYyA9IG5ldyBqc1BERigncCcsICdtbScsICdhNCcpOw0KDQogICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKERBVEFfVVJMKTsNCiAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgIGNvbnN0IHJlY3MgPSB0ZXh0LnNwbGl0KCdcbicpOw0KDQogICAgICAgICAgICAgIGNvbnN0IHZhbGlkUmVjcyA9IHJlY3MuZmlsdGVyKHIgPT4gew0KICAgICAgICAgICAgICAgICAgbGV0IGYgPSByLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAyMCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBmWzEzXT8udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09ICJZRVMiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaXNBbm9uID0gKCFmWzJdIHx8IGZbMl0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmNwdFByaW50ZWQgPSBmWzE2XT8udHJpbSgpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBwcmFzYWRhbVNlbnQgPSBmWzE3XT8udHJpbSgpLnRvVXBwZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBpc1JlYWR5ID0gKHJjcHRQcmludGVkID09PSAiTk8iIHx8IHJjcHRQcmludGVkID09PSAiIikgJiYNCiAgICAgICAgICAgICAgICAgICAgICAocHJhc2FkYW1TZW50ID09PSAiTk8iIHx8IHByYXNhZGFtU2VudCA9PT0gIiIpOw0KDQogICAgICAgICAgICAgICAgICByZXR1cm4gZlswXS5zdGFydHNXaXRoKCJDRyIpICYmIHBhcnNlRGF0ZShmWzFdKSA+PSBDVVRPRkZfREFURSAmJg0KICAgICAgICAgICAgICAgICAgICAgICFpc0NhbmNlbGxlZCAmJiAhaXNBbm9uICYmIGZbNF0udHJpbSgpICE9PSAiIiAmJiBpc1JlYWR5Ow0KICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICBpZiAodmFsaWRSZWNzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIk5vIHJlY2VpcHRzIGFyZSBjdXJyZW50bHkgbWFya2VkIGFzICdSRUFEWScuIik7DQogICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBjb25zdCBtYXJnaW4gPSAxMCwgbGFiZWxXID0gOTUsIGxhYmVsSCA9IDcwLCBjb2xzID0gMiwgcm93cyA9IDQ7DQogICAgICAgICAgICAgIGxldCBjdXJyZW50SXRlbSA9IDA7DQoNCiAgICAgICAgICAgICAgdmFsaWRSZWNzLmZvckVhY2goKHIpID0+IHsNCiAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50SXRlbSA+IDAgJiYgY3VycmVudEl0ZW0gJSAoY29scyAqIHJvd3MpID09PSAwKSBkb2MuYWRkUGFnZSgpOw0KDQogICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2VpcHQgPSBmWzBdOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZG9ub3JOYW1lID0gIlNocmkuL1NtdC4gIiArIGZbMl0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcGhvbmUgPSBmWzNdIHx8ICIiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcGluQ29kZSA9IGZbMTVdPy50cmltKCkgfHwgIiI7DQoNCiAgICAgICAgICAgICAgICAgIC8vIFRyZWF0IH4gYXMgc3BhY2UgZm9yIG5hdHVyYWwgZmxvdw0KICAgICAgICAgICAgICAgICAgbGV0IGZ1bGxBZGRyID0gZls0XS5yZXBsYWNlKC9+L2csICcgJykudHJpbSgpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBwYWdlSWR4ID0gY3VycmVudEl0ZW0gJSAoY29scyAqIHJvd3MpLCBjb2wgPSBwYWdlSWR4ICUgY29scywgcm93ID0gTWF0aC5mbG9vcihwYWdlSWR4IC8gY29scyk7DQogICAgICAgICAgICAgICAgICBjb25zdCB4ID0gbWFyZ2luICsgKGNvbCAqIGxhYmVsVyksIHkgPSBtYXJnaW4gKyAocm93ICogbGFiZWxIKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gRGFyayBCb3JkZXINCiAgICAgICAgICAgICAgICAgIGRvYy5zZXREcmF3Q29sb3IoMCk7DQogICAgICAgICAgICAgICAgICBkb2Muc2V0TGluZVdpZHRoKDAuNCk7DQogICAgICAgICAgICAgICAgICBkb2MucmVjdCh4LCB5LCBsYWJlbFcsIGxhYmVsSCk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDEuIFJlZiBIZWFkZXINCiAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250U2l6ZSg5KTsNCiAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAibm9ybWFsIik7DQogICAgICAgICAgICAgICAgICBkb2MudGV4dCgiVE86IiwgeCArIDUsIHkgKyA4KTsNCiAgICAgICAgICAgICAgICAgIGRvYy50ZXh0KCJSZWY6ICIgKyByZWNlaXB0LCB4ICsgbGFiZWxXIC0gMzAsIHkgKyA4KTsNCg0KICAgICAgICAgICAgICAgICAgLy8gMi4gTmFtZSAtIEJvbGQgYW5kIFdyYXBwZWQNCiAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250U2l6ZSgxMyk7DQogICAgICAgICAgICAgICAgICBkb2Muc2V0Rm9udCgiaGVsdmV0aWNhIiwgImJvbGQiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdyYXBwZWROYW1lID0gZG9jLnNwbGl0VGV4dFRvU2l6ZShkb25vck5hbWUsIDg1KTsNCiAgICAgICAgICAgICAgICAgIGRvYy50ZXh0KHdyYXBwZWROYW1lLCB4ICsgNSwgeSArIDE3KTsNCg0KICAgICAgICAgICAgICAgICAgLy8gU3BhY2luZzogRW5kIG9mIG5hbWUgKyA1bW0gZ2FwIGZvciB2aXN1YWwgY2xhcml0eQ0KICAgICAgICAgICAgICAgICAgbGV0IGFkZHJZID0geSArIDE3ICsgKHdyYXBwZWROYW1lLmxlbmd0aCAqIDUuNSkgKyAyOw0KDQogICAgICAgICAgICAgICAgICAvLyAzLiBBZGRyZXNzIExvZ2ljDQogICAgICAgICAgICAgICAgICBkb2Muc2V0Rm9udCgiaGVsdmV0aWNhIiwgIm5vcm1hbCIpOw0KICAgICAgICAgICAgICAgICAgZG9jLnNldEZvbnRTaXplKDExKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gU2VwYXJhdGUgQ2l0eSAoTGFzdCBXb3JkKQ0KICAgICAgICAgICAgICAgICAgbGV0IHdvcmRzID0gZnVsbEFkZHIuc3BsaXQoL1xzKy8pOw0KICAgICAgICAgICAgICAgICAgbGV0IGNpdHkgPSB3b3Jkcy5sZW5ndGggPiAwID8gd29yZHMucG9wKCkucmVwbGFjZSgvWyw6XSQvLCAiIikgOiAiIjsNCiAgICAgICAgICAgICAgICAgIGxldCBhZGRyV2l0aG91dENpdHkgPSB3b3Jkcy5qb2luKCIgIik7DQoNCiAgICAgICAgICAgICAgICAgIC8vIEh5YnJpZCBXcmFwcGluZyBBcHByb2FjaA0KICAgICAgICAgICAgICAgICAgLy8gRmlyc3QgdHJ5IHNwbGl0dGluZyBieSBleGlzdGluZyBwdW5jdHVhdGlvbg0KICAgICAgICAgICAgICAgICAgbGV0IHNlZ21lbnRzID0gYWRkcldpdGhvdXRDaXR5LnNwbGl0KC9bLDpdLykubWFwKHMgPT4gcy50cmltKCkpLmZpbHRlcihzID0+IHMgIT09ICIiKTsNCiAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50TGluZSA9ICIiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgbWF4V2lkdGggPSA4NTsNCg0KICAgICAgICAgICAgICAgICAgc2VnbWVudHMuZm9yRWFjaCgoc2VnbWVudCwgaWR4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBzZWdtZW50IGl0c2VsZiBpcyB0b28gbG9uZyBmb3IgYSBibGFuayBsaW5lDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGRvYy5nZXRUZXh0V2lkdGgoc2VnbWVudCkgPiBtYXhXaWR0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBGT1JDRSBURVhUIEZMT1cgZm9yIHRoaXMgc2VnbWVudCAoU3BsaXQgYnkgc3BhY2UpDQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzdWJXb3JkcyA9IHNlZ21lbnQuc3BsaXQoL1xzKy8pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJXb3Jkcy5mb3JFYWNoKHN3ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0ZXN0TGluZSA9IGN1cnJlbnRMaW5lID09PSAiIiA/IHN3IDogY3VycmVudExpbmUgKyAiICIgKyBzdzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuZ2V0VGV4dFdpZHRoKHRlc3RMaW5lKSA8IG1heFdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudExpbmUgPSB0ZXN0TGluZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoY3VycmVudExpbmUsIHggKyA1LCBhZGRyWSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkclkgKz0gNS41Ow0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lID0gc3c7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0YW5kYXJkIHBhY2tpbmcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRlc3RMaW5lID0gY3VycmVudExpbmUgPT09ICIiID8gc2VnbWVudCA6IGN1cnJlbnRMaW5lICsgIiwgIiArIHNlZ21lbnQ7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb2MuZ2V0VGV4dFdpZHRoKHRlc3RMaW5lKSA8IG1heFdpZHRoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50TGluZSA9IHRlc3RMaW5lOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJpbnQgY3VycmVudCBsaW5lIGFuZCBzdGFydCBuZXcgbGluZSB3aXRoIHRoaXMgc2VnbWVudA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoY3VycmVudExpbmUgKyAoY3VycmVudExpbmUuZW5kc1dpdGgoIiwiKSA/ICIiIDogIiwiKSwgeCArIDUsIGFkZHJZKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJZICs9IDUuNTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRMaW5lID0gc2VnbWVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAvLyBQcmludCBmaW5hbCBhZGRyZXNzIGJvZHkgbGluZQ0KICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRMaW5lKSB7DQogICAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoY3VycmVudExpbmUsIHggKyA1LCBhZGRyWSk7DQogICAgICAgICAgICAgICAgICAgICAgYWRkclkgKz0gNS41Ow0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAvLyBDaXR5IC0gUGluY29kZQ0KICAgICAgICAgICAgICAgICAgY29uc3QgY2l0eVBpbiA9IGNpdHkgKyAocGluQ29kZSA/ICIgLSAiICsgcGluQ29kZSA6ICIiKTsNCiAgICAgICAgICAgICAgICAgIGRvYy50ZXh0KGNpdHlQaW4sIHggKyA1LCBhZGRyWSk7DQogICAgICAgICAgICAgICAgICBhZGRyWSArPSA3Ow0KDQogICAgICAgICAgICAgICAgICAvLyA0LiBUZWxlcGhvbmUgKEJvbGQpDQogICAgICAgICAgICAgICAgICBpZiAocGhvbmUgJiYgcGhvbmUudHJpbSgpICE9PSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgIGRvYy5zZXRGb250KCJoZWx2ZXRpY2EiLCAiYm9sZCIpOw0KICAgICAgICAgICAgICAgICAgICAgIC8vIEVuc3VyZSBwaG9uZSBkb2Vzbid0IGRyb3Agb2ZmIHRoZSBsYWJlbA0KICAgICAgICAgICAgICAgICAgICAgIGxldCBmaW5hbFBob25lWSA9IE1hdGgubWluKGFkZHJZLCB5ICsgbGFiZWxIIC0gNik7DQogICAgICAgICAgICAgICAgICAgICAgZG9jLnRleHQoIlRlbGVwaG9uZSA6ICIgKyBwaG9uZSwgeCArIDUsIGZpbmFsUGhvbmVZKTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIGN1cnJlbnRJdGVtKys7DQogICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLUdCJykucmVwbGFjZSgvXC8vZywgJy0nKTsNCiAgICAgICAgICAgICAgZG9jLnNhdmUoYExhYmVscyAtICR7dG9kYXl9LnBkZmApOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgLy8gMS4gSW5pdGlhbGl6ZSBBdWRpbyBhbmQgaGFuZGxlIEJyb3dzZXIgQXV0b3BsYXkgUG9saWN5DQogICAgICAgICAgZnVuY3Rpb24gaW5pdEF1ZGlvKCkgew0KICAgICAgICAgICAgICBjb25zdCBhdWRpbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZ011c2ljJyk7DQogICAgICAgICAgICAgIGF1ZGlvLnZvbHVtZSA9IDAuMzsgLy8gU2V0IHZvbHVtZSB0byAzMCUgc28gaXQncyBub3QgdG9vIGxvdWQNCg0KICAgICAgICAgICAgICAvLyBNb2Rlcm4gYnJvd3NlcnMgYmxvY2sgYXVkaW8gdW50aWwgdGhlIHVzZXIgY2xpY2tzIHNvbWV0aGluZw0KICAgICAgICAgICAgICBjb25zdCBwbGF5QXR0ZW1wdCA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgIGF1ZGlvLnBsYXkoKS50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyBPbmNlIHBsYXlpbmcgc3RhcnRzLCByZW1vdmUgdGhlICJmaXJzdC1jbGljayIgbGlzdGVuZXJzDQogICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5QXR0ZW1wdCk7DQogICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHBsYXlBdHRlbXB0KTsNCiAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGUgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBdWRpbyB3YWl0aW5nIGZvciB1c2VyIGludGVyYWN0aW9uLiIpOw0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgLy8gVHJpZ2dlciBwbGF5IG9uIHRoZSB2ZXJ5IGZpcnN0IGNsaWNrIG9yIGtleXByZXNzIHRoZSB1c2VyIG1ha2VzDQogICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheUF0dGVtcHQpOw0KICAgICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgcGxheUF0dGVtcHQpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIDIuIFRoZSBNdXRlL1VubXV0ZSBUb2dnbGUgZnVuY3Rpb24NCiAgICAgICAgICBmdW5jdGlvbiB0b2dnbGVNdXRlKCkgew0KICAgICAgICAgICAgICBjb25zdCBhdWRpbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiZ011c2ljJyk7DQogICAgICAgICAgICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtdXRlQnRuJyk7DQoNCiAgICAgICAgICAgICAgaWYgKGF1ZGlvLm11dGVkKSB7DQogICAgICAgICAgICAgICAgICBhdWRpby5tdXRlZCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgYnRuLmlubmVySFRNTCA9ICLwn5SHIE11dGUiOw0KICAgICAgICAgICAgICAgICAgYnRuLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgJyNlZWVlZWUnLCAnaW1wb3J0YW50Jyk7DQogICAgICAgICAgICAgICAgICBidG4uc3R5bGUuc2V0UHJvcGVydHkoJ2NvbG9yJywgJ2JsYWNrJywgJ2ltcG9ydGFudCcpOw0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgYXVkaW8ubXV0ZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgYnRuLmlubmVySFRNTCA9ICLwn5SKIFVubXV0ZSI7DQogICAgICAgICAgICAgICAgICAvLyBDaGFuZ2VzIHRvIGEgc29mdCByZWQgYmFja2dyb3VuZCB3aXRoIGRhcmsgcmVkIHRleHQgd2hlbiBtdXRlZA0KICAgICAgICAgICAgICAgICAgYnRuLnN0eWxlLnNldFByb3BlcnR5KCdiYWNrZ3JvdW5kJywgJyNmZmRhZGEnLCAnaW1wb3J0YW50Jyk7DQogICAgICAgICAgICAgICAgICBidG4uc3R5bGUuc2V0UHJvcGVydHkoJ2NvbG9yJywgJyM4ODAwMDAnLCAnaW1wb3J0YW50Jyk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvLyAzLiBNYWtlIHN1cmUgdG8gY2FsbCBpbml0QXVkaW8gd2hlbiB0aGUgcGFnZSBsb2Fkcw0KICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdEF1ZGlvKTsNCg0KDQogICAgICAgICAgLyoqDQoqIEFub255IE1hdGNoOiBQbGFjZWhvbGRlciBmb3IgZnV0dXJlIGxvZ2ljIHRvIG1hdGNoDQoqIGFub255bW91cyBkb25hdGlvbnMgd2l0aCBzcGVjaWZpYyBkb25vciByZWNvcmRzLg0KKi8NCg0KDQogICAgICAgICAgLy8gSGVscGVyIHRvIGNsZWFuIHRoZSByZWZlcmVuY2Ugc3RyaW5nIG9mIGJhbmtpbmcgbm9pc2UNCiAgICAgICAgICBmdW5jdGlvbiBzYW5pdGl6ZVJlZihzdHIpIHsNCiAgICAgICAgICAgICAgaWYgKCFzdHIpIHJldHVybiAiIjsNCiAgICAgICAgICAgICAgbGV0IGNsZWFuID0gc3RyLnRvVXBwZXJDYXNlKCk7DQoNCiAgICAgICAgICAgICAgLy8gMS4gUmVtb3ZlIFN0YW5kYXJkIEJhbmtpbmcgUHJlZml4ZXMNCiAgICAgICAgICAgICAgY29uc3Qgbm9pc2UgPSBbDQogICAgICAgICAgICAgICAgICAiQlkgT05MIFVQSS8iLCAiQlkgTkVGVCBUUkYiLCAiQlkgT05MIFRSRi8iLCAiQlkgT05MIElNUFMvIiwNCiAgICAgICAgICAgICAgICAgICJCWSBPTkwgQ1IvIiwgIkJZIE9OTCBNQi8iLCAiQlkgT05MIENDLyIsICJCWSBPTkwgREMvIiwNCiAgICAgICAgICAgICAgICAgICJCWSBUUkFOU0ZFUi0iLCAiQlkgVFJBTlNGRVIvIiwgIkJZIENBU0giLCAiOjowMDAzMiIsICI6OjAwMDAxIg0KICAgICAgICAgICAgICBdOw0KICAgICAgICAgICAgICBub2lzZS5mb3JFYWNoKHAgPT4geyBjbGVhbiA9IGNsZWFuLnNwbGl0KHApLmpvaW4oIiIpOyB9KTsNCg0KICAgICAgICAgICAgICAvLyAyLiBSZW1vdmUgTnVtYmVycyAoSURzLCBJRlNDIGNvZGVzLCBEYXRlcykgdG8gZm9jdXMgb24gbmFtZXMvdGV4dA0KICAgICAgICAgICAgICAvLyBXZSByZXBsYWNlIGRpZ2l0cyB3aXRoIGEgc3BhY2Ugc28gd2UgZG9uJ3QgYWNjaWRlbnRhbGx5IGpvaW4gdHdvIHdvcmRzDQogICAgICAgICAgICAgIGNsZWFuID0gY2xlYW4ucmVwbGFjZSgvWzAtOV0vZywgIiAiKTsNCg0KICAgICAgICAgICAgICAvLyAzLiBSZW1vdmUgU3BlY2lhbCBDaGFyYWN0ZXJzIGFuZCBleHRyYSBzcGFjZXMNCiAgICAgICAgICAgICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9bXkEtWiBdL2csICIgIik7DQoNCiAgICAgICAgICAgICAgLy8gNC4gUmV0dXJuIGNvbmRlbnNlZCB1cHBlcmNhc2Ugc3RyaW5nIChlLmcuLCAiTVlUSElMSUlDSUNNWUpJTkpVIikNCiAgICAgICAgICAgICAgcmV0dXJuIGNsZWFuLnJlcGxhY2UoL1xzKy9nLCAiIikudHJpbSgpOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgLyoqDQoqIFNBTklUSVpBVElPTiBFTkdJTkUNCiogUmVtb3ZlcyBiYW5rIHByZWZpeGVzLCB0cmFuc2FjdGlvbiBJRHMsIGFuZCBzdGFuZGFyZCBzdWZmaXhlcy4NCiovDQogICAgICAgICAgZnVuY3Rpb24gc2FuaXRpemVSZWYoc3RyKSB7DQogICAgICAgICAgICAgIGlmICghc3RyIHx8IHR5cGVvZiBzdHIgIT09ICdzdHJpbmcnKSByZXR1cm4gIiI7DQogICAgICAgICAgICAgIGxldCBjbGVhbiA9IHN0ci50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgICAgICAgIC8vIDEuIExpc3Qgb2YgcGhyYXNlcyB0byBpZ25vcmUgKEZpbmUtdHVuZSB0aGlzIGxpc3QgYXMgbmVlZGVkKQ0KICAgICAgICAgICAgICBjb25zdCBub2lzZSA9IFsNCiAgICAgICAgICAgICAgICAgICJCWSBPTkwgVVBJLyIsICJCWSBORUZUIFRSRiIsICJCWSBPTkwgVFJGLyIsICJCWSBPTkwgSU1QUy8iLA0KICAgICAgICAgICAgICAgICAgIkJZIE9OTCBDUi8iLCAiQlkgT05MIE1CLyIsICJCWSBPTkwgQ0MvIiwgIkJZIE9OTCBEQy8iLA0KICAgICAgICAgICAgICAgICAgIkJZIFRSQU5TRkVSLSIsICJCWSBUUkFOU0ZFUi8iLCAiQlkgQ0FTSCIsICI6OjAwMDMyIiwgIjo6MDAwMDEiLA0KICAgICAgICAgICAgICAgICAgIlRSQU5TRkVSIEZST00iLCAiQ0ggU0JJTiIsICJGRFJMLyIsICJJQ0lDLyINCiAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgbm9pc2UuZm9yRWFjaChwID0+IHsgY2xlYW4gPSBjbGVhbi5zcGxpdChwKS5qb2luKCIiKTsgfSk7DQoNCiAgICAgICAgICAgICAgLy8gMi4gUmVtb3ZlIGFsbCBudW1iZXJzIChyZW1vdmVzIFVQSSBJRHMsIElGU0MgY29kZXMsIGFuZCBkYXRlcykNCiAgICAgICAgICAgICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9bMC05XS9nLCAiIik7DQoNCiAgICAgICAgICAgICAgLy8gMy4gUmVtb3ZlIG5vbi1hbHBoYSBjaGFyYWN0ZXJzIChzbGFzaGVzLCBjb2xvbnMsIGRvdHMpDQogICAgICAgICAgICAgIGNsZWFuID0gY2xlYW4ucmVwbGFjZSgvW15BLVpdL2csICIiKTsNCg0KICAgICAgICAgICAgICByZXR1cm4gY2xlYW4udHJpbSgpOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgLyoqDQoqIFNBTklUSVpBVElPTiBFTkdJTkUNCiogUmVtb3ZlcyBiYW5rIHByZWZpeGVzLCB0cmFuc2FjdGlvbiBJRHMsIGFuZCBzdGFuZGFyZCBzdWZmaXhlcy4NCiovDQogICAgICAgICAgZnVuY3Rpb24gc2FuaXRpemVSZWYoc3RyKSB7DQogICAgICAgICAgICAgIGlmICghc3RyIHx8IHR5cGVvZiBzdHIgIT09ICdzdHJpbmcnKSByZXR1cm4gIiI7DQogICAgICAgICAgICAgIGxldCBjbGVhbiA9IHN0ci50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgICAgICAgIC8vIDEuIExpc3Qgb2YgcGhyYXNlcyB0byBpZ25vcmUgKEZpbmUtdHVuZSB0aGlzIGxpc3QgYXMgbmVlZGVkKQ0KICAgICAgICAgICAgICBjb25zdCBub2lzZSA9IFsNCiAgICAgICAgICAgICAgICAgICJCWSBPTkwgVVBJLyIsICJCWSBORUZUIFRSRiIsICJCWSBPTkwgVFJGLyIsICJCWSBPTkwgSU1QUy8iLA0KICAgICAgICAgICAgICAgICAgIkJZIE9OTCBDUi8iLCAiQlkgT05MIE1CLyIsICJCWSBPTkwgQ0MvIiwgIkJZIE9OTCBEQy8iLA0KICAgICAgICAgICAgICAgICAgIkJZIFRSQU5TRkVSLSIsICJCWSBUUkFOU0ZFUi8iLCAiQlkgQ0FTSCIsICI6OjAwMDMyIiwgIjo6MDAwMDEiLA0KICAgICAgICAgICAgICAgICAgIlRSQU5TRkVSIEZST00iLCAiQ0ggU0JJTiIsICJGRFJMLyIsICJJQ0lDLyINCiAgICAgICAgICAgICAgXTsNCiAgICAgICAgICAgICAgbm9pc2UuZm9yRWFjaChwID0+IHsgY2xlYW4gPSBjbGVhbi5zcGxpdChwKS5qb2luKCIiKTsgfSk7DQoNCiAgICAgICAgICAgICAgLy8gMi4gUmVtb3ZlIGFsbCBudW1iZXJzIChyZW1vdmVzIFVQSSBJRHMsIElGU0MgY29kZXMsIGFuZCBkYXRlcykNCiAgICAgICAgICAgICAgY2xlYW4gPSBjbGVhbi5yZXBsYWNlKC9bMC05XS9nLCAiIik7DQoNCiAgICAgICAgICAgICAgLy8gMy4gUmVtb3ZlIG5vbi1hbHBoYSBjaGFyYWN0ZXJzIChzbGFzaGVzLCBjb2xvbnMsIGRvdHMpDQogICAgICAgICAgICAgIGNsZWFuID0gY2xlYW4ucmVwbGFjZSgvW15BLVpdL2csICIiKTsNCg0KICAgICAgICAgICAgICByZXR1cm4gY2xlYW4udHJpbSgpOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgZnVuY3Rpb24gZG93bmxvYWRBbm9ueU1hdGNoKCkgew0KICAgICAgICAgICAgICBjb25zdCB0YWJsZUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWF0Y2hUYWJsZUJvZHknKTsNCiAgICAgICAgICAgICAgaWYgKCF0YWJsZUJvZHkgfHwgdGFibGVCb2R5LnJvd3MubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiTm8gcmVzdWx0cyB0byBkb3dubG9hZC4iKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGxldCB0ZXh0Q29udGVudCA9ICJBTk9OWU1PVVMgTUFUQ0ggUkVTVUxUU1xuIjsNCiAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gIkdlbmVyYXRlZCBvbjogIiArIG5ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKSArICJcbiI7DQogICAgICAgICAgICAgIHRleHRDb250ZW50ICs9ICI9Ii5yZXBlYXQoODApICsgIlxuXG4iOw0KDQogICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSB0YWJsZUJvZHkucXVlcnlTZWxlY3RvckFsbCgndHInKTsNCg0KICAgICAgICAgICAgICByb3dzLmZvckVhY2gocm93ID0+IHsNCiAgICAgICAgICAgICAgICAgIC8vIFNraXAgdGhlIGdyYXkgc3BhY2VyIHJvd3MNCiAgICAgICAgICAgICAgICAgIGlmIChyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdzcGFjZXItcm93JykgfHwgcm93LnN0eWxlLmhlaWdodCA9PT0gIjE1cHgiKSB7DQogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gIi0iLnJlcGVhdCg4MCkgKyAiXG5cbiI7IC8vIERpdmlkZXIgYWZ0ZXIgZXZlcnkgc2V0DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCBjb2xzID0gcm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoY29scy5sZW5ndGggPCA0KSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2VpcHQgPSBjb2xzWzBdLmlubmVyVGV4dC5yZXBsYWNlKC9cbi9nLCAiIHwgIik7DQogICAgICAgICAgICAgICAgICBjb25zdCBhbW91bnQgPSBjb2xzWzFdLmlubmVyVGV4dDsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbm9yID0gY29sc1syXS5pbm5lclRleHQucmVwbGFjZSgvXG4vZywgIiAiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZiA9IGNvbHNbM10uaW5uZXJUZXh0Ow0KDQogICAgICAgICAgICAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnYW5vbnktbWFpbi1yb3cnKSkgew0KICAgICAgICAgICAgICAgICAgICAgIHRleHRDb250ZW50ICs9IGBbVEFSR0VUXSBSZWNlaXB0OiAke3JlY2VpcHR9IHwgQW10OiAke2Ftb3VudH1cbmA7DQogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gYCAgICAgICAgIFJlZjogJHtyZWZ9XG5gOw0KICAgICAgICAgICAgICAgICAgICAgIHRleHRDb250ZW50ICs9ICJNYXRjaGVzIEZvdW5kOlxuIjsNCiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gYCAgID4+IE1hdGNoOiAke3JlY2VpcHR9IHwgQW10OiAke2Ftb3VudH1cbmA7DQogICAgICAgICAgICAgICAgICAgICAgdGV4dENvbnRlbnQgKz0gYCAgICAgIERvbm9yOiAke2Rvbm9yfVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICB0ZXh0Q29udGVudCArPSBgICAgICAgUmVmOiAgICR7cmVmfVxuXG5gOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAvLyBDcmVhdGUgdGhlIGRvd25sb2FkIGxpbmsNCiAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFt0ZXh0Q29udGVudF0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pOw0KICAgICAgICAgICAgICBjb25zdCB1cmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgICAgICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOw0KICAgICAgICAgICAgICBhLmhyZWYgPSB1cmw7DQogICAgICAgICAgICAgIGEuZG93bmxvYWQgPSAnQW5vbnlNYXRjaC50eHQnOw0KICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOw0KICAgICAgICAgICAgICBhLmNsaWNrKCk7DQogICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYSk7DQogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsNCiAgICAgICAgICB9DQoNCg0KDQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkFub255TWF0Y2goKSB7DQogICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmdEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpOw0KICAgICAgICAgICAgICBpZiAobG9hZGluZ0Rpdikgew0KICAgICAgICAgICAgICAgICAgbG9hZGluZ0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgICAgIGxvYWRpbmdEaXYuaW5uZXJIVE1MID0gIkluaXRpYWxpemluZyBNYXRjaCBmb3IgU2VsZWN0ZWQgWWVhci4uLiI7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAvLyBHZXQgdGhlIHNlbGVjdGVkIHllYXIgZnJvbSB5b3VyIGRhc2hib2FyZCByYWRpbyBidXR0b25zDQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCg0KICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwKSk7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHRzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpOw0KDQogICAgICAgICAgICAgICAgICByZXN1bHRzRGl2LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgICAgIDxoMyBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IHBhZGRpbmc6MTBweDsiPkFub255bW91cyBJZGVudGl0eSBNYXRjaCAoRlkgJHtzWWVhcn0pPC9oMz4NCiAgICAgICAgICAgICAgICAgIDx0YWJsZSBpZD0ibWF0Y2hUYWJsZSIgYm9yZGVyPSIxIiBzdHlsZT0id2lkdGg6MTAwJTsgYm9yZGVyLWNvbGxhcHNlOmNvbGxhcHNlOyI+DQogICAgICAgICAgICAgICAgICAgICAgPHRoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8dHIgc3R5bGU9ImJhY2tncm91bmQ6I2YyZjJmMjsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIHN0eWxlPSJ3aWR0aDoyMCUiPlJlY2VpcHQgLyBEYXRlPC90aD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0aCBzdHlsZT0id2lkdGg6MCUiPjwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9IndpZHRoOjMwJSI+RG9ub3IgRGV0YWlsczwvdGg+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGggc3R5bGU9IndpZHRoOjUwJSI+T3JpZ2luYWwgUmVmZXJlbmNlPC90aD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgICAgICA8L3RoZWFkPg0KICAgICAgICAgICAgICAgICAgICAgIDx0Ym9keSBpZD0ibWF0Y2hUYWJsZUJvZHkiPjwvdGJvZHk+DQogICAgICAgICAgICAgICAgICA8L3RhYmxlPmA7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhYmxlQm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXRjaFRhYmxlQm9keScpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBhbGxSZWNvcmRzID0gdGV4dC5zcGxpdCgnXG4nKS5maWx0ZXIociA9PiByLmxlbmd0aCA+IDIwKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gMS4gSWRlbnRpZnkgVGFyZ2V0IEFub255bW91cyBSZWNvcmRzIE9OTFkgZm9yIHRoZSBzZWxlY3RlZCBGaW5hbmNpYWwgWWVhcg0KICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0cyA9IGFsbFJlY29yZHMuZmlsdGVyKHIgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGxldCBmID0gci5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJObyA9IChmWzBdIHx8ICIiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJEYXRlID0gcGFyc2VEYXRlKGZbMV0pOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FuY2VsbGVkID0gZlsxM10/LnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0Fub24gPSAoIWZbMl0gfHwgZlsyXS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCJhbm9ueW1vdXMiKSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNHVyA9IHJOby5zdGFydHNXaXRoKCJHVyIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgRmluYW5jaWFsIFllYXIgTG9naWMgKE1hdGNoaW5nIHlvdXIgcnVuQW5vbnltb3VzIGxvZ2ljKQ0KICAgICAgICAgICAgICAgICAgICAgIGxldCBpblllYXIgPSAoc1llYXIgPT09ICJhbGwiKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluWWVhcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmeVMgPSBwYXJzZUludChzWWVhcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSByRGF0ZS5nZXRNb250aCgpICsgMSwgeSA9IHJEYXRlLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGluWWVhciA9ICh5ID09PSBmeVMgJiYgbSA+PSA0KSB8fCAoeSA9PT0gZnlTICsgMSAmJiBtIDw9IDMpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpblllYXIgJiYgaXNBbm9uICYmICFpc0NhbmNlbGxlZCAmJiAhaXNHVzsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAodGFyZ2V0cy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICByZXN1bHRzRGl2LmlubmVySFRNTCA9IGA8ZGl2IHN0eWxlPSdwYWRkaW5nOjIwcHg7IHRleHQtYWxpZ246Y2VudGVyOyc+Tm8gYW5vbnltb3VzIHJlY29yZHMgZm91bmQgZm9yIEZZICR7c1llYXJ9LjwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmdEaXYpIGxvYWRpbmdEaXYuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoTGVuZ3RoID0gMTU7DQogICAgICAgICAgICAgICAgICBsZXQgY2x1c3RlcnNGb3VuZCA9IDA7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDIuIExvb3AgdGhyb3VnaCB0aGUgWWVhci1TcGVjaWZpYyBUYXJnZXRzDQogICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0RpdikgbG9hZGluZ0Rpdi5pbm5lckhUTUwgPSBgU2Nhbm5pbmcgUmVjb3JkICR7aSArIDF9IG9mICR7dGFyZ2V0cy5sZW5ndGh9Li4uYDsNCiAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMSkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IHRhcmdldHNbaV0uc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtUmVmQ2xlYW4gPSBzYW5pdGl6ZVJlZihtWzEwXSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbUlEID0gbVswXTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChtUmVmQ2xlYW4ubGVuZ3RoIDwgbWF0Y2hMZW5ndGgpIGNvbnRpbnVlOw0KDQogICAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoZXNIdG1sID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoQ291bnQgPSAwOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gMy4gU2VhcmNoIEdMT0JBTCBkYXRhYmFzZSBmb3IgbWF0Y2hlcyAoTm8geWVhciByZXN0cmljdGlvbiBoZXJlKQ0KICAgICAgICAgICAgICAgICAgICAgIGFsbFJlY29yZHMuZm9yRWFjaChkYlJvdyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGQgPSBkYlJvdy5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkTm8gPSAoZFswXSB8fCAiIikudG9VcHBlckNhc2UoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZFswXSA9PT0gbUlEIHx8IGROby5zdGFydHNXaXRoKCJHVyIpKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5kaWRhdGVBbm9uID0gKCFkWzJdIHx8IGRbMl0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDYW5kaWRhdGVBbm9uKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBkWzEzXT8udG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FzaCA9IChkWzExXSB8fCAiIikudG9VcHBlckNhc2UoKS5pbmNsdWRlcygiQ0FTSCIpIHx8IChkWzhdIHx8ICIiKS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDQVNIIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxlZCB8fCBpc0Nhc2gpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkUmVmQ2xlYW4gPSBzYW5pdGl6ZVJlZihkWzEwXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkUmVmQ2xlYW4ubGVuZ3RoIDwgbWF0Y2hMZW5ndGgpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZm91bmRPdmVybGFwID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkUmVmQ2xlYW4uaW5jbHVkZXMobVJlZkNsZWFuKSB8fCBtUmVmQ2xlYW4uaW5jbHVkZXMoZFJlZkNsZWFuKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRPdmVybGFwID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDw9IG1SZWZDbGVhbi5sZW5ndGggLSBtYXRjaExlbmd0aDsgeCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRSZWZDbGVhbi5pbmNsdWRlcyhtUmVmQ2xlYW4uc3Vic3RyaW5nKHgsIHggKyBtYXRjaExlbmd0aCkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kT3ZlcmxhcCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZE92ZXJsYXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoQ291bnQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhpc3RBbXQgPSBwYXJzZUZsb2F0KGRbOV0gfHwgMCkudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzSHRtbCArPSBgDQoNCjx0ciBjbGFzcz0ibWF0Y2gtcmVzdWx0LXJvdyI+DQogICAgICAgICAgICAgIDx0ZD4ke2RbMF19PGJyPiR7ZFsxXX08YnI+e+KCuSR7cGFyc2VGbG9hdChkWzldIHx8IDApLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+DQogICAgICAgICAgICAgIDx0ZD48L3RkPg0KICAgICAgICAgICAgICA8dGQ+PGI+JHtkWzJdfTwvYj48YnI+PHNtYWxsPiR7ZFs0XX08YnI+UElOOiAke2RbMTVdfSB8ICR7ZFsxOV19PGJyPlRlbDogJHtkWzNdfTwvc21hbGw+PC90ZD4NCiAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3b3JkLWJyZWFrOmJyZWFrLWFsbDsgZm9udC1zaXplOjAuNzVyZW07Ij4NCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImNvbG9yOnB1cnBsZTsgZm9udC13ZWlnaHQ6Ym9sZDsgYm9yZGVyLWJvdHRvbToxcHggc29saWQgI2RkZDsgbWFyZ2luLWJvdHRvbTo0cHg7Ij5UOiAke21bMTBdfTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgPGRpdj5NOiAke2RbMTBdfTwvZGl2Pg0KICAgICAgICAgICAgICA8L3RkPg0KICAgICAgICAgIDwvdHI+YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoQ291bnQgPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJzRm91bmQrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0QW10ID0gcGFyc2VGbG9hdChtWzldIHx8IDApLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBgDQogICAgICAgICAgICAgICAgICAgICAgICAgIDx0ciBjbGFzcz0iYW5vbnktbWFpbi1yb3ciIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjRTFCRUU3ICFpbXBvcnRhbnQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+JHttWzBdfTxicj4ke21bMV19PGJyPnvigrkke3RhcmdldEFtdH19PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZD48L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJjb2xvcjpwdXJwbGU7IHRleHQtYWxpZ246Y2VudGVyOyI+PGI+WyBBTk9OWU1PVVMgVEFSR0VUIF08L2I+PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0id29yZC1icmVhazpicmVhay1hbGw7IGZvbnQtc2l6ZTowLjc1cmVtOyI+JHttWzEwXX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQm9keS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIGhlYWRlciArIG1hdGNoZXNIdG1sICsgYDx0ciBzdHlsZT0iaGVpZ2h0OjE1cHg7IGJhY2tncm91bmQ6I2YwZjBmMDsiPjx0ZCBjb2xzcGFuPSI0Ij48L3RkPjwvdHI+YCk7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAvLyA0LiBTdW1tYXJ5IEJhciB3aXRoIERvd25sb2FkIEJ1dHRvbg0KICAgICAgICAgICAgICAgICAgY29uc3QgYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2hTdW1tYXJ5QmFyJyk7DQogICAgICAgICAgICAgICAgICBiLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICAgICAgYi5pbm5lckhUTUwgPSBgDQogICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBjZW50ZXI7IHdpZHRoOiAxMDAlOyBwYWRkaW5nOiA1cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA8c3Bhbj5GWSAke3NZZWFyfTogRm91bmQgJHtjbHVzdGVyc0ZvdW5kfSBkb25vcnMgZm9yICR7dGFyZ2V0cy5sZW5ndGh9IGFub255bW91cyByZWNvcmRzLjwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvd25sb2FkQW5vbnlNYXRjaCgpIiBjbGFzcz0idXRpbC1tZW51LWJ0biINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJiYWNrZ3JvdW5kOiAjMjhhNzQ1ICFpbXBvcnRhbnQ7IGNvbG9yOiB3aGl0ZSAhaW1wb3J0YW50OyB3aWR0aDogYXV0bzsgcGFkZGluZzogNXB4IDE1cHg7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgRG93bmxvYWQgTGlzdCAoLnR4dCkNCiAgICAgICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCiAgICAgICAgICAgICAgICAgIDwvZGl2PmA7DQogICAgICAgICAgICAgICAgICBsb2FkaW5nRGl2LmlubmVySFRNTCA9ICJQbGVhc2Ugd2FpdCAtIFdvcmtpbmcgb24geW91ciByZXF1ZXN0IjsNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgICAgICAgICAgICAgICBhbGVydCgiTG9naWMgZXJyb3I6ICIgKyBlcnIubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0RpdikgbG9hZGluZ0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgICAgdG9nZ2xlU2Nyb2xsQnV0dG9ucyh0cnVlKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgICBmdW5jdGlvbiByZW5kZXJNYXRjaFJvdyhkKSB7DQogICAgICAgICAgICAgIGNvbnN0IGFtdCA9IChwYXJzZUZsb2F0KGRbOV0pIHx8IDApLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpOw0KICAgICAgICAgICAgICByZXR1cm4gYA0KICAgICAgICAgICAgICA8dHIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7Ij4NCiAgICAgICAgICAgICAgICAgIDx0ZD4ke2RbMF19PGJyPiR7ZFsxXX08L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkPuKCuSR7YW10fTwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQ+PGI+JHtkWzJdfTwvYj48YnI+PHNtYWxsPiR7ZFs0XX08YnI+UElOOiAke2RbMTVdfSB8ICR7ZFsxOV19PGJyPlRlbDogJHtkWzNdfTwvc21hbGw+PC90ZD4NCiAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0id29yZC1icmVhazpicmVhay1hbGw7IGZvbnQtc2l6ZTowLjc1cmVtOyI+JHtkWzEwXX08L3RkPg0KICAgICAgICAgICAgICA8L3RyPmA7DQogICAgICAgICAgfQ0KDQoNCg0KICAgICAgICAgIC8vIEhlbHBlciB0byByZW5kZXIgdGhlIGRvbm9yIHJvdw0KICAgICAgICAgIGZ1bmN0aW9uIHJlbmRlck1hdGNoUm93KGQpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIGANCiAgICAgICAgICAgICAgPHRyIGNsYXNzPSJtYXRjaC1yZXN1bHQtcm93Ij4NCiAgICAgICAgICAgICAgICAgIDx0ZD4ke2RbMF19PGJyPiR7ZFsxXX08L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkPiR7ZFs1XX08L3RkPg0KICAgICAgICAgICAgICAgICAgPHRkPjxiPiR7ZFsyXX08L2I+PGJyPjxzbWFsbD4ke2RbNF19PGJyPlBJTjogJHtkWzE1XX0gfCAke2RbMTRdfTxicj5UZWw6ICR7ZFszXX08L3NtYWxsPjwvdGQ+DQogICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9IndvcmQtYnJlYWs6YnJlYWstYWxsOyBmb250LXNpemU6MC43NXJlbTsiPiR7ZFsxMF19PC90ZD4NCiAgICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICAgIH0NCg0KDQoNCg0KICAgICAgICAgIC8vIEhlbHBlciBmdW5jdGlvbiB0byBrZWVwIGNvZGUgY2xlYW4NCiAgICAgICAgICBmdW5jdGlvbiByZW5kZXJNYXRjaFJvdyhkKSB7DQogICAgICAgICAgICAgIGNvbnN0IGRvbm9yRGV0YWlscyA9IGA8Yj4ke2RbMl19PC9iPjxicj4ke2RbNF19PGJyPlBJTjogJHtkWzE1XX0gfCAke2RbMTRdfTxicj5UZWw6ICR7ZFszXX1gOw0KICAgICAgICAgICAgICByZXR1cm4gYDx0ciBjbGFzcz0ibWF0Y2gtcmVzdWx0LXJvdyI+DQogICAgICAgICAgICAgICAgICAgICAgPHRkPiR7ZFswXX08YnI+JHtkWzFdfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgPHRkPiR7ZFs1XX08L3RkPg0KICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke2Rvbm9yRGV0YWlsc308L3RkPg0KICAgICAgICAgICAgICAgICAgICAgIDx0ZD4ke2RbMTBdfTwvdGQ+DQogICAgICAgICAgICAgICAgICAgPC90cj5gOw0KICAgICAgICAgIH0NCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiB1cGRhdGVVc2VyU3RhdHVzKCkgew0KICAgICAgICAgICAgICBjb25zdCBtb25pdG9yRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJNb25pdG9yJyk7DQogICAgICAgICAgICAgIGNvbnN0IHVzZXJGaWxlVXJsID0gImh0dHBzOi8vZGwuZHJvcGJveHVzZXJjb250ZW50LmNvbS9zY2wvZmkvZzcyM2lxOHBqa3JqbWQ2ZTN1djZwL1VzZXJzLnR4dD9ybGtleT00M2R0a2Q3NmtwZDA5d2tiOHJqd3J3MW9jJnN0PWIyZ3VtZDFhJmRsPTEmbm9jYWNoZT0iICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXNlckZpbGVVcmwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gUGFyc2UgdXNlciBuYW1lcyBmcm9tIHRoZSBwaXBlLWRlbGltaXRlZCBmaWxlDQogICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VXNlcnMgPSB0ZXh0LnNwbGl0KC9ccj9cbi8pDQogICAgICAgICAgICAgICAgICAgICAgLm1hcChsaW5lID0+IGxpbmUudHJpbSgpKQ0KICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIobGluZSA9PiBsaW5lLmluY2x1ZGVzKCd8JykpDQogICAgICAgICAgICAgICAgICAgICAgLm1hcChsaW5lID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBsaW5lLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJ0c1sxXSA/IHBhcnRzWzFdLnRyaW0oKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcih1ID0+IHUubGVuZ3RoID4gMCk7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VXNlcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgbW9uaXRvckRpdi5jbGFzc05hbWUgPSAic3RhdHVzLWVtcHR5IjsNCiAgICAgICAgICAgICAgICAgICAgICBtb25pdG9yRGl2LmlubmVySFRNTCA9IGA8ZGl2IHN0eWxlPSJjb2xvcjojNzU3NTc1OyI+Tm8gb25lIHVzaW5nIHRoZSBNYWluIFNvZnR3YXJlIE5vdzwvZGl2PmA7DQogICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgIG1vbml0b3JEaXYuY2xhc3NOYW1lID0gInN0YXR1cy1hY3RpdmUiOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlMaXN0ID0gY3VycmVudFVzZXJzLmpvaW4oIiB8ICIpOw0KICAgICAgICAgICAgICAgICAgICAgIC8vIExpbmUgMTogTWFpbiBTb2Z0d2FyZSBVc2Vycw0KICAgICAgICAgICAgICAgICAgICAgIG1vbml0b3JEaXYuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9InBhZGRpbmctYm90dG9tOjJweDsiPjxzcGFuIGNsYXNzPSJsaXZlLWRvdCI+PC9zcGFuPiA8c3BhbiBzdHlsZT0iY29sb3I6I2ZmZDYwMDsiPk1haW4gU29mdHdhcmUgVXNlcjo8L3NwYW4+IFsgJHtkaXNwbGF5TGlzdH0gXTwvZGl2PmA7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIC8vIExpbmUgMjogQXBwIHVzZXJzIChDYWxjdWxhdGVkIGZyb20geW91ciBnbG9iYWwgdmFyaWFibGUpDQogICAgICAgICAgICAgICAgICBjb25zdCBhcHBVc2VyTGFiZWwgPSAodHlwZW9mIGdsb2JhbEFwcFVzZXJJZGVudGl0eSAhPT0gJ3VuZGVmaW5lZCcgJiYgZ2xvYmFsQXBwVXNlcklkZW50aXR5KSA/IGdsb2JhbEFwcFVzZXJJZGVudGl0eSA6ICJBY3RpdmUiOw0KICAgICAgICAgICAgICAgICAgbW9uaXRvckRpdi5pbm5lckhUTUwgKz0gYDxkaXY+PHNwYW4gY2xhc3M9ImxpdmUtZG90Ij48L3NwYW4+QXBwIHVzZXJzIDogPHNwYW4gaWQ9ImFjdGl2ZVVzZXJMaXN0Ij4ke2FwcFVzZXJMYWJlbH08L3NwYW4+PC9kaXY+YDsNCg0KICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHByZXZpb3VzVXNlckxpc3QgZm9yIHRoZSBsb2dpbiBub3RpZmljYXRpb24gbG9naWMgZWxzZXdoZXJlIGluIHlvdXIgc2NyaXB0DQogICAgICAgICAgICAgICAgICBwcmV2aW91c1VzZXJMaXN0ID0gY3VycmVudFVzZXJzOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiTW9uaXRvciBTeW5jIEVycm9yOiIsIGVycik7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQoNCg0KICAgICAgICAgIC8vIENhbGwgdGhlIGZ1bmN0aW9uIG9uIGxvYWQNCiAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHVwZGF0ZVVzZXJTdGF0dXMpOw0KICAgICAgICAgIC8vIE9wdGlvbmFsOiBSZWZyZXNoIGV2ZXJ5IDYwIHNlY29uZHMNCiAgICAgICAgICBzZXRJbnRlcnZhbCh1cGRhdGVVc2VyU3RhdHVzLCA2MDAwMCk7DQoNCg0KICAgICAgICAgIC8vIE5FVzogR2xvYmFsIHZhcmlhYmxlIGZvciB0aGUgSWRlbnRpdHkgTmFtZQ0KICAgICAgICAgIGxldCBhcHBVc2VySWRlbnRpdHkgPSAiVXNlciI7DQoNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBORVcgRlVOQ1RJT046IFJlYWRzIEFwcHJvdmVkMi50eHQsIG1hdGNoZXMgdGhlIElELA0KICAgICAgICAgICAqIGFuZCBleHRyYWN0cyB0aGUgbmFtZSBwYXJ0IGFmdGVyIHRoZSAifCIgc2VwYXJhdG9yLg0KICAgICAgICAgICAqLw0KDQoNCg0KDQoNCg0KICAgICAgICAgIC8vIC0tLSBDT05GSUdVUkFUSU9OIC0tLQ0KICAgICAgICAgIGNvbnN0IEJJTl9JRCA9ICI2OTYzNWQ4ZmQwZWE4ODFmNDA2M2E3MmUiOw0KICAgICAgICAgIGNvbnN0IE1BU1RFUl9LRVkgPSAiJDJhJDEwJGNCc1VDYjNTcnBHTUlmSjI2YjI4Li5jcVR3UlQ1akZBc1hKc3dqTi9XL0NBM2tRWHV1TjF1IjsNCiAgICAgICAgICB2YXIgZ2xvYmFsQXBwVXNlcklkZW50aXR5ID0gIiI7DQoNCiAgICAgICAgICAvLyAtLS0gMS4gVEhFIENMT1VEIFNZTkMgTE9HSUMgKEhhbmRsZXMgU2VsZi1DbGVhbmluZykgLS0tDQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gc3luY1dpdGhKc29uQmluKCkgew0KICAgICAgICAgICAgICBpZiAoIWdsb2JhbEFwcFVzZXJJZGVudGl0eSkgcmV0dXJuOw0KDQogICAgICAgICAgICAgIGNvbnN0IEJJTl9JRCA9ICI2OTYzNWQ4ZmQwZWE4ODFmNDA2M2E3MmUiOw0KICAgICAgICAgICAgICBjb25zdCBNQVNURVJfS0VZID0gIiQyYSQxMCRjQnNVQ2IzU3JwR01JZkoyNmIyOC4uY3FUd1JUNWpGQXNYSnN3ak4vVy9DQTNrUVh1dU4xdSI7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIC8vIFdlIGFkZCA/bm9jYWNoZT0uLi4gdG8gZm9yY2UgdGhlIGJyb3dzZXIgdG8gZ2V0IHRoZSByZWFsIGRhdGEgZnJvbSB0aGUgYmluDQogICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5qc29uYmluLmlvL3YzL2IvJHtCSU5fSUR9L2xhdGVzdD9ub2NhY2hlPSR7RGF0ZS5ub3coKX1gLCB7DQogICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAiWC1NYXN0ZXItS2V5IjogTUFTVEVSX0tFWSB9DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7DQogICAgICAgICAgICAgICAgICBsZXQgcmF3TmFtZXMgPSBkYXRhLnJlY29yZC51c2VycyB8fCAiIjsNCg0KICAgICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBleHBpcnlMaW1pdCA9IDEyMDsgLy8gMiBtaW51dGVzDQoNCiAgICAgICAgICAgICAgICAgIGxldCBhbGxFbnRyaWVzID0gcmF3TmFtZXMgPyByYXdOYW1lcy5zcGxpdCgnLCcpIDogW107DQogICAgICAgICAgICAgICAgICBsZXQgdmFsaWRFbnRyaWVzID0gW107DQogICAgICAgICAgICAgICAgICBsZXQgZGlzcGxheU5hbWVzID0gW107DQoNCiAgICAgICAgICAgICAgICAgIGFsbEVudHJpZXMuZm9yRWFjaChlbnRyeSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgW25hbWUsIHRpbWVzdGFtcF0gPSBlbnRyeS5zcGxpdCgnOicpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGVudHJ5VGltZSA9IHBhcnNlSW50KHRpbWVzdGFtcCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB1c2VyIGlzIGFjdGl2ZSB3aXRoaW4gMiBtaW5zLCBrZWVwIHRoZW0NCiAgICAgICAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gZ2xvYmFsQXBwVXNlcklkZW50aXR5IHx8IChub3cgLSBlbnRyeVRpbWUpIDwgZXhwaXJ5TGltaXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkaXNwbGF5TmFtZXMuaW5jbHVkZXMobmFtZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbmFsVGltZSA9IChuYW1lID09PSBnbG9iYWxBcHBVc2VySWRlbnRpdHkpID8gbm93IDogZW50cnlUaW1lOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsaWRFbnRyaWVzLnB1c2goYCR7bmFtZX06JHtmaW5hbFRpbWV9YCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZXMucHVzaChuYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBpZiAoIWRpc3BsYXlOYW1lcy5pbmNsdWRlcyhnbG9iYWxBcHBVc2VySWRlbnRpdHkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgdmFsaWRFbnRyaWVzLnB1c2goYCR7Z2xvYmFsQXBwVXNlcklkZW50aXR5fToke25vd31gKTsNCiAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZXMucHVzaChnbG9iYWxBcHBVc2VySWRlbnRpdHkpOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkU3RyaW5nID0gdmFsaWRFbnRyaWVzLmpvaW4oJywnKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gV3JpdGUgYmFjayB0aGUgY2xlYW5lZCBsaXN0DQogICAgICAgICAgICAgICAgICBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkuanNvbmJpbi5pby92My9iLyR7QklOX0lEfWAsIHsNCiAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQVVQnLA0KICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlgtTWFzdGVyLUtleSI6IE1BU1RFUl9LRVkNCiAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgdXNlcnM6IHVwZGF0ZWRTdHJpbmcgfSkNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgVUkgYmFyDQogICAgICAgICAgICAgICAgICBjb25zdCBsaXN0U3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmVVc2VyTGlzdCcpOw0KICAgICAgICAgICAgICAgICAgbGlzdFNwYW4uaW5uZXJUZXh0ID0gZGlzcGxheU5hbWVzLmpvaW4oJyB8ICcpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBtb25pdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJNb25pdG9yJyk7DQogICAgICAgICAgICAgICAgICBtb25pdG9yLmNsYXNzTmFtZSA9ICdzdGF0dXMtYWN0aXZlJzsNCiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxdWl0QnRuJykuc3R5bGUuZGlzcGxheSA9ICdpbmxpbmUtYmxvY2snOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJTeW5jIEVycm9yOiIsIGUpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCg0KDQogICAgICAgICAgLy8gLS0tIDIuIElERU5USVRZIENIRUNLIC0tLQ0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJJZGVudGl0eShteUlEKSB7DQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCgiaHR0cHM6Ly9kbC5kcm9wYm94dXNlcmNvbnRlbnQuY29tL3NjbC9maS8wejB3aXMwMmNhMW1yY251dHF1YzAvQXBwcm92ZWQyLnR4dD9ybGtleT1za2wzdXp4NTBqOG4wMnVpbXNtYXYydGh0JmRsPTEiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gKGF3YWl0IHJlcy50ZXh0KCkpLnNwbGl0KC9ccj9cbi8pOw0KDQogICAgICAgICAgICAgICAgICBmb3IgKGxldCBsaW5lIG9mIGxpbmVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUuaW5jbHVkZXMobXlJRCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsQXBwVXNlcklkZW50aXR5ID0gbGluZS5zcGxpdCgnfCcpWzFdLnRyaW0oKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTZXQgVUkgdG8gYWN0aXZlIGFuZCBzaG93IHF1aXQgYnV0dG9uDQogICAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1c2VyTW9uaXRvcicpLmNsYXNzTmFtZSA9ICJzdGF0dXMtYWN0aXZlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3F1aXRCdG4nKS5zdHlsZS5kaXNwbGF5ID0gImlubGluZS1ibG9jayI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW5pdGlhbCBzeW5jIGFuZCBzdGFydCBsb29wDQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vc3luY1dpdGhKc29uQmluKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHNldEludGVydmFsKHN5bmNXaXRoSnNvbkJpbiwgNDUwMDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgeyBjb25zb2xlLmVycm9yKCJJZGVudGl0eSBsb29rdXAgZmFpbGVkLiIpOyB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gLS0tIDMuIFRIRSBDT05UUk9MTEVEIFFVSVQgKEZvcmVncm91bmQgRGVsZXRpb24pIC0tLQ0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHByb3BlclF1aXQoKSB7DQogICAgICAgICAgICAgIGlmICghZ2xvYmFsQXBwVXNlcklkZW50aXR5KSByZXR1cm47DQoNCiAgICAgICAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3F1aXRCdG4nKTsNCiAgICAgICAgICAgICAgYnRuLmlubmVyVGV4dCA9ICJDbG9zaW5nLi4uIjsNCiAgICAgICAgICAgICAgYnRuLmRpc2FibGVkID0gdHJ1ZTsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgLy8gV2Ugc2VuZCBhICJRVUlUX1JFUSIgYmVhY29uIGZpcnN0IGFzIGEgYmFja3VwLCB0aGVuIHRyeSBhIGZ1bGwgd2lwZQ0KICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW51cERhdGEgPSBKU09OLnN0cmluZ2lmeSh7IHVzZXJzOiAiUVVJVF9SRVEiIH0pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjbGVhbnVwRGF0YV0sIHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pOw0KICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLnNlbmRCZWFjb24oYGh0dHBzOi8vYXBpLmpzb25iaW4uaW8vdjMvYi8ke0JJTl9JRH1gLCBibG9iKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gRXhwbGljaXRseSBjbGVhciB0aGUgaWRlbnRpdHkgbG9jYWxseSBzbyB0aGUgc2FmZXR5IHByb21wdCBkb2Vzbid0IHRyaWdnZXINCiAgICAgICAgICAgICAgICAgIGdsb2JhbEFwcFVzZXJJZGVudGl0eSA9ICIiOw0KICAgICAgICAgICAgICAgICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gbnVsbDsNCg0KICAgICAgICAgICAgICAgICAgYWxlcnQoIlNlc3Npb24gRW5kZWQuIEl0IGlzIG5vdyBzYWZlIHRvIGNsb3NlIHRoaXMgdGFiLiIpOw0KICAgICAgICAgICAgICAgICAgd2luZG93LmNsb3NlKCk7DQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFeGl0IGVycm9yLiBZb3UgY2FuIGNsb3NlIHRoZSB0YWIgbWFudWFsbHkuIik7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvLyAtLS0gNC4gU0FGRVRZIFBST01QVCAtLS0NCiAgICAgICAgICB3aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgIGlmIChnbG9iYWxBcHBVc2VySWRlbnRpdHkpIHsNCiAgICAgICAgICAgICAgICAgIHJldHVybiAiUGxlYXNlIHVzZSB0aGUgUkVEIFFVSVQgQlVUVE9OIHRvIGxvZyBvdXQgY29ycmVjdGx5LiI7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9Ow0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcmVmcmVzaEdsb2JhbExpc3QoKSB7DQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICAvLyBSZWFkIHRoZSBzaGFyZWQgTUFTVEVSIGtleQ0KICAgICAgICAgICAgICAgICAgY29uc3QgZ2V0VVJMID0gYGh0dHBzOi8va2V5dmFsdWUuaW1tYW51YWwud29ya2Vycy5kZXYvZ2V0L01BU1RFUl9VU0VSX0xJU1Q/bm9jYWNoZT1gICsgRGF0ZS5ub3coKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZ2V0VVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJhd0RhdGEgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChyYXdEYXRhICYmICFyYXdEYXRhLmluY2x1ZGVzKCJLZXkgbm90IGZvdW5kIikgJiYgcmF3RGF0YS50cmltKCkgIT09ICIiKSB7DQogICAgICAgICAgICAgICAgICAgICAgLy8gQ29udmVydCBzZXJ2ZXIgY29tbWFzIHRvIHlvdXIgcHJlZmVycmVkIHBpcGUgc2VwYXJhdG9yDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5MaXN0ID0gcmF3RGF0YS5zcGxpdCgnLCcpLmpvaW4oJyB8ICcpOw0KICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmVVc2VyTGlzdCcpLmlubmVyVGV4dCA9IGNsZWFuTGlzdDsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlJlYWQgZmFpbGVkIChDT1JTIG9yIE5ldHdvcmspIik7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgaWYgKGdsb2JhbEFwcFVzZXJJZGVudGl0eSkgew0KICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZVNoYXJlZEtleSA9ICJHTE9CQUxfU0hBUkVEX0xJU1RfVjEiOw0KICAgICAgICAgICAgICAgICAgY29uc3QgbG9nb3V0VVJMID0gYGh0dHBzOi8va2V5dmFsdWUuaW1tYW51YWwud29ya2Vycy5kZXYvcmVtb3ZlX2Zyb21fc3RyaW5nLyR7dW5pcXVlU2hhcmVkS2V5fS8ke2VuY29kZVVSSUNvbXBvbmVudChnbG9iYWxBcHBVc2VySWRlbnRpdHkpfWA7DQogICAgICAgICAgICAgICAgICBuYXZpZ2F0b3Iuc2VuZEJlYWNvbihsb2dvdXRVUkwpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfSk7DQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkRldGFpbGVkTWF0Y2hSZXBvcnQoKSB7DQogICAgICAgICAgICAgIC8vIDEuIFRIRSBCUklER0U6IENvbnZlcnQgcmFkaW8gdmFsdWUgKGUuZy4sIDIwMjUpIHRvIHlvdXIgZW5naW5lJ3MgZm9ybWF0IChlLmcuLCAyNS0yNikNCiAgICAgICAgICAgICAgY29uc3QgcmFkaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpOw0KICAgICAgICAgICAgICBpZiAoIXJhZGlvIHx8IHJhZGlvLnZhbHVlID09PSAiYWxsIikgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzZWxlY3QgYSBzcGVjaWZpYyBGaW5hbmNpYWwgWWVhciBmaXJzdC4iKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkVmFsID0gcmFkaW8udmFsdWUudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgY29uc3QgeXIyRGlnaXQgPSBzZWxlY3RlZFZhbC5zbGljZSgtMik7DQogICAgICAgICAgICAgIGNvbnN0IG5leHRZcjJEaWdpdCA9IChwYXJzZUludCh5cjJEaWdpdCkgKyAxKS50b1N0cmluZygpOw0KICAgICAgICAgICAgICBjb25zdCB0YXJnZXRGWSA9IGAke3lyMkRpZ2l0fS0ke25leHRZcjJEaWdpdH1gOw0KICAgICAgICAgICAgICBjb25zdCBmdWxsRllTdHJpbmcgPSBgJHtzZWxlY3RlZFZhbH0tJHtwYXJzZUludChzZWxlY3RlZFZhbCkgKyAxfWA7DQoNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCBbYmFua1JlcywgZGF0YVJlcywgZXhwUmVzLCByZXZSZXMsIGNhc2hSZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoWw0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKEJBTktfTkVXX1VSTCkudGhlbihyZXMgPT4gcmVzLnRleHQoKSksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goREFUQV9VUkwpLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpLA0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKEVYUEVOU0VTX1VSTCkudGhlbihyZXMgPT4gcmVzLmFycmF5QnVmZmVyKCkpLA0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKFJFVkVSU0FMU19VUkwpLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpLA0KICAgICAgICAgICAgICAgICAgICAgIGZldGNoKENBU0hfTElTVF9VUkwpLnRoZW4ocmVzID0+IHJlcy50ZXh0KCkpDQogICAgICAgICAgICAgICAgICBdKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gLS0tIEVWRVJZVEhJTkcgQkVMT1cgSVMgRlJPTSBZT1VSIHYxOS4wIEJBU0UgLS0tDQogICAgICAgICAgICAgICAgICBjb25zdCBiYW5rTGluZXMgPSBiYW5rUmVzLnNwbGl0KCdcbicpLmZpbHRlcihsID0+IGwudHJpbSgpLnNwbGl0KCd8JykubGVuZ3RoID49IDUpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZGIgPSBkYXRhUmVzLnNwbGl0KCdcbicpLm1hcChyID0+IHIuc3BsaXQoJ3wnKSkuZmlsdGVyKGYgPT4gZi5sZW5ndGggPj0gMTUgJiYgZlsxM10/LnRvVXBwZXJDYXNlKCkgIT09ICJZRVMiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmVyc2FscyA9IHJldlJlcy5zcGxpdCgnXG4nKS5tYXAobGluZSA9PiBsaW5lLnNwbGl0KCd8JykpLmZpbHRlcihmID0+IGYubGVuZ3RoID49IDcpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgY2FzaExpbmVzID0gY2FzaFJlcy5zcGxpdCgnXG4nKS5maWx0ZXIobCA9PiBsLmluY2x1ZGVzKCd8JykpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQobmV3IFVpbnQ4QXJyYXkoZXhwUmVzKSwgeyB0eXBlOiAnYXJyYXknIH0pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhwUm93cyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3JrYm9vay5TaGVldHNbd29ya2Jvb2suU2hlZXROYW1lc1swXV0sIHsgaGVhZGVyOiAxIH0pOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBjcmVkaXRFeGVtcHRLZXl3b3JkcyA9IFsiQ1JFRElUIElOVEVSRVNUIiwgIkNMT1NVUkUgT0YgRkQiLCAiUEFSVCBXSVRIRFJBV0wiLCAiRkQgIiwgIkZEOiIsICJCWSBJTlQgVFJBTlNGRVIiLCAiSEFORExJTkdSRVYiLCAiVVBJTUkgQ1IgQURKIiwgIkxPQU4iLCAiUkVUVVJOIiwgIlJFVkVSU0FMIl07DQoNCiAgICAgICAgICAgICAgICAgIGxldCByZXBvcnQgPSBgTU1QVCBUUkFOU0FDVElPTkFMIE1BVENIIFJFUE9SVCAke2Z1bGxGWVN0cmluZ31cbmA7DQogICAgICAgICAgICAgICAgICByZXBvcnQgKz0gIj0iLnJlcGVhdCgyMTUpICsgIlxuIjsNCiAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHsiREFURSIucGFkRW5kKDEyKX0gfCAkeyJSRUNFSVBUIi5wYWRFbmQoMTIpfSB8ICR7IkFNT1VOVCIucGFkU3RhcnQoMTQpfSB8ICR7IlRZUEUiLnBhZEVuZCgxMil9IHwgJHsiREVUQUlMUyIucGFkRW5kKDgwKX0gfCBCQU5LIFJFRkVSRU5DRVxuYDsNCiAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSAiLSIucmVwZWF0KDIxNSkgKyAiXG4iOw0KDQogICAgICAgICAgICAgICAgICBiYW5rTGluZXMuZm9yRWFjaChsaW5lID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiID0gbGluZS5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJEYXRlUmF3ID0gYlswXS50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYlJlZlJhdyA9IChiWzFdIHx8ICIiKS50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYkFtdCA9IHBhcnNlRmxvYXQoYls0XSB8fCBiWzNdIHx8IDApOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ3JlZGl0ID0gYls0XSAhPT0gIiIgJiYgYls0XSAhPT0gIjAiOw0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEZZKGJEYXRlUmF3KSAhPT0gdGFyZ2V0RlkpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJEYXRlU3RkID0gYkRhdGVSYXcucmVwbGFjZSgvW1wvXC5dL2csICctJyk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IHByb2Nlc3NlZCA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ3JlZGl0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0tLSBVTlRPVUNIRUQgdjE5LjAgQ1JFRElUIExPR0lDIC0tLQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXZNYXRjaCA9IHJldmVyc2Fscy5maW5kKHIgPT4gclswXS50cmltKCkucmVwbGFjZSgvW1wvXC5dL2csICctJykgPT09IGJEYXRlU3RkICYmIHJbMV0udHJpbSgpLnRvVXBwZXJDYXNlKCkgPT09IGJSZWZSYXcudG9VcHBlckNhc2UoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRXhlbXB0ID0gY3JlZGl0RXhlbXB0S2V5d29yZHMuc29tZShrID0+IGJSZWZSYXcudG9VcHBlckNhc2UoKS5pbmNsdWRlcyhrKSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJldk1hdGNoIHx8IGlzRXhlbXB0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkdGwgPSByZXZNYXRjaCA/IGBSRVZFUlNBTDogJHtyZXZNYXRjaFs2XX1gIDogYEJBTksgRVhFTVBUOiAke2JSZWZSYXd9YDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHtiRGF0ZVJhdy5wYWRFbmQoMTIpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAke2JBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSkucGFkU3RhcnQoMTQpfSB8ICR7IkMgRXhlbXB0Ii5wYWRFbmQoMTIpfSB8ICR7ZHRsLnBhZEVuZCg4MCl9IHwgJHtiUmVmUmF3fVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVkRG9ub3JzID0gZGIuZmlsdGVyKGQgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkUmVmID0gKGRbMTBdIHx8ICIiKS50cmltKCkudG9VcHBlckNhc2UoKS5zcGxpdCgnKCcpWzBdLnNwbGl0KCdbJylbMF0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkWzFdLnRyaW0oKS5yZXBsYWNlKC9bXC9cLl0vZywgJy0nKSA9PT0gYkRhdGVTdGQgJiYgZFJlZiAhPT0gIiIgJiYgYlJlZlJhdy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKGRSZWYpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkRG9ub3JzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVkRG9ub3JzLmZvckVhY2goKG0pID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZVN0ciA9IG1hdGNoZWREb25vcnMubGVuZ3RoID4gMSA/ICJNIERvbm9ycyIgOiAiRG9ub3IiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByY3B0Tm8gPSBtWzBdLnRyaW0oKS5zdWJzdHJpbmcoMCwgMTIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtRGV0YWlscyA9IGAke21bMl19LCAke21bMTldfSwgJHttWzE1XX0sICR7bVsxMl19LCAke21bMTFdfWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1BbXQgPSBwYXJzZUZsb2F0KG1bOV0pLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicsIHsgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAyIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWZUb1Nob3cgPSBtYXRjaGVkRG9ub3JzLmxlbmd0aCA9PT0gMSA/IGJSZWZSYXcgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVwb3J0ICs9IGAke2JEYXRlUmF3LnBhZEVuZCgxMil9IHwgJHtyY3B0Tm8ucGFkRW5kKDEyKX0gfCAke21BbXQucGFkU3RhcnQoMTQpfSB8ICR7dHlwZVN0ci5wYWRFbmQoMTIpfSB8ICR7bURldGFpbHMuc3Vic3RyaW5nKDAsIDc5KS5wYWRFbmQoODApfSB8ICR7cmVmVG9TaG93fVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2hlZERvbm9ycy5sZW5ndGggPiAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHsiIi5wYWRFbmQoMTIpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAkeyItLS0tLS0tLS0tLS0iLnBhZFN0YXJ0KDE0KX0gfCAkeyIiLnBhZEVuZCgxMil9IHwgJHsoIihCYW5rIFRvdGFsIE1hdGNoOiDigrkiICsgYkFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKSArICIpIikucGFkRW5kKDgwKX0gfCAke2JSZWZSYXd9XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwcm9jZXNzZWQgJiYgYlJlZlJhdy50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDQVNIIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXNoTWF0Y2ggPSBjYXNoTGluZXMuZmluZChjbCA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWQgPSBjbC5zcGxpdCgnfCcpWzBdLnRyaW0oKS5zcGxpdCgvXHMrLyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBoZWFkWzBdID09PSBiRGF0ZVJhdyAmJiBNYXRoLmFicyhwYXJzZUZsb2F0KGhlYWRbaGVhZC5sZW5ndGggLSAxXSkgLSBiQW10KSA8IDE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhc2hNYXRjaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gY2FzaE1hdGNoLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZWZpeCA9IHBbMV0udHJpbSgpID09PSAnTScgPyAiTVBTIiA6ICJDRyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJJZHMgPSBwWzJdLnNwbGl0KCcsJykubWFwKGlkID0+IHByZWZpeCArIGlkLnRyaW0oKS5wYWRTdGFydChwWzFdLnRyaW0oKSA9PT0gJ00nID8gNyA6IDYsICcwJykpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBySWRzLmZvckVhY2goaWQgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IGRiLmZpbmQoZCA9PiBkWzBdLnRyaW0oKSA9PT0gaWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnQgKz0gYCR7YkRhdGVSYXcucGFkRW5kKDEyKX0gfCAke2lkLnN1YnN0cmluZygwLCAxMikucGFkRW5kKDEyKX0gfCAke3BhcnNlRmxvYXQobVs5XSkudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSkucGFkU3RhcnQoMTQpfSB8ICR7Ik0gRG9ub3IiLnBhZEVuZCgxMil9IHwgJHsoYCR7bVsyXX0sICR7bVsxOV19YCkuc3Vic3RyaW5nKDAsIDc5KS5wYWRFbmQoODApfSB8IFxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHsiIi5wYWRFbmQoMTIpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAkeyItLS0tLS0tLS0tLS0iLnBhZFN0YXJ0KDE0KX0gfCAkeyIiLnBhZEVuZCgxMil9IHwgJHsoIihDYXNoIERlcG9zaXQgVG90YWw6IOKCuSIgKyBiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpICsgIikiKS5wYWRFbmQoODApfSB8ICR7YlJlZlJhd31cbmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gLS0tIERFQklUIExPR0lDIC0tLQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleHBNYXRjaCA9IGV4cFJvd3MuZmluZCgociwgaSkgPT4gaSA+IDAgJiYgclszXSAmJiBNYXRoLmFicyhwYXJzZUZsb2F0KHJbM10pIC0gYkFtdCkgPCAwLjAxKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cE1hdGNoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBleGNlbERldGFpbCA9IChleHBNYXRjaFs0XSB8fCAiIikudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBRERFRCBMT0dJQzogQ2hlY2sgZm9yIGJvdGggIkVYRU1QVCIgKG9yaWdpbmFsKSBhbmQgIkZSRVNIIERFUE9TSVQiIChuZXcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdHlwZSA9ICJFeHBlbnNlIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleGNlbERldGFpbC5pbmNsdWRlcygiRVhFTVBUIikgfHwgZXhjZWxEZXRhaWwuaW5jbHVkZXMoIkZSRVNIIERFUE9TSVQiKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSAiRCBFeGVtcHQiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnQgKz0gYCR7YkRhdGVSYXcucGFkRW5kKDEyKX0gfCAkeyIiLnBhZEVuZCgxMil9IHwgJHtiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicsIHsgbWluaW11bUZyYWN0aW9uRGlnaXRzOiAyIH0pLnBhZFN0YXJ0KDE0KX0gfCAke3R5cGUucGFkRW5kKDEyKX0gfCAkeyhleHBNYXRjaFs0XSB8fCBiUmVmUmF3KS50b1N0cmluZygpLnN1YnN0cmluZygwLCA3OSkucGFkRW5kKDgwKX0gfCAke2JSZWZSYXd9XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc2VkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgIGlmICghcHJvY2Vzc2VkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydCArPSBgJHtiRGF0ZVJhdy5wYWRFbmQoMTIpfSB8ICR7IiIucGFkRW5kKDEyKX0gfCAke2JBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJywgeyBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDIgfSkucGFkU3RhcnQoMTQpfSB8ICR7IlBlbmRpbmciLnBhZEVuZCgxMil9IHwgJHsiIi5wYWRFbmQoODApfSB8ICR7YlJlZlJhd31cbmA7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbcmVwb3J0XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOw0KICAgICAgICAgICAgICAgICAgbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsNCiAgICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSBgTU1QVCBUUkFOU0FDVElPTkFMIE1BVENIIFJFUE9SVCAke2Z1bGxGWVN0cmluZ30udHh0YDsNCiAgICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCg0KDQogICAgICAgICAgLy8gRW5zdXJlIHRoZXNlIGFyZSBhdCB0aGUgdG9wIG9mIHlvdXIgc2NyaXB0IHdpdGggb3RoZXIgVVJMcw0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVNYXRjaFJlcG9ydEZyb21NZW51KCkgew0KICAgICAgICAgICAgICBjb25zdCB5ZWFyUmFkaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpOw0KICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZEZZID0geWVhclJhZGlvID8geWVhclJhZGlvLnZhbHVlIDogImFsbCI7DQoNCiAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkRlkgPT09ICJhbGwiKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIHNwZWNpZmljIEZpbmFuY2lhbCBZZWFyIChlLmcuLCAyMy0yNCkgZnJvbSB0aGUgdG9wIGZpbHRlcnMgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAvLyBXcmFwIGluIHlvdXIgcHJvamVjdCdzIHN0YW5kYXJkIGxvYWRpbmcgc3Bpbm5lcg0KICAgICAgICAgICAgICB3cmFwTG9hZGluZyhhc3luYyAoKSA9PiB7DQogICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHJ1bkRldGFpbGVkTWF0Y2hSZXBvcnQoc2VsZWN0ZWRGWSk7DQogICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiUmVwb3J0IEVycm9yOiAiICsgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBkb3dubG9hZERvbmF0aW9uTGlzdERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoIXJhZGlvIHx8IHJhZGlvLnZhbHVlID09PSAiYWxsIikgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2Ugc2VsZWN0IGEgc3BlY2lmaWMgRmluYW5jaWFsIFllYXIgZmlyc3QuIik7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFllYXIgPSByYWRpby52YWx1ZTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEZZID0gYCR7c2VsZWN0ZWRZZWFyLnNsaWNlKC0yKX0tJHsocGFyc2VJbnQoc2VsZWN0ZWRZZWFyLnNsaWNlKC0yKSkgKyAxKX1gOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzLnRleHQoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSB0ZXh0LnNwbGl0KCdcbicpLm1hcChyID0+IHIuc3BsaXQoJ3wnKSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRpdGxlcyA9IFsiUmVjZWlwdCBOby4iLCAiRGF0ZSIsICJOYW1lIiwgIlBob25lIiwgIkFkZHJlc3MiLCAiRW1haWwiLCAiUEFOIiwgIlN0YXIiLCAiR290aHJhbSIsICJBbW91bnQiLCAiUmVmZXJlbmNlIiwgIk1vZGUiLCAiVG93YXJkcyIsICJDYW5jZWwiLCAiQ29tbWVudHMiLCAiUGluIENvZGUiLCAiUmVjZWlwdCBQcmludGVkIiwgIlByYXNhZGFtIFNlbnQiLCAiQ29ycHVzIFNpZ25lZCIsICJDb3VudHJ5Il07DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGV4Y2VsRGF0YSA9IFt0aXRsZXNdOw0KDQogICAgICAgICAgICAgICAgICByb3dzLmZvckVhY2goZiA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKGYubGVuZ3RoIDwgMTUpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdICYmIGZbMTNdLnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDYW5jZWxsZWQpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJEYXRlID0gZlsxXT8udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRGWShyRGF0ZSkgPT09IHRhcmdldEZZKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5wdXNoKGYuc2xpY2UoMCwgMjApKTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGV4Y2VsRGF0YS5sZW5ndGggPD0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJObyBhY3RpdmUgcmVjb3JkcyBmb3VuZC4iKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd3MgPSBYTFNYLnV0aWxzLmFvYV90b19zaGVldChleGNlbERhdGEpOw0KDQogICAgICAgICAgICAgICAgICAvLyAtLS0gTkVXIEFVVE8tV0lEVEggTE9HSUMgU1RBUlQgLS0tDQogICAgICAgICAgICAgICAgICBjb25zdCBjb2xXaWR0aHMgPSB0aXRsZXMubWFwKCh0aXRsZSwgaW5kZXgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBsb25nZXN0IHN0cmluZyBpbiB0aGlzIHNwZWNpZmljIGNvbHVtbg0KICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXhMZW5ndGggPSB0aXRsZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgZXhjZWxEYXRhLmZvckVhY2gocm93ID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbFZhbHVlID0gcm93W2luZGV4XSA/IHJvd1tpbmRleF0udG9TdHJpbmcoKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2VsbFZhbHVlLmxlbmd0aCA+IG1heExlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4TGVuZ3RoID0gY2VsbFZhbHVlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIC8vIFJldHVybiB3aWR0aCBvYmplY3QgKHBhZGRpbmcgd2l0aCArMiBmb3IgY29tZm9ydCkNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB3Y2g6IG1heExlbmd0aCArIDIgfTsNCiAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgd3NbJyFjb2xzJ10gPSBjb2xXaWR0aHM7DQogICAgICAgICAgICAgICAgICAvLyAtLS0gTkVXIEFVVE8tV0lEVEggTE9HSUMgRU5EIC0tLQ0KDQogICAgICAgICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgIkRvbmF0aW9ucyIpOw0KICAgICAgICAgICAgICAgICAgWExTWC53cml0ZUZpbGUod2IsIGBNTVBUX0RvbmF0aW9uX0xpc3RfRllfJHt0YXJnZXRGWX0ueGxzeGApOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCiAgICAgICAgICBhc3luYyBmdW5jdGlvbiBkb3dubG9hZEFub255bW91c0xpc3REaXJlY3QoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpOw0KICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY29uc3QgcmFkaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFyYWRpbyB8fCByYWRpby52YWx1ZSA9PT0gImFsbCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIHNwZWNpZmljIEZpbmFuY2lhbCBZZWFyIGZpcnN0LiIpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRZZWFyID0gcmFkaW8udmFsdWU7DQogICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRGWSA9IGAke3NlbGVjdGVkWWVhci5zbGljZSgtMil9LSR7KHBhcnNlSW50KHNlbGVjdGVkWWVhci5zbGljZSgtMikpICsgMSl9YDsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gdGV4dC5zcGxpdCgnXG4nKS5tYXAociA9PiByLnNwbGl0KCd8JykpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCB0aXRsZXMgPSBbIlJlY2VpcHQgTm8uIiwgIkRhdGUiLCAiTmFtZSIsICJQaG9uZSIsICJBZGRyZXNzIiwgIkVtYWlsIiwgIlBBTiIsICJTdGFyIiwgIkdvdGhyYW0iLCAiQW1vdW50IiwgIlJlZmVyZW5jZSIsICJNb2RlIiwgIlRvd2FyZHMiLCAiQ2FuY2VsIiwgIkNvbW1lbnRzIiwgIlBpbiBDb2RlIiwgIlJlY2VpcHQgUHJpbnRlZCIsICJQcmFzYWRhbSBTZW50IiwgIkNvcnB1cyBTaWduZWQiLCAiQ291bnRyeSJdOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRhID0gW3RpdGxlc107DQoNCiAgICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaChmID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxNSkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgckRhdGUgPSBmWzFdPy50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBmWzEzXSAmJiBmWzEzXS50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9iZWQgTG9naWMgZnJvbSB2MTkuMToNCiAgICAgICAgICAgICAgICAgICAgICAvLyBBbm9ueW1pdHkgaXMgZGVmaW5lZCBhczogTmFtZSBpcyBtaXNzaW5nL2VtcHR5IE9SIG5hbWUgY29udGFpbnMgJ2Fub255bW91cycNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkb25vck5hbWUgPSAoZlsyXSB8fCAiIikudHJpbSgpLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBbm9ueW1vdXMgPSAoZG9ub3JOYW1lID09PSAiIiB8fCBkb25vck5hbWUuaW5jbHVkZXMoImFub255bW91cyIpKTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRGWShyRGF0ZSkgPT09IHRhcmdldEZZICYmICFpc0NhbmNlbGxlZCAmJiBpc0Fub255bW91cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlbERhdGEucHVzaChmLnNsaWNlKDAsIDIwKSk7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChleGNlbERhdGEubGVuZ3RoIDw9IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydChgTm8gcmVjb3JkcyBtYXRjaGluZyBBbm9ueW1vdXMgY3JpdGVyaWEgZm91bmQgZm9yIEZZICR7dGFyZ2V0Rll9LmApOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy8gRXhwb3J0IHdpdGggQXV0by1XaWR0aA0KICAgICAgICAgICAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KGV4Y2VsRGF0YSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBjb2xXaWR0aHMgPSB0aXRsZXMubWFwKCh0aXRsZSwgaW5kZXgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgbWF4TGVuZ3RoID0gdGl0bGUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5mb3JFYWNoKHJvdyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxWYWx1ZSA9IHJvd1tpbmRleF0gPyByb3dbaW5kZXhdLnRvU3RyaW5nKCkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNlbGxWYWx1ZS5sZW5ndGggPiBtYXhMZW5ndGgpIG1heExlbmd0aCA9IGNlbGxWYWx1ZS5sZW5ndGg7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgd2NoOiBtYXhMZW5ndGggKyAyIH07DQogICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgIHdzWychY29scyddID0gY29sV2lkdGhzOw0KDQogICAgICAgICAgICAgICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgIkFub255bW91cyBMaXN0Iik7DQogICAgICAgICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgYE1NUFRfQW5vbnltb3VzX0xpc3RfRllfJHt0YXJnZXRGWX0ueGxzeGApOw0KDQogICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIGRvd25sb2FkUGVuZGluZ0NvbnNlbnREaXJlY3QoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpOw0KICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY29uc3QgcmFkaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpOw0KICAgICAgICAgICAgICAgICAgaWYgKCFyYWRpbyB8fCByYWRpby52YWx1ZSA9PT0gImFsbCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiUGxlYXNlIHNlbGVjdCBhIHNwZWNpZmljIEZpbmFuY2lhbCBZZWFyIGZpcnN0LiIpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRZZWFyID0gcmFkaW8udmFsdWU7DQogICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRGWSA9IGAke3NlbGVjdGVkWWVhci5zbGljZSgtMil9LSR7KHBhcnNlSW50KHNlbGVjdGVkWWVhci5zbGljZSgtMikpICsgMSl9YDsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gdGV4dC5zcGxpdCgnXG4nKS5tYXAociA9PiByLnNwbGl0KCd8JykpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCB0aXRsZXMgPSBbIlJlY2VpcHQgTm8uIiwgIkRhdGUiLCAiTmFtZSIsICJQaG9uZSIsICJBZGRyZXNzIiwgIkVtYWlsIiwgIlBBTiIsICJTdGFyIiwgIkdvdGhyYW0iLCAiQW1vdW50IiwgIlJlZmVyZW5jZSIsICJNb2RlIiwgIlRvd2FyZHMiLCAiQ2FuY2VsIiwgIkNvbW1lbnRzIiwgIlBpbiBDb2RlIiwgIlJlY2VpcHQgUHJpbnRlZCIsICJQcmFzYWRhbSBTZW50IiwgIkNvcnB1cyBTaWduZWQiLCAiQ291bnRyeSJdOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRhID0gW3RpdGxlc107DQoNCiAgICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaChmID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxOSkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgckRhdGUgPSBmWzFdPy50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBmWzEzXSAmJiBmWzEzXS50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBMb2dpYzogVG93YXJkcyBtdXN0IGJlIENPUlBVUyAoSW5kZXggMTIpDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgdG93YXJkcyA9IChmWzEyXSB8fCAiIikudHJpbSgpLnRvVXBwZXJDYXNlKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBMb2dpYzogQ29ycHVzIFNpZ25lZCBtdXN0IGJlIE5PIG9yIEVtcHR5IChJbmRleCAxOCkNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb3JwdXNTaWduZWQgPSAoZlsxOF0gfHwgIiIpLnRyaW0oKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzUGVuZGluZyA9IChjb3JwdXNTaWduZWQgPT09ICJOTyIgfHwgY29ycHVzU2lnbmVkID09PSAiIik7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0RlkockRhdGUpID09PSB0YXJnZXRGWSAmJiAhaXNDYW5jZWxsZWQgJiYgdG93YXJkcyA9PT0gIkNPUlBVUyIgJiYgaXNQZW5kaW5nKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5wdXNoKGYuc2xpY2UoMCwgMjApKTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGV4Y2VsRGF0YS5sZW5ndGggPD0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGBObyBQZW5kaW5nIENvbnNlbnQgcmVjb3JkcyAoVG93YXJkczogQ09SUFVTLCBTaWduZWQ6IE5PKSBmb3VuZCBmb3IgRlkgJHt0YXJnZXRGWX0uYCk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoZXhjZWxEYXRhKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gQXV0by13aWR0aCBsb2dpYw0KICAgICAgICAgICAgICAgICAgY29uc3QgY29sV2lkdGhzID0gdGl0bGVzLm1hcCgodGl0bGUsIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IG1heExlbmd0aCA9IHRpdGxlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICBleGNlbERhdGEuZm9yRWFjaChyb3cgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsVmFsdWUgPSByb3dbaW5kZXhdID8gcm93W2luZGV4XS50b1N0cmluZygpIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZWxsVmFsdWUubGVuZ3RoID4gbWF4TGVuZ3RoKSBtYXhMZW5ndGggPSBjZWxsVmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHdjaDogbWF4TGVuZ3RoICsgMiB9Ow0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB3c1snIWNvbHMnXSA9IGNvbFdpZHRoczsNCg0KICAgICAgICAgICAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MsICJQZW5kaW5nIENvbnNlbnRzIik7DQogICAgICAgICAgICAgICAgICBYTFNYLndyaXRlRmlsZSh3YiwgYE1NUFRfUGVuZGluZ19Db25zZW50X0ZZXyR7dGFyZ2V0Rll9Lnhsc3hgKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZG93bmxvYWRVbmlxdWVEb25vckxpc3REaXJlY3QoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpOw0KICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgY29uc3QgcmFkaW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgaXNBbGxZZWFycyA9ICghcmFkaW8gfHwgcmFkaW8udmFsdWUgPT09ICJhbGwiKTsNCg0KICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldEZZID0gIkFsbF9ZZWFycyI7DQogICAgICAgICAgICAgICAgICBpZiAoIWlzQWxsWWVhcnMpIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFllYXIgPSByYWRpby52YWx1ZTsNCiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRGWSA9IGAke3NlbGVjdGVkWWVhci5zbGljZSgtMil9LSR7KHBhcnNlSW50KHNlbGVjdGVkWWVhci5zbGljZSgtMikpICsgMSl9YDsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gdGV4dC5zcGxpdCgnXG4nKS5tYXAociA9PiByLnNwbGl0KCd8JykpOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBkb25vck1hcCA9IG5ldyBNYXAoKTsNCg0KICAgICAgICAgICAgICAgICAgcm93cy5mb3JFYWNoKGYgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGlmIChmLmxlbmd0aCA8IDE1KSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZSA9IGZbMV0/LnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdICYmIGZbMTNdLnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSAiWUVTIjsNCg0KICAgICAgICAgICAgICAgICAgICAgIC8vIFNLSVAgY2FuY2VsbGVkIGFsd2F5cw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxlZCkgcmV0dXJuOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gWUVBUiBGSUxURVI6IE9ubHkgYXBwbHkgaWYgYSBzcGVjaWZpYyB5ZWFyIGlzIGNob3Nlbg0KICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNBbGxZZWFycyAmJiBnZXRGWShyRGF0ZSkgIT09IHRhcmdldEZZKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgcGhvbmUgPSAoZlszXSB8fCAiTi9BIikudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gKGZbMl0gfHwgIkFub255bW91cyIpLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhbXQgPSBwYXJzZUZsb2F0KGZbOV0pIHx8IDA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBBbm9ueW1vdXMgbG9naWMgKDk5OTk5IC8gODg4ODgpDQogICAgICAgICAgICAgICAgICAgICAgaWYgKHBob25lLnN0YXJ0c1dpdGgoIjk5OTk5IikgfHwgcGhvbmUuc3RhcnRzV2l0aCgiODg4ODgiKSB8fCBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoImFub255bW91cyIpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lID0gIkFOT05ZTU9VU19HUk9VUCI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAiQW5vbnltb3VzIC8gR2VuZXJhbCBEb25vciI7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFkb25vck1hcC5oYXMocGhvbmUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGRvbm9yTWFwLnNldChwaG9uZSwgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lOiAocGhvbmUgPT09ICJBTk9OWU1PVVNfR1JPVVAiID8gIk11bHRpcGxlIiA6IHBob25lKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3M6IChwaG9uZSA9PT0gIkFOT05ZTU9VU19HUk9VUCIgPyAiTi9BIiA6IChmWzRdIHx8ICIiKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogKHBob25lID09PSAiQU5PTllNT1VTX0dST1VQIiA/ICJOL0EiIDogKGZbNV0gfHwgIiIpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpbmNvZGU6IChwaG9uZSA9PT0gIkFOT05ZTU9VU19HUk9VUCIgPyAiIiA6IChmWzE1XSB8fCAiIikpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeTogKHBob25lID09PSAiQU5PTllNT1VTX0dST1VQIiA/ICIiIDogKGZbMTldIHx8ICIiKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbEFtb3VudDogMCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbmF0aW9uQ291bnQ6IDANCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9ub3IgPSBkb25vck1hcC5nZXQocGhvbmUpOw0KICAgICAgICAgICAgICAgICAgICAgIGRvbm9yLnRvdGFsQW1vdW50ICs9IGFtdDsNCiAgICAgICAgICAgICAgICAgICAgICBkb25vci5kb25hdGlvbkNvdW50ICs9IDE7DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgLy8gU29ydCBieSBUb3RhbCBBbW91bnQgKERlc2NlbmRpbmcpDQogICAgICAgICAgICAgICAgICBjb25zdCBzb3J0ZWREb25vcnMgPSBBcnJheS5mcm9tKGRvbm9yTWFwLnZhbHVlcygpKS5zb3J0KChhLCBiKSA9PiBiLnRvdGFsQW1vdW50IC0gYS50b3RhbEFtb3VudCk7DQoNCiAgICAgICAgICAgICAgICAgIGlmIChzb3J0ZWREb25vcnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIk5vIHJlY29yZHMgZm91bmQuIik7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCB0aXRsZXMgPSBbIlJhbmsiLCAiTmFtZSIsICJQaG9uZSBOdW1iZXIiLCAiVG90YWwgQW1vdW50IERvbmF0ZWQiLCAiTm8uIG9mIERvbmF0aW9ucyIsICJBZGRyZXNzIiwgIlBpbmNvZGUiLCAiRW1haWwiLCAiQ291bnRyeSJdOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRhID0gW3RpdGxlc107DQoNCiAgICAgICAgICAgICAgICAgIHNvcnRlZERvbm9ycy5mb3JFYWNoKChkLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5wdXNoKFtpbmRleCArIDEsIGQubmFtZSwgZC5waG9uZSwgZC50b3RhbEFtb3VudCwgZC5kb25hdGlvbkNvdW50LCBkLmFkZHJlc3MsIGQucGluY29kZSwgZC5lbWFpbCwgZC5jb3VudHJ5XSk7DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3Qgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KGV4Y2VsRGF0YSk7DQoNCiAgICAgICAgICAgICAgICAgIC8vIEF1dG8td2lkdGgNCiAgICAgICAgICAgICAgICAgIHdzWychY29scyddID0gdGl0bGVzLm1hcCgodGl0bGUsIGluZGV4KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IG1heExlbmd0aCA9IHRpdGxlLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgICBleGNlbERhdGEuZm9yRWFjaChyb3cgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjZWxsVmFsdWUgPSByb3dbaW5kZXhdID8gcm93W2luZGV4XS50b1N0cmluZygpIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjZWxsVmFsdWUubGVuZ3RoID4gbWF4TGVuZ3RoKSBtYXhMZW5ndGggPSBjZWxsVmFsdWUubGVuZ3RoOw0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHdjaDogbWF4TGVuZ3RoICsgMiB9Ow0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAiVW5pcXVlIERvbm9ycyIpOw0KICAgICAgICAgICAgICAgICAgWExTWC53cml0ZUZpbGUod2IsIGBNTVBUX1VuaXF1ZV9Eb25vcl9MaXN0XyR7dGFyZ2V0Rll9Lnhsc3hgKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gZG93bmxvYWRQZW5kaW5nQ2FzaERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHdpbmRvdy5nbG9iYWxQZW5kaW5nQ2FwdHVyZTsNCg0KICAgICAgICAgICAgICBpZiAoIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJObyBkYXRhIGNhcHR1cmVkLiBQbGVhc2UgbG9hZCB0aGUgUGVuZGluZyBDYXNoIGRhc2hib2FyZCBmaXJzdC4iKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCBwZW5kaW5nUmNwdE5vcyA9IG5ldyBTZXQoZGF0YS5tYXAoaXRlbSA9PiBpdGVtLnJjcHQudHJpbSgpLnRvVXBwZXJDYXNlKCkpKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChEQVRBX1VSTCk7DQogICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZGJSb3dzID0gdGV4dC5zcGxpdCgnXG4nKS5tYXAociA9PiByLnNwbGl0KCd8JykpLmZpbHRlcihmID0+IGYubGVuZ3RoID49IDE1KTsNCg0KICAgICAgICAgICAgICAgICAgLy8gWW91ciAyMCBEQiBIZWFkZXJzDQogICAgICAgICAgICAgICAgICBjb25zdCBmdWxsSGVhZGVycyA9IFsNCiAgICAgICAgICAgICAgICAgICAgICAiUmVjZWlwdCBOby4iLCAiRGF0ZSIsICJOYW1lIiwgIkFkZHJlc3MiLCAiUGhvbmUiLA0KICAgICAgICAgICAgICAgICAgICAgICJFbWFpbCIsICJQQU4vSUQiLCAiT2NjYXNpb24iLCAiQW1vdW50IFdvcmRzIiwgIkFtb3VudCIsDQogICAgICAgICAgICAgICAgICAgICAgIlJlZmVyZW5jZSIsICJNb2RlIiwgIlRvd2FyZHMiLCAiQ2FuY2VsbGVkIiwgIlVzZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICJUaW1lIiwgIkYxNyIsICJGMTgiLCAiRjE5IiwgIkYyMCINCiAgICAgICAgICAgICAgICAgIF07DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGV4Y2VsUm93cyA9IFtmdWxsSGVhZGVyc107DQoNCiAgICAgICAgICAgICAgICAgIGRiUm93cy5mb3JFYWNoKGYgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRSY3B0ID0gZlswXS50cmltKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1JjcHROb3MuaGFzKGN1cnJlbnRSY3B0KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlbFJvd3MucHVzaChmKTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIFdvcmtib29rIGFuZCBXb3Jrc2hlZXQNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdiID0gWExTWC51dGlscy5ib29rX25ldygpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd3MgPSBYTFNYLnV0aWxzLmFvYV90b19zaGVldChleGNlbFJvd3MpOw0KDQogICAgICAgICAgICAgICAgICAvLyAtLS0gQVVUTyBDT0xVTU4gV0lEVEggTE9HSUMgLS0tDQogICAgICAgICAgICAgICAgICBjb25zdCBjb2xXaWR0aHMgPSBmdWxsSGVhZGVycy5tYXAoKGhlYWRlciwgaW5kZXgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBsb25nZXN0IHN0cmluZyBpbiB0aGlzIHNwZWNpZmljIGNvbHVtbg0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1heENvbHVtbkxlbmd0aCA9IGV4Y2VsUm93cy5yZWR1Y2UoKG1heCwgcm93KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNlbGxWYWx1ZSA9IHJvd1tpbmRleF0gPyByb3dbaW5kZXhdLnRvU3RyaW5nKCkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgY2VsbFZhbHVlLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgfSwgaGVhZGVyLmxlbmd0aCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gd2lkdGggd2l0aCBhIGxpdHRsZSBleHRyYSBwYWRkaW5nDQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgd2NoOiBtYXhDb2x1bW5MZW5ndGggKyAyIH07DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgd3NbJyFjb2xzJ10gPSBjb2xXaWR0aHM7DQogICAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiAgICAgICAgICAgICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQod2IsIHdzLCAiUGVuZGluZ19DYXNoX0Z1bGwiKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgeXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpPy52YWx1ZSB8fCAiUmVwb3J0IjsNCiAgICAgICAgICAgICAgICAgIFhMU1gud3JpdGVGaWxlKHdiLCBgTU1QVF9QZW5kaW5nX0Nhc2hfRnVsbF8ke3lyfS54bHN4YCk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkV4cG9ydCBFcnJvcjogIiArIGUubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJ1bkJhbmtTdGF0ZW1lbnREaXJlY3QoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpOw0KICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgLy8gMS4gR2V0IHRoZSB0YXJnZXQgeWVhciBmcm9tIHRoZSByYWRpbyBidXR0b25zDQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoIXJhZGlvKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzZWxlY3QgYSBZZWFyIGZpcnN0LiIpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RlZFllYXIgPSByYWRpby52YWx1ZTsgLy8gZS5nLiwgIjIwMjUiDQogICAgICAgICAgICAgICAgICBjb25zdCBuZXh0WWVhclNob3J0ID0gKHBhcnNlSW50KHNlbGVjdGVkWWVhci5zbGljZSgtMikpICsgMSkudG9TdHJpbmcoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldEZZID0gYCR7c2VsZWN0ZWRZZWFyLnNsaWNlKC0yKX0tJHtuZXh0WWVhclNob3J0fWA7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDIuIEZldGNoIHRoZSBiYW5rIGZpbGUNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goQkFOS19ORVdfVVJMKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkgIT09ICIiKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IFsiRGF0ZSIsICJSZWZlcmVuY2UiLCAiQ2hxIE5vLiIsICJEZWJpdCIsICJDcmVkaXQiLCAiQmFsYW5jZSJdOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZXhjZWxEYXRhID0gW2hlYWRlcnNdOw0KDQogICAgICAgICAgICAgICAgICAvLyAzLiBGaWx0ZXIgYW5kIE1hcA0KICAgICAgICAgICAgICAgICAgbGluZXMuZm9yRWFjaChsaW5lID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xzID0gbGluZS5zcGxpdCgnfCcpLm1hcChjID0+IGMudHJpbSgpKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoY29scy5sZW5ndGggPj0gNikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3dEYXRlID0gY29sc1swXTsgLy8gRm9ybWF0OiBERC1NTS1ZWVlZDQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBpbmNsdWRlIGlmIGRhdGUgYmVsb25ncyB0byBzZWxlY3RlZCBGWQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0Rlkocm93RGF0ZSkgPT09IHRhcmdldEZZKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwIEFtb3VudHM6IElmIGVtcHR5IG9yIDAsIGxlYXZlIGFzIGVtcHR5IHN0cmluZyAiIg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGViaXQgPSAoY29sc1szXSAmJiBwYXJzZUZsb2F0KGNvbHNbM10pICE9PSAwKSA/IHBhcnNlRmxvYXQoY29sc1szXSkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNyZWRpdCA9IChjb2xzWzRdICYmIHBhcnNlRmxvYXQoY29sc1s0XSkgIT09IDApID8gcGFyc2VGbG9hdChjb2xzWzRdKSA6ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmFsYW5jZSA9IChjb2xzWzVdICE9PSAiIikgPyBwYXJzZUZsb2F0KGNvbHNbNV0pIDogIiI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VsRGF0YS5wdXNoKFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dEYXRlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHNbMV0sIC8vIFJlZmVyZW5jZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHNbMl0sIC8vIENocSBOby4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWJpdCwgICAvLyBFbXB0eSBpZiBubyB2YWx1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWRpdCwgIC8vIEVtcHR5IGlmIG5vIHZhbHVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFsYW5jZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGV4Y2VsRGF0YS5sZW5ndGggPT09IDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydChgTm8gYmFuayByZWNvcmRzIGZvdW5kIGZvciBGWSAke3RhcmdldEZZfWApOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy8gNC4gQ3JlYXRlIEV4Y2VsDQogICAgICAgICAgICAgICAgICBjb25zdCB3YiA9IFhMU1gudXRpbHMuYm9va19uZXcoKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHdzID0gWExTWC51dGlscy5hb2FfdG9fc2hlZXQoZXhjZWxEYXRhKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gNS4gQXV0by1GaXQgQ29sdW1uIFdpZHRocw0KICAgICAgICAgICAgICAgICAgd3NbJyFjb2xzJ10gPSBoZWFkZXJzLm1hcCgoaGVhZGVyLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1heExlbiA9IGV4Y2VsRGF0YS5yZWR1Y2UoKG1heCwgcm93KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbCA9IChyb3dbaW5kZXhdICE9PSB1bmRlZmluZWQgJiYgcm93W2luZGV4XSAhPT0gbnVsbCkgPyByb3dbaW5kZXhdLnRvU3RyaW5nKCkgOiAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KG1heCwgdmFsLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgfSwgaGVhZGVyLmxlbmd0aCk7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgd2NoOiBtYXhMZW4gKyAyIH07DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgWExTWC51dGlscy5ib29rX2FwcGVuZF9zaGVldCh3Yiwgd3MsICJCYW5rIFN0YXRlbWVudCIpOw0KICAgICAgICAgICAgICAgICAgWExTWC53cml0ZUZpbGUod2IsIGBNTVBUX0JhbmtfU3RhdGVtZW50XyR7dGFyZ2V0Rll9Lnhsc3hgKTsNCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpOw0KICAgICAgICAgICAgICAgICAgYWxlcnQoIkVycm9yOiAiICsgZS5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuRXhwZW5zZXNFeHBvcnQoKSB7DQogICAgICAgICAgICAgIGNvbnN0IGxvYWRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZ01zZycpOw0KICAgICAgICAgICAgICBpZiAobG9hZGluZykgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgLy8gMS4gRmluYW5jaWFsIFllYXIgRmlsdGVyDQogICAgICAgICAgICAgICAgICBjb25zdCByYWRpbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9InllYXJGaWx0ZXIiXTpjaGVja2VkJyk7DQogICAgICAgICAgICAgICAgICBpZiAoIXJhZGlvKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIlBsZWFzZSBzZWxlY3QgYSBZZWFyIGZpcnN0LiIpOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChsb2FkaW5nKSBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWRZZWFyID0gcmFkaW8udmFsdWU7DQogICAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRGWSA9IGAke3NlbGVjdGVkWWVhci5zbGljZSgtMil9LSR7KHBhcnNlSW50KHNlbGVjdGVkWWVhci5zbGljZSgtMikpICsgMSl9YDsNCg0KICAgICAgICAgICAgICAgICAgLy8gMi4gRmV0Y2ggdGhlIEV4cGVuc2UgRXhjZWwgRmlsZQ0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChFWFBFTlNFU19VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpOw0KDQogICAgICAgICAgICAgICAgICAvLyAzLiBSZWFkIHRoZSBXb3JrYm9vaw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoYXJyYXlCdWZmZXIsIHsgdHlwZTogJ2FycmF5JywgY2VsbERhdGVzOiB0cnVlIH0pOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZmlyc3RTaGVldCA9IHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzBdXTsNCg0KICAgICAgICAgICAgICAgICAgLy8gQ29udmVydCB0byBBcnJheSBvZiBBcnJheXMgKGhlYWRlcjogMSBrZWVwcyBpdCBhcyByb3dzKQ0KICAgICAgICAgICAgICAgICAgY29uc3QgYWxsUm93cyA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbihmaXJzdFNoZWV0LCB7IGhlYWRlcjogMSB9KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKGFsbFJvd3MubGVuZ3RoIDwgMSkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJFeHBlbnNlIGZpbGUgaXMgZW1wdHkuIik7DQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gYWxsUm93c1swXTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cG9ydERhdGEgPSBbaGVhZGVyc107DQoNCiAgICAgICAgICAgICAgICAgIC8vIDQuIEZpbHRlcmluZyBMb29wDQogICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IGFsbFJvd3MubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByb3cgPSBhbGxSb3dzW2ldOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRlVmFsID0gcm93WzBdOyAvLyBBc3N1bWluZyBEYXRlIGlzIGNvbHVtbiAxDQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZVZhbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2hlY2tEYXRlID0gIiI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSGFuZGxlIGlmIEV4Y2VsIGdpdmVzIGEgRGF0ZSBPYmplY3Qgb3IgYSBTdHJpbmcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGVWYWwgaW5zdGFuY2VvZiBEYXRlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZCA9IFN0cmluZyhkYXRlVmFsLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1tID0gU3RyaW5nKGRhdGVWYWwuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB5eXl5ID0gZGF0ZVZhbC5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tEYXRlID0gYCR7ZGR9LSR7bW19LSR7eXl5eX1gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tEYXRlID0gZGF0ZVZhbC50b1N0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWF0Y2ggYWdhaW5zdCB5b3VyIFllYXIgRmlsdGVyDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRGWShjaGVja0RhdGUpID09PSB0YXJnZXRGWSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0RGF0YS5wdXNoKHJvdyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIGlmIChleHBvcnREYXRhLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KGBObyBleHBlbnNlcyBmb3VuZCBmb3IgRlkgJHt0YXJnZXRGWX1gKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIC8vIDUuIENyZWF0ZSBPdXRwdXQgRmlsZQ0KICAgICAgICAgICAgICAgICAgY29uc3QgbmV3V2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBuZXdXcyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KGV4cG9ydERhdGEpOw0KDQogICAgICAgICAgICAgICAgICAvLyAtLS0gQVVUTyBDT0xVTU4gV0lEVEggLS0tDQogICAgICAgICAgICAgICAgICBuZXdXc1snIWNvbHMnXSA9IGhlYWRlcnMubWFwKChoLCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1heExlbiA9IGV4cG9ydERhdGEucmVkdWNlKChtYXgsIHJvdykgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSByb3dbaW5kZXhdID8gcm93W2luZGV4XS50b1N0cmluZygpIDogIiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLm1heChtYXgsIHZhbC5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICAgIH0sIGggPyBoLnRvU3RyaW5nKCkubGVuZ3RoIDogMTApOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHdjaDogbWF4TGVuICsgMiB9Ow0KICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgIFhMU1gudXRpbHMuYm9va19hcHBlbmRfc2hlZXQobmV3V2IsIG5ld1dzLCAiRXhwZW5zZXMiKTsNCiAgICAgICAgICAgICAgICAgIFhMU1gud3JpdGVGaWxlKG5ld1diLCBgTU1QVF9FeHBlbnNlc18ke3RhcmdldEZZfS54bHN4YCk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiRXhwZW5zZSBFcnJvcjoiLCBlKTsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJDb3VsZCBub3QgcHJvY2VzcyBFeHBlbnNlIGZpbGU6ICIgKyBlLm1lc3NhZ2UpOw0KICAgICAgICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgICAgICAgICAgaWYgKGxvYWRpbmcpIGxvYWRpbmcuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuQW5vbnlNYXRjaERpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGlmIChsb2FkaW5nRGl2KSB7DQogICAgICAgICAgICAgICAgICBsb2FkaW5nRGl2LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KICAgICAgICAgICAgICAgICAgbG9hZGluZ0Rpdi5pbm5lckhUTUwgPSAiSW5pdGlhbGl6aW5nIERlZXAgTWF0Y2ggZm9yIFNlbGVjdGVkIFllYXIuLi4iOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgY29uc3Qgc1llYXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMTAwKSk7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBVSSBDTEVBUklORyBDT01NRU5URUQgT1VUIC0tLQ0KICAgICAgICAgICAgICAgICAgLy8gY2xlYXJXb3Jrc3BhY2UoKTsNCg0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlcy50ZXh0KCk7DQogICAgICAgICAgICAgICAgICBjb25zdCBhbGxSZWNvcmRzID0gdGV4dC5zcGxpdCgnXG4nKS5maWx0ZXIociA9PiByLmxlbmd0aCA+IDIwKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gMS4gRVhBQ1QgWWVhciBMb2dpYyBmcm9tIHlvdXIgb3JpZ2luYWwNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldHMgPSBhbGxSZWNvcmRzLmZpbHRlcihyID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgZiA9IHIuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByTm8gPSAoZlswXSB8fCAiIikudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZSA9IHBhcnNlRGF0ZShmWzFdKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdPy50cmltKCkudG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBbm9uID0gKCFmWzJdIHx8IGZbMl0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzR1cgPSByTm8uc3RhcnRzV2l0aCgiR1ciKTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGxldCBpblllYXIgPSAoc1llYXIgPT09ICJhbGwiKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoIWluWWVhcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmeVMgPSBwYXJzZUludChzWWVhcik7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSByRGF0ZS5nZXRNb250aCgpICsgMSwgeSA9IHJEYXRlLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGluWWVhciA9ICh5ID09PSBmeVMgJiYgbSA+PSA0KSB8fCAoeSA9PT0gZnlTICsgMSAmJiBtIDw9IDMpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5ZZWFyICYmIGlzQW5vbiAmJiAhaXNDYW5jZWxsZWQgJiYgIWlzR1c7DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldHMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgYWxlcnQoYE5vIGFub255bW91cyByZWNvcmRzIGZvdW5kIGZvciBGWSAke3NZZWFyfS5gKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0RpdikgbG9hZGluZ0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hMZW5ndGggPSAxNTsNCiAgICAgICAgICAgICAgICAgIGxldCByZXBvcnRUZXh0ID0gYE1NUFQgQU5PTllNT1VTIE1BVENISU5HIFJFUE9SVCAtIEZZICR7c1llYXJ9XG5gOw0KICAgICAgICAgICAgICAgICAgcmVwb3J0VGV4dCArPSBgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmA7DQoNCiAgICAgICAgICAgICAgICAgIC8vIDIuIExvb3AgdGhyb3VnaCBZZWFyLVNwZWNpZmljIFRhcmdldHMgKERlZXAgTWF0Y2hpbmcpDQogICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0RpdikgbG9hZGluZ0Rpdi5pbm5lckhUTUwgPSBgU2Nhbm5pbmcgUmVjb3JkICR7aSArIDF9IG9mICR7dGFyZ2V0cy5sZW5ndGh9Li4uYDsNCiAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyID0+IHNldFRpbWVvdXQociwgMSkpOyAvLyBQcmV2ZW50cyBicm93c2VyIGhhbmcNCg0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG0gPSB0YXJnZXRzW2ldLnNwbGl0KCd8Jyk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbVJlZkNsZWFuID0gc2FuaXRpemVSZWYobVsxMF0pOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1JRCA9IG1bMF07DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAobVJlZkNsZWFuLmxlbmd0aCA8IG1hdGNoTGVuZ3RoKSBjb250aW51ZTsNCg0KICAgICAgICAgICAgICAgICAgICAgIGxldCB0YXJnZXRIZWFkZXJBZGRlZCA9IGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gMy4gU2VhcmNoIEdMT0JBTCBkYXRhYmFzZSBmb3IgbWF0Y2hlcw0KICAgICAgICAgICAgICAgICAgICAgIGFsbFJlY29yZHMuZm9yRWFjaChkYlJvdyA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGQgPSBkYlJvdy5zcGxpdCgnfCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkTm8gPSAoZFswXSB8fCAiIikudG9VcHBlckNhc2UoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZFswXSA9PT0gbUlEIHx8IGROby5zdGFydHNXaXRoKCJHVyIpKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5kaWRhdGVBbm9uID0gKCFkWzJdIHx8IGRbMl0udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygiYW5vbnltb3VzIikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDYW5kaWRhdGVBbm9uKSByZXR1cm47DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNDYW5jZWxsZWQgPSBkWzEzXT8udG9VcHBlckNhc2UoKSA9PT0gIllFUyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzQ2FzaCA9IChkWzExXSB8fCAiIikudG9VcHBlckNhc2UoKS5pbmNsdWRlcygiQ0FTSCIpIHx8IChkWzhdIHx8ICIiKS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKCJDQVNIIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NhbmNlbGxlZCB8fCBpc0Nhc2gpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkUmVmQ2xlYW4gPSBzYW5pdGl6ZVJlZihkWzEwXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkUmVmQ2xlYW4ubGVuZ3RoIDwgbWF0Y2hMZW5ndGgpIHJldHVybjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZm91bmRPdmVybGFwID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkUmVmQ2xlYW4uaW5jbHVkZXMobVJlZkNsZWFuKSB8fCBtUmVmQ2xlYW4uaW5jbHVkZXMoZFJlZkNsZWFuKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRPdmVybGFwID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDw9IG1SZWZDbGVhbi5sZW5ndGggLSBtYXRjaExlbmd0aDsgeCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRSZWZDbGVhbi5pbmNsdWRlcyhtUmVmQ2xlYW4uc3Vic3RyaW5nKHgsIHggKyBtYXRjaExlbmd0aCkpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kT3ZlcmxhcCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZE92ZXJsYXApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0SGVhZGVyQWRkZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnRUZXh0ICs9IGBcblRBUkdFVDogJHttWzBdfSB8ICR7bVsxXX0gfCBBbXQ6ICR7bVs5XX0gfCBSZWY6ICR7bVsxMF19XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydFRleHQgKz0gYC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRIZWFkZXJBZGRlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXBvcnRUZXh0ICs9IGAgICA+PiBNQVRDSDogJHtkWzBdfSB8ICR7ZFsyXX0gfCBUZWw6ICR7ZFszXX0gfCBSZWY6ICR7ZFsxMF19XG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIC8vIDQuIFRyaWdnZXIgQXV0by1Eb3dubG9hZCAoUmVwbGFjaW5nIHRoZSBNYW51YWwgRG93bmxvYWQgQnV0dG9uKQ0KICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtyZXBvcnRUZXh0XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOw0KICAgICAgICAgICAgICAgICAgbGluay5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsNCiAgICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSBgQW5vbnltb3VzX01hdGNoX1JlcG9ydF8ke3NZZWFyfS50eHRgOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChsaW5rKTsNCiAgICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTsNCiAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobGluayk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgICAgICAgICAgICAgICBhbGVydCgiTG9naWMgZXJyb3I6ICIgKyBlcnIubWVzc2FnZSk7DQogICAgICAgICAgICAgIH0gZmluYWxseSB7DQogICAgICAgICAgICAgICAgICBpZiAobG9hZGluZ0RpdikgbG9hZGluZ0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgfQ0KDQoNCg0KDQoNCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gcnVuU29mdGNvcGllc0RpcmVjdCgpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgY29uc3QgcE1zZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkaW5nTXNnJyk7DQogICAgICAgICAgICAgIGNvbnN0IHNZZWFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT0ieWVhckZpbHRlciJdOmNoZWNrZWQnKS52YWx1ZTsNCiAgICAgICAgICAgICAgY29uc3QgRllfRElTUExBWSA9IHNZZWFyID09PSAiYWxsIiA/ICJBbGwgWWVhcnMiIDogYCR7c1llYXJ9LSR7cGFyc2VJbnQoc1llYXIpICsgMX1gOw0KDQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgZmV0Y2goREFUQV9VUkwpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHJlc3AudGV4dCgpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgcmVjb3JkcyA9IHRleHQuc3BsaXQoJ1xuJyk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHsganNQREYgfSA9IHdpbmRvdy5qc3BkZjsNCiAgICAgICAgICAgICAgICAgIGxldCB2YWxpZFJlY29yZHMgPSBbXTsNCg0KICAgICAgICAgICAgICAgICAgLy8gMS4gRmlsdGVyIHZhbGlkIHJlY29yZHMgYmFzZWQgb24gRlkgc2VsZWN0aW9uDQogICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlY29yZHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgZiA9IHJlY29yZHNbaV0uc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoZi5sZW5ndGggPCAxMykgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgckRhdGVTdHIgPSBmWzFdLnRyaW0oKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCByRGF0ZU9iaiA9IHBhcnNlRGF0ZShyRGF0ZVN0cik7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IHJEYXRlT2JqLmdldE1vbnRoKCkgKyAxOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSByRGF0ZU9iai5nZXRGdWxsWWVhcigpOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCByZWNvcmRGWSA9IChtIDwgNCkgPyAoeSAtIDEpLnRvU3RyaW5nKCkgOiB5LnRvU3RyaW5nKCk7DQogICAgICAgICAgICAgICAgICAgICAgaWYgKHNZZWFyID09PSAiYWxsIiB8fCBzWWVhciA9PT0gcmVjb3JkRlkpIHZhbGlkUmVjb3Jkcy5wdXNoKGYpOw0KICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICBjb25zdCB0b3RhbFRvUHJvY2VzcyA9IHZhbGlkUmVjb3Jkcy5sZW5ndGg7DQogICAgICAgICAgICAgICAgICBpZiAodG90YWxUb1Byb2Nlc3MgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICBhbGVydCgiTm8gcmVjZWlwdHMgZm91bmQgZm9yIHRoZSBzZWxlY3RlZCBwZXJpb2QuIik7DQogICAgICAgICAgICAgICAgICAgICAgaGlkZUxvYWRpbmcoKTsNCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgIC8vIDIuIENIVU5LIExPR0lDICgxMDAwIFJlY2VpcHRzIHBlciBmaWxlKQ0KICAgICAgICAgICAgICAgICAgY29uc3QgQ0hVTktfU0laRSA9IDEwMDA7DQogICAgICAgICAgICAgICAgICBsZXQgcGFydE51bWJlciA9IDE7DQoNCiAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdG90YWxUb1Byb2Nlc3M7IGkgKz0gQ0hVTktfU0laRSkgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBkZiA9IG5ldyBqc1BERigncCcsICdwdCcsICdhNCcpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRCYXRjaCA9IHZhbGlkUmVjb3Jkcy5zbGljZShpLCBpICsgQ0hVTktfU0laRSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmF0Y2hQYWdlQ291bnQgPSBNYXRoLmNlaWwoY3VycmVudEJhdGNoLmxlbmd0aCAvIDIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBjdXJyZW50QmF0Y2gubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGYgPSBjdXJyZW50QmF0Y2hbal07DQogICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBnbG9iYWxDb3VudCA9IGkgKyBqICsgMTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQcm9ncmVzcyBkaXNwbGF5OiAiUGFydCAxIC0gUHJvY2Vzc2luZyA1MDUgKDUwNS8yNTAwKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgcE1zZy5pbm5lclRleHQgPSBgUGxlYXNlIFdhaXQgOiBQYXJ0ICR7cGFydE51bWJlcn0gLSBQcm9jZXNzaW5nICR7ZlswXX0gKCR7Z2xvYmFsQ291bnR9LyR7dG90YWxUb1Byb2Nlc3N9KWA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1nRGF0YSA9IGF3YWl0IHJlbmRlck9yaWdpbmFsUmVjZWlwdFRvSW1hZ2UoZik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFsZlBhZ2UgPSA0MjE7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlY2VpcHRIZWlnaHQgPSAzMzU7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHlPZmZzZXQgPSAoaGFsZlBhZ2UgLSByZWNlaXB0SGVpZ2h0KSAvIDI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMiByZWNlaXB0cyBwZXIgcGFnZSBsb2dpYw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaiAlIDIgPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqID4gMCkgcGRmLmFkZFBhZ2UoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUERGIEhlYWRlcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRmLnNldEZvbnRTaXplKDEwKTsgcGRmLnNldEZvbnQoImhlbHZldGljYSIsICJib2xkIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYudGV4dChgUmVjZWlwdHMgR2VuZXJhdGVkIGluIHRoZSBGaW5hbmNpYWwgWWVhciA6ICR7RllfRElTUExBWX0gKFBhcnQgJHtwYXJ0TnVtYmVyfSlgLCA0MCwgMzApOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQREYgRm9vdGVyDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYuc2V0Rm9udFNpemUoOSk7IHBkZi5zZXRGb250KCJoZWx2ZXRpY2EiLCAibm9ybWFsIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50UGFnZSA9IE1hdGguY2VpbCgoaiArIDEpIC8gMik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYudGV4dChgUGFnZSAke2N1cnJlbnRQYWdlfSBvZiAke2JhdGNoUGFnZUNvdW50fWAsIDUwMCwgODIwKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWlkLXBhZ2UgY3V0dGluZyBndWlkZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGRmLnNldERyYXdDb2xvcigyMDApOyBwZGYuc2V0TGluZURhc2hQYXR0ZXJuKFs1LCA1XSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYubGluZSgwLCBoYWxmUGFnZSwgNTk1LCBoYWxmUGFnZSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBkZi5hZGRJbWFnZShpbWdEYXRhLCAnSlBFRycsIDUwLCB5T2Zmc2V0ICsgMjAsIDQ5NSwgMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZGYuYWRkSW1hZ2UoaW1nRGF0YSwgJ0pQRUcnLCA1MCwgaGFsZlBhZ2UgKyB5T2Zmc2V0LCA0OTUsIDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSB0aGUgZmlsZSBmb3IgdGhpcyBiYXRjaA0KICAgICAgICAgICAgICAgICAgICAgIHBkZi5zYXZlKGBNTVBUIFJlY2VpcHRzICR7RllfRElTUExBWX0gUGFydCAke3BhcnROdW1iZXJ9LnBkZmApOw0KICAgICAgICAgICAgICAgICAgICAgIHBhcnROdW1iZXIrKzsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsNCiAgICAgICAgICAgICAgICAgIGFsZXJ0KCJDcml0aWNhbCBFcnJvcjogIiArIGVyci5tZXNzYWdlKTsNCiAgICAgICAgICAgICAgfSBmaW5hbGx5IHsNCiAgICAgICAgICAgICAgICAgIGhpZGVMb2FkaW5nKCk7DQogICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICBoaWRlTG9hZGluZygpOyBhbGVydCgiQWxsIHBhcnRzIGRvd25sb2FkZWQgc3VjY2Vzc2Z1bGx5ISIpOw0KDQogICAgICAgICAgfQ0KDQoNCg0KICAgICAgICAgIGFzeW5jIGZ1bmN0aW9uIHJlbmRlck9yaWdpbmFsUmVjZWlwdFRvSW1hZ2UoZikgew0KICAgICAgICAgICAgICBjb25zdCBpc0NhbmNlbGxlZCA9IGZbMTNdPy50b0xvd2VyQ2FzZSgpLnRyaW0oKSA9PT0gJ3llcyc7DQogICAgICAgICAgICAgIGNvbnN0IHRlbXBEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgICAgICAgdGVtcERpdi5zdHlsZSA9ICJ3aWR0aDogNDgwcHQ7IHBhZGRpbmc6IDEwcHggMjBweDsgYmFja2dyb3VuZDogI2ZmZjsgYm9yZGVyOiAycHggc29saWQgIzAwMDsgZm9udC1mYW1pbHk6ICdUaW1lcyBOZXcgUm9tYW4nLCBzZXJpZjsgY29sb3I6ICMwMDA7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgbGVmdDogLTk5OTlweDsiOw0KDQogICAgICAgICAgICAgIC8vIFN0cnVjdHVyZTogQWRkcmVzcyg0KSwgQ291bnRyeSgxOSksIFBpbiBDb2RlKDE1KQ0KICAgICAgICAgICAgICBjb25zdCBhZGRyID0gZls0XSA/IGZbNF0udHJpbSgpIDogIiI7DQogICAgICAgICAgICAgIGNvbnN0IGNvdW50cnkgPSBmWzE5XSA/IGZbMTldLnRyaW0oKSA6ICIiOw0KICAgICAgICAgICAgICBjb25zdCBwaW4gPSBmWzE1XSA/IGZbMTVdLnRyaW0oKSA6ICIiOw0KDQogICAgICAgICAgICAgIGxldCBmdWxsQWRkcmVzcyA9IGFkZHI7DQogICAgICAgICAgICAgIGlmIChjb3VudHJ5KSBmdWxsQWRkcmVzcyArPSAiLCAiICsgY291bnRyeTsNCiAgICAgICAgICAgICAgaWYgKHBpbikgZnVsbEFkZHJlc3MgKz0gIiwgIiArIHBpbjsNCg0KICAgICAgICAgICAgICB0ZW1wRGl2LmlubmVySFRNTCA9IGANCiAgICAgICAgICAgICAgPGRpdiBzdHlsZT0icG9zaXRpb246IHJlbGF0aXZlOyI+DQogICAgICAgICAgICAgICAgICAke2lzQ2FuY2VsbGVkID8gJzxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlOyB0b3A6NTAlOyBsZWZ0OjUwJTsgdHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLC01MCUpIHJvdGF0ZSgtNDVkZWcpOyBmb250LXNpemU6NzBwdDsgY29sb3I6cmdiYSgyMTcsODMsNzksMC4xNSk7IGZvbnQtd2VpZ2h0OmJvbGQ7IGJvcmRlcjo4cHQgc29saWQgcmdiYSgyMTcsODMsNzksMC4xNSk7IHBhZGRpbmc6MTBweCAzMHB4OyB6LWluZGV4OjEwMDsgd2hpdGUtc3BhY2U6bm93cmFwOyI+Q0FOQ0VMTEVEPC9kaXY+JyA6ICcnfQ0KICAgICAgICAgICAgICAgICAgPHRhYmxlIHN0eWxlPSJ3aWR0aDogMTAwJTsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsiPg0KICAgICAgICAgICAgICAgICAgICAgIDx0cj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ3aWR0aDogNzVwdDsgdmVydGljYWwtYWxpZ246IHRvcDsiPjxpbWcgc3JjPSJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL2J1cDNuczNiNHg3Zmd4bzY0N2Z5ZC9QZXJpeWF2YS5qcGc/cmxrZXk9ZjNrOGdjMWh3bGp1ZXl5djRjNzM2aWdpciZkbD0xIiBzdHlsZT0id2lkdGg6MTAwJSIgY3Jvc3NvcmlnaW49ImFub255bW91cyI+PC90ZD4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHBhZGRpbmctbGVmdDogNXB0OyI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDEzcHQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+TVlMQUkgTUFIQVBFUklZQVZBIEFOVVNIQU0gVFJVU1QgKFJFR0QuKTwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiA4LjVwdDsgbGluZS1oZWlnaHQ6IDEuMjsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5ldyBOby4gNCwgT2xkIE5vLiAyMywgUGl0Y2h1cGlsbGFpIFN0cmVldCwgTXlsYXBvcmUsIENoZW5uYWktNjAwIDAwNC48YnI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUGhvbmU6IDYzODA4OTgyMzEsIDg2MTAyMTQxMzguPGJyPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIPCfk6cgdGhpcnVteWxhaWFudXNoYW1AZ21haWwuY29tIPCfjJAgd3d3Lm15bGFpbWFoYXBlcml5YXZhdGVtcGxlLmNvbTxicj4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDik5Ugd3d3LmZhY2Vib29rLmNvbS90aGlydW15bGFpLmFudXNoYW0gOiBXaGF0c0FwcDogNjM4MDg5ODIzMQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGQ+DQogICAgICAgICAgICAgICAgICAgICAgPC90cj4NCiAgICAgICAgICAgICAgICAgIDwvdGFibGU+DQogICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOiA1cHQ7IGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci10b3A6IDJweCBzb2xpZCAjMDAwOyBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzAwMDsgcGFkZGluZzogMnB0IDA7IGZvbnQtc2l6ZTogOS41cHQ7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0id2lkdGg6MTMwcHQiPkRhdGU6ICR7ZlsxXX08L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9InRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOyI+UkVDRUlQVDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0id2lkdGg6MTMwcHQ7IHRleHQtYWxpZ246cmlnaHQiPk5vOiAke2ZbMF19PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOiA4cHQ7IGZvbnQtc2l6ZTogMTAuNXB0OyB0ZXh0LWFsaWduOiBqdXN0aWZ5OyBsaW5lLWhlaWdodDogMS4zOyI+DQogICAgICAgICAgICAgICAgICAgICAgUmVjZWl2ZWQgd2l0aCB0aGFua3MgUnMuIDxiPiR7Zls5XX08L2I+ICg8Yj5SdXBlZXMgJHt0b1dvcmRzKGZbOV0pfSBvbmx5PC9iPikgZm9yIDxiPiR7ZlsxMl19PC9iPiB2aWEgJHtmWzExXX0gPGI+JHtmWzEwXX08L2I+IGZyb206DQogICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJvcmRlci10b3A6IDFweCBzb2xpZCAjMDAwOyBtYXJnaW46IDRwdCAwOyI+PC9kaXY+DQogICAgICAgICAgICAgICAgICA8dGFibGUgc3R5bGU9IndpZHRoOiAxMDAlOyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyI+DQogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZCBzdHlsZT0id2lkdGg6IDg1cHQ7IGZvbnQtc2l6ZTogOS41cHQ7IHBhZGRpbmc6IDEuNXB0IDA7Ij5OYW1lPC90ZD48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+U2hyaS4vU210LiAke2ZbMl19PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IHBhZGRpbmc6IDEuNXB0IDA7Ij5QQU48L3RkPjx0ZCBzdHlsZT0iZm9udC1zaXplOiA5LjVwdDsgZm9udC13ZWlnaHQ6IGJvbGQ7Ij4ke2ZbNl0gfHwgJ04vQSd9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgICAgIDx0cj48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IHBhZGRpbmc6IDEuNXB0IDA7Ij5QaG9uZTwvdGQ+PHRkIHN0eWxlPSJmb250LXNpemU6IDkuNXB0OyBmb250LXdlaWdodDogYm9sZDsiPiR7ZlszXSB8fCAnTi9BJ308L3RkPjwvdHI+DQogICAgICAgICAgICAgICAgICAgICAgPHRyPjx0ZCBzdHlsZT0iZm9udC1zaXplOiA5LjVwdDsgcGFkZGluZzogMS41cHQgMDsiPkVtYWlsPC90ZD48dGQgc3R5bGU9ImZvbnQtc2l6ZTogOS41cHQ7IGZvbnQtd2VpZ2h0OiBib2xkOyI+JHtmWzVdIHx8ICdOL0EnfTwvdGQ+PC90cj4NCiAgICAgICAgICAgICAgICAgICAgICA8dHI+PHRkIHN0eWxlPSJmb250LXNpemU6IDkuNXB0OyBwYWRkaW5nOiAxLjVwdCAwOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyI+QWRkcmVzczwvdGQ+PHRkIHN0eWxlPSJmb250LXNpemU6IDkuNXB0OyBmb250LXdlaWdodDogYm9sZDsiPiR7ZnVsbEFkZHJlc3N9PC90ZD48L3RyPg0KICAgICAgICAgICAgICAgICAgPC90YWJsZT4NCiAgICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9ImJvcmRlci10b3A6IDFweCBzb2xpZCAjMDAwOyBtYXJnaW46IDRwdCAwOyI+PC9kaXY+DQogICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47IGFsaWduLWl0ZW1zOiBmbGV4LWVuZDsgbWFyZ2luLXRvcDogNXB0OyI+DQogICAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0iZm9udC1zaXplOiA3cHQ7IGZvbnQtc3R5bGU6IGl0YWxpYzsgd2lkdGg6IDUwJTsiPipDb21wdXRlciBHZW5lcmF0ZWQgUmVjZWlwdC1ObyBzaWduYXR1cmUgUmVxdWlyZWQ8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodDsgd2lkdGg6IDUwJTsiPg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDkuNXB0OyBmb250LXdlaWdodDogYm9sZDsiPmZvciBNWUxBSSBNQUhBUEVSSVlBVkEgQU5VU0hBTSBUUlVTVDwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJmb250LXNpemU6IDhwdDsgZm9udC13ZWlnaHQ6IGJvbGQ7IG1hcmdpbi10b3A6IDJwdDsiPlNlYyAxMi1BIFZhbGlkIHRpbGwgMzEtMDMtMjAyNiB8IFBBTiBBQUVUTTUxNDVKPC9kaXY+DQogICAgICAgICAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgYDsNCg0KICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRlbXBEaXYpOw0KICAgICAgICAgICAgICBjb25zdCBjYW52YXMgPSBhd2FpdCBodG1sMmNhbnZhcyh0ZW1wRGl2LCB7IHVzZUNPUlM6IHRydWUsIHNjYWxlOiAyIH0pOw0KICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRlbXBEaXYpOw0KICAgICAgICAgICAgICByZXR1cm4gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvanBlZycsIDEuMCk7DQogICAgICAgICAgfQ0KDQoNCg0KDQoNCg0KICAgICAgICAgIC8qKg0KKiBOZXcgRG93bmxvYWQgTWVudSBGdW5jdGlvbjogQ2xlYXJzIHdvcmtzcGFjZSBhbmQgcHJvdmlkZXMgY29uc29saWRhdGVkDQoqIGRvd25sb2FkIGJ1dHRvbnMgdGhhdCBhdXRvLWFkanVzdCB0byBzY3JlZW4gd2lkdGguDQoqLw0KDQogICAgICAgICAgZnVuY3Rpb24gc2hvd0Rvd25sb2FkTWVudSgpIHsNCiAgICAgICAgICAgICAgY2xlYXJXb3Jrc3BhY2UoKTsNCiAgICAgICAgICAgICAgY29uc3QgcmVzdWx0c0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZXRhaWxlZFJlc3VsdHMnKTsNCg0KICAgICAgICAgICAgICAvLyBFYWNoIGJ1dHRvbiBoYXMgYSB1bmlxdWUgYmFja2dyb3VuZCBhbmQgaGlnaC1jb250cmFzdCB0ZXh0IGNvbG9yDQogICAgICAgICAgICAgIGNvbnN0IGh0bWwgPSBgDQogICAgICAgICAgICAgIDxkaXYgaWQ9ImRvd25sb2FkQ2VudGVyVG9wIiBzdHlsZT0icGFkZGluZzogMTVweDsgZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgZ2FwOiAxMHB4OyBhbGlnbi1pdGVtczogY2VudGVyOyBtYXgtd2lkdGg6IDgwMHB4OyBtYXJnaW46IDAgYXV0bzsiPg0KICAgICAgICAgICAgICAgICAgPGgzIHN0eWxlPSJjb2xvcjogdmFyKC0tcHJpbWFyeS1ibHVlKTsgbWFyZ2luLWJvdHRvbTogNXB4OyI+TU1QVCBEb3dubG9hZCBDZW50ZXI8L2gzPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9IndyYXBMb2FkaW5nKHJ1blNvZnRjb3BpZXNEaXJlY3QpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogIzJFN0QzMjsgY29sb3I6ICNGRkZGRkY7IGJvcmRlcjogMXB4IHNvbGlkICMxQjVFMjA7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDEuIFNvZnRjb3BpZXMgb2YgUmVjZWlwdHMgKFBERikNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImdlbmVyYXRlUlJMYWJlbHMoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICNGRkY5QzQ7IGNvbG9yOiAjMDAwMDAwOyBib3JkZXI6IDFweCBzb2xpZCAjRkJDMDJEOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICAyLiBMYWJlbHMgZm9yIFJlYWR5IFJlY2VpcHRzIChQREYpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJkb3dubG9hZERvbmF0aW9uTGlzdERpcmVjdCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0UzRjJGRDsgY29sb3I6ICMwRDQ3QTE7IGJvcmRlcjogMXB4IHNvbGlkICMyMTk2RjM7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDMuIERvbmF0aW9uIExpc3QgKEV4Y2VsKQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZG93bmxvYWRVbmlxdWVEb25vckxpc3REaXJlY3QoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICNFOEY1RTk7IGNvbG9yOiAjMUI1RTIwOyBib3JkZXI6IDFweCBzb2xpZCAjNENBRjUwOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA0LiBVbmlxdWUgRG9ub3IgTGlzdCAoVG9wIERvbm9ycyBFeGNlbCkNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvd25sb2FkUGVuZGluZ0Nhc2hEaXJlY3QoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICNFRkVCRTk7IGNvbG9yOiAjNEUzNDJFOyBib3JkZXI6IDFweCBzb2xpZCAjOEQ2RTYzOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA1LiBQZW5kaW5nIENhc2ggRGVwb3NpdHMgKEV4Y2VsKQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iZG93bmxvYWRQZW5kaW5nQ29uc2VudERpcmVjdCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0ZCRTlFNzsgY29sb3I6ICNCRjM2MEM7IGJvcmRlcjogMXB4IHNvbGlkICNGRjU3MjI7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDYuIFBlbmRpbmcgQ29uc2VudCBMZXR0ZXJzIChDb3JwdXMgRXhjZWwpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJkb3dubG9hZEFub255bW91c0xpc3REaXJlY3QoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICNGM0U1RjU7IGNvbG9yOiAjNEExNDhDOyBib3JkZXI6IDFweCBzb2xpZCAjOUMyN0IwOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA3LiBBbm9ueW1vdXMgTGlzdCAoRXhjZWwpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJydW5Bbm9ueU1hdGNoRGlyZWN0KCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjNEExNDhDOyBjb2xvcjogI0ZGRkZGRjsgYm9yZGVyOiAxcHggc29saWQgIzMxMUI5MjsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgOC4gQW5vbnltb3VzIE1hdGNoIExpc3QgKFRYVCkNCiAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KDQogICAgICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9InJ1bkJhbmtTdGF0ZW1lbnREaXJlY3QoKSINCiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAlOyBoZWlnaHQ6IDUwcHg7IGJhY2tncm91bmQ6ICMwMDYwNjQ7IGNvbG9yOiAjRTBGN0ZBOyBib3JkZXI6IDFweCBzb2xpZCAjMDA4MzhGOyBmb250LXdlaWdodDogYm9sZDsgYm9yZGVyLXJhZGl1czogNXB4OyBjdXJzb3I6IHBvaW50ZXI7Ij4NCiAgICAgICAgICAgICAgICAgICAgICA5LiBCYW5rIFN0YXRlbWVudCAoRXhjZWwpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJydW5EZXRhaWxlZE1hdGNoUmVwb3J0KCkiDQogICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwJTsgaGVpZ2h0OiA1MHB4OyBiYWNrZ3JvdW5kOiAjMDE1NzlCOyBjb2xvcjogI0UxRjVGRTsgYm9yZGVyOiAxcHggc29saWQgIzAyNzdCRDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAgMTAuIERldGFpbGVkIEJhbmsgTWF0Y2ggUmVwb3J0IChUWFQpDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSJydW5FeHBlbnNlc0V4cG9ydCgpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNTBweDsgYmFja2dyb3VuZDogI0I3MUMxQzsgY29sb3I6ICNGRkVCRUU7IGJvcmRlcjogMXB4IHNvbGlkICNDNjI4Mjg7IGZvbnQtd2VpZ2h0OiBib2xkOyBib3JkZXItcmFkaXVzOiA1cHg7IGN1cnNvcjogcG9pbnRlcjsiPg0KICAgICAgICAgICAgICAgICAgICAgIDExLiBFeHBlbnNlcyBSZXBvcnQgKEV4Y2VsKQ0KICAgICAgICAgICAgICAgICAgPC9idXR0b24+DQoNCiAgICAgICAgICAgICAgICAgIDxidXR0b24gb25jbGljaz0iaGlkZVV0aWxpdGllcygpIg0KICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMCU7IGhlaWdodDogNDVweDsgYmFja2dyb3VuZDogIzMzMzsgY29sb3I6IHdoaXRlOyBib3JkZXI6IG5vbmU7IG1hcmdpbi10b3A6IDE1cHg7IGJvcmRlci1yYWRpdXM6IDVweDsgY3Vyc29yOiBwb2ludGVyOyI+DQogICAgICAgICAgICAgICAgICAgICAg4oaQIEJBQ0sgVE8gREFTSEJPQVJEDQogICAgICAgICAgICAgICAgICA8L2J1dHRvbj4NCg0KICAgICAgICAgICAgICAgICAgPHAgaWQ9ImRvd25sb2FkQ2VudGVyQm90dG9tIiBzdHlsZT0iZm9udC1zaXplOiAwLjhyZW07IGNvbG9yOiAjNjY2OyBtYXJnaW4tdG9wOiAxMHB4OyI+DQogICAgICAgICAgICAgICAgICAgICAgKiBFbnN1cmUgRlkgRmlsdGVyIGlzIGFwcGxpZWQgYmVmb3JlIGRvd25sb2FkaW5nLg0KICAgICAgICAgICAgICAgICAgPC9wPg0KICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICBgOw0KICAgICAgICAgICAgICByZXN1bHRzRGl2LmlubmVySFRNTCA9IGh0bWw7DQogICAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgZnVuY3Rpb24gdG9Xb3JkcyhuKSB7DQogICAgICAgICAgICAgIGlmIChuID09IDApIHJldHVybiAnWmVybyc7DQogICAgICAgICAgICAgIGxldCBhID0gWycnLCAnT25lICcsICdUd28gJywgJ1RocmVlICcsICdGb3VyICcsICdGaXZlICcsICdTaXggJywgJ1NldmVuICcsICdFaWdodCAnLCAnTmluZSAnLCAnVGVuICcsICdFbGV2ZW4gJywgJ1R3ZWx2ZSAnLCAnVGhpcnRlZW4gJywgJ0ZvdXJ0ZWVuICcsICdGaWZ0ZWVuICcsICdTaXh0ZWVuICcsICdTZXZlbnRlZW4gJywgJ0VpZ2h0ZWVuICcsICdOaW5ldGVlbiAnXTsNCiAgICAgICAgICAgICAgbGV0IGIgPSBbJycsICcnLCAnVHdlbnR5JywgJ1RoaXJ0eScsICdGb3J0eScsICdGaWZ0eScsICdTaXh0eScsICdTZXZlbnR5JywgJ0VpZ2h0eScsICdOaW5ldHknXTsNCg0KICAgICAgICAgICAgICBsZXQgbnVtID0gKCcwMDAwMDAwMDAnICsgcGFyc2VJbnQobikpLnN1YnN0cigtOSkubWF0Y2goL14oXGR7Mn0pKFxkezJ9KShcZHsyfSkoXGR7MX0pKFxkezJ9KSQvKTsNCiAgICAgICAgICAgICAgaWYgKCFudW0pIHJldHVybiAiIjsNCg0KICAgICAgICAgICAgICBsZXQgc3RyID0gJyc7DQogICAgICAgICAgICAgIHN0ciArPSAobnVtWzFdICE9IDApID8gKGFbTnVtYmVyKG51bVsxXSldIHx8IGJbbnVtWzFdWzBdXSArICcgJyArIGFbbnVtWzFdWzFdXSkgKyAnQ3JvcmUgJyA6ICcnOw0KICAgICAgICAgICAgICBzdHIgKz0gKG51bVsyXSAhPSAwKSA/IChhW051bWJlcihudW1bMl0pXSB8fCBiW251bVsyXVswXV0gKyAnICcgKyBhW251bVsyXVsxXV0pICsgJ0xha2ggJyA6ICcnOw0KICAgICAgICAgICAgICBzdHIgKz0gKG51bVszXSAhPSAwKSA/IChhW051bWJlcihudW1bM10pXSB8fCBiW251bVszXVswXV0gKyAnICcgKyBhW251bVszXVsxXV0pICsgJ1Rob3VzYW5kICcgOiAnJzsNCiAgICAgICAgICAgICAgc3RyICs9IChudW1bNF0gIT0gMCkgPyAoYVtOdW1iZXIobnVtWzRdKV0gfHwgYltudW1bNF1bMF1dICsgJyAnICsgYVtudW1bNF1bMV1dKSArICdIdW5kcmVkICcgOiAnJzsNCiAgICAgICAgICAgICAgc3RyICs9IChudW1bNV0gIT0gMCkgPyAoKHN0ciAhPSAnJykgPyAnYW5kICcgOiAnJykgKyAoYVtOdW1iZXIobnVtWzVdKV0gfHwgYltudW1bNV1bMF1dICsgJyAnICsgYVtudW1bNV1bMV1dKSA6ICcnOw0KDQogICAgICAgICAgICAgIHJldHVybiBzdHIudHJpbSgpOw0KICAgICAgICAgIH0NCg0KDQogICAgICAgICAgYXN5bmMgZnVuY3Rpb24gc2hvd0Rvbm9yTWF0Y2hMaXN0KCkgew0KICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRpbmdNc2cnKTsNCiAgICAgICAgICAgICAgbG9hZGluZy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgICAgICAgICAgICAgY29uc3QgUkVWRVJTQUxTX1VSTCA9ICJodHRwczovL2RsLmRyb3Bib3h1c2VyY29udGVudC5jb20vc2NsL2ZpL2s2Y2x2a2U3aDJxeGhnbjA3dm1iNS9SZXZlcnNhbHMudHh0P3Jsa2V5PTF5OWRucmV2ZDZtbW5zMDAzbHlkdXc5NW0mZGw9MSI7DQogICAgICAgICAgICAgIGNsZWFyV29ya3NwYWNlKCk7DQoNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgY29uc3QgW2JhbmtSZXMsIGRhdGFSZXMsIGV4cFJlcywgcmV2UmVzLCBjYXNoUmVzXSA9IGF3YWl0IFByb21pc2UuYWxsKFsNCiAgICAgICAgICAgICAgICAgICAgICBmZXRjaChCQU5LX05FV19VUkwpLCBmZXRjaChEQVRBX1VSTCksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goRVhQRU5TRVNfVVJMKS50aGVuKHJlcyA9PiByZXMuYXJyYXlCdWZmZXIoKSksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goUkVWRVJTQUxTX1VSTCkudGhlbihyZXMgPT4gcmVzLnRleHQoKSksDQogICAgICAgICAgICAgICAgICAgICAgZmV0Y2goQ0FTSF9MSVNUX1VSTCkudGhlbihyZXMgPT4gcmVzLnRleHQoKSkNCiAgICAgICAgICAgICAgICAgIF0pOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCBiYW5rTGluZXMgPSAoYXdhaXQgYmFua1Jlcy50ZXh0KCkpLnNwbGl0KCdcbicpLmZpbHRlcihsID0+IGwudHJpbSgpLnNwbGl0KCd8JykubGVuZ3RoID49IDUpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgZG9ub3JSZWNzID0gKGF3YWl0IGRhdGFSZXMudGV4dCgpKS5zcGxpdCgnXG4nKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRiID0gZG9ub3JSZWNzLm1hcChyID0+IHIuc3BsaXQoJ3wnKSkuZmlsdGVyKGYgPT4gZi5sZW5ndGggPj0gMTUgJiYgZlsxM10/LnRvVXBwZXJDYXNlKCkgIT09ICJZRVMiKTsNCiAgICAgICAgICAgICAgICAgIGNvbnN0IHJldmVyc2FscyA9IHJldlJlcy5zcGxpdCgnXG4nKS5tYXAobGluZSA9PiBsaW5lLnNwbGl0KCd8JykpLmZpbHRlcihmID0+IGYubGVuZ3RoID49IDcpOw0KICAgICAgICAgICAgICAgICAgY29uc3QgY2FzaExpbmVzID0gY2FzaFJlcy5zcGxpdCgnXG4nKS5maWx0ZXIobCA9PiBsLnRyaW0oKSAhPT0gIiIpOw0KICAgICAgICAgICAgICAgICAgY29uc3Qgd29ya2Jvb2sgPSBYTFNYLnJlYWQoZXhwUmVzLCB7IHR5cGU6ICdhcnJheScgfSk7DQogICAgICAgICAgICAgICAgICBjb25zdCByb3dzID0gWExTWC51dGlscy5zaGVldF90b19qc29uKHdvcmtib29rLlNoZWV0c1t3b3JrYm9vay5TaGVldE5hbWVzWzBdXSwgeyBoZWFkZXI6IDEgfSk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnN0IGNyZWRpdEV4ZW1wdEtleXdvcmRzID0gWyJDUkVESVQgSU5URVJFU1QiLCAiQ0xPU1VSRSBPRiBGRCIsICJQQVJUIFdJVEhEUkFXTCIsICJGRCAiLCAiRkQ6IiwgIkJZIElOVCBUUkFOU0ZFUiIsICJIQU5ETElOR1JFViIsICJVUElNSSBDUiBBREoiLCAiTE9BTiIsICJSRVRVUk4iLCAiUkVWRVJTQUwiXTsNCg0KICAgICAgICAgICAgICAgICAgbGV0IG1haW5NYXN0ZXJIdG1sID0gIiIsIGV4ZW1wdENyZWRpdHNIdG1sID0gIiIsIGV4ZW1wdERlYml0c0h0bWwgPSAiIiwgcGVuZGluZ1Jvd3NIdG1sID0gIiI7DQogICAgICAgICAgICAgICAgICBsZXQgYmFua1N0YXRlbWVudENvdW50ID0gMDsNCiAgICAgICAgICAgICAgICAgIGxldCBtYXRjaGVkUmVjZWlwdHNTZXQgPSBuZXcgU2V0KCk7DQogICAgICAgICAgICAgICAgICBsZXQgYXVkaXRUb3dhcmRzTWFwID0ge307IGxldCBhdWRpdE1vZGVNYXAgPSB7fTsNCg0KICAgICAgICAgICAgICAgICAgYmFua0xpbmVzLmZvckVhY2gobGluZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYiA9IGxpbmUuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBiRGF0ZVJhdyA9IGJbMF0udHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJSZWZSYXcgPSAoYlsxXSB8fCAiIikudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGJBbXQgPSBwYXJzZUZsb2F0KGJbNF0gfHwgYlszXSB8fCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc0NyZWRpdCA9IGJbNF0gIT09ICIiICYmIGJbNF0gIT09ICIwIiAmJiBiWzRdICE9PSAiMC4wMCIgJiYgYls0XSAhPT0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEZZICE9PSAiYWxsIiAmJiAiMjAiICsgZ2V0RlkoYkRhdGVSYXcpLnNwbGl0KCctJylbMF0gIT09IHNlbGVjdGVkRlkpIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICBiYW5rU3RhdGVtZW50Q291bnQrKzsNCg0KICAgICAgICAgICAgICAgICAgICAgIGxldCByb3dTdHlsZSA9ICIiLCBkZXRhaWxDb2xIdG1sID0gIiIsIHJlY0h0bWwgPSAiIiwgaXNNYXRjaGVkID0gZmFsc2UsIG1hdGNoZWREb25vcnMgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICBsZXQgaXNFeGVtcHRDcmVkaXQgPSBmYWxzZSwgaXNFeGVtcHREZWJpdCA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgIGxldCBhbXRDbGFzcyA9IGlzQ3JlZGl0ID8gImFtdC1jcmVkaXQiIDogImFtdC1kZWJpdCI7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGFtdFN1YkxhYmVsID0gIiI7DQoNCiAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNDcmVkaXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYkRhdGVTdGQgPSBiRGF0ZVJhdy5yZXBsYWNlKC9bXC9cLl0vZywgJy0nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV2TWF0Y2ggPSByZXZlcnNhbHMuZmluZChyID0+IHJbMF0udHJpbSgpLnJlcGxhY2UoL1tcL1wuXS9nLCAnLScpID09PSBiRGF0ZVN0ZCAmJiByWzFdLnRyaW0oKS50b1VwcGVyQ2FzZSgpID09PSBiUmVmUmF3LnRvVXBwZXJDYXNlKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV2TWF0Y2gpIHsgaXNNYXRjaGVkID0gdHJ1ZTsgaXNFeGVtcHRDcmVkaXQgPSB0cnVlOyByb3dTdHlsZSA9ICdzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojZTNmMmZkOyInOyBkZXRhaWxDb2xIdG1sID0gJzxiPlJFVkVSU0FMOjwvYj4gJyArIHJldk1hdGNoWzZdOyB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGNyZWRpdEV4ZW1wdEtleXdvcmRzLnNvbWUoayA9PiBiUmVmUmF3LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoaykpKSB7IGlzTWF0Y2hlZCA9IHRydWU7IGlzRXhlbXB0Q3JlZGl0ID0gdHJ1ZTsgcm93U3R5bGUgPSAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2UzZjJmZDsiJzsgZGV0YWlsQ29sSHRtbCA9ICc8Yj5CQU5LIEVYRU1QVDo8L2I+ICcgKyBiUmVmUmF3OyB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJSZWZSYXcudG9VcHBlckNhc2UoKS5pbmNsdWRlcygiQ0FTSCBERVBPU0lUIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgY2xNYXRjaCA9IGNhc2hMaW5lcy5maW5kKGNsID0+IHsgY29uc3QgcGFydHMgPSBjbC5zcGxpdCgnfCcpWzBdLnRyaW0oKS5zcGxpdCgnICcpOyByZXR1cm4gcGFydHNbMF0ucmVwbGFjZSgvW1wvXC5dL2csICctJykgPT09IGJEYXRlU3RkICYmIE1hdGguYWJzKHBhcnNlRmxvYXQocGFydHNbMV0pIC0gYkFtdCkgPCAwLjAxOyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xNYXRjaCkgeyBpc01hdGNoZWQgPSB0cnVlOyBjb25zdCBwID0gY2xNYXRjaC5zcGxpdCgnfCcpOyBjb25zdCBwcmVmaXggPSBwWzFdLnRyaW0oKSA9PT0gJ00nID8gIk1QUyIgOiAiQ0ciOyBjb25zdCByTGlzdCA9IHBbMl0uc3BsaXQoJywnKS5tYXAociA9PiBwcmVmaXggKyByLnRyaW0oKS5wYWRTdGFydChwWzFdLnRyaW0oKSA9PT0gJ00nID8gNyA6IDYsICcwJykpOyBtYXRjaGVkRG9ub3JzID0gZGIuZmlsdGVyKGQgPT4gckxpc3QuaW5jbHVkZXMoZFswXS50cmltKCkpKTsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyBtYXRjaGVkRG9ub3JzID0gZGIuZmlsdGVyKGQgPT4gZFsxXS50cmltKCkucmVwbGFjZSgvW1wvXC5dL2csICctJykgPT09IGJEYXRlU3RkICYmIE1hdGguYWJzKHBhcnNlRmxvYXQoZFs5XSkgLSBiQW10KSA8IDAuMDEgJiYgZFsxMV0udG9VcHBlckNhc2UoKSA9PT0gIkNBU0giKTsgaWYgKG1hdGNoZWREb25vcnMubGVuZ3RoID4gMCkgaXNNYXRjaGVkID0gdHJ1ZTsgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVkRG9ub3JzID0gZGIuZmlsdGVyKGQgPT4geyBsZXQgZFJlZiA9IChkWzEwXSB8fCAiIikudHJpbSgpLnRvVXBwZXJDYXNlKCkuc3BsaXQoJygnKVswXS5zcGxpdCgnWycpWzBdLnRyaW0oKTsgcmV0dXJuIGRbMV0udHJpbSgpLnJlcGxhY2UoL1tcL1wuXS9nLCAnLScpID09PSBiRGF0ZVN0ZCAmJiBkUmVmICE9PSAiIiAmJiBiUmVmUmF3LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXMoZFJlZik7IH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkRG9ub3JzLmxlbmd0aCA+IDApIGlzTWF0Y2hlZCA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZXhwTWF0Y2ggPSByb3dzLmZpbmQoKHIsIGkpID0+IGkgPiAwICYmIHJbM10gJiYgTWF0aC5hYnMocGFyc2VGbG9hdChyWzNdKSAtIGJBbXQpIDwgMC4wMSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBNYXRjaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNYXRjaGVkID0gdHJ1ZTsgYW10U3ViTGFiZWwgPSAnPGRpdiBzdHlsZT0iZm9udC1zaXplOjAuNjVyZW07IGNvbG9yOmluaGVyaXQ7IGZvbnQtd2VpZ2h0OmJvbGQ7Ij5FeHBlbnNlPC9kaXY+JzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cE5vdGUgPSAoZXhwTWF0Y2hbNF0gfHwgIiIpLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChleHBOb3RlLmluY2x1ZGVzKCJFWEVNUFQiKSB8fCBleHBOb3RlLmluY2x1ZGVzKCJGUkVTSCBERVBPU0lUIikpIHsgaXNFeGVtcHREZWJpdCA9IHRydWU7IHJvd1N0eWxlID0gJ3N0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjYjcxYzFjOyBjb2xvcjogI2ZmZmZmZiAhaW1wb3J0YW50OyInOyB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsgcm93U3R5bGUgPSAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmY2U0ZWM7Iic7IH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbENvbEh0bWwgPSAnPGI+JyArIChleHBNYXRjaFs0XSB8fCBiUmVmUmF3KSArICc8L2I+JzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgIGxldCBmaW5hbEFtdFN0eWxlID0gaXNFeGVtcHREZWJpdCA/ICdzdHlsZT0iY29sb3I6I2ZmZmZmZiAhaW1wb3J0YW50OyBmb250LXdlaWdodDpib2xkOyInIDogJyc7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGFtdENvbEh0bWwgPSBg4oK5JHtiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfSR7YW10U3ViTGFiZWx9YDsNCg0KICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0NyZWRpdCAmJiBpc01hdGNoZWQgJiYgbWF0Y2hlZERvbm9ycy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElNUExFTUVOVEVEOiBDbGlja2FibGUgUmVjZWlwdCBMaW5rcyBmb3IgTWF0Y2hlZCBEb25vcnMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVjSHRtbCA9IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6MC43cmVtOyBtYXJnaW4tdG9wOjNweDsiPiR7bWF0Y2hlZERvbm9ycy5tYXAobSA9PiBgPHNwYW4gY2xhc3M9InJjcHQtbGluayIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHttWzBdLnRyaW0oKX0nKSI+JHttWzBdLnRyaW0oKX08L3NwYW4+YCkuam9pbignPGJyPicpfTwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaGVkRG9ub3JzLmxlbmd0aCA9PT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm93U3R5bGUgPSAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2ZmZmRlNzsiJzsgY29uc3QgbSA9IG1hdGNoZWREb25vcnNbMF07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbXRDb2xIdG1sID0gYOKCuSR7YkFtdC50b0xvY2FsZVN0cmluZygnZW4tSU4nKX08YnI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTowLjY1cmVtOyBjb2xvcjojNTU1OyI+VG93YXJkczogJHttWzEyXX08L3NwYW4+PGJyPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MC42NXJlbTsgY29sb3I6IzU1NTsiPk1vZGU6ICR7bVsxMV19PC9zcGFuPmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxDb2xIdG1sID0gYDxiPiR7bVsyXX08L2I+IHwgJHttWzE5XX0gfCAke21bMTVdfTxicj5QQU46ICR7bVs2XX08YnI+UnMuJHtwYXJzZUZsb2F0KG1bOV0pLnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfSA6IFRvd2FyZHMgOiAke21bMTJdfWA7DQogICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dTdHlsZSA9ICdzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjojZmZmMTc2OyInOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW10Q29sSHRtbCA9IGA8ZGl2IHN0eWxlPSJmb250LXNpemU6MC43cmVtOyBmb250LXdlaWdodDpib2xkOyBjb2xvcjojMzMzOyI+TXVsdGlwbGUgRG9ub3JzPC9kaXY+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2ZmOTgwMDsgY29sb3I6d2hpdGU7IHBhZGRpbmc6MnB4IDRweDsgYm9yZGVyLXJhZGl1czozcHg7IGRpc3BsYXk6aW5saW5lLWJsb2NrOyBmb250LXdlaWdodDpib2xkOyI+4oK5JHtiQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvc3Bhbj48ZGl2IHN0eWxlPSJmb250LXNpemU6MC42NXJlbTsgbWFyZ2luLXRvcDoycHg7IGNvbG9yOiM1NTU7Ij5Nb2RlOiAke21hdGNoZWREb25vcnNbMF1bMTFdfTwvZGl2PmA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWxDb2xIdG1sID0gYDxkaXYgc3R5bGU9ImZvbnQtd2VpZ2h0OmJvbGQ7IHRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7IGNvbG9yOiMwZDQ3YTE7IG1hcmdpbi1ib3R0b206NXB4OyI+RG9ub3IgRGV0YWlsczwvZGl2PmAgKyBtYXRjaGVkRG9ub3JzLm1hcChtID0+IGA8Yj4ke21bMl19PC9iPiB8ICR7bVsxOV19IHwgJHttWzE1XX08YnI+UEFOOiAke21bNl19PGJyPlJzLiR7cGFyc2VGbG9hdChtWzldKS50b0xvY2FsZVN0cmluZygnZW4tSU4nKX0gOiBUb3dhcmRzIDogJHttWzEyXX1gKS5qb2luKCc8aHIgc3R5bGU9ImJvcmRlcjpub25lOyBib3JkZXItdG9wOjFweCBzb2xpZCAjY2NjOyBtYXJnaW46OHB4IDA7Ij4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVkRG9ub3JzLmZvckVhY2gobSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBwYXJzZUZsb2F0KG1bOV0pIHx8IDA7IG1hdGNoZWRSZWNlaXB0c1NldC5hZGQobVswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdWRpdFRvd2FyZHNNYXBbbVsxMl1dKSBhdWRpdFRvd2FyZHNNYXBbbVsxMl1dID0geyBhbXQ6IDAsIHJTZXQ6IG5ldyBTZXQoKSB9OyBhdWRpdFRvd2FyZHNNYXBbbVsxMl1dLmFtdCArPSB2YWw7IGF1ZGl0VG93YXJkc01hcFttWzEyXV0uclNldC5hZGQobVswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhdWRpdE1vZGVNYXBbbVsxMV1dKSBhdWRpdE1vZGVNYXBbbVsxMV1dID0geyBhbXQ6IDAsIHJTZXQ6IG5ldyBTZXQoKSB9OyBhdWRpdE1vZGVNYXBbbVsxMV1dLmFtdCArPSB2YWw7IGF1ZGl0TW9kZU1hcFttWzExXV0uclNldC5hZGQobVswXS50cmltKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc01hdGNoZWQpIHsgcm93U3R5bGUgPSBpc0NyZWRpdCA/ICdzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IicgOiAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNlOGY1ZTk7Iic7IGRldGFpbENvbEh0bWwgPSBgPGkgc3R5bGU9ImNvbG9yOiM2NjY7Ij5CYW5rIFJlZjogJHtiUmVmUmF3fTwvaT5gOyB9DQogICAgICAgICAgICAgICAgICAgICAgY29uc3Qgcm93U3RyID0gYDx0ciAke2lzRXhlbXB0RGViaXQgPyAnc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2I3MWMxYzsgY29sb3I6I2ZmZmZmZiAhaW1wb3J0YW50OyInIDogcm93U3R5bGV9Pjx0ZCBzdHlsZT0id2lkdGg6MTAlIj48Yj4ke2JEYXRlUmF3fTwvYj4ke3JlY0h0bWx9PC90ZD48dGQgc3R5bGU9IndpZHRoOjEwJSIgY2xhc3M9IiR7aXNFeGVtcHREZWJpdCA/ICcnIDogYW10Q2xhc3N9IiAke2ZpbmFsQW10U3R5bGV9PiR7YW10Q29sSHRtbH08L3RkPjx0ZCBzdHlsZT0id2lkdGg6ODAlIj4ke2RldGFpbENvbEh0bWx9PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgbWFpbk1hc3Rlckh0bWwgKz0gcm93U3RyOyBpZiAoaXNFeGVtcHRDcmVkaXQpIGV4ZW1wdENyZWRpdHNIdG1sICs9IHJvd1N0cjsgaWYgKGlzRXhlbXB0RGViaXQpIGV4ZW1wdERlYml0c0h0bWwgKz0gcm93U3RyOyBpZiAoIWlzTWF0Y2hlZCkgcGVuZGluZ1Jvd3NIdG1sICs9IHJvd1N0cjsNCiAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICBsZXQgdW5tYXRjaGVkSHRtbCA9ICIiLCB1bm1hdGNoZWRUb3RhbEFtdCA9IDAsIHVubWF0Y2hlZENvdW50ID0gMDsNCiAgICAgICAgICAgICAgICAgIGRiLmZpbHRlcihtID0+IHsgY29uc3QgbUZZID0gIjIwIiArIGdldEZZKG1bMV0udHJpbSgpKS5zcGxpdCgnLScpWzBdOyByZXR1cm4gIW1hdGNoZWRSZWNlaXB0c1NldC5oYXMobVswXS50cmltKCkpICYmIChzZWxlY3RlZEZZID09PSAiYWxsIiB8fCBtRlkgPT09IHNlbGVjdGVkRlkpOyB9KQ0KICAgICAgICAgICAgICAgICAgICAgIC5mb3JFYWNoKG0gPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkQW10ID0gcGFyc2VGbG9hdChtWzldIHx8IDApOyB1bm1hdGNoZWRUb3RhbEFtdCArPSBkQW10OyB1bm1hdGNoZWRDb3VudCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJTVBMRU1FTlRFRDogQ2xpY2thYmxlIFJlY2VpcHQgTGlua3MgZm9yIFVubWF0Y2hlZCBUYWJsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICB1bm1hdGNoZWRIdG1sICs9IGA8dHIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6I2ZhZmFmYTsiPjx0ZCBzdHlsZT0id2lkdGg6MTAlIj48Yj4ke21bMV19PC9iPjxicj48ZGl2IGNsYXNzPSJyY3B0LWxpbmsiIHN0eWxlPSJmb250LXNpemU6MC43cmVtOyIgb25jbGljaz0ianVtcFRvUmVjZWlwdCgnJHttWzBdLnRyaW0oKX0nKSI+JHttWzBdLnRyaW0oKX08L2Rpdj48L3RkPjx0ZCBzdHlsZT0id2lkdGg6MTAlIiBjbGFzcz0iYW10LWNyZWRpdCI+4oK5JHtkQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTxicj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjAuNjVyZW07IGNvbG9yOiM1NTU7Ij5Ub3dhcmRzOiAke21bMTJdfTwvc3Bhbj48YnI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTowLjY1cmVtOyBjb2xvcjojNTU1OyI+TW9kZTogJHttWzExXX08L3NwYW4+PC90ZD48dGQgc3R5bGU9IndpZHRoOjgwJSI+PGI+JHttWzJdfTwvYj4gfCAke21bMTldfSB8ICR7bVsxNV19PGJyPlBBTjogJHttWzZdfTxicj5Scy4ke2RBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9IDogVG93YXJkcyA6ICR7bVsxMl19PC90ZD48L3RyPmA7DQogICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB1bm1hdGNoZWRIdG1sICs9IGA8dHIgc3R5bGU9ImJhY2tncm91bmQ6IzQ0NDsgY29sb3I6d2hpdGU7IGZvbnQtd2VpZ2h0OmJvbGQ7Ij48dGQgc3R5bGU9IndpZHRoOjEwJSI+VE9UQUw8L3RkPjx0ZCBzdHlsZT0id2lkdGg6MTAlIj7igrkke3VubWF0Y2hlZFRvdGFsQW10LnRvTG9jYWxlU3RyaW5nKCdlbi1JTicpfTwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDo4MCUiPkNvdW50OiAke3VubWF0Y2hlZENvdW50fSBSZWNlaXB0cyBOb3QgRm91bmQgaW4gQmFuayBTdGF0ZW1lbnRzPC90ZD48L3RyPmA7DQoNCiAgICAgICAgICAgICAgICAgIGxldCBhdWRpdFRvdGFsQW10ID0gMDsgT2JqZWN0LnZhbHVlcyhhdWRpdFRvd2FyZHNNYXApLmZvckVhY2godiA9PiBhdWRpdFRvdGFsQW10ICs9IHYuYW10KTsNCiAgICAgICAgICAgICAgICAgIGxldCBhdWRpdFJvd3MgPSBgPHRyPjx0ZCBzdHlsZT0id2lkdGg6MTAlIj48Yj5UT1RBTDwvYj48L3RkPjx0ZCBzdHlsZT0id2lkdGg6MTAlOyB0ZXh0LWFsaWduOmNlbnRlcjsiPjxiPiR7bWF0Y2hlZFJlY2VpcHRzU2V0LnNpemV9PC9iPjwvdGQ+PHRkIHN0eWxlPSJ3aWR0aDo4MCU7IHRleHQtYWxpZ246cmlnaHQ7Ij48Yj7igrkke2F1ZGl0VG90YWxBbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC9iPjwvdGQ+PC90cj5gOw0KICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoYXVkaXRUb3dhcmRzTWFwKS5zb3J0KCkuZm9yRWFjaCh0dyA9PiB7IGF1ZGl0Um93cyArPSBgPHRyPjx0ZD5Ub3dhcmRzICR7dHd9PC90ZD48dGQgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyI+JHthdWRpdFRvd2FyZHNNYXBbdHddLnJTZXQuc2l6ZX08L3RkPjx0ZCBzdHlsZT0idGV4dC1hbGlnbjpyaWdodDsiPuKCuSR7YXVkaXRUb3dhcmRzTWFwW3R3XS5hbXQudG9Mb2NhbGVTdHJpbmcoJ2VuLUlOJyl9PC90ZD48L3RyPmA7IH0pOw0KDQogICAgICAgICAgICAgICAgICBjb25zdCB0YWJsZUhlYWRlciA9ICc8dGhlYWQ+PHRyPjx0aCBzdHlsZT0id2lkdGg6MTAlIj5EYXRlPC90aD48dGggc3R5bGU9IndpZHRoOjEwJSI+QW1vdW50PC90aD48dGggc3R5bGU9IndpZHRoOjgwJSI+RG9ub3IgLyBSZWNvcmQgRGV0YWlsczwvdGg+PC90cj48L3RoZWFkPic7DQogICAgICAgICAgICAgICAgICBjb25zdCBhdWRpdEhlYWRlciA9ICc8dGhlYWQgc3R5bGU9ImJhY2tncm91bmQ6IzBkNDdhMTsgY29sb3I6d2hpdGU7Ij48dHI+PHRoIHN0eWxlPSJ3aWR0aDoxMCUiPkl0ZW08L3RoPjx0aCBzdHlsZT0id2lkdGg6MTAlIj5Eb25vcnM8L3RoPjx0aCBzdHlsZT0id2lkdGg6ODAlIj5BbW91bnQ8L3RoPjwvdHI+PC90aGVhZD4nOw0KDQogICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsZWRSZXN1bHRzJykuaW5uZXJIVE1MID0gYA0KICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7IGp1c3RpZnktY29udGVudDpjZW50ZXI7IGdhcDoxMHB4OyBtYXJnaW4tYm90dG9tOjIwcHg7IGZvbnQtc2l6ZTowLjc1cmVtOyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iYmFja2dyb3VuZDojZmZmZGU3OyBwYWRkaW5nOjRweCA4cHg7IGJvcmRlcjoxcHggc29saWQgI2RkZDsiPlNpbmdsZSBNYXRjaDwvc3Bhbj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kOiNmZmYxNzY7IHBhZGRpbmc6NHB4IDhweDsgYm9yZGVyOjFweCBzb2xpZCAjZGRkOyI+TXVsdGktRG9ub3I8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iYmFja2dyb3VuZDojZTNmMmZkOyBwYWRkaW5nOjRweCA4cHg7IGJvcmRlcjoxcHggc29saWQgI2RkZDsiPkV4ZW1wdC9SZXY8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBzdHlsZT0iYmFja2dyb3VuZDojYjcxYzFjOyBjb2xvcjp3aGl0ZTsgcGFkZGluZzo0cHggOHB4OyI+RXhlbXB0IERlYml0PC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gc3R5bGU9ImJhY2tncm91bmQ6I2U4ZjVlOTsgcGFkZGluZzo0cHggOHB4OyBib3JkZXI6MXB4IHNvbGlkICNkZGQ7Ij5FeHBlbnNlPC9zcGFuPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJiYW5rLXRpdGxlIj5NYXN0ZXIgTWF0Y2g8L2gyPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGUgY2xhc3M9Im1hdGNoVGFibGUiPiR7dGFibGVIZWFkZXJ9PHRib2R5PiR7bWFpbk1hc3Rlckh0bWx9PC90Ym9keT48L3RhYmxlPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsgcGFkZGluZzoxMHB4OyBiYWNrZ3JvdW5kOiNlZWU7IGZvbnQtd2VpZ2h0OmJvbGQ7IG1hcmdpbjoxMHB4IDA7Ij5bVG90YWwgMzYzMSByZWNvcmRzIHwgUHJvY2Vzc2VkICR7YmFua1N0YXRlbWVudENvdW50fSBiYW5rIHJvd3NdPC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxoMiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9ImNvbG9yOiMxNTY1YzA7Ij5FeGVtcHRlZCBDcmVkaXRzPC9oMj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlIGNsYXNzPSJtYXRjaFRhYmxlIj4ke3RhYmxlSGVhZGVyfTx0Ym9keT4ke2V4ZW1wdENyZWRpdHNIdG1sfTwvdGJvZHk+PC90YWJsZT48L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0iY29sb3I6I2I3MWMxYzsiPkV4ZW1wdGVkIERlYml0czwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZSBjbGFzcz0ibWF0Y2hUYWJsZSI+JHt0YWJsZUhlYWRlcn08dGJvZHk+JHtleGVtcHREZWJpdHNIdG1sfTwvdGJvZHk+PC90YWJsZT48L2Rpdj4NCiAgICAgICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJiYW5rLXRpdGxlIiBzdHlsZT0iY29sb3I6IzFiNWUyMDsiPlBlbmRpbmcgRW50cmllczwvaDI+DQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InRhYmxlLXdyYXAiPjx0YWJsZSBjbGFzcz0ibWF0Y2hUYWJsZSI+JHt0YWJsZUhlYWRlcn08dGJvZHk+JHtwZW5kaW5nUm93c0h0bWx9PC90Ym9keT48L3RhYmxlPjwvZGl2Pg0KICAgICAgICAgICAgICAgICAgICA8aDIgY2xhc3M9ImJhbmstdGl0bGUiPkZpbmFsIEF1ZGl0PC9oMj4NCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idGFibGUtd3JhcCI+PHRhYmxlIGNsYXNzPSJtYXRjaFRhYmxlIj4ke2F1ZGl0SGVhZGVyfTx0Ym9keT4ke2F1ZGl0Um93c308L3Rib2R5PjwvdGFibGU+PC9kaXY+DQogICAgICAgICAgICAgICAgICAgIDxoMiBjbGFzcz0iYmFuay10aXRsZSIgc3R5bGU9ImNvbG9yOiNlNjUxMDA7Ij5SZWNlaXB0cyBub3QgTWF0Y2hlZCBpbiBCYW5rIFN0YXRlbWVudHM8L2gyPg0KICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJ0YWJsZS13cmFwIj48dGFibGUgY2xhc3M9Im1hdGNoVGFibGUiPiR7dGFibGVIZWFkZXJ9PHRib2R5PiR7dW5tYXRjaGVkSHRtbH08L3Rib2R5PjwvdGFibGU+PC9kaXY+YDsNCg0KDQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBBRERFRDogRE9XTkxPQUQgQlVUVE9OIElOSkVDVElPTiAtLS0NCiAgICAgICAgICAgICAgICAgIGNvbnN0IGRvd25sb2FkQnRuSHRtbCA9IGANCiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7IG1hcmdpbjogNDBweCAwOyI+DQogICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJidG5Eb3dubG9hZE1hdGNoIiBjbGFzcz0ibmF2LXNjcm9sbC1idG4iIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT0icG9zaXRpb246c3RhdGljOyB3aWR0aDphdXRvOyBoZWlnaHQ6YXV0bzsgcGFkZGluZzoxMnB4IDI0cHg7IGJvcmRlci1yYWRpdXM6OHB4OyBiYWNrZ3JvdW5kOiMxYjVlMjA7IGZvbnQtc2l6ZToxcmVtOyINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25jbGljaz0iZG93bmxvYWRNYXRjaExpc3QoKSI+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgRG93bmxvYWQgQmFuay1Eb25vci1FeHBlbnNlLU1hdGNoIExpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgIDwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOw0KICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbGVkUmVzdWx0cycpLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgZG93bmxvYWRCdG5IdG1sKTsNCg0KICAgICAgICAgICAgICAgICAgLy8gLS0tIFRIRSBET1dOTE9BRCBIQU5ETEVSIC0tLQ0KICAgICAgICAgICAgICAgICAgd2luZG93LmRvd25sb2FkTWF0Y2hMaXN0ID0gZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRlkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPSJ5ZWFyRmlsdGVyIl06Y2hlY2tlZCcpLnZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJvd3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWF0Y2hUYWJsZTpmaXJzdC1vZi10eXBlIHRyJyk7DQogICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBgQkFOSy1ET05PUi1FWFBFTlNFLU1BVENIIExJU1QgfCBGWTogJHtzZWxlY3RlZEZZfVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGBHZW5lcmF0ZWQgb246ICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfVxuYDsNCiAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA9ImAucmVwZWF0KDUwKSArIGBcblxuYDsNCg0KICAgICAgICAgICAgICAgICAgICAgIHJvd3MuZm9yRWFjaCgocm93LCBpbmRleCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2xzID0gcm93LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoLCB0ZCcpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYERBVEVgLnBhZEVuZCgxNSkgKyBgIHwgYCArIGBBTU9VTlRgLnBhZEVuZCgyMCkgKyBgIHwgYCArIGBERVRBSUxTXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgLWAucmVwZWF0KDEwMCkgKyBgXG5gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0ZSA9IGNvbHNbMF0uaW5uZXJUZXh0LnJlcGxhY2UoL1xuL2csICcgJykudHJpbSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYW10ID0gY29sc1sxXS5pbm5lclRleHQucmVwbGFjZSgvXG4vZywgJyAnKS50cmltKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkZXRhaWxzID0gY29sc1syXS5pbm5lclRleHQucmVwbGFjZSgvXG4vZywgJyB8ICcpLnRyaW0oKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBkYXRlLnBhZEVuZCgxNSkgKyBgIHwgYCArIGFtdC5wYWRFbmQoMjApICsgYCB8IGAgKyBkZXRhaWxzICsgYFxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYC1gLnJlcGVhdCgxMDApICsgYFxuYDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb250ZW50XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7DQogICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOw0KICAgICAgICAgICAgICAgICAgICAgIGxpbmsuZG93bmxvYWQgPSBgQmFuay1Eb25vci1FeHBlbnNlLU1hdGNoIExpc3RfJHtzZWxlY3RlZEZZfS50eHRgOw0KICAgICAgICAgICAgICAgICAgICAgIGxpbmsuY2xpY2soKTsNCiAgICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICAgIC8vIC0tLSBGT1JDRUQgTkFWSUdBVElPTiBCVVRUT05TIElOSkVDVElPTiAoUmVtYWluIGF0IGJvdHRvbSkgLS0tDQoNCg0KICAgICAgICAgICAgICAgICAgLy9jb25zdCBuYXZIdG1sID0gYDxidXR0b24gaWQ9ImZVcCIgc3R5bGU9InBvc2l0aW9uOmZpeGVkOyBib3R0b206ODBweDsgcmlnaHQ6MjBweDsgei1pbmRleDo5OTk5OTsgd2lkdGg6NDVweDsgaGVpZ2h0OjQ1cHg7IGJvcmRlci1yYWRpdXM6NTAlOyBiYWNrZ3JvdW5kOiMzMzM7IGNvbG9yOiNmZmY7IGJvcmRlcjpub25lOyBjdXJzb3I6cG9pbnRlcjsgZm9udC1zaXplOjIwcHg7IGJveC1zaGFkb3c6MCAycHggNXB4IHJnYmEoMCwwLDAsMC4zKTsiIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOjAsIGJlaGF2aW9yOidzbW9vdGgnfSkiPuKGkTwvYnV0dG9uPg0KICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgICA8YnV0dG9uIGlkPSJmRG93biIgc3R5bGU9InBvc2l0aW9uOmZpeGVkOyBib3R0b206MjBweDsgcmlnaHQ6MjBweDsgei1pbmRleDo5OTk5OTsgd2lkdGg6NDVweDsgaGVpZ2h0OjQ1cHg7IGJvcmRlci1yYWRpdXM6NTAlOyBiYWNrZ3JvdW5kOiMzMzM7IGNvbG9yOiNmZmY7IGJvcmRlcjpub25lOyBjdXJzb3I6cG9pbnRlcjsgZm9udC1zaXplOjIwcHg7IGJveC1zaGFkb3c6MCAycHggNXB4IHJnYmEoMCwwLDAsMC4zKTsiIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOmRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjonc21vb3RoJ30pIj7ihpM8L2J1dHRvbj5gOw0KICAgICAgICAgICAgICAgICAgLy9kb2N1bWVudC5ib2R5Lmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJywgbmF2SHRtbCk7DQoNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgeyBjb25zb2xlLmVycm9yKGUpOyBhbGVydCgiRXJyb3I6ICIgKyBlLm1lc3NhZ2UpOyB9IGZpbmFsbHkgeyBsb2FkaW5nLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7IH0NCiAgICAgICAgICB9DQoNCg0KDQogICAgICA8L3NjcmlwdD4NCg0KICAgICAgPGJ1dHRvbiBpZD0iYnRuR29Cb3R0b20iDQogICAgICAgICAgICAgIGNsYXNzPSJuYXYtc2Nyb2xsLWJ0biINCiAgICAgICAgICAgICAgb25jbGljaz0id2luZG93LnNjcm9sbFRvKHt0b3A6IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LCBiZWhhdmlvcjogJ3Ntb290aCd9KSINCiAgICAgICAgICAgICAgdGl0bGU9IkdvIHRvIEJvdHRvbSI+DQogICAgICAgICAg4oaTDQogICAgICA8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gaWQ9ImJ0bkdvVG9wIg0KICAgICAgICAgICAgICBjbGFzcz0ibmF2LXNjcm9sbC1idG4iDQogICAgICAgICAgICAgIG9uY2xpY2s9IndpbmRvdy5zY3JvbGxUbyh7dG9wOiAwLCBiZWhhdmlvcjogJ3Ntb290aCd9KSINCiAgICAgICAgICAgICAgdGl0bGU9IkdvIHRvIFRvcCI+DQogICAgICAgICAg4oaRDQogICAgICA8L2J1dHRvbj4NCiAgPC9ib2R5Pg0KPC9odG1sPg0K"))));</script>